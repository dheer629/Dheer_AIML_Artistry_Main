var L4=Object.defineProperty;var QP=e=>{throw TypeError(e)};var F4=(e,t,n)=>t in e?L4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Pe=(e,t,n)=>F4(e,typeof t!="symbol"?t+"":t,n),mb=(e,t,n)=>t.has(e)||QP("Cannot "+n);var ct=(e,t,n)=>(mb(e,t,"read from private field"),n?n.call(e):t.get(e)),Yn=(e,t,n)=>t.has(e)?QP("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),wn=(e,t,n,r)=>(mb(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),fs=(e,t,n)=>(mb(e,t,"access private method"),n);var nv=(e,t,n,r)=>({set _(s){wn(e,t,s,n)},get _(){return ct(e,t,r)}});function R4(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function j4(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var BA={exports:{}},Vw={},VA={exports:{}},kn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z0=Symbol.for("react.element"),N4=Symbol.for("react.portal"),z4=Symbol.for("react.fragment"),B4=Symbol.for("react.strict_mode"),V4=Symbol.for("react.profiler"),U4=Symbol.for("react.provider"),W4=Symbol.for("react.context"),G4=Symbol.for("react.forward_ref"),K4=Symbol.for("react.suspense"),H4=Symbol.for("react.memo"),q4=Symbol.for("react.lazy"),YP=Symbol.iterator;function Q4(e){return e===null||typeof e!="object"?null:(e=YP&&e[YP]||e["@@iterator"],typeof e=="function"?e:null)}var UA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WA=Object.assign,GA={};function Jh(e,t,n){this.props=e,this.context=t,this.refs=GA,this.updater=n||UA}Jh.prototype.isReactComponent={};Jh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KA(){}KA.prototype=Jh.prototype;function rT(e,t,n){this.props=e,this.context=t,this.refs=GA,this.updater=n||UA}var sT=rT.prototype=new KA;sT.constructor=rT;WA(sT,Jh.prototype);sT.isPureReactComponent=!0;var XP=Array.isArray,HA=Object.prototype.hasOwnProperty,iT={current:null},qA={key:!0,ref:!0,__self:!0,__source:!0};function QA(e,t,n){var r,s={},o=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)HA.call(t,r)&&!qA.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:z0,type:e,key:o,ref:a,props:s,_owner:iT.current}}function Y4(e,t){return{$$typeof:z0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function oT(e){return typeof e=="object"&&e!==null&&e.$$typeof===z0}function X4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var JP=/\/+/g;function gb(e,t){return typeof e=="object"&&e!==null&&e.key!=null?X4(""+e.key):t.toString(36)}function Dv(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case z0:case N4:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+gb(a,0):r,XP(s)?(n="",e!=null&&(n=e.replace(JP,"$&/")+"/"),Dv(s,t,n,"",function(d){return d})):s!=null&&(oT(s)&&(s=Y4(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(JP,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",XP(e))for(var c=0;c<e.length;c++){o=e[c];var u=r+gb(o,c);a+=Dv(o,t,n,u,s)}else if(u=Q4(e),typeof u=="function")for(e=u.call(e),c=0;!(o=e.next()).done;)o=o.value,u=r+gb(o,c++),a+=Dv(o,t,n,u,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function rv(e,t,n){if(e==null)return e;var r=[],s=0;return Dv(e,r,"","",function(o){return t.call(n,o,s++)}),r}function J4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $s={current:null},Lv={transition:null},Z4={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:Lv,ReactCurrentOwner:iT};function YA(){throw Error("act(...) is not supported in production builds of React.")}kn.Children={map:rv,forEach:function(e,t,n){rv(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return rv(e,function(){t++}),t},toArray:function(e){return rv(e,function(t){return t})||[]},only:function(e){if(!oT(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};kn.Component=Jh;kn.Fragment=z4;kn.Profiler=V4;kn.PureComponent=rT;kn.StrictMode=B4;kn.Suspense=K4;kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z4;kn.act=YA;kn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=WA({},e.props),s=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=iT.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)HA.call(t,u)&&!qA.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:z0,type:e.type,key:s,ref:o,props:r,_owner:a}};kn.createContext=function(e){return e={$$typeof:W4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:U4,_context:e},e.Consumer=e};kn.createElement=QA;kn.createFactory=function(e){var t=QA.bind(null,e);return t.type=e,t};kn.createRef=function(){return{current:null}};kn.forwardRef=function(e){return{$$typeof:G4,render:e}};kn.isValidElement=oT;kn.lazy=function(e){return{$$typeof:q4,_payload:{_status:-1,_result:e},_init:J4}};kn.memo=function(e,t){return{$$typeof:H4,type:e,compare:t===void 0?null:t}};kn.startTransition=function(e){var t=Lv.transition;Lv.transition={};try{e()}finally{Lv.transition=t}};kn.unstable_act=YA;kn.useCallback=function(e,t){return $s.current.useCallback(e,t)};kn.useContext=function(e){return $s.current.useContext(e)};kn.useDebugValue=function(){};kn.useDeferredValue=function(e){return $s.current.useDeferredValue(e)};kn.useEffect=function(e,t){return $s.current.useEffect(e,t)};kn.useId=function(){return $s.current.useId()};kn.useImperativeHandle=function(e,t,n){return $s.current.useImperativeHandle(e,t,n)};kn.useInsertionEffect=function(e,t){return $s.current.useInsertionEffect(e,t)};kn.useLayoutEffect=function(e,t){return $s.current.useLayoutEffect(e,t)};kn.useMemo=function(e,t){return $s.current.useMemo(e,t)};kn.useReducer=function(e,t,n){return $s.current.useReducer(e,t,n)};kn.useRef=function(e){return $s.current.useRef(e)};kn.useState=function(e){return $s.current.useState(e)};kn.useSyncExternalStore=function(e,t,n){return $s.current.useSyncExternalStore(e,t,n)};kn.useTransition=function(){return $s.current.useTransition()};kn.version="18.3.1";VA.exports=kn;var B=VA.exports;const we=zA(B),XA=R4({__proto__:null,default:we},[B]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ej=B,tj=Symbol.for("react.element"),nj=Symbol.for("react.fragment"),rj=Object.prototype.hasOwnProperty,sj=ej.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ij={key:!0,ref:!0,__self:!0,__source:!0};function JA(e,t,n){var r,s={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)rj.call(t,r)&&!ij.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:tj,type:e,key:o,ref:a,props:s,_owner:sj.current}}Vw.Fragment=nj;Vw.jsx=JA;Vw.jsxs=JA;BA.exports=Vw;var R=BA.exports,ZA={exports:{}},di={},e3={exports:{}},t3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,ke){var De=te.length;te.push(ke);e:for(;0<De;){var me=De-1>>>1,ee=te[me];if(0<s(ee,ke))te[me]=ke,te[De]=ee,De=me;else break e}}function n(te){return te.length===0?null:te[0]}function r(te){if(te.length===0)return null;var ke=te[0],De=te.pop();if(De!==ke){te[0]=De;e:for(var me=0,ee=te.length,ge=ee>>>1;me<ge;){var Ie=2*(me+1)-1,Be=te[Ie],Ue=Ie+1,pe=te[Ue];if(0>s(Be,De))Ue<ee&&0>s(pe,Be)?(te[me]=pe,te[Ue]=De,me=Ue):(te[me]=Be,te[Ie]=De,me=Ie);else if(Ue<ee&&0>s(pe,De))te[me]=pe,te[Ue]=De,me=Ue;else break e}}return ke}function s(te,ke){var De=te.sortIndex-ke.sortIndex;return De!==0?De:te.id-ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var u=[],d=[],h=1,m=null,p=3,v=!1,T=!1,E=!1,O=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(te){for(var ke=n(d);ke!==null;){if(ke.callback===null)r(d);else if(ke.startTime<=te)r(d),ke.sortIndex=ke.expirationTime,t(u,ke);else break;ke=n(d)}}function k(te){if(E=!1,I(te),!T)if(n(u)!==null)T=!0,ye($);else{var ke=n(d);ke!==null&&xe(k,ke.startTime-te)}}function $(te,ke){T=!1,E&&(E=!1,b(j),j=-1),v=!0;var De=p;try{for(I(ke),m=n(u);m!==null&&(!(m.expirationTime>ke)||te&&!oe());){var me=m.callback;if(typeof me=="function"){m.callback=null,p=m.priorityLevel;var ee=me(m.expirationTime<=ke);ke=e.unstable_now(),typeof ee=="function"?m.callback=ee:m===n(u)&&r(u),I(ke)}else r(u);m=n(u)}if(m!==null)var ge=!0;else{var Ie=n(d);Ie!==null&&xe(k,Ie.startTime-ke),ge=!1}return ge}finally{m=null,p=De,v=!1}}var P=!1,D=null,j=-1,Y=5,q=-1;function oe(){return!(e.unstable_now()-q<Y)}function de(){if(D!==null){var te=e.unstable_now();q=te;var ke=!0;try{ke=D(!0,te)}finally{ke?re():(P=!1,D=null)}}else P=!1}var re;if(typeof M=="function")re=function(){M(de)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ue=he.port2;he.port1.onmessage=de,re=function(){ue.postMessage(null)}}else re=function(){O(de,0)};function ye(te){D=te,P||(P=!0,re())}function xe(te,ke){j=O(function(){te(e.unstable_now())},ke)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){T||v||(T=!0,ye($))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(te){switch(p){case 1:case 2:case 3:var ke=3;break;default:ke=p}var De=p;p=ke;try{return te()}finally{p=De}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,ke){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var De=p;p=te;try{return ke()}finally{p=De}},e.unstable_scheduleCallback=function(te,ke,De){var me=e.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?me+De:me):De=me,te){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=De+ee,te={id:h++,callback:ke,priorityLevel:te,startTime:De,expirationTime:ee,sortIndex:-1},De>me?(te.sortIndex=De,t(d,te),n(u)===null&&te===n(d)&&(E?(b(j),j=-1):E=!0,xe(k,De-me))):(te.sortIndex=ee,t(u,te),T||v||(T=!0,ye($))),te},e.unstable_shouldYield=oe,e.unstable_wrapCallback=function(te){var ke=p;return function(){var De=p;p=ke;try{return te.apply(this,arguments)}finally{p=De}}}})(t3);e3.exports=t3;var oj=e3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aj=B,ci=oj;function vt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n3=new Set,l0={};function Gc(e,t){Rh(e,t),Rh(e+"Capture",t)}function Rh(e,t){for(l0[e]=t,e=0;e<t.length;e++)n3.add(t[e])}var ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gx=Object.prototype.hasOwnProperty,lj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ZP={},eS={};function cj(e){return gx.call(eS,e)?!0:gx.call(ZP,e)?!1:lj.test(e)?eS[e]=!0:(ZP[e]=!0,!1)}function uj(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function dj(e,t,n,r){if(t===null||typeof t>"u"||uj(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Is(e,t,n,r,s,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var os={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){os[e]=new Is(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];os[t]=new Is(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){os[e]=new Is(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){os[e]=new Is(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){os[e]=new Is(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){os[e]=new Is(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){os[e]=new Is(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){os[e]=new Is(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){os[e]=new Is(e,5,!1,e.toLowerCase(),null,!1,!1)});var aT=/[\-:]([a-z])/g;function lT(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(aT,lT);os[t]=new Is(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(aT,lT);os[t]=new Is(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(aT,lT);os[t]=new Is(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){os[e]=new Is(e,1,!1,e.toLowerCase(),null,!1,!1)});os.xlinkHref=new Is("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){os[e]=new Is(e,1,!1,e.toLowerCase(),null,!0,!0)});function cT(e,t,n,r){var s=os.hasOwnProperty(t)?os[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(dj(t,n,s,r)&&(n=null),r||s===null?cj(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ya=aj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sv=Symbol.for("react.element"),th=Symbol.for("react.portal"),nh=Symbol.for("react.fragment"),uT=Symbol.for("react.strict_mode"),_x=Symbol.for("react.profiler"),r3=Symbol.for("react.provider"),s3=Symbol.for("react.context"),dT=Symbol.for("react.forward_ref"),yx=Symbol.for("react.suspense"),vx=Symbol.for("react.suspense_list"),hT=Symbol.for("react.memo"),Za=Symbol.for("react.lazy"),i3=Symbol.for("react.offscreen"),tS=Symbol.iterator;function y_(e){return e===null||typeof e!="object"?null:(e=tS&&e[tS]||e["@@iterator"],typeof e=="function"?e:null)}var Tr=Object.assign,_b;function L_(e){if(_b===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);_b=t&&t[1]||""}return`
`+_b+e}var yb=!1;function vb(e,t){if(!e||yb)return"";yb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),a=s.length-1,c=o.length-1;1<=a&&0<=c&&s[a]!==o[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==o[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==o[c]){var u=`
`+s[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=c);break}}}finally{yb=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L_(e):""}function hj(e){switch(e.tag){case 5:return L_(e.type);case 16:return L_("Lazy");case 13:return L_("Suspense");case 19:return L_("SuspenseList");case 0:case 2:case 15:return e=vb(e.type,!1),e;case 11:return e=vb(e.type.render,!1),e;case 1:return e=vb(e.type,!0),e;default:return""}}function wx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case nh:return"Fragment";case th:return"Portal";case _x:return"Profiler";case uT:return"StrictMode";case yx:return"Suspense";case vx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case s3:return(e.displayName||"Context")+".Consumer";case r3:return(e._context.displayName||"Context")+".Provider";case dT:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case hT:return t=e.displayName||null,t!==null?t:wx(e.type)||"Memo";case Za:t=e._payload,e=e._init;try{return wx(e(t))}catch{}}return null}function fj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wx(t);case 8:return t===uT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ml(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function o3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pj(e){var t=o3(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function iv(e){e._valueTracker||(e._valueTracker=pj(e))}function a3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=o3(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function tw(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bx(e,t){var n=t.checked;return Tr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function nS(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ml(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function l3(e,t){t=t.checked,t!=null&&cT(e,"checked",t,!1)}function xx(e,t){l3(e,t);var n=Ml(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Mx(e,t.type,n):t.hasOwnProperty("defaultValue")&&Mx(e,t.type,Ml(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rS(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Mx(e,t,n){(t!=="number"||tw(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var F_=Array.isArray;function vh(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ml(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Tx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(vt(91));return Tr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sS(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(vt(92));if(F_(n)){if(1<n.length)throw Error(vt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ml(n)}}function c3(e,t){var n=Ml(t.value),r=Ml(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function iS(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function u3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ex(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?u3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ov,d3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ov=ov||document.createElement("div"),ov.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ov.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function c0(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var G_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mj=["Webkit","ms","Moz","O"];Object.keys(G_).forEach(function(e){mj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),G_[t]=G_[e]})});function h3(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||G_.hasOwnProperty(e)&&G_[e]?(""+t).trim():t+"px"}function f3(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=h3(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var gj=Tr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Px(e,t){if(t){if(gj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(vt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(vt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(vt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(vt(62))}}function Sx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cx=null;function fT(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kx=null,wh=null,bh=null;function oS(e){if(e=U0(e)){if(typeof kx!="function")throw Error(vt(280));var t=e.stateNode;t&&(t=Hw(t),kx(e.stateNode,e.type,t))}}function p3(e){wh?bh?bh.push(e):bh=[e]:wh=e}function m3(){if(wh){var e=wh,t=bh;if(bh=wh=null,oS(e),t)for(e=0;e<t.length;e++)oS(t[e])}}function g3(e,t){return e(t)}function _3(){}var wb=!1;function y3(e,t,n){if(wb)return e(t,n);wb=!0;try{return g3(e,t,n)}finally{wb=!1,(wh!==null||bh!==null)&&(_3(),m3())}}function u0(e,t){var n=e.stateNode;if(n===null)return null;var r=Hw(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(vt(231,t,typeof n));return n}var Ax=!1;if(ca)try{var v_={};Object.defineProperty(v_,"passive",{get:function(){Ax=!0}}),window.addEventListener("test",v_,v_),window.removeEventListener("test",v_,v_)}catch{Ax=!1}function _j(e,t,n,r,s,o,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(h){this.onError(h)}}var K_=!1,nw=null,rw=!1,$x=null,yj={onError:function(e){K_=!0,nw=e}};function vj(e,t,n,r,s,o,a,c,u){K_=!1,nw=null,_j.apply(yj,arguments)}function wj(e,t,n,r,s,o,a,c,u){if(vj.apply(this,arguments),K_){if(K_){var d=nw;K_=!1,nw=null}else throw Error(vt(198));rw||(rw=!0,$x=d)}}function Kc(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function v3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function aS(e){if(Kc(e)!==e)throw Error(vt(188))}function bj(e){var t=e.alternate;if(!t){if(t=Kc(e),t===null)throw Error(vt(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return aS(s),e;if(o===r)return aS(s),t;o=o.sibling}throw Error(vt(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=o;break}if(c===r){a=!0,r=s,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=s;break}if(c===r){a=!0,r=o,n=s;break}c=c.sibling}if(!a)throw Error(vt(189))}}if(n.alternate!==r)throw Error(vt(190))}if(n.tag!==3)throw Error(vt(188));return n.stateNode.current===n?e:t}function w3(e){return e=bj(e),e!==null?b3(e):null}function b3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=b3(e);if(t!==null)return t;e=e.sibling}return null}var x3=ci.unstable_scheduleCallback,lS=ci.unstable_cancelCallback,xj=ci.unstable_shouldYield,Mj=ci.unstable_requestPaint,zr=ci.unstable_now,Tj=ci.unstable_getCurrentPriorityLevel,pT=ci.unstable_ImmediatePriority,M3=ci.unstable_UserBlockingPriority,sw=ci.unstable_NormalPriority,Ej=ci.unstable_LowPriority,T3=ci.unstable_IdlePriority,Uw=null,ko=null;function Pj(e){if(ko&&typeof ko.onCommitFiberRoot=="function")try{ko.onCommitFiberRoot(Uw,e,void 0,(e.current.flags&128)===128)}catch{}}var Ji=Math.clz32?Math.clz32:kj,Sj=Math.log,Cj=Math.LN2;function kj(e){return e>>>=0,e===0?32:31-(Sj(e)/Cj|0)|0}var av=64,lv=4194304;function R_(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function iw(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=R_(c):(o&=a,o!==0&&(r=R_(o)))}else a=n&~s,a!==0?r=R_(a):o!==0&&(r=R_(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ji(t),s=1<<n,r|=e[n],t&=~s;return r}function Aj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $j(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Ji(o),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=Aj(c,t)):u<=t&&(e.expiredLanes|=c),o&=~c}}function Ix(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function E3(){var e=av;return av<<=1,!(av&4194240)&&(av=64),e}function bb(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function B0(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ji(t),e[t]=n}function Ij(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ji(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function mT(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ji(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Jn=0;function P3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var S3,gT,C3,k3,A3,Ox=!1,cv=[],fl=null,pl=null,ml=null,d0=new Map,h0=new Map,nl=[],Oj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cS(e,t){switch(e){case"focusin":case"focusout":fl=null;break;case"dragenter":case"dragleave":pl=null;break;case"mouseover":case"mouseout":ml=null;break;case"pointerover":case"pointerout":d0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":h0.delete(t.pointerId)}}function w_(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=U0(t),t!==null&&gT(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Dj(e,t,n,r,s){switch(t){case"focusin":return fl=w_(fl,e,t,n,r,s),!0;case"dragenter":return pl=w_(pl,e,t,n,r,s),!0;case"mouseover":return ml=w_(ml,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return d0.set(o,w_(d0.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,h0.set(o,w_(h0.get(o)||null,e,t,n,r,s)),!0}return!1}function $3(e){var t=Ec(e.target);if(t!==null){var n=Kc(t);if(n!==null){if(t=n.tag,t===13){if(t=v3(n),t!==null){e.blockedOn=t,A3(e.priority,function(){C3(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Cx=r,n.target.dispatchEvent(r),Cx=null}else return t=U0(n),t!==null&&gT(t),e.blockedOn=n,!1;t.shift()}return!0}function uS(e,t,n){Fv(e)&&n.delete(t)}function Lj(){Ox=!1,fl!==null&&Fv(fl)&&(fl=null),pl!==null&&Fv(pl)&&(pl=null),ml!==null&&Fv(ml)&&(ml=null),d0.forEach(uS),h0.forEach(uS)}function b_(e,t){e.blockedOn===t&&(e.blockedOn=null,Ox||(Ox=!0,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,Lj)))}function f0(e){function t(s){return b_(s,e)}if(0<cv.length){b_(cv[0],e);for(var n=1;n<cv.length;n++){var r=cv[n];r.blockedOn===e&&(r.blockedOn=null)}}for(fl!==null&&b_(fl,e),pl!==null&&b_(pl,e),ml!==null&&b_(ml,e),d0.forEach(t),h0.forEach(t),n=0;n<nl.length;n++)r=nl[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<nl.length&&(n=nl[0],n.blockedOn===null);)$3(n),n.blockedOn===null&&nl.shift()}var xh=ya.ReactCurrentBatchConfig,ow=!0;function Fj(e,t,n,r){var s=Jn,o=xh.transition;xh.transition=null;try{Jn=1,_T(e,t,n,r)}finally{Jn=s,xh.transition=o}}function Rj(e,t,n,r){var s=Jn,o=xh.transition;xh.transition=null;try{Jn=4,_T(e,t,n,r)}finally{Jn=s,xh.transition=o}}function _T(e,t,n,r){if(ow){var s=Dx(e,t,n,r);if(s===null)$b(e,t,r,aw,n),cS(e,r);else if(Dj(s,e,t,n,r))r.stopPropagation();else if(cS(e,r),t&4&&-1<Oj.indexOf(e)){for(;s!==null;){var o=U0(s);if(o!==null&&S3(o),o=Dx(e,t,n,r),o===null&&$b(e,t,r,aw,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else $b(e,t,r,null,n)}}var aw=null;function Dx(e,t,n,r){if(aw=null,e=fT(r),e=Ec(e),e!==null)if(t=Kc(e),t===null)e=null;else if(n=t.tag,n===13){if(e=v3(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return aw=e,null}function I3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Tj()){case pT:return 1;case M3:return 4;case sw:case Ej:return 16;case T3:return 536870912;default:return 16}default:return 16}}var ul=null,yT=null,Rv=null;function O3(){if(Rv)return Rv;var e,t=yT,n=t.length,r,s="value"in ul?ul.value:ul.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[o-r];r++);return Rv=s.slice(e,1<r?1-r:void 0)}function jv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function uv(){return!0}function dS(){return!1}function hi(e){function t(n,r,s,o,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?uv:dS,this.isPropagationStopped=dS,this}return Tr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=uv)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=uv)},persist:function(){},isPersistent:uv}),t}var Zh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vT=hi(Zh),V0=Tr({},Zh,{view:0,detail:0}),jj=hi(V0),xb,Mb,x_,Ww=Tr({},V0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wT,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==x_&&(x_&&e.type==="mousemove"?(xb=e.screenX-x_.screenX,Mb=e.screenY-x_.screenY):Mb=xb=0,x_=e),xb)},movementY:function(e){return"movementY"in e?e.movementY:Mb}}),hS=hi(Ww),Nj=Tr({},Ww,{dataTransfer:0}),zj=hi(Nj),Bj=Tr({},V0,{relatedTarget:0}),Tb=hi(Bj),Vj=Tr({},Zh,{animationName:0,elapsedTime:0,pseudoElement:0}),Uj=hi(Vj),Wj=Tr({},Zh,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gj=hi(Wj),Kj=Tr({},Zh,{data:0}),fS=hi(Kj),Hj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Qj[e])?!!t[e]:!1}function wT(){return Yj}var Xj=Tr({},V0,{key:function(e){if(e.key){var t=Hj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wT,charCode:function(e){return e.type==="keypress"?jv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Jj=hi(Xj),Zj=Tr({},Ww,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pS=hi(Zj),eN=Tr({},V0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wT}),tN=hi(eN),nN=Tr({},Zh,{propertyName:0,elapsedTime:0,pseudoElement:0}),rN=hi(nN),sN=Tr({},Ww,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iN=hi(sN),oN=[9,13,27,32],bT=ca&&"CompositionEvent"in window,H_=null;ca&&"documentMode"in document&&(H_=document.documentMode);var aN=ca&&"TextEvent"in window&&!H_,D3=ca&&(!bT||H_&&8<H_&&11>=H_),mS=" ",gS=!1;function L3(e,t){switch(e){case"keyup":return oN.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rh=!1;function lN(e,t){switch(e){case"compositionend":return F3(t);case"keypress":return t.which!==32?null:(gS=!0,mS);case"textInput":return e=t.data,e===mS&&gS?null:e;default:return null}}function cN(e,t){if(rh)return e==="compositionend"||!bT&&L3(e,t)?(e=O3(),Rv=yT=ul=null,rh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return D3&&t.locale!=="ko"?null:t.data;default:return null}}var uN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _S(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!uN[e.type]:t==="textarea"}function R3(e,t,n,r){p3(r),t=lw(t,"onChange"),0<t.length&&(n=new vT("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var q_=null,p0=null;function dN(e){q3(e,0)}function Gw(e){var t=oh(e);if(a3(t))return e}function hN(e,t){if(e==="change")return t}var j3=!1;if(ca){var Eb;if(ca){var Pb="oninput"in document;if(!Pb){var yS=document.createElement("div");yS.setAttribute("oninput","return;"),Pb=typeof yS.oninput=="function"}Eb=Pb}else Eb=!1;j3=Eb&&(!document.documentMode||9<document.documentMode)}function vS(){q_&&(q_.detachEvent("onpropertychange",N3),p0=q_=null)}function N3(e){if(e.propertyName==="value"&&Gw(p0)){var t=[];R3(t,p0,e,fT(e)),y3(dN,t)}}function fN(e,t,n){e==="focusin"?(vS(),q_=t,p0=n,q_.attachEvent("onpropertychange",N3)):e==="focusout"&&vS()}function pN(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gw(p0)}function mN(e,t){if(e==="click")return Gw(t)}function gN(e,t){if(e==="input"||e==="change")return Gw(t)}function _N(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var eo=typeof Object.is=="function"?Object.is:_N;function m0(e,t){if(eo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!gx.call(t,s)||!eo(e[s],t[s]))return!1}return!0}function wS(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bS(e,t){var n=wS(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wS(n)}}function z3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?z3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function B3(){for(var e=window,t=tw();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=tw(e.document)}return t}function xT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yN(e){var t=B3(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&z3(n.ownerDocument.documentElement,n)){if(r!==null&&xT(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=bS(n,o);var a=bS(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vN=ca&&"documentMode"in document&&11>=document.documentMode,sh=null,Lx=null,Q_=null,Fx=!1;function xS(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Fx||sh==null||sh!==tw(r)||(r=sh,"selectionStart"in r&&xT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Q_&&m0(Q_,r)||(Q_=r,r=lw(Lx,"onSelect"),0<r.length&&(t=new vT("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=sh)))}function dv(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ih={animationend:dv("Animation","AnimationEnd"),animationiteration:dv("Animation","AnimationIteration"),animationstart:dv("Animation","AnimationStart"),transitionend:dv("Transition","TransitionEnd")},Sb={},V3={};ca&&(V3=document.createElement("div").style,"AnimationEvent"in window||(delete ih.animationend.animation,delete ih.animationiteration.animation,delete ih.animationstart.animation),"TransitionEvent"in window||delete ih.transitionend.transition);function Kw(e){if(Sb[e])return Sb[e];if(!ih[e])return e;var t=ih[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in V3)return Sb[e]=t[n];return e}var U3=Kw("animationend"),W3=Kw("animationiteration"),G3=Kw("animationstart"),K3=Kw("transitionend"),H3=new Map,MS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $l(e,t){H3.set(e,t),Gc(t,[e])}for(var Cb=0;Cb<MS.length;Cb++){var kb=MS[Cb],wN=kb.toLowerCase(),bN=kb[0].toUpperCase()+kb.slice(1);$l(wN,"on"+bN)}$l(U3,"onAnimationEnd");$l(W3,"onAnimationIteration");$l(G3,"onAnimationStart");$l("dblclick","onDoubleClick");$l("focusin","onFocus");$l("focusout","onBlur");$l(K3,"onTransitionEnd");Rh("onMouseEnter",["mouseout","mouseover"]);Rh("onMouseLeave",["mouseout","mouseover"]);Rh("onPointerEnter",["pointerout","pointerover"]);Rh("onPointerLeave",["pointerout","pointerover"]);Gc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var j_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xN=new Set("cancel close invalid load scroll toggle".split(" ").concat(j_));function TS(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,wj(r,t,void 0,e),e.currentTarget=null}function q3(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==o&&s.isPropagationStopped())break e;TS(s,c,d),o=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==o&&s.isPropagationStopped())break e;TS(s,c,d),o=u}}}if(rw)throw e=$x,rw=!1,$x=null,e}function ur(e,t){var n=t[Bx];n===void 0&&(n=t[Bx]=new Set);var r=e+"__bubble";n.has(r)||(Q3(t,e,2,!1),n.add(r))}function Ab(e,t,n){var r=0;t&&(r|=4),Q3(n,e,r,t)}var hv="_reactListening"+Math.random().toString(36).slice(2);function g0(e){if(!e[hv]){e[hv]=!0,n3.forEach(function(n){n!=="selectionchange"&&(xN.has(n)||Ab(n,!1,e),Ab(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hv]||(t[hv]=!0,Ab("selectionchange",!1,t))}}function Q3(e,t,n,r){switch(I3(t)){case 1:var s=Fj;break;case 4:s=Rj;break;default:s=_T}n=s.bind(null,t,n,e),s=void 0,!Ax||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function $b(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=Ec(c),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}c=c.parentNode}}r=r.return}y3(function(){var d=o,h=fT(n),m=[];e:{var p=H3.get(e);if(p!==void 0){var v=vT,T=e;switch(e){case"keypress":if(jv(n)===0)break e;case"keydown":case"keyup":v=Jj;break;case"focusin":T="focus",v=Tb;break;case"focusout":T="blur",v=Tb;break;case"beforeblur":case"afterblur":v=Tb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=hS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=zj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=tN;break;case U3:case W3:case G3:v=Uj;break;case K3:v=rN;break;case"scroll":v=jj;break;case"wheel":v=iN;break;case"copy":case"cut":case"paste":v=Gj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=pS}var E=(t&4)!==0,O=!E&&e==="scroll",b=E?p!==null?p+"Capture":null:p;E=[];for(var M=d,I;M!==null;){I=M;var k=I.stateNode;if(I.tag===5&&k!==null&&(I=k,b!==null&&(k=u0(M,b),k!=null&&E.push(_0(M,k,I)))),O)break;M=M.return}0<E.length&&(p=new v(p,T,null,n,h),m.push({event:p,listeners:E}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",p&&n!==Cx&&(T=n.relatedTarget||n.fromElement)&&(Ec(T)||T[ua]))break e;if((v||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=d,T=T?Ec(T):null,T!==null&&(O=Kc(T),T!==O||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=d),v!==T)){if(E=hS,k="onMouseLeave",b="onMouseEnter",M="mouse",(e==="pointerout"||e==="pointerover")&&(E=pS,k="onPointerLeave",b="onPointerEnter",M="pointer"),O=v==null?p:oh(v),I=T==null?p:oh(T),p=new E(k,M+"leave",v,n,h),p.target=O,p.relatedTarget=I,k=null,Ec(h)===d&&(E=new E(b,M+"enter",T,n,h),E.target=I,E.relatedTarget=O,k=E),O=k,v&&T)t:{for(E=v,b=T,M=0,I=E;I;I=Hd(I))M++;for(I=0,k=b;k;k=Hd(k))I++;for(;0<M-I;)E=Hd(E),M--;for(;0<I-M;)b=Hd(b),I--;for(;M--;){if(E===b||b!==null&&E===b.alternate)break t;E=Hd(E),b=Hd(b)}E=null}else E=null;v!==null&&ES(m,p,v,E,!1),T!==null&&O!==null&&ES(m,O,T,E,!0)}}e:{if(p=d?oh(d):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var $=hN;else if(_S(p))if(j3)$=gN;else{$=pN;var P=fN}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&($=mN);if($&&($=$(e,d))){R3(m,$,n,h);break e}P&&P(e,p,d),e==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&Mx(p,"number",p.value)}switch(P=d?oh(d):window,e){case"focusin":(_S(P)||P.contentEditable==="true")&&(sh=P,Lx=d,Q_=null);break;case"focusout":Q_=Lx=sh=null;break;case"mousedown":Fx=!0;break;case"contextmenu":case"mouseup":case"dragend":Fx=!1,xS(m,n,h);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":xS(m,n,h)}var D;if(bT)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else rh?L3(e,n)&&(j="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(D3&&n.locale!=="ko"&&(rh||j!=="onCompositionStart"?j==="onCompositionEnd"&&rh&&(D=O3()):(ul=h,yT="value"in ul?ul.value:ul.textContent,rh=!0)),P=lw(d,j),0<P.length&&(j=new fS(j,e,null,n,h),m.push({event:j,listeners:P}),D?j.data=D:(D=F3(n),D!==null&&(j.data=D)))),(D=aN?lN(e,n):cN(e,n))&&(d=lw(d,"onBeforeInput"),0<d.length&&(h=new fS("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=D))}q3(m,t)})}function _0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function lw(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=u0(e,n),o!=null&&r.unshift(_0(e,o,s)),o=u0(e,t),o!=null&&r.push(_0(e,o,s))),e=e.return}return r}function Hd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ES(e,t,n,r,s){for(var o=t._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=u0(n,o),u!=null&&a.unshift(_0(n,u,c))):s||(u=u0(n,o),u!=null&&a.push(_0(n,u,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var MN=/\r\n?/g,TN=/\u0000|\uFFFD/g;function PS(e){return(typeof e=="string"?e:""+e).replace(MN,`
`).replace(TN,"")}function fv(e,t,n){if(t=PS(t),PS(e)!==t&&n)throw Error(vt(425))}function cw(){}var Rx=null,jx=null;function Nx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zx=typeof setTimeout=="function"?setTimeout:void 0,EN=typeof clearTimeout=="function"?clearTimeout:void 0,SS=typeof Promise=="function"?Promise:void 0,PN=typeof queueMicrotask=="function"?queueMicrotask:typeof SS<"u"?function(e){return SS.resolve(null).then(e).catch(SN)}:zx;function SN(e){setTimeout(function(){throw e})}function Ib(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),f0(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);f0(t)}function gl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function CS(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ef=Math.random().toString(36).slice(2),Co="__reactFiber$"+ef,y0="__reactProps$"+ef,ua="__reactContainer$"+ef,Bx="__reactEvents$"+ef,CN="__reactListeners$"+ef,kN="__reactHandles$"+ef;function Ec(e){var t=e[Co];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ua]||n[Co]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=CS(e);e!==null;){if(n=e[Co])return n;e=CS(e)}return t}e=n,n=e.parentNode}return null}function U0(e){return e=e[Co]||e[ua],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function oh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(vt(33))}function Hw(e){return e[y0]||null}var Vx=[],ah=-1;function Il(e){return{current:e}}function dr(e){0>ah||(e.current=Vx[ah],Vx[ah]=null,ah--)}function ar(e,t){ah++,Vx[ah]=e.current,e.current=t}var Tl={},ws=Il(Tl),Ks=Il(!1),Nc=Tl;function jh(e,t){var n=e.type.contextTypes;if(!n)return Tl;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Hs(e){return e=e.childContextTypes,e!=null}function uw(){dr(Ks),dr(ws)}function kS(e,t,n){if(ws.current!==Tl)throw Error(vt(168));ar(ws,t),ar(Ks,n)}function Y3(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(vt(108,fj(e)||"Unknown",s));return Tr({},n,r)}function dw(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tl,Nc=ws.current,ar(ws,e),ar(Ks,Ks.current),!0}function AS(e,t,n){var r=e.stateNode;if(!r)throw Error(vt(169));n?(e=Y3(e,t,Nc),r.__reactInternalMemoizedMergedChildContext=e,dr(Ks),dr(ws),ar(ws,e)):dr(Ks),ar(Ks,n)}var ra=null,qw=!1,Ob=!1;function X3(e){ra===null?ra=[e]:ra.push(e)}function AN(e){qw=!0,X3(e)}function Ol(){if(!Ob&&ra!==null){Ob=!0;var e=0,t=Jn;try{var n=ra;for(Jn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ra=null,qw=!1}catch(s){throw ra!==null&&(ra=ra.slice(e+1)),x3(pT,Ol),s}finally{Jn=t,Ob=!1}}return null}var lh=[],ch=0,hw=null,fw=0,Ei=[],Pi=0,zc=null,sa=1,ia="";function vc(e,t){lh[ch++]=fw,lh[ch++]=hw,hw=e,fw=t}function J3(e,t,n){Ei[Pi++]=sa,Ei[Pi++]=ia,Ei[Pi++]=zc,zc=e;var r=sa;e=ia;var s=32-Ji(r)-1;r&=~(1<<s),n+=1;var o=32-Ji(t)+s;if(30<o){var a=s-s%5;o=(r&(1<<a)-1).toString(32),r>>=a,s-=a,sa=1<<32-Ji(t)+s|n<<s|r,ia=o+e}else sa=1<<o|n<<s|r,ia=e}function MT(e){e.return!==null&&(vc(e,1),J3(e,1,0))}function TT(e){for(;e===hw;)hw=lh[--ch],lh[ch]=null,fw=lh[--ch],lh[ch]=null;for(;e===zc;)zc=Ei[--Pi],Ei[Pi]=null,ia=Ei[--Pi],Ei[Pi]=null,sa=Ei[--Pi],Ei[Pi]=null}var oi=null,ii=null,yr=!1,Xi=null;function Z3(e,t){var n=Si(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function $S(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,oi=e,ii=gl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,oi=e,ii=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=zc!==null?{id:sa,overflow:ia}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Si(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,oi=e,ii=null,!0):!1;default:return!1}}function Ux(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Wx(e){if(yr){var t=ii;if(t){var n=t;if(!$S(e,t)){if(Ux(e))throw Error(vt(418));t=gl(n.nextSibling);var r=oi;t&&$S(e,t)?Z3(r,n):(e.flags=e.flags&-4097|2,yr=!1,oi=e)}}else{if(Ux(e))throw Error(vt(418));e.flags=e.flags&-4097|2,yr=!1,oi=e}}}function IS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;oi=e}function pv(e){if(e!==oi)return!1;if(!yr)return IS(e),yr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nx(e.type,e.memoizedProps)),t&&(t=ii)){if(Ux(e))throw e$(),Error(vt(418));for(;t;)Z3(e,t),t=gl(t.nextSibling)}if(IS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(vt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ii=gl(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ii=null}}else ii=oi?gl(e.stateNode.nextSibling):null;return!0}function e$(){for(var e=ii;e;)e=gl(e.nextSibling)}function Nh(){ii=oi=null,yr=!1}function ET(e){Xi===null?Xi=[e]:Xi.push(e)}var $N=ya.ReactCurrentBatchConfig;function M_(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(vt(309));var r=n.stateNode}if(!r)throw Error(vt(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var c=s.refs;a===null?delete c[o]:c[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(vt(284));if(!n._owner)throw Error(vt(290,e))}return e}function mv(e,t){throw e=Object.prototype.toString.call(t),Error(vt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function OS(e){var t=e._init;return t(e._payload)}function t$(e){function t(b,M){if(e){var I=b.deletions;I===null?(b.deletions=[M],b.flags|=16):I.push(M)}}function n(b,M){if(!e)return null;for(;M!==null;)t(b,M),M=M.sibling;return null}function r(b,M){for(b=new Map;M!==null;)M.key!==null?b.set(M.key,M):b.set(M.index,M),M=M.sibling;return b}function s(b,M){return b=wl(b,M),b.index=0,b.sibling=null,b}function o(b,M,I){return b.index=I,e?(I=b.alternate,I!==null?(I=I.index,I<M?(b.flags|=2,M):I):(b.flags|=2,M)):(b.flags|=1048576,M)}function a(b){return e&&b.alternate===null&&(b.flags|=2),b}function c(b,M,I,k){return M===null||M.tag!==6?(M=zb(I,b.mode,k),M.return=b,M):(M=s(M,I),M.return=b,M)}function u(b,M,I,k){var $=I.type;return $===nh?h(b,M,I.props.children,k,I.key):M!==null&&(M.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Za&&OS($)===M.type)?(k=s(M,I.props),k.ref=M_(b,M,I),k.return=b,k):(k=Gv(I.type,I.key,I.props,null,b.mode,k),k.ref=M_(b,M,I),k.return=b,k)}function d(b,M,I,k){return M===null||M.tag!==4||M.stateNode.containerInfo!==I.containerInfo||M.stateNode.implementation!==I.implementation?(M=Bb(I,b.mode,k),M.return=b,M):(M=s(M,I.children||[]),M.return=b,M)}function h(b,M,I,k,$){return M===null||M.tag!==7?(M=Lc(I,b.mode,k,$),M.return=b,M):(M=s(M,I),M.return=b,M)}function m(b,M,I){if(typeof M=="string"&&M!==""||typeof M=="number")return M=zb(""+M,b.mode,I),M.return=b,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case sv:return I=Gv(M.type,M.key,M.props,null,b.mode,I),I.ref=M_(b,null,M),I.return=b,I;case th:return M=Bb(M,b.mode,I),M.return=b,M;case Za:var k=M._init;return m(b,k(M._payload),I)}if(F_(M)||y_(M))return M=Lc(M,b.mode,I,null),M.return=b,M;mv(b,M)}return null}function p(b,M,I,k){var $=M!==null?M.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return $!==null?null:c(b,M,""+I,k);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case sv:return I.key===$?u(b,M,I,k):null;case th:return I.key===$?d(b,M,I,k):null;case Za:return $=I._init,p(b,M,$(I._payload),k)}if(F_(I)||y_(I))return $!==null?null:h(b,M,I,k,null);mv(b,I)}return null}function v(b,M,I,k,$){if(typeof k=="string"&&k!==""||typeof k=="number")return b=b.get(I)||null,c(M,b,""+k,$);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case sv:return b=b.get(k.key===null?I:k.key)||null,u(M,b,k,$);case th:return b=b.get(k.key===null?I:k.key)||null,d(M,b,k,$);case Za:var P=k._init;return v(b,M,I,P(k._payload),$)}if(F_(k)||y_(k))return b=b.get(I)||null,h(M,b,k,$,null);mv(M,k)}return null}function T(b,M,I,k){for(var $=null,P=null,D=M,j=M=0,Y=null;D!==null&&j<I.length;j++){D.index>j?(Y=D,D=null):Y=D.sibling;var q=p(b,D,I[j],k);if(q===null){D===null&&(D=Y);break}e&&D&&q.alternate===null&&t(b,D),M=o(q,M,j),P===null?$=q:P.sibling=q,P=q,D=Y}if(j===I.length)return n(b,D),yr&&vc(b,j),$;if(D===null){for(;j<I.length;j++)D=m(b,I[j],k),D!==null&&(M=o(D,M,j),P===null?$=D:P.sibling=D,P=D);return yr&&vc(b,j),$}for(D=r(b,D);j<I.length;j++)Y=v(D,b,j,I[j],k),Y!==null&&(e&&Y.alternate!==null&&D.delete(Y.key===null?j:Y.key),M=o(Y,M,j),P===null?$=Y:P.sibling=Y,P=Y);return e&&D.forEach(function(oe){return t(b,oe)}),yr&&vc(b,j),$}function E(b,M,I,k){var $=y_(I);if(typeof $!="function")throw Error(vt(150));if(I=$.call(I),I==null)throw Error(vt(151));for(var P=$=null,D=M,j=M=0,Y=null,q=I.next();D!==null&&!q.done;j++,q=I.next()){D.index>j?(Y=D,D=null):Y=D.sibling;var oe=p(b,D,q.value,k);if(oe===null){D===null&&(D=Y);break}e&&D&&oe.alternate===null&&t(b,D),M=o(oe,M,j),P===null?$=oe:P.sibling=oe,P=oe,D=Y}if(q.done)return n(b,D),yr&&vc(b,j),$;if(D===null){for(;!q.done;j++,q=I.next())q=m(b,q.value,k),q!==null&&(M=o(q,M,j),P===null?$=q:P.sibling=q,P=q);return yr&&vc(b,j),$}for(D=r(b,D);!q.done;j++,q=I.next())q=v(D,b,j,q.value,k),q!==null&&(e&&q.alternate!==null&&D.delete(q.key===null?j:q.key),M=o(q,M,j),P===null?$=q:P.sibling=q,P=q);return e&&D.forEach(function(de){return t(b,de)}),yr&&vc(b,j),$}function O(b,M,I,k){if(typeof I=="object"&&I!==null&&I.type===nh&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case sv:e:{for(var $=I.key,P=M;P!==null;){if(P.key===$){if($=I.type,$===nh){if(P.tag===7){n(b,P.sibling),M=s(P,I.props.children),M.return=b,b=M;break e}}else if(P.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Za&&OS($)===P.type){n(b,P.sibling),M=s(P,I.props),M.ref=M_(b,P,I),M.return=b,b=M;break e}n(b,P);break}else t(b,P);P=P.sibling}I.type===nh?(M=Lc(I.props.children,b.mode,k,I.key),M.return=b,b=M):(k=Gv(I.type,I.key,I.props,null,b.mode,k),k.ref=M_(b,M,I),k.return=b,b=k)}return a(b);case th:e:{for(P=I.key;M!==null;){if(M.key===P)if(M.tag===4&&M.stateNode.containerInfo===I.containerInfo&&M.stateNode.implementation===I.implementation){n(b,M.sibling),M=s(M,I.children||[]),M.return=b,b=M;break e}else{n(b,M);break}else t(b,M);M=M.sibling}M=Bb(I,b.mode,k),M.return=b,b=M}return a(b);case Za:return P=I._init,O(b,M,P(I._payload),k)}if(F_(I))return T(b,M,I,k);if(y_(I))return E(b,M,I,k);mv(b,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,M!==null&&M.tag===6?(n(b,M.sibling),M=s(M,I),M.return=b,b=M):(n(b,M),M=zb(I,b.mode,k),M.return=b,b=M),a(b)):n(b,M)}return O}var zh=t$(!0),n$=t$(!1),pw=Il(null),mw=null,uh=null,PT=null;function ST(){PT=uh=mw=null}function CT(e){var t=pw.current;dr(pw),e._currentValue=t}function Gx(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Mh(e,t){mw=e,PT=uh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gs=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(PT!==e)if(e={context:e,memoizedValue:t,next:null},uh===null){if(mw===null)throw Error(vt(308));uh=e,mw.dependencies={lanes:0,firstContext:e}}else uh=uh.next=e;return t}var Pc=null;function kT(e){Pc===null?Pc=[e]:Pc.push(e)}function r$(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,kT(t)):(n.next=s.next,s.next=n),t.interleaved=n,da(e,r)}function da(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var el=!1;function AT(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s$(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function oa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _l(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Un&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,da(e,n)}return s=r.interleaved,s===null?(t.next=t,kT(r)):(t.next=s.next,s.next=t),r.interleaved=t,da(e,n)}function Nv(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,mT(e,n)}}function DS(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function gw(e,t,n,r){var s=e.updateQueue;el=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?o=d:a.next=d,a=u;var h=e.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==a&&(c===null?h.firstBaseUpdate=d:c.next=d,h.lastBaseUpdate=u))}if(o!==null){var m=s.baseState;a=0,h=d=u=null,c=o;do{var p=c.lane,v=c.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var T=e,E=c;switch(p=t,v=n,E.tag){case 1:if(T=E.payload,typeof T=="function"){m=T.call(v,m,p);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=E.payload,p=typeof T=="function"?T.call(v,m,p):T,p==null)break e;m=Tr({},m,p);break e;case 2:el=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[c]:p.push(c))}else v={eventTime:v,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(d=h=v,u=m):h=h.next=v,a|=p;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;p=c,c=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Vc|=a,e.lanes=a,e.memoizedState=m}}function LS(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(vt(191,s));s.call(r)}}}var W0={},Ao=Il(W0),v0=Il(W0),w0=Il(W0);function Sc(e){if(e===W0)throw Error(vt(174));return e}function $T(e,t){switch(ar(w0,t),ar(v0,e),ar(Ao,W0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ex(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ex(t,e)}dr(Ao),ar(Ao,t)}function Bh(){dr(Ao),dr(v0),dr(w0)}function i$(e){Sc(w0.current);var t=Sc(Ao.current),n=Ex(t,e.type);t!==n&&(ar(v0,e),ar(Ao,n))}function IT(e){v0.current===e&&(dr(Ao),dr(v0))}var br=Il(0);function _w(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Db=[];function OT(){for(var e=0;e<Db.length;e++)Db[e]._workInProgressVersionPrimary=null;Db.length=0}var zv=ya.ReactCurrentDispatcher,Lb=ya.ReactCurrentBatchConfig,Bc=0,Mr=null,qr=null,Zr=null,yw=!1,Y_=!1,b0=0,IN=0;function ps(){throw Error(vt(321))}function DT(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!eo(e[n],t[n]))return!1;return!0}function LT(e,t,n,r,s,o){if(Bc=o,Mr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zv.current=e===null||e.memoizedState===null?FN:RN,e=n(r,s),Y_){o=0;do{if(Y_=!1,b0=0,25<=o)throw Error(vt(301));o+=1,Zr=qr=null,t.updateQueue=null,zv.current=jN,e=n(r,s)}while(Y_)}if(zv.current=vw,t=qr!==null&&qr.next!==null,Bc=0,Zr=qr=Mr=null,yw=!1,t)throw Error(vt(300));return e}function FT(){var e=b0!==0;return b0=0,e}function Mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?Mr.memoizedState=Zr=e:Zr=Zr.next=e,Zr}function $i(){if(qr===null){var e=Mr.alternate;e=e!==null?e.memoizedState:null}else e=qr.next;var t=Zr===null?Mr.memoizedState:Zr.next;if(t!==null)Zr=t,qr=e;else{if(e===null)throw Error(vt(310));qr=e,e={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},Zr===null?Mr.memoizedState=Zr=e:Zr=Zr.next=e}return Zr}function x0(e,t){return typeof t=="function"?t(e):t}function Fb(e){var t=$i(),n=t.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=e;var r=qr,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var c=a=null,u=null,d=o;do{var h=d.lane;if((Bc&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=m,a=r):u=u.next=m,Mr.lanes|=h,Vc|=h}d=d.next}while(d!==null&&d!==o);u===null?a=r:u.next=c,eo(r,t.memoizedState)||(Gs=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,Mr.lanes|=o,Vc|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Rb(e){var t=$i(),n=t.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=e(o,a.action),a=a.next;while(a!==s);eo(o,t.memoizedState)||(Gs=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function o$(){}function a$(e,t){var n=Mr,r=$i(),s=t(),o=!eo(r.memoizedState,s);if(o&&(r.memoizedState=s,Gs=!0),r=r.queue,RT(u$.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Zr!==null&&Zr.memoizedState.tag&1){if(n.flags|=2048,M0(9,c$.bind(null,n,r,s,t),void 0,null),es===null)throw Error(vt(349));Bc&30||l$(n,t,s)}return s}function l$(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Mr.updateQueue,t===null?(t={lastEffect:null,stores:null},Mr.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function c$(e,t,n,r){t.value=n,t.getSnapshot=r,d$(t)&&h$(e)}function u$(e,t,n){return n(function(){d$(t)&&h$(e)})}function d$(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!eo(e,n)}catch{return!0}}function h$(e){var t=da(e,1);t!==null&&Zi(t,e,1,-1)}function FS(e){var t=Mo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x0,lastRenderedState:e},t.queue=e,e=e.dispatch=LN.bind(null,Mr,e),[t.memoizedState,e]}function M0(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Mr.updateQueue,t===null?(t={lastEffect:null,stores:null},Mr.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function f$(){return $i().memoizedState}function Bv(e,t,n,r){var s=Mo();Mr.flags|=e,s.memoizedState=M0(1|t,n,void 0,r===void 0?null:r)}function Qw(e,t,n,r){var s=$i();r=r===void 0?null:r;var o=void 0;if(qr!==null){var a=qr.memoizedState;if(o=a.destroy,r!==null&&DT(r,a.deps)){s.memoizedState=M0(t,n,o,r);return}}Mr.flags|=e,s.memoizedState=M0(1|t,n,o,r)}function RS(e,t){return Bv(8390656,8,e,t)}function RT(e,t){return Qw(2048,8,e,t)}function p$(e,t){return Qw(4,2,e,t)}function m$(e,t){return Qw(4,4,e,t)}function g$(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _$(e,t,n){return n=n!=null?n.concat([e]):null,Qw(4,4,g$.bind(null,t,e),n)}function jT(){}function y$(e,t){var n=$i();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&DT(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function v$(e,t){var n=$i();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&DT(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function w$(e,t,n){return Bc&21?(eo(n,t)||(n=E3(),Mr.lanes|=n,Vc|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gs=!0),e.memoizedState=n)}function ON(e,t){var n=Jn;Jn=n!==0&&4>n?n:4,e(!0);var r=Lb.transition;Lb.transition={};try{e(!1),t()}finally{Jn=n,Lb.transition=r}}function b$(){return $i().memoizedState}function DN(e,t,n){var r=vl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},x$(e))M$(t,n);else if(n=r$(e,t,n,r),n!==null){var s=As();Zi(n,e,r,s),T$(n,t,r)}}function LN(e,t,n){var r=vl(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(x$(e))M$(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,c=o(a,n);if(s.hasEagerState=!0,s.eagerState=c,eo(c,a)){var u=t.interleaved;u===null?(s.next=s,kT(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=r$(e,t,s,r),n!==null&&(s=As(),Zi(n,e,r,s),T$(n,t,r))}}function x$(e){var t=e.alternate;return e===Mr||t!==null&&t===Mr}function M$(e,t){Y_=yw=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function T$(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,mT(e,n)}}var vw={readContext:Ai,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},FN={readContext:Ai,useCallback:function(e,t){return Mo().memoizedState=[e,t===void 0?null:t],e},useContext:Ai,useEffect:RS,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Bv(4194308,4,g$.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bv(4,2,e,t)},useMemo:function(e,t){var n=Mo();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Mo();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=DN.bind(null,Mr,e),[r.memoizedState,e]},useRef:function(e){var t=Mo();return e={current:e},t.memoizedState=e},useState:FS,useDebugValue:jT,useDeferredValue:function(e){return Mo().memoizedState=e},useTransition:function(){var e=FS(!1),t=e[0];return e=ON.bind(null,e[1]),Mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Mr,s=Mo();if(yr){if(n===void 0)throw Error(vt(407));n=n()}else{if(n=t(),es===null)throw Error(vt(349));Bc&30||l$(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,RS(u$.bind(null,r,o,e),[e]),r.flags|=2048,M0(9,c$.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Mo(),t=es.identifierPrefix;if(yr){var n=ia,r=sa;n=(r&~(1<<32-Ji(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=b0++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=IN++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},RN={readContext:Ai,useCallback:y$,useContext:Ai,useEffect:RT,useImperativeHandle:_$,useInsertionEffect:p$,useLayoutEffect:m$,useMemo:v$,useReducer:Fb,useRef:f$,useState:function(){return Fb(x0)},useDebugValue:jT,useDeferredValue:function(e){var t=$i();return w$(t,qr.memoizedState,e)},useTransition:function(){var e=Fb(x0)[0],t=$i().memoizedState;return[e,t]},useMutableSource:o$,useSyncExternalStore:a$,useId:b$,unstable_isNewReconciler:!1},jN={readContext:Ai,useCallback:y$,useContext:Ai,useEffect:RT,useImperativeHandle:_$,useInsertionEffect:p$,useLayoutEffect:m$,useMemo:v$,useReducer:Rb,useRef:f$,useState:function(){return Rb(x0)},useDebugValue:jT,useDeferredValue:function(e){var t=$i();return qr===null?t.memoizedState=e:w$(t,qr.memoizedState,e)},useTransition:function(){var e=Rb(x0)[0],t=$i().memoizedState;return[e,t]},useMutableSource:o$,useSyncExternalStore:a$,useId:b$,unstable_isNewReconciler:!1};function Ki(e,t){if(e&&e.defaultProps){t=Tr({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Kx(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Tr({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Yw={isMounted:function(e){return(e=e._reactInternals)?Kc(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=As(),s=vl(e),o=oa(r,s);o.payload=t,n!=null&&(o.callback=n),t=_l(e,o,s),t!==null&&(Zi(t,e,s,r),Nv(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=As(),s=vl(e),o=oa(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=_l(e,o,s),t!==null&&(Zi(t,e,s,r),Nv(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=As(),r=vl(e),s=oa(n,r);s.tag=2,t!=null&&(s.callback=t),t=_l(e,s,r),t!==null&&(Zi(t,e,r,n),Nv(t,e,r))}};function jS(e,t,n,r,s,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,a):t.prototype&&t.prototype.isPureReactComponent?!m0(n,r)||!m0(s,o):!0}function E$(e,t,n){var r=!1,s=Tl,o=t.contextType;return typeof o=="object"&&o!==null?o=Ai(o):(s=Hs(t)?Nc:ws.current,r=t.contextTypes,o=(r=r!=null)?jh(e,s):Tl),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Yw,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function NS(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Yw.enqueueReplaceState(t,t.state,null)}function Hx(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},AT(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Ai(o):(o=Hs(t)?Nc:ws.current,s.context=jh(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Kx(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Yw.enqueueReplaceState(s,s.state,null),gw(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Vh(e,t){try{var n="",r=t;do n+=hj(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function jb(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function qx(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var NN=typeof WeakMap=="function"?WeakMap:Map;function P$(e,t,n){n=oa(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){bw||(bw=!0,sM=r),qx(e,t)},n}function S$(e,t,n){n=oa(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){qx(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){qx(e,t),typeof r!="function"&&(yl===null?yl=new Set([this]):yl.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function zS(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new NN;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=ZN.bind(null,e,t,n),t.then(e,e))}function BS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function VS(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=oa(-1,1),t.tag=2,_l(n,t,1))),n.lanes|=1),e)}var zN=ya.ReactCurrentOwner,Gs=!1;function Cs(e,t,n,r){t.child=e===null?n$(t,null,n,r):zh(t,e.child,n,r)}function US(e,t,n,r,s){n=n.render;var o=t.ref;return Mh(t,s),r=LT(e,t,n,r,o,s),n=FT(),e!==null&&!Gs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ha(e,t,s)):(yr&&n&&MT(t),t.flags|=1,Cs(e,t,r,s),t.child)}function WS(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!KT(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,C$(e,t,o,r,s)):(e=Gv(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:m0,n(a,r)&&e.ref===t.ref)return ha(e,t,s)}return t.flags|=1,e=wl(o,r),e.ref=t.ref,e.return=t,t.child=e}function C$(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(m0(o,r)&&e.ref===t.ref)if(Gs=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(Gs=!0);else return t.lanes=e.lanes,ha(e,t,s)}return Qx(e,t,n,r,s)}function k$(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ar(hh,ri),ri|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ar(hh,ri),ri|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ar(hh,ri),ri|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,ar(hh,ri),ri|=r;return Cs(e,t,s,n),t.child}function A$(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Qx(e,t,n,r,s){var o=Hs(n)?Nc:ws.current;return o=jh(t,o),Mh(t,s),n=LT(e,t,n,r,o,s),r=FT(),e!==null&&!Gs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ha(e,t,s)):(yr&&r&&MT(t),t.flags|=1,Cs(e,t,n,s),t.child)}function GS(e,t,n,r,s){if(Hs(n)){var o=!0;dw(t)}else o=!1;if(Mh(t,s),t.stateNode===null)Vv(e,t),E$(t,n,r),Hx(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ai(d):(d=Hs(n)?Nc:ws.current,d=jh(t,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&NS(t,a,r,d),el=!1;var p=t.memoizedState;a.state=p,gw(t,r,a,s),u=t.memoizedState,c!==r||p!==u||Ks.current||el?(typeof h=="function"&&(Kx(t,n,h,r),u=t.memoizedState),(c=el||jS(t,n,c,r,p,u,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,s$(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:Ki(t.type,c),a.props=d,m=t.pendingProps,p=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ai(u):(u=Hs(n)?Nc:ws.current,u=jh(t,u));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==m||p!==u)&&NS(t,a,r,u),el=!1,p=t.memoizedState,a.state=p,gw(t,r,a,s);var T=t.memoizedState;c!==m||p!==T||Ks.current||el?(typeof v=="function"&&(Kx(t,n,v,r),T=t.memoizedState),(d=el||jS(t,n,d,r,p,T,u)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,T,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,T,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=T),a.props=r,a.state=T,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Yx(e,t,n,r,o,s)}function Yx(e,t,n,r,s,o){A$(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&AS(t,n,!1),ha(e,t,o);r=t.stateNode,zN.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=zh(t,e.child,null,o),t.child=zh(t,null,c,o)):Cs(e,t,c,o),t.memoizedState=r.state,s&&AS(t,n,!0),t.child}function $$(e){var t=e.stateNode;t.pendingContext?kS(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kS(e,t.context,!1),$T(e,t.containerInfo)}function KS(e,t,n,r,s){return Nh(),ET(s),t.flags|=256,Cs(e,t,n,r),t.child}var Xx={dehydrated:null,treeContext:null,retryLane:0};function Jx(e){return{baseLanes:e,cachePool:null,transitions:null}}function I$(e,t,n){var r=t.pendingProps,s=br.current,o=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ar(br,s&1),e===null)return Wx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,o?(r=t.mode,o=t.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Zw(a,r,0,null),e=Lc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Jx(n),t.memoizedState=Xx,e):NT(t,a));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return BN(e,t,a,r,c,s,n);if(o){o=r.fallback,a=t.mode,s=e.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=wl(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?o=wl(c,o):(o=Lc(o,a,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,a=e.child.memoizedState,a=a===null?Jx(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=Xx,r}return o=e.child,e=o.sibling,r=wl(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function NT(e,t){return t=Zw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gv(e,t,n,r){return r!==null&&ET(r),zh(t,e.child,null,n),e=NT(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function BN(e,t,n,r,s,o,a){if(n)return t.flags&256?(t.flags&=-257,r=jb(Error(vt(422))),gv(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=Zw({mode:"visible",children:r.children},s,0,null),o=Lc(o,s,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&zh(t,e.child,null,a),t.child.memoizedState=Jx(a),t.memoizedState=Xx,o);if(!(t.mode&1))return gv(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(vt(419)),r=jb(o,r,void 0),gv(e,t,a,r)}if(c=(a&e.childLanes)!==0,Gs||c){if(r=es,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,da(e,s),Zi(r,e,s,-1))}return GT(),r=jb(Error(vt(421))),gv(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=ez.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,ii=gl(s.nextSibling),oi=t,yr=!0,Xi=null,e!==null&&(Ei[Pi++]=sa,Ei[Pi++]=ia,Ei[Pi++]=zc,sa=e.id,ia=e.overflow,zc=t),t=NT(t,r.children),t.flags|=4096,t)}function HS(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Gx(e.return,t,n)}function Nb(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function O$(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(Cs(e,t,r.children,n),r=br.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&HS(e,n,t);else if(e.tag===19)HS(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ar(br,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&_w(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Nb(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&_w(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Nb(t,!0,n,null,o);break;case"together":Nb(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ha(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Vc|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(vt(153));if(t.child!==null){for(e=t.child,n=wl(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=wl(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function VN(e,t,n){switch(t.tag){case 3:$$(t),Nh();break;case 5:i$(t);break;case 1:Hs(t.type)&&dw(t);break;case 4:$T(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ar(pw,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ar(br,br.current&1),t.flags|=128,null):n&t.child.childLanes?I$(e,t,n):(ar(br,br.current&1),e=ha(e,t,n),e!==null?e.sibling:null);ar(br,br.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return O$(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ar(br,br.current),r)break;return null;case 22:case 23:return t.lanes=0,k$(e,t,n)}return ha(e,t,n)}var D$,Zx,L$,F$;D$=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zx=function(){};L$=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Sc(Ao.current);var o=null;switch(n){case"input":s=bx(e,s),r=bx(e,r),o=[];break;case"select":s=Tr({},s,{value:void 0}),r=Tr({},r,{value:void 0}),o=[];break;case"textarea":s=Tx(e,s),r=Tx(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=cw)}Px(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(l0.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(l0.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ur("scroll",e),o||c===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};F$=function(e,t,n,r){n!==r&&(t.flags|=4)};function T_(e,t){if(!yr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ms(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function UN(e,t,n){var r=t.pendingProps;switch(TT(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ms(t),null;case 1:return Hs(t.type)&&uw(),ms(t),null;case 3:return r=t.stateNode,Bh(),dr(Ks),dr(ws),OT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(pv(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Xi!==null&&(aM(Xi),Xi=null))),Zx(e,t),ms(t),null;case 5:IT(t);var s=Sc(w0.current);if(n=t.type,e!==null&&t.stateNode!=null)L$(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(vt(166));return ms(t),null}if(e=Sc(Ao.current),pv(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Co]=t,r[y0]=o,e=(t.mode&1)!==0,n){case"dialog":ur("cancel",r),ur("close",r);break;case"iframe":case"object":case"embed":ur("load",r);break;case"video":case"audio":for(s=0;s<j_.length;s++)ur(j_[s],r);break;case"source":ur("error",r);break;case"img":case"image":case"link":ur("error",r),ur("load",r);break;case"details":ur("toggle",r);break;case"input":nS(r,o),ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ur("invalid",r);break;case"textarea":sS(r,o),ur("invalid",r)}Px(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&fv(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&fv(r.textContent,c,e),s=["children",""+c]):l0.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&ur("scroll",r)}switch(n){case"input":iv(r),rS(r,o,!0);break;case"textarea":iv(r),iS(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=cw)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=u3(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Co]=t,e[y0]=r,D$(e,t,!1,!1),t.stateNode=e;e:{switch(a=Sx(n,r),n){case"dialog":ur("cancel",e),ur("close",e),s=r;break;case"iframe":case"object":case"embed":ur("load",e),s=r;break;case"video":case"audio":for(s=0;s<j_.length;s++)ur(j_[s],e);s=r;break;case"source":ur("error",e),s=r;break;case"img":case"image":case"link":ur("error",e),ur("load",e),s=r;break;case"details":ur("toggle",e),s=r;break;case"input":nS(e,r),s=bx(e,r),ur("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Tr({},r,{value:void 0}),ur("invalid",e);break;case"textarea":sS(e,r),s=Tx(e,r),ur("invalid",e);break;default:s=r}Px(n,s),c=s;for(o in c)if(c.hasOwnProperty(o)){var u=c[o];o==="style"?f3(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&d3(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&c0(e,u):typeof u=="number"&&c0(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(l0.hasOwnProperty(o)?u!=null&&o==="onScroll"&&ur("scroll",e):u!=null&&cT(e,o,u,a))}switch(n){case"input":iv(e),rS(e,r,!1);break;case"textarea":iv(e),iS(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ml(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?vh(e,!!r.multiple,o,!1):r.defaultValue!=null&&vh(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=cw)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ms(t),null;case 6:if(e&&t.stateNode!=null)F$(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(vt(166));if(n=Sc(w0.current),Sc(Ao.current),pv(t)){if(r=t.stateNode,n=t.memoizedProps,r[Co]=t,(o=r.nodeValue!==n)&&(e=oi,e!==null))switch(e.tag){case 3:fv(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fv(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Co]=t,t.stateNode=r}return ms(t),null;case 13:if(dr(br),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yr&&ii!==null&&t.mode&1&&!(t.flags&128))e$(),Nh(),t.flags|=98560,o=!1;else if(o=pv(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(vt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(vt(317));o[Co]=t}else Nh(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ms(t),o=!1}else Xi!==null&&(aM(Xi),Xi=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||br.current&1?Yr===0&&(Yr=3):GT())),t.updateQueue!==null&&(t.flags|=4),ms(t),null);case 4:return Bh(),Zx(e,t),e===null&&g0(t.stateNode.containerInfo),ms(t),null;case 10:return CT(t.type._context),ms(t),null;case 17:return Hs(t.type)&&uw(),ms(t),null;case 19:if(dr(br),o=t.memoizedState,o===null)return ms(t),null;if(r=(t.flags&128)!==0,a=o.rendering,a===null)if(r)T_(o,!1);else{if(Yr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=_w(e),a!==null){for(t.flags|=128,T_(o,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ar(br,br.current&1|2),t.child}e=e.sibling}o.tail!==null&&zr()>Uh&&(t.flags|=128,r=!0,T_(o,!1),t.lanes=4194304)}else{if(!r)if(e=_w(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),T_(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!yr)return ms(t),null}else 2*zr()-o.renderingStartTime>Uh&&n!==1073741824&&(t.flags|=128,r=!0,T_(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=zr(),t.sibling=null,n=br.current,ar(br,r?n&1|2:n&1),t):(ms(t),null);case 22:case 23:return WT(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?ri&1073741824&&(ms(t),t.subtreeFlags&6&&(t.flags|=8192)):ms(t),null;case 24:return null;case 25:return null}throw Error(vt(156,t.tag))}function WN(e,t){switch(TT(t),t.tag){case 1:return Hs(t.type)&&uw(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bh(),dr(Ks),dr(ws),OT(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return IT(t),null;case 13:if(dr(br),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(vt(340));Nh()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return dr(br),null;case 4:return Bh(),null;case 10:return CT(t.type._context),null;case 22:case 23:return WT(),null;case 24:return null;default:return null}}var _v=!1,ys=!1,GN=typeof WeakSet=="function"?WeakSet:Set,Vt=null;function dh(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Or(e,t,r)}else n.current=null}function eM(e,t,n){try{n()}catch(r){Or(e,t,r)}}var qS=!1;function KN(e,t){if(Rx=ow,e=B3(),xT(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,h=0,m=e,p=null;t:for(;;){for(var v;m!==n||s!==0&&m.nodeType!==3||(c=a+s),m!==o||r!==0&&m.nodeType!==3||(u=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(v=m.firstChild)!==null;)p=m,m=v;for(;;){if(m===e)break t;if(p===n&&++d===s&&(c=a),p===o&&++h===r&&(u=a),(v=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=v}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(jx={focusedElem:e,selectionRange:n},ow=!1,Vt=t;Vt!==null;)if(t=Vt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Vt=e;else for(;Vt!==null;){t=Vt;try{var T=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var E=T.memoizedProps,O=T.memoizedState,b=t.stateNode,M=b.getSnapshotBeforeUpdate(t.elementType===t.type?E:Ki(t.type,E),O);b.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var I=t.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vt(163))}}catch(k){Or(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Vt=e;break}Vt=t.return}return T=qS,qS=!1,T}function X_(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&eM(t,n,o)}s=s.next}while(s!==r)}}function Xw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function tM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function R$(e){var t=e.alternate;t!==null&&(e.alternate=null,R$(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Co],delete t[y0],delete t[Bx],delete t[CN],delete t[kN])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function j$(e){return e.tag===5||e.tag===3||e.tag===4}function QS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||j$(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nM(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=cw));else if(r!==4&&(e=e.child,e!==null))for(nM(e,t,n),e=e.sibling;e!==null;)nM(e,t,n),e=e.sibling}function rM(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(rM(e,t,n),e=e.sibling;e!==null;)rM(e,t,n),e=e.sibling}var rs=null,Qi=!1;function Ga(e,t,n){for(n=n.child;n!==null;)N$(e,t,n),n=n.sibling}function N$(e,t,n){if(ko&&typeof ko.onCommitFiberUnmount=="function")try{ko.onCommitFiberUnmount(Uw,n)}catch{}switch(n.tag){case 5:ys||dh(n,t);case 6:var r=rs,s=Qi;rs=null,Ga(e,t,n),rs=r,Qi=s,rs!==null&&(Qi?(e=rs,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):rs.removeChild(n.stateNode));break;case 18:rs!==null&&(Qi?(e=rs,n=n.stateNode,e.nodeType===8?Ib(e.parentNode,n):e.nodeType===1&&Ib(e,n),f0(e)):Ib(rs,n.stateNode));break;case 4:r=rs,s=Qi,rs=n.stateNode.containerInfo,Qi=!0,Ga(e,t,n),rs=r,Qi=s;break;case 0:case 11:case 14:case 15:if(!ys&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&eM(n,t,a),s=s.next}while(s!==r)}Ga(e,t,n);break;case 1:if(!ys&&(dh(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Or(n,t,c)}Ga(e,t,n);break;case 21:Ga(e,t,n);break;case 22:n.mode&1?(ys=(r=ys)||n.memoizedState!==null,Ga(e,t,n),ys=r):Ga(e,t,n);break;default:Ga(e,t,n)}}function YS(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new GN),t.forEach(function(r){var s=tz.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Wi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:rs=c.stateNode,Qi=!1;break e;case 3:rs=c.stateNode.containerInfo,Qi=!0;break e;case 4:rs=c.stateNode.containerInfo,Qi=!0;break e}c=c.return}if(rs===null)throw Error(vt(160));N$(o,a,s),rs=null,Qi=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Or(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)z$(t,e),t=t.sibling}function z$(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wi(t,e),bo(e),r&4){try{X_(3,e,e.return),Xw(3,e)}catch(E){Or(e,e.return,E)}try{X_(5,e,e.return)}catch(E){Or(e,e.return,E)}}break;case 1:Wi(t,e),bo(e),r&512&&n!==null&&dh(n,n.return);break;case 5:if(Wi(t,e),bo(e),r&512&&n!==null&&dh(n,n.return),e.flags&32){var s=e.stateNode;try{c0(s,"")}catch(E){Or(e,e.return,E)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&l3(s,o),Sx(c,a);var d=Sx(c,o);for(a=0;a<u.length;a+=2){var h=u[a],m=u[a+1];h==="style"?f3(s,m):h==="dangerouslySetInnerHTML"?d3(s,m):h==="children"?c0(s,m):cT(s,h,m,d)}switch(c){case"input":xx(s,o);break;case"textarea":c3(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var v=o.value;v!=null?vh(s,!!o.multiple,v,!1):p!==!!o.multiple&&(o.defaultValue!=null?vh(s,!!o.multiple,o.defaultValue,!0):vh(s,!!o.multiple,o.multiple?[]:"",!1))}s[y0]=o}catch(E){Or(e,e.return,E)}}break;case 6:if(Wi(t,e),bo(e),r&4){if(e.stateNode===null)throw Error(vt(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(E){Or(e,e.return,E)}}break;case 3:if(Wi(t,e),bo(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{f0(t.containerInfo)}catch(E){Or(e,e.return,E)}break;case 4:Wi(t,e),bo(e);break;case 13:Wi(t,e),bo(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(VT=zr())),r&4&&YS(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(ys=(d=ys)||h,Wi(t,e),ys=d):Wi(t,e),bo(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(Vt=e,h=e.child;h!==null;){for(m=Vt=h;Vt!==null;){switch(p=Vt,v=p.child,p.tag){case 0:case 11:case 14:case 15:X_(4,p,p.return);break;case 1:dh(p,p.return);var T=p.stateNode;if(typeof T.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,T.props=t.memoizedProps,T.state=t.memoizedState,T.componentWillUnmount()}catch(E){Or(r,n,E)}}break;case 5:dh(p,p.return);break;case 22:if(p.memoizedState!==null){JS(m);continue}}v!==null?(v.return=p,Vt=v):JS(m)}h=h.sibling}e:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=h3("display",a))}catch(E){Or(e,e.return,E)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(E){Or(e,e.return,E)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Wi(t,e),bo(e),r&4&&YS(e);break;case 21:break;default:Wi(t,e),bo(e)}}function bo(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(j$(n)){var r=n;break e}n=n.return}throw Error(vt(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(c0(s,""),r.flags&=-33);var o=QS(e);rM(e,o,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=QS(e);nM(e,c,a);break;default:throw Error(vt(161))}}catch(u){Or(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function HN(e,t,n){Vt=e,B$(e)}function B$(e,t,n){for(var r=(e.mode&1)!==0;Vt!==null;){var s=Vt,o=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||_v;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||ys;c=_v;var d=ys;if(_v=a,(ys=u)&&!d)for(Vt=s;Vt!==null;)a=Vt,u=a.child,a.tag===22&&a.memoizedState!==null?ZS(s):u!==null?(u.return=a,Vt=u):ZS(s);for(;o!==null;)Vt=o,B$(o),o=o.sibling;Vt=s,_v=c,ys=d}XS(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Vt=o):XS(e)}}function XS(e){for(;Vt!==null;){var t=Vt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ys||Xw(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ys)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ki(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&LS(t,o,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}LS(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&f0(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vt(163))}ys||t.flags&512&&tM(t)}catch(p){Or(t,t.return,p)}}if(t===e){Vt=null;break}if(n=t.sibling,n!==null){n.return=t.return,Vt=n;break}Vt=t.return}}function JS(e){for(;Vt!==null;){var t=Vt;if(t===e){Vt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Vt=n;break}Vt=t.return}}function ZS(e){for(;Vt!==null;){var t=Vt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Xw(4,t)}catch(u){Or(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Or(t,s,u)}}var o=t.return;try{tM(t)}catch(u){Or(t,o,u)}break;case 5:var a=t.return;try{tM(t)}catch(u){Or(t,a,u)}}}catch(u){Or(t,t.return,u)}if(t===e){Vt=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Vt=c;break}Vt=t.return}}var qN=Math.ceil,ww=ya.ReactCurrentDispatcher,zT=ya.ReactCurrentOwner,Ci=ya.ReactCurrentBatchConfig,Un=0,es=null,Gr=null,is=0,ri=0,hh=Il(0),Yr=0,T0=null,Vc=0,Jw=0,BT=0,J_=null,Us=null,VT=0,Uh=1/0,ta=null,bw=!1,sM=null,yl=null,yv=!1,dl=null,xw=0,Z_=0,iM=null,Uv=-1,Wv=0;function As(){return Un&6?zr():Uv!==-1?Uv:Uv=zr()}function vl(e){return e.mode&1?Un&2&&is!==0?is&-is:$N.transition!==null?(Wv===0&&(Wv=E3()),Wv):(e=Jn,e!==0||(e=window.event,e=e===void 0?16:I3(e.type)),e):1}function Zi(e,t,n,r){if(50<Z_)throw Z_=0,iM=null,Error(vt(185));B0(e,n,r),(!(Un&2)||e!==es)&&(e===es&&(!(Un&2)&&(Jw|=n),Yr===4&&rl(e,is)),qs(e,r),n===1&&Un===0&&!(t.mode&1)&&(Uh=zr()+500,qw&&Ol()))}function qs(e,t){var n=e.callbackNode;$j(e,t);var r=iw(e,e===es?is:0);if(r===0)n!==null&&lS(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&lS(n),t===1)e.tag===0?AN(eC.bind(null,e)):X3(eC.bind(null,e)),PN(function(){!(Un&6)&&Ol()}),n=null;else{switch(P3(r)){case 1:n=pT;break;case 4:n=M3;break;case 16:n=sw;break;case 536870912:n=T3;break;default:n=sw}n=Q$(n,V$.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function V$(e,t){if(Uv=-1,Wv=0,Un&6)throw Error(vt(327));var n=e.callbackNode;if(Th()&&e.callbackNode!==n)return null;var r=iw(e,e===es?is:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Mw(e,r);else{t=r;var s=Un;Un|=2;var o=W$();(es!==e||is!==t)&&(ta=null,Uh=zr()+500,Dc(e,t));do try{XN();break}catch(c){U$(e,c)}while(!0);ST(),ww.current=o,Un=s,Gr!==null?t=0:(es=null,is=0,t=Yr)}if(t!==0){if(t===2&&(s=Ix(e),s!==0&&(r=s,t=oM(e,s))),t===1)throw n=T0,Dc(e,0),rl(e,r),qs(e,zr()),n;if(t===6)rl(e,r);else{if(s=e.current.alternate,!(r&30)&&!QN(s)&&(t=Mw(e,r),t===2&&(o=Ix(e),o!==0&&(r=o,t=oM(e,o))),t===1))throw n=T0,Dc(e,0),rl(e,r),qs(e,zr()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(vt(345));case 2:wc(e,Us,ta);break;case 3:if(rl(e,r),(r&130023424)===r&&(t=VT+500-zr(),10<t)){if(iw(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){As(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=zx(wc.bind(null,e,Us,ta),t);break}wc(e,Us,ta);break;case 4:if(rl(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Ji(r);o=1<<a,a=t[a],a>s&&(s=a),r&=~o}if(r=s,r=zr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qN(r/1960))-r,10<r){e.timeoutHandle=zx(wc.bind(null,e,Us,ta),r);break}wc(e,Us,ta);break;case 5:wc(e,Us,ta);break;default:throw Error(vt(329))}}}return qs(e,zr()),e.callbackNode===n?V$.bind(null,e):null}function oM(e,t){var n=J_;return e.current.memoizedState.isDehydrated&&(Dc(e,t).flags|=256),e=Mw(e,t),e!==2&&(t=Us,Us=n,t!==null&&aM(t)),e}function aM(e){Us===null?Us=e:Us.push.apply(Us,e)}function QN(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!eo(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rl(e,t){for(t&=~BT,t&=~Jw,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ji(t),r=1<<n;e[n]=-1,t&=~r}}function eC(e){if(Un&6)throw Error(vt(327));Th();var t=iw(e,0);if(!(t&1))return qs(e,zr()),null;var n=Mw(e,t);if(e.tag!==0&&n===2){var r=Ix(e);r!==0&&(t=r,n=oM(e,r))}if(n===1)throw n=T0,Dc(e,0),rl(e,t),qs(e,zr()),n;if(n===6)throw Error(vt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Us,ta),qs(e,zr()),null}function UT(e,t){var n=Un;Un|=1;try{return e(t)}finally{Un=n,Un===0&&(Uh=zr()+500,qw&&Ol())}}function Uc(e){dl!==null&&dl.tag===0&&!(Un&6)&&Th();var t=Un;Un|=1;var n=Ci.transition,r=Jn;try{if(Ci.transition=null,Jn=1,e)return e()}finally{Jn=r,Ci.transition=n,Un=t,!(Un&6)&&Ol()}}function WT(){ri=hh.current,dr(hh)}function Dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,EN(n)),Gr!==null)for(n=Gr.return;n!==null;){var r=n;switch(TT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&uw();break;case 3:Bh(),dr(Ks),dr(ws),OT();break;case 5:IT(r);break;case 4:Bh();break;case 13:dr(br);break;case 19:dr(br);break;case 10:CT(r.type._context);break;case 22:case 23:WT()}n=n.return}if(es=e,Gr=e=wl(e.current,null),is=ri=t,Yr=0,T0=null,BT=Jw=Vc=0,Us=J_=null,Pc!==null){for(t=0;t<Pc.length;t++)if(n=Pc[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,r.next=a}n.pending=r}Pc=null}return e}function U$(e,t){do{var n=Gr;try{if(ST(),zv.current=vw,yw){for(var r=Mr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}yw=!1}if(Bc=0,Zr=qr=Mr=null,Y_=!1,b0=0,zT.current=null,n===null||n.return===null){Yr=1,T0=t,Gr=null;break}e:{var o=e,a=n.return,c=n,u=t;if(t=is,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=c,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=BS(a);if(v!==null){v.flags&=-257,VS(v,a,c,o,t),v.mode&1&&zS(o,d,t),t=v,u=d;var T=t.updateQueue;if(T===null){var E=new Set;E.add(u),t.updateQueue=E}else T.add(u);break e}else{if(!(t&1)){zS(o,d,t),GT();break e}u=Error(vt(426))}}else if(yr&&c.mode&1){var O=BS(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),VS(O,a,c,o,t),ET(Vh(u,c));break e}}o=u=Vh(u,c),Yr!==4&&(Yr=2),J_===null?J_=[o]:J_.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var b=P$(o,u,t);DS(o,b);break e;case 1:c=u;var M=o.type,I=o.stateNode;if(!(o.flags&128)&&(typeof M.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(yl===null||!yl.has(I)))){o.flags|=65536,t&=-t,o.lanes|=t;var k=S$(o,c,t);DS(o,k);break e}}o=o.return}while(o!==null)}K$(n)}catch($){t=$,Gr===n&&n!==null&&(Gr=n=n.return);continue}break}while(!0)}function W$(){var e=ww.current;return ww.current=vw,e===null?vw:e}function GT(){(Yr===0||Yr===3||Yr===2)&&(Yr=4),es===null||!(Vc&268435455)&&!(Jw&268435455)||rl(es,is)}function Mw(e,t){var n=Un;Un|=2;var r=W$();(es!==e||is!==t)&&(ta=null,Dc(e,t));do try{YN();break}catch(s){U$(e,s)}while(!0);if(ST(),Un=n,ww.current=r,Gr!==null)throw Error(vt(261));return es=null,is=0,Yr}function YN(){for(;Gr!==null;)G$(Gr)}function XN(){for(;Gr!==null&&!xj();)G$(Gr)}function G$(e){var t=q$(e.alternate,e,ri);e.memoizedProps=e.pendingProps,t===null?K$(e):Gr=t,zT.current=null}function K$(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=WN(n,t),n!==null){n.flags&=32767,Gr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yr=6,Gr=null;return}}else if(n=UN(n,t,ri),n!==null){Gr=n;return}if(t=t.sibling,t!==null){Gr=t;return}Gr=t=e}while(t!==null);Yr===0&&(Yr=5)}function wc(e,t,n){var r=Jn,s=Ci.transition;try{Ci.transition=null,Jn=1,JN(e,t,n,r)}finally{Ci.transition=s,Jn=r}return null}function JN(e,t,n,r){do Th();while(dl!==null);if(Un&6)throw Error(vt(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(vt(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Ij(e,o),e===es&&(Gr=es=null,is=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||yv||(yv=!0,Q$(sw,function(){return Th(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ci.transition,Ci.transition=null;var a=Jn;Jn=1;var c=Un;Un|=4,zT.current=null,KN(e,n),z$(n,e),yN(jx),ow=!!Rx,jx=Rx=null,e.current=n,HN(n),Mj(),Un=c,Jn=a,Ci.transition=o}else e.current=n;if(yv&&(yv=!1,dl=e,xw=s),o=e.pendingLanes,o===0&&(yl=null),Pj(n.stateNode),qs(e,zr()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(bw)throw bw=!1,e=sM,sM=null,e;return xw&1&&e.tag!==0&&Th(),o=e.pendingLanes,o&1?e===iM?Z_++:(Z_=0,iM=e):Z_=0,Ol(),null}function Th(){if(dl!==null){var e=P3(xw),t=Ci.transition,n=Jn;try{if(Ci.transition=null,Jn=16>e?16:e,dl===null)var r=!1;else{if(e=dl,dl=null,xw=0,Un&6)throw Error(vt(331));var s=Un;for(Un|=4,Vt=e.current;Vt!==null;){var o=Vt,a=o.child;if(Vt.flags&16){var c=o.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(Vt=d;Vt!==null;){var h=Vt;switch(h.tag){case 0:case 11:case 15:X_(8,h,o)}var m=h.child;if(m!==null)m.return=h,Vt=m;else for(;Vt!==null;){h=Vt;var p=h.sibling,v=h.return;if(R$(h),h===d){Vt=null;break}if(p!==null){p.return=v,Vt=p;break}Vt=v}}}var T=o.alternate;if(T!==null){var E=T.child;if(E!==null){T.child=null;do{var O=E.sibling;E.sibling=null,E=O}while(E!==null)}}Vt=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Vt=a;else e:for(;Vt!==null;){if(o=Vt,o.flags&2048)switch(o.tag){case 0:case 11:case 15:X_(9,o,o.return)}var b=o.sibling;if(b!==null){b.return=o.return,Vt=b;break e}Vt=o.return}}var M=e.current;for(Vt=M;Vt!==null;){a=Vt;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,Vt=I;else e:for(a=M;Vt!==null;){if(c=Vt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Xw(9,c)}}catch($){Or(c,c.return,$)}if(c===a){Vt=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,Vt=k;break e}Vt=c.return}}if(Un=s,Ol(),ko&&typeof ko.onPostCommitFiberRoot=="function")try{ko.onPostCommitFiberRoot(Uw,e)}catch{}r=!0}return r}finally{Jn=n,Ci.transition=t}}return!1}function tC(e,t,n){t=Vh(n,t),t=P$(e,t,1),e=_l(e,t,1),t=As(),e!==null&&(B0(e,1,t),qs(e,t))}function Or(e,t,n){if(e.tag===3)tC(e,e,n);else for(;t!==null;){if(t.tag===3){tC(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yl===null||!yl.has(r))){e=Vh(n,e),e=S$(t,e,1),t=_l(t,e,1),e=As(),t!==null&&(B0(t,1,e),qs(t,e));break}}t=t.return}}function ZN(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=As(),e.pingedLanes|=e.suspendedLanes&n,es===e&&(is&n)===n&&(Yr===4||Yr===3&&(is&130023424)===is&&500>zr()-VT?Dc(e,0):BT|=n),qs(e,t)}function H$(e,t){t===0&&(e.mode&1?(t=lv,lv<<=1,!(lv&130023424)&&(lv=4194304)):t=1);var n=As();e=da(e,t),e!==null&&(B0(e,t,n),qs(e,n))}function ez(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),H$(e,n)}function tz(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(vt(314))}r!==null&&r.delete(t),H$(e,n)}var q$;q$=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ks.current)Gs=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Gs=!1,VN(e,t,n);Gs=!!(e.flags&131072)}else Gs=!1,yr&&t.flags&1048576&&J3(t,fw,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vv(e,t),e=t.pendingProps;var s=jh(t,ws.current);Mh(t,n),s=LT(null,t,r,e,s,n);var o=FT();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hs(r)?(o=!0,dw(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,AT(t),s.updater=Yw,t.stateNode=s,s._reactInternals=t,Hx(t,r,e,n),t=Yx(null,t,r,!0,o,n)):(t.tag=0,yr&&o&&MT(t),Cs(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vv(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=rz(r),e=Ki(r,e),s){case 0:t=Qx(null,t,r,e,n);break e;case 1:t=GS(null,t,r,e,n);break e;case 11:t=US(null,t,r,e,n);break e;case 14:t=WS(null,t,r,Ki(r.type,e),n);break e}throw Error(vt(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ki(r,s),Qx(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ki(r,s),GS(e,t,r,s,n);case 3:e:{if($$(t),e===null)throw Error(vt(387));r=t.pendingProps,o=t.memoizedState,s=o.element,s$(e,t),gw(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Vh(Error(vt(423)),t),t=KS(e,t,r,n,s);break e}else if(r!==s){s=Vh(Error(vt(424)),t),t=KS(e,t,r,n,s);break e}else for(ii=gl(t.stateNode.containerInfo.firstChild),oi=t,yr=!0,Xi=null,n=n$(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Nh(),r===s){t=ha(e,t,n);break e}Cs(e,t,r,n)}t=t.child}return t;case 5:return i$(t),e===null&&Wx(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,a=s.children,Nx(r,s)?a=null:o!==null&&Nx(r,o)&&(t.flags|=32),A$(e,t),Cs(e,t,a,n),t.child;case 6:return e===null&&Wx(t),null;case 13:return I$(e,t,n);case 4:return $T(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=zh(t,null,r,n):Cs(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ki(r,s),US(e,t,r,s,n);case 7:return Cs(e,t,t.pendingProps,n),t.child;case 8:return Cs(e,t,t.pendingProps.children,n),t.child;case 12:return Cs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,ar(pw,r._currentValue),r._currentValue=a,o!==null)if(eo(o.value,a)){if(o.children===s.children&&!Ks.current){t=ha(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var c=o.dependencies;if(c!==null){a=o.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=oa(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Gx(o.return,n,t),c.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(vt(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Gx(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Cs(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Mh(t,n),s=Ai(s),r=r(s),t.flags|=1,Cs(e,t,r,n),t.child;case 14:return r=t.type,s=Ki(r,t.pendingProps),s=Ki(r.type,s),WS(e,t,r,s,n);case 15:return C$(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ki(r,s),Vv(e,t),t.tag=1,Hs(r)?(e=!0,dw(t)):e=!1,Mh(t,n),E$(t,r,s),Hx(t,r,s,n),Yx(null,t,r,!0,e,n);case 19:return O$(e,t,n);case 22:return k$(e,t,n)}throw Error(vt(156,t.tag))};function Q$(e,t){return x3(e,t)}function nz(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,n,r){return new nz(e,t,n,r)}function KT(e){return e=e.prototype,!(!e||!e.isReactComponent)}function rz(e){if(typeof e=="function")return KT(e)?1:0;if(e!=null){if(e=e.$$typeof,e===dT)return 11;if(e===hT)return 14}return 2}function wl(e,t){var n=e.alternate;return n===null?(n=Si(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gv(e,t,n,r,s,o){var a=2;if(r=e,typeof e=="function")KT(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case nh:return Lc(n.children,s,o,t);case uT:a=8,s|=8;break;case _x:return e=Si(12,n,t,s|2),e.elementType=_x,e.lanes=o,e;case yx:return e=Si(13,n,t,s),e.elementType=yx,e.lanes=o,e;case vx:return e=Si(19,n,t,s),e.elementType=vx,e.lanes=o,e;case i3:return Zw(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case r3:a=10;break e;case s3:a=9;break e;case dT:a=11;break e;case hT:a=14;break e;case Za:a=16,r=null;break e}throw Error(vt(130,e==null?e:typeof e,""))}return t=Si(a,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return e=Si(7,e,r,t),e.lanes=n,e}function Zw(e,t,n,r){return e=Si(22,e,r,t),e.elementType=i3,e.lanes=n,e.stateNode={isHidden:!1},e}function zb(e,t,n){return e=Si(6,e,null,t),e.lanes=n,e}function Bb(e,t,n){return t=Si(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sz(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bb(0),this.expirationTimes=bb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bb(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function HT(e,t,n,r,s,o,a,c,u){return e=new sz(e,t,n,c,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Si(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},AT(o),e}function iz(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:th,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Y$(e){if(!e)return Tl;e=e._reactInternals;e:{if(Kc(e)!==e||e.tag!==1)throw Error(vt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(vt(171))}if(e.tag===1){var n=e.type;if(Hs(n))return Y3(e,n,t)}return t}function X$(e,t,n,r,s,o,a,c,u){return e=HT(n,r,!0,e,s,o,a,c,u),e.context=Y$(null),n=e.current,r=As(),s=vl(n),o=oa(r,s),o.callback=t??null,_l(n,o,s),e.current.lanes=s,B0(e,s,r),qs(e,r),e}function e1(e,t,n,r){var s=t.current,o=As(),a=vl(s);return n=Y$(n),t.context===null?t.context=n:t.pendingContext=n,t=oa(o,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=_l(s,t,a),e!==null&&(Zi(e,s,a,o),Nv(e,s,a)),a}function Tw(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qT(e,t){nC(e,t),(e=e.alternate)&&nC(e,t)}function oz(){return null}var J$=typeof reportError=="function"?reportError:function(e){console.error(e)};function QT(e){this._internalRoot=e}t1.prototype.render=QT.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(vt(409));e1(e,t,null,null)};t1.prototype.unmount=QT.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Uc(function(){e1(null,e,null,null)}),t[ua]=null}};function t1(e){this._internalRoot=e}t1.prototype.unstable_scheduleHydration=function(e){if(e){var t=k3();e={blockedOn:null,target:e,priority:t};for(var n=0;n<nl.length&&t!==0&&t<nl[n].priority;n++);nl.splice(n,0,e),n===0&&$3(e)}};function YT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function n1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rC(){}function az(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=Tw(a);o.call(d)}}var a=X$(t,r,e,0,null,!1,!1,"",rC);return e._reactRootContainer=a,e[ua]=a.current,g0(e.nodeType===8?e.parentNode:e),Uc(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Tw(u);c.call(d)}}var u=HT(e,0,!1,null,null,!1,!1,"",rC);return e._reactRootContainer=u,e[ua]=u.current,g0(e.nodeType===8?e.parentNode:e),Uc(function(){e1(t,u,n,r)}),u}function r1(e,t,n,r,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var c=s;s=function(){var u=Tw(a);c.call(u)}}e1(t,a,e,s)}else a=az(n,t,e,s,r);return Tw(a)}S3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=R_(t.pendingLanes);n!==0&&(mT(t,n|1),qs(t,zr()),!(Un&6)&&(Uh=zr()+500,Ol()))}break;case 13:Uc(function(){var r=da(e,1);if(r!==null){var s=As();Zi(r,e,1,s)}}),qT(e,1)}};gT=function(e){if(e.tag===13){var t=da(e,134217728);if(t!==null){var n=As();Zi(t,e,134217728,n)}qT(e,134217728)}};C3=function(e){if(e.tag===13){var t=vl(e),n=da(e,t);if(n!==null){var r=As();Zi(n,e,t,r)}qT(e,t)}};k3=function(){return Jn};A3=function(e,t){var n=Jn;try{return Jn=e,t()}finally{Jn=n}};kx=function(e,t,n){switch(t){case"input":if(xx(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Hw(r);if(!s)throw Error(vt(90));a3(r),xx(r,s)}}}break;case"textarea":c3(e,n);break;case"select":t=n.value,t!=null&&vh(e,!!n.multiple,t,!1)}};g3=UT;_3=Uc;var lz={usingClientEntryPoint:!1,Events:[U0,oh,Hw,p3,m3,UT]},E_={findFiberByHostInstance:Ec,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cz={bundleType:E_.bundleType,version:E_.version,rendererPackageName:E_.rendererPackageName,rendererConfig:E_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ya.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=w3(e),e===null?null:e.stateNode},findFiberByHostInstance:E_.findFiberByHostInstance||oz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vv.isDisabled&&vv.supportsFiber)try{Uw=vv.inject(cz),ko=vv}catch{}}di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lz;di.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!YT(t))throw Error(vt(200));return iz(e,t,null,n)};di.createRoot=function(e,t){if(!YT(e))throw Error(vt(299));var n=!1,r="",s=J$;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=HT(e,1,!1,null,null,n,!1,r,s),e[ua]=t.current,g0(e.nodeType===8?e.parentNode:e),new QT(t)};di.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(vt(188)):(e=Object.keys(e).join(","),Error(vt(268,e)));return e=w3(t),e=e===null?null:e.stateNode,e};di.flushSync=function(e){return Uc(e)};di.hydrate=function(e,t,n){if(!n1(t))throw Error(vt(200));return r1(null,e,t,!0,n)};di.hydrateRoot=function(e,t,n){if(!YT(e))throw Error(vt(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",a=J$;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=X$(t,null,e,1,n??null,s,!1,o,a),e[ua]=t.current,g0(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new t1(t)};di.render=function(e,t,n){if(!n1(t))throw Error(vt(200));return r1(null,e,t,!1,n)};di.unmountComponentAtNode=function(e){if(!n1(e))throw Error(vt(40));return e._reactRootContainer?(Uc(function(){r1(null,null,e,!1,function(){e._reactRootContainer=null,e[ua]=null})}),!0):!1};di.unstable_batchedUpdates=UT;di.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!n1(n))throw Error(vt(200));if(e==null||e._reactInternals===void 0)throw Error(vt(38));return r1(e,t,n,!1,r)};di.version="18.3.1-next-f1338f8080-20240426";function Z$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z$)}catch(e){console.error(e)}}Z$(),ZA.exports=di;var G0=ZA.exports;const eI=zA(G0);var tI,sC=G0;tI=sC.createRoot,sC.hydrateRoot;const uz=1,dz=1e6;let Vb=0;function hz(){return Vb=(Vb+1)%Number.MAX_SAFE_INTEGER,Vb.toString()}const Ub=new Map,iC=e=>{if(Ub.has(e))return;const t=setTimeout(()=>{Ub.delete(e),e0({type:"REMOVE_TOAST",toastId:e})},dz);Ub.set(e,t)},fz=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,uz)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?iC(n):e.toasts.forEach(r=>{iC(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Kv=[];let Hv={toasts:[]};function e0(e){Hv=fz(Hv,e),Kv.forEach(t=>{t(Hv)})}function XT({...e}){const t=hz(),n=s=>e0({type:"UPDATE_TOAST",toast:{...s,id:t}}),r=()=>e0({type:"DISMISS_TOAST",toastId:t});return e0({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||r()}}}),{id:t,dismiss:r,update:n}}function JT(){const[e,t]=B.useState(Hv);return B.useEffect(()=>(Kv.push(t),()=>{const n=Kv.indexOf(t);n>-1&&Kv.splice(n,1)}),[e]),{...e,toast:XT,dismiss:n=>e0({type:"DISMISS_TOAST",toastId:n})}}function vn(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function pz(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function nI(...e){return t=>e.forEach(n=>pz(n,t))}function Er(...e){return B.useCallback(nI(...e),e)}function mz(e,t=[]){let n=[];function r(o,a){const c=B.createContext(a),u=n.length;n=[...n,a];function d(m){const{scope:p,children:v,...T}=m,E=(p==null?void 0:p[e][u])||c,O=B.useMemo(()=>T,Object.values(T));return R.jsx(E.Provider,{value:O,children:v})}function h(m,p){const v=(p==null?void 0:p[e][u])||c,T=B.useContext(v);if(T)return T;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${o}\``)}return d.displayName=o+"Provider",[d,h]}const s=()=>{const o=n.map(a=>B.createContext(a));return function(c){const u=(c==null?void 0:c[e])||o;return B.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return s.scopeName=e,[r,gz(s,...t)]}function gz(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return B.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var E0=B.forwardRef((e,t)=>{const{children:n,...r}=e,s=B.Children.toArray(n),o=s.find(_z);if(o){const a=o.props.children,c=s.map(u=>u===o?B.Children.count(a)>1?B.Children.only(null):B.isValidElement(a)?a.props.children:null:u);return R.jsx(lM,{...r,ref:t,children:B.isValidElement(a)?B.cloneElement(a,void 0,c):null})}return R.jsx(lM,{...r,ref:t,children:n})});E0.displayName="Slot";var lM=B.forwardRef((e,t)=>{const{children:n,...r}=e;if(B.isValidElement(n)){const s=vz(n);return B.cloneElement(n,{...yz(r,n.props),ref:t?nI(t,s):s})}return B.Children.count(n)>1?B.Children.only(null):null});lM.displayName="SlotClone";var rI=({children:e})=>R.jsx(R.Fragment,{children:e});function _z(e){return B.isValidElement(e)&&e.type===rI}function yz(e,t){const n={...t};for(const r in t){const s=e[r],o=t[r];/^on[A-Z]/.test(r)?s&&o?n[r]=(...c)=>{o(...c),s(...c)}:s&&(n[r]=s):r==="style"?n[r]={...s,...o}:r==="className"&&(n[r]=[s,o].filter(Boolean).join(" "))}return{...e,...n}}function vz(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function ZT(e){const t=e+"CollectionProvider",[n,r]=mz(t),[s,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=v=>{const{scope:T,children:E}=v,O=we.useRef(null),b=we.useRef(new Map).current;return R.jsx(s,{scope:T,itemMap:b,collectionRef:O,children:E})};a.displayName=t;const c=e+"CollectionSlot",u=we.forwardRef((v,T)=>{const{scope:E,children:O}=v,b=o(c,E),M=Er(T,b.collectionRef);return R.jsx(E0,{ref:M,children:O})});u.displayName=c;const d=e+"CollectionItemSlot",h="data-radix-collection-item",m=we.forwardRef((v,T)=>{const{scope:E,children:O,...b}=v,M=we.useRef(null),I=Er(T,M),k=o(d,E);return we.useEffect(()=>(k.itemMap.set(M,{ref:M,...b}),()=>void k.itemMap.delete(M))),R.jsx(E0,{[h]:"",ref:I,children:O})});m.displayName=d;function p(v){const T=o(e+"CollectionConsumer",v);return we.useCallback(()=>{const O=T.collectionRef.current;if(!O)return[];const b=Array.from(O.querySelectorAll(`[${h}]`));return Array.from(T.itemMap.values()).sort((k,$)=>b.indexOf(k.ref.current)-b.indexOf($.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:a,Slot:u,ItemSlot:m},p,r]}function tf(e,t=[]){let n=[];function r(o,a){const c=B.createContext(a),u=n.length;n=[...n,a];const d=m=>{var b;const{scope:p,children:v,...T}=m,E=((b=p==null?void 0:p[e])==null?void 0:b[u])||c,O=B.useMemo(()=>T,Object.values(T));return R.jsx(E.Provider,{value:O,children:v})};d.displayName=o+"Provider";function h(m,p){var E;const v=((E=p==null?void 0:p[e])==null?void 0:E[u])||c,T=B.useContext(v);if(T)return T;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[d,h]}const s=()=>{const o=n.map(a=>B.createContext(a));return function(c){const u=(c==null?void 0:c[e])||o;return B.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return s.scopeName=e,[r,wz(s,...t)]}function wz(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return B.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var bz=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Nn=bz.reduce((e,t)=>{const n=B.forwardRef((r,s)=>{const{asChild:o,...a}=r,c=o?E0:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),R.jsx(c,{...a,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function sI(e,t){e&&G0.flushSync(()=>e.dispatchEvent(t))}function Qr(e){const t=B.useRef(e);return B.useEffect(()=>{t.current=e}),B.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function xz(e,t=globalThis==null?void 0:globalThis.document){const n=Qr(e);B.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Mz="DismissableLayer",cM="dismissableLayer.update",Tz="dismissableLayer.pointerDownOutside",Ez="dismissableLayer.focusOutside",oC,iI=B.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eE=B.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:a,onDismiss:c,...u}=e,d=B.useContext(iI),[h,m]=B.useState(null),p=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,v]=B.useState({}),T=Er(t,D=>m(D)),E=Array.from(d.layers),[O]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=E.indexOf(O),M=h?E.indexOf(h):-1,I=d.layersWithOutsidePointerEventsDisabled.size>0,k=M>=b,$=Sz(D=>{const j=D.target,Y=[...d.branches].some(q=>q.contains(j));!k||Y||(s==null||s(D),a==null||a(D),D.defaultPrevented||c==null||c())},p),P=Cz(D=>{const j=D.target;[...d.branches].some(q=>q.contains(j))||(o==null||o(D),a==null||a(D),D.defaultPrevented||c==null||c())},p);return xz(D=>{M===d.layers.size-1&&(r==null||r(D),!D.defaultPrevented&&c&&(D.preventDefault(),c()))},p),B.useEffect(()=>{if(h)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(oC=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),aC(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=oC)}},[h,p,n,d]),B.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),aC())},[h,d]),B.useEffect(()=>{const D=()=>v({});return document.addEventListener(cM,D),()=>document.removeEventListener(cM,D)},[]),R.jsx(Nn.div,{...u,ref:T,style:{pointerEvents:I?k?"auto":"none":void 0,...e.style},onFocusCapture:vn(e.onFocusCapture,P.onFocusCapture),onBlurCapture:vn(e.onBlurCapture,P.onBlurCapture),onPointerDownCapture:vn(e.onPointerDownCapture,$.onPointerDownCapture)})});eE.displayName=Mz;var Pz="DismissableLayerBranch",oI=B.forwardRef((e,t)=>{const n=B.useContext(iI),r=B.useRef(null),s=Er(t,r);return B.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),R.jsx(Nn.div,{...e,ref:s})});oI.displayName=Pz;function Sz(e,t=globalThis==null?void 0:globalThis.document){const n=Qr(e),r=B.useRef(!1),s=B.useRef(()=>{});return B.useEffect(()=>{const o=c=>{if(c.target&&!r.current){let u=function(){aI(Tz,n,d,{discrete:!0})};const d={originalEvent:c};c.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=u,t.addEventListener("click",s.current,{once:!0})):u()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",o),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Cz(e,t=globalThis==null?void 0:globalThis.document){const n=Qr(e),r=B.useRef(!1);return B.useEffect(()=>{const s=o=>{o.target&&!r.current&&aI(Ez,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function aC(){const e=new CustomEvent(cM);document.dispatchEvent(e)}function aI(e,t,n,{discrete:r}){const s=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?sI(s,o):s.dispatchEvent(o)}var kz=eE,Az=oI,to=globalThis!=null&&globalThis.document?B.useLayoutEffect:()=>{},$z="Portal",lI=B.forwardRef((e,t)=>{var c;const{container:n,...r}=e,[s,o]=B.useState(!1);to(()=>o(!0),[]);const a=n||s&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return a?eI.createPortal(R.jsx(Nn.div,{...r,ref:t}),a):null});lI.displayName=$z;function Iz(e,t){return B.useReducer((n,r)=>t[n][r]??n,e)}var Dl=e=>{const{present:t,children:n}=e,r=Oz(t),s=typeof n=="function"?n({present:r.isPresent}):B.Children.only(n),o=Er(r.ref,Dz(s));return typeof n=="function"||r.isPresent?B.cloneElement(s,{ref:o}):null};Dl.displayName="Presence";function Oz(e){const[t,n]=B.useState(),r=B.useRef({}),s=B.useRef(e),o=B.useRef("none"),a=e?"mounted":"unmounted",[c,u]=Iz(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return B.useEffect(()=>{const d=wv(r.current);o.current=c==="mounted"?d:"none"},[c]),to(()=>{const d=r.current,h=s.current;if(h!==e){const p=o.current,v=wv(d);e?u("MOUNT"):v==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(h&&p!==v?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,u]),to(()=>{if(t){let d;const h=t.ownerDocument.defaultView??window,m=v=>{const E=wv(r.current).includes(v.animationName);if(v.target===t&&E&&(u("ANIMATION_END"),!s.current)){const O=t.style.animationFillMode;t.style.animationFillMode="forwards",d=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=O)})}},p=v=>{v.target===t&&(o.current=wv(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{h.clearTimeout(d),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:B.useCallback(d=>{d&&(r.current=getComputedStyle(d)),n(d)},[])}}function wv(e){return(e==null?void 0:e.animationName)||"none"}function Dz(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function s1({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,s]=Lz({defaultProp:t,onChange:n}),o=e!==void 0,a=o?e:r,c=Qr(n),u=B.useCallback(d=>{if(o){const m=typeof d=="function"?d(e):d;m!==e&&c(m)}else s(d)},[o,e,s,c]);return[a,u]}function Lz({defaultProp:e,onChange:t}){const n=B.useState(e),[r]=n,s=B.useRef(r),o=Qr(t);return B.useEffect(()=>{s.current!==r&&(o(r),s.current=r)},[r,s,o]),n}var Fz="VisuallyHidden",i1=B.forwardRef((e,t)=>R.jsx(Nn.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));i1.displayName=Fz;var Rz=i1,tE="ToastProvider",[nE,jz,Nz]=ZT("Toast"),[cI,yY]=tf("Toast",[Nz]),[zz,o1]=cI(tE),uI=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:o=50,children:a}=e,[c,u]=B.useState(null),[d,h]=B.useState(0),m=B.useRef(!1),p=B.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${tE}\`. Expected non-empty \`string\`.`),R.jsx(nE.Provider,{scope:t,children:R.jsx(zz,{scope:t,label:n,duration:r,swipeDirection:s,swipeThreshold:o,toastCount:d,viewport:c,onViewportChange:u,onToastAdd:B.useCallback(()=>h(v=>v+1),[]),onToastRemove:B.useCallback(()=>h(v=>v-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:p,children:a})})};uI.displayName=tE;var dI="ToastViewport",Bz=["F8"],uM="toast.viewportPause",dM="toast.viewportResume",hI=B.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=Bz,label:s="Notifications ({hotkey})",...o}=e,a=o1(dI,n),c=jz(n),u=B.useRef(null),d=B.useRef(null),h=B.useRef(null),m=B.useRef(null),p=Er(t,m,a.onViewportChange),v=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),T=a.toastCount>0;B.useEffect(()=>{const O=b=>{var I;r.length!==0&&r.every(k=>b[k]||b.code===k)&&((I=m.current)==null||I.focus())};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[r]),B.useEffect(()=>{const O=u.current,b=m.current;if(T&&O&&b){const M=()=>{if(!a.isClosePausedRef.current){const P=new CustomEvent(uM);b.dispatchEvent(P),a.isClosePausedRef.current=!0}},I=()=>{if(a.isClosePausedRef.current){const P=new CustomEvent(dM);b.dispatchEvent(P),a.isClosePausedRef.current=!1}},k=P=>{!O.contains(P.relatedTarget)&&I()},$=()=>{O.contains(document.activeElement)||I()};return O.addEventListener("focusin",M),O.addEventListener("focusout",k),O.addEventListener("pointermove",M),O.addEventListener("pointerleave",$),window.addEventListener("blur",M),window.addEventListener("focus",I),()=>{O.removeEventListener("focusin",M),O.removeEventListener("focusout",k),O.removeEventListener("pointermove",M),O.removeEventListener("pointerleave",$),window.removeEventListener("blur",M),window.removeEventListener("focus",I)}}},[T,a.isClosePausedRef]);const E=B.useCallback(({tabbingDirection:O})=>{const M=c().map(I=>{const k=I.ref.current,$=[k,...eB(k)];return O==="forwards"?$:$.reverse()});return(O==="forwards"?M.reverse():M).flat()},[c]);return B.useEffect(()=>{const O=m.current;if(O){const b=M=>{var $,P,D;const I=M.altKey||M.ctrlKey||M.metaKey;if(M.key==="Tab"&&!I){const j=document.activeElement,Y=M.shiftKey;if(M.target===O&&Y){($=d.current)==null||$.focus();return}const de=E({tabbingDirection:Y?"backwards":"forwards"}),re=de.findIndex(he=>he===j);Wb(de.slice(re+1))?M.preventDefault():Y?(P=d.current)==null||P.focus():(D=h.current)==null||D.focus()}};return O.addEventListener("keydown",b),()=>O.removeEventListener("keydown",b)}},[c,E]),R.jsxs(Az,{ref:u,role:"region","aria-label":s.replace("{hotkey}",v),tabIndex:-1,style:{pointerEvents:T?void 0:"none"},children:[T&&R.jsx(hM,{ref:d,onFocusFromOutsideViewport:()=>{const O=E({tabbingDirection:"forwards"});Wb(O)}}),R.jsx(nE.Slot,{scope:n,children:R.jsx(Nn.ol,{tabIndex:-1,...o,ref:p})}),T&&R.jsx(hM,{ref:h,onFocusFromOutsideViewport:()=>{const O=E({tabbingDirection:"backwards"});Wb(O)}})]})});hI.displayName=dI;var fI="ToastFocusProxy",hM=B.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=e,o=o1(fI,n);return R.jsx(i1,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:a=>{var d;const c=a.relatedTarget;!((d=o.viewport)!=null&&d.contains(c))&&r()}})});hM.displayName=fI;var a1="Toast",Vz="toast.swipeStart",Uz="toast.swipeMove",Wz="toast.swipeCancel",Gz="toast.swipeEnd",pI=B.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:o,...a}=e,[c=!0,u]=s1({prop:r,defaultProp:s,onChange:o});return R.jsx(Dl,{present:n||c,children:R.jsx(qz,{open:c,...a,ref:t,onClose:()=>u(!1),onPause:Qr(e.onPause),onResume:Qr(e.onResume),onSwipeStart:vn(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:vn(e.onSwipeMove,d=>{const{x:h,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:vn(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:vn(e.onSwipeEnd,d=>{const{x:h,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),u(!1)})})})});pI.displayName=a1;var[Kz,Hz]=cI(a1,{onClose(){}}),qz=B.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:o,onClose:a,onEscapeKeyDown:c,onPause:u,onResume:d,onSwipeStart:h,onSwipeMove:m,onSwipeCancel:p,onSwipeEnd:v,...T}=e,E=o1(a1,n),[O,b]=B.useState(null),M=Er(t,he=>b(he)),I=B.useRef(null),k=B.useRef(null),$=s||E.duration,P=B.useRef(0),D=B.useRef($),j=B.useRef(0),{onToastAdd:Y,onToastRemove:q}=E,oe=Qr(()=>{var ue;(O==null?void 0:O.contains(document.activeElement))&&((ue=E.viewport)==null||ue.focus()),a()}),de=B.useCallback(he=>{!he||he===1/0||(window.clearTimeout(j.current),P.current=new Date().getTime(),j.current=window.setTimeout(oe,he))},[oe]);B.useEffect(()=>{const he=E.viewport;if(he){const ue=()=>{de(D.current),d==null||d()},ye=()=>{const xe=new Date().getTime()-P.current;D.current=D.current-xe,window.clearTimeout(j.current),u==null||u()};return he.addEventListener(uM,ye),he.addEventListener(dM,ue),()=>{he.removeEventListener(uM,ye),he.removeEventListener(dM,ue)}}},[E.viewport,$,u,d,de]),B.useEffect(()=>{o&&!E.isClosePausedRef.current&&de($)},[o,$,E.isClosePausedRef,de]),B.useEffect(()=>(Y(),()=>q()),[Y,q]);const re=B.useMemo(()=>O?bI(O):null,[O]);return E.viewport?R.jsxs(R.Fragment,{children:[re&&R.jsx(Qz,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:re}),R.jsx(Kz,{scope:n,onClose:oe,children:G0.createPortal(R.jsx(nE.ItemSlot,{scope:n,children:R.jsx(kz,{asChild:!0,onEscapeKeyDown:vn(c,()=>{E.isFocusedToastEscapeKeyDownRef.current||oe(),E.isFocusedToastEscapeKeyDownRef.current=!1}),children:R.jsx(Nn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":E.swipeDirection,...T,ref:M,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:vn(e.onKeyDown,he=>{he.key==="Escape"&&(c==null||c(he.nativeEvent),he.nativeEvent.defaultPrevented||(E.isFocusedToastEscapeKeyDownRef.current=!0,oe()))}),onPointerDown:vn(e.onPointerDown,he=>{he.button===0&&(I.current={x:he.clientX,y:he.clientY})}),onPointerMove:vn(e.onPointerMove,he=>{if(!I.current)return;const ue=he.clientX-I.current.x,ye=he.clientY-I.current.y,xe=!!k.current,te=["left","right"].includes(E.swipeDirection),ke=["left","up"].includes(E.swipeDirection)?Math.min:Math.max,De=te?ke(0,ue):0,me=te?0:ke(0,ye),ee=he.pointerType==="touch"?10:2,ge={x:De,y:me},Ie={originalEvent:he,delta:ge};xe?(k.current=ge,bv(Uz,m,Ie,{discrete:!1})):lC(ge,E.swipeDirection,ee)?(k.current=ge,bv(Vz,h,Ie,{discrete:!1}),he.target.setPointerCapture(he.pointerId)):(Math.abs(ue)>ee||Math.abs(ye)>ee)&&(I.current=null)}),onPointerUp:vn(e.onPointerUp,he=>{const ue=k.current,ye=he.target;if(ye.hasPointerCapture(he.pointerId)&&ye.releasePointerCapture(he.pointerId),k.current=null,I.current=null,ue){const xe=he.currentTarget,te={originalEvent:he,delta:ue};lC(ue,E.swipeDirection,E.swipeThreshold)?bv(Gz,v,te,{discrete:!0}):bv(Wz,p,te,{discrete:!0}),xe.addEventListener("click",ke=>ke.preventDefault(),{once:!0})}})})})}),E.viewport)})]}):null}),Qz=e=>{const{__scopeToast:t,children:n,...r}=e,s=o1(a1,t),[o,a]=B.useState(!1),[c,u]=B.useState(!1);return Jz(()=>a(!0)),B.useEffect(()=>{const d=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(d)},[]),c?null:R.jsx(lI,{asChild:!0,children:R.jsx(i1,{...r,children:o&&R.jsxs(R.Fragment,{children:[s.label," ",n]})})})},Yz="ToastTitle",mI=B.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return R.jsx(Nn.div,{...r,ref:t})});mI.displayName=Yz;var Xz="ToastDescription",gI=B.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return R.jsx(Nn.div,{...r,ref:t})});gI.displayName=Xz;var _I="ToastAction",yI=B.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?R.jsx(wI,{altText:n,asChild:!0,children:R.jsx(rE,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${_I}\`. Expected non-empty \`string\`.`),null)});yI.displayName=_I;var vI="ToastClose",rE=B.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,s=Hz(vI,n);return R.jsx(wI,{asChild:!0,children:R.jsx(Nn.button,{type:"button",...r,ref:t,onClick:vn(e.onClick,s.onClose)})})});rE.displayName=vI;var wI=B.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...s}=e;return R.jsx(Nn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:t})});function bI(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),Zz(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!s)if(o){const a=r.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...bI(r))}}),t}function bv(e,t,n,{discrete:r}){const s=n.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?sI(s,o):s.dispatchEvent(o)}var lC=(e,t,n=0)=>{const r=Math.abs(e.x),s=Math.abs(e.y),o=r>s;return t==="left"||t==="right"?o&&r>n:!o&&s>n};function Jz(e=()=>{}){const t=Qr(e);to(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function Zz(e){return e.nodeType===e.ELEMENT_NODE}function eB(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Wb(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var tB=uI,xI=hI,MI=pI,TI=mI,EI=gI,PI=yI,SI=rE;function CI(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=CI(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function kI(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=CI(e))&&(r&&(r+=" "),r+=t);return r}const cC=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,uC=kI,sE=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return uC(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:o}=t,a=Object.keys(s).map(d=>{const h=n==null?void 0:n[d],m=o==null?void 0:o[d];if(h===null)return null;const p=cC(h)||cC(m);return s[d][p]}),c=n&&Object.entries(n).reduce((d,h)=>{let[m,p]=h;return p===void 0||(d[m]=p),d},{}),u=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((d,h)=>{let{class:m,className:p,...v}=h;return Object.entries(v).every(T=>{let[E,O]=T;return Array.isArray(O)?O.includes({...o,...c}[E]):{...o,...c}[E]===O})?[...d,m,p]:d},[]);return uC(e,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AI=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=B.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:a,...c},u)=>B.createElement("svg",{ref:u,...rB,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:AI("lucide",s),...c},[...a.map(([d,h])=>B.createElement(d,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=(e,t)=>{const n=B.forwardRef(({className:r,...s},o)=>B.createElement(sB,{ref:o,iconNode:t,className:AI(`lucide-${nB(e)}`,r),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=iB("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),iE="-",aB=e=>{const t=cB(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const c=a.split(iE);return c[0]===""&&c.length!==1&&c.shift(),$I(c,t)||lB(a)},getConflictingClassGroupIds:(a,c)=>{const u=n[a]||[];return c&&r[a]?[...u,...r[a]]:u}}},$I=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?$I(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const o=e.join(iE);return(a=t.validators.find(({validator:c})=>c(o)))==null?void 0:a.classGroupId},dC=/^\[(.+)\]$/,lB=e=>{if(dC.test(e)){const t=dC.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},cB=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return dB(Object.entries(e.classGroups),n).forEach(([o,a])=>{fM(a,r,o,t)}),r},fM=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const o=s===""?t:hC(t,s);o.classGroupId=n;return}if(typeof s=="function"){if(uB(s)){fM(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([o,a])=>{fM(a,hC(t,o),n,r)})})},hC=(e,t)=>{let n=e;return t.split(iE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},uB=e=>e.isThemeGetter,dB=(e,t)=>t?e.map(([n,r])=>{const s=r.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([a,c])=>[t+a,c])):o);return[n,s]}):e,hB=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(o,a)=>{n.set(o,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(o){let a=n.get(o);if(a!==void 0)return a;if((a=r.get(o))!==void 0)return s(o,a),a},set(o,a){n.has(o)?n.set(o,a):s(o,a)}}},II="!",fB=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],o=t.length,a=c=>{const u=[];let d=0,h=0,m;for(let O=0;O<c.length;O++){let b=c[O];if(d===0){if(b===s&&(r||c.slice(O,O+o)===t)){u.push(c.slice(h,O)),h=O+o;continue}if(b==="/"){m=O;continue}}b==="["?d++:b==="]"&&d--}const p=u.length===0?c:c.substring(h),v=p.startsWith(II),T=v?p.substring(1):p,E=m&&m>h?m-h:void 0;return{modifiers:u,hasImportantModifier:v,baseClassName:T,maybePostfixModifierPosition:E}};return n?c=>n({className:c,parseClassName:a}):a},pB=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},mB=e=>({cache:hB(e.cacheSize),parseClassName:fB(e),...aB(e)}),gB=/\s+/,_B=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,o=[],a=e.trim().split(gB);let c="";for(let u=a.length-1;u>=0;u-=1){const d=a[u],{modifiers:h,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:v}=n(d);let T=!!v,E=r(T?p.substring(0,v):p);if(!E){if(!T){c=d+(c.length>0?" "+c:c);continue}if(E=r(p),!E){c=d+(c.length>0?" "+c:c);continue}T=!1}const O=pB(h).join(":"),b=m?O+II:O,M=b+E;if(o.includes(M))continue;o.push(M);const I=s(E,T);for(let k=0;k<I.length;++k){const $=I[k];o.push(b+$)}c=d+(c.length>0?" "+c:c)}return c};function yB(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=OI(t))&&(r&&(r+=" "),r+=n);return r}const OI=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=OI(e[r]))&&(n&&(n+=" "),n+=t);return n};function vB(e,...t){let n,r,s,o=a;function a(u){const d=t.reduce((h,m)=>m(h),e());return n=mB(d),r=n.cache.get,s=n.cache.set,o=c,c(u)}function c(u){const d=r(u);if(d)return d;const h=_B(u,n);return s(u,h),h}return function(){return o(yB.apply(null,arguments))}}const cr=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},DI=/^\[(?:([a-z-]+):)?(.+)\]$/i,wB=/^\d+\/\d+$/,bB=new Set(["px","full","screen"]),xB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,MB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TB=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,EB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,PB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jo=e=>Eh(e)||bB.has(e)||wB.test(e),Ka=e=>nf(e,"length",DB),Eh=e=>!!e&&!Number.isNaN(Number(e)),Gb=e=>nf(e,"number",Eh),P_=e=>!!e&&Number.isInteger(Number(e)),SB=e=>e.endsWith("%")&&Eh(e.slice(0,-1)),yn=e=>DI.test(e),Ha=e=>xB.test(e),CB=new Set(["length","size","percentage"]),kB=e=>nf(e,CB,LI),AB=e=>nf(e,"position",LI),$B=new Set(["image","url"]),IB=e=>nf(e,$B,FB),OB=e=>nf(e,"",LB),S_=()=>!0,nf=(e,t,n)=>{const r=DI.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},DB=e=>MB.test(e)&&!TB.test(e),LI=()=>!1,LB=e=>EB.test(e),FB=e=>PB.test(e),RB=()=>{const e=cr("colors"),t=cr("spacing"),n=cr("blur"),r=cr("brightness"),s=cr("borderColor"),o=cr("borderRadius"),a=cr("borderSpacing"),c=cr("borderWidth"),u=cr("contrast"),d=cr("grayscale"),h=cr("hueRotate"),m=cr("invert"),p=cr("gap"),v=cr("gradientColorStops"),T=cr("gradientColorStopPositions"),E=cr("inset"),O=cr("margin"),b=cr("opacity"),M=cr("padding"),I=cr("saturate"),k=cr("scale"),$=cr("sepia"),P=cr("skew"),D=cr("space"),j=cr("translate"),Y=()=>["auto","contain","none"],q=()=>["auto","hidden","clip","visible","scroll"],oe=()=>["auto",yn,t],de=()=>[yn,t],re=()=>["",Jo,Ka],he=()=>["auto",Eh,yn],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ye=()=>["solid","dashed","dotted","double","none"],xe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],te=()=>["start","end","center","between","around","evenly","stretch"],ke=()=>["","0",yn],De=()=>["auto","avoid","all","avoid-page","page","left","right","column"],me=()=>[Eh,yn];return{cacheSize:500,separator:":",theme:{colors:[S_],spacing:[Jo,Ka],blur:["none","",Ha,yn],brightness:me(),borderColor:[e],borderRadius:["none","","full",Ha,yn],borderSpacing:de(),borderWidth:re(),contrast:me(),grayscale:ke(),hueRotate:me(),invert:ke(),gap:de(),gradientColorStops:[e],gradientColorStopPositions:[SB,Ka],inset:oe(),margin:oe(),opacity:me(),padding:de(),saturate:me(),scale:me(),sepia:ke(),skew:me(),space:de(),translate:de()},classGroups:{aspect:[{aspect:["auto","square","video",yn]}],container:["container"],columns:[{columns:[Ha]}],"break-after":[{"break-after":De()}],"break-before":[{"break-before":De()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),yn]}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:Y()}],"overscroll-x":[{"overscroll-x":Y()}],"overscroll-y":[{"overscroll-y":Y()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",P_,yn]}],basis:[{basis:oe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",yn]}],grow:[{grow:ke()}],shrink:[{shrink:ke()}],order:[{order:["first","last","none",P_,yn]}],"grid-cols":[{"grid-cols":[S_]}],"col-start-end":[{col:["auto",{span:["full",P_,yn]},yn]}],"col-start":[{"col-start":he()}],"col-end":[{"col-end":he()}],"grid-rows":[{"grid-rows":[S_]}],"row-start-end":[{row:["auto",{span:[P_,yn]},yn]}],"row-start":[{"row-start":he()}],"row-end":[{"row-end":he()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",yn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",yn]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...te()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...te(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...te(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[M]}],px:[{px:[M]}],py:[{py:[M]}],ps:[{ps:[M]}],pe:[{pe:[M]}],pt:[{pt:[M]}],pr:[{pr:[M]}],pb:[{pb:[M]}],pl:[{pl:[M]}],m:[{m:[O]}],mx:[{mx:[O]}],my:[{my:[O]}],ms:[{ms:[O]}],me:[{me:[O]}],mt:[{mt:[O]}],mr:[{mr:[O]}],mb:[{mb:[O]}],ml:[{ml:[O]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",yn,t]}],"min-w":[{"min-w":[yn,t,"min","max","fit"]}],"max-w":[{"max-w":[yn,t,"none","full","min","max","fit","prose",{screen:[Ha]},Ha]}],h:[{h:[yn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[yn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[yn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[yn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ha,Ka]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Gb]}],"font-family":[{font:[S_]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",yn]}],"line-clamp":[{"line-clamp":["none",Eh,Gb]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Jo,yn]}],"list-image":[{"list-image":["none",yn]}],"list-style-type":[{list:["none","disc","decimal",yn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Jo,Ka]}],"underline-offset":[{"underline-offset":["auto",Jo,yn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:de()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",yn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",yn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),AB]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",kB]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},IB]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...ye(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:ye()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...ye()]}],"outline-offset":[{"outline-offset":[Jo,yn]}],"outline-w":[{outline:[Jo,Ka]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:re()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Jo,Ka]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ha,OB]}],"shadow-color":[{shadow:[S_]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...xe(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":xe()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Ha,yn]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[m]}],saturate:[{saturate:[I]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",yn]}],duration:[{duration:me()}],ease:[{ease:["linear","in","out","in-out",yn]}],delay:[{delay:me()}],animate:[{animate:["none","spin","ping","pulse","bounce",yn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[P_,yn]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",yn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",yn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":de()}],"scroll-mx":[{"scroll-mx":de()}],"scroll-my":[{"scroll-my":de()}],"scroll-ms":[{"scroll-ms":de()}],"scroll-me":[{"scroll-me":de()}],"scroll-mt":[{"scroll-mt":de()}],"scroll-mr":[{"scroll-mr":de()}],"scroll-mb":[{"scroll-mb":de()}],"scroll-ml":[{"scroll-ml":de()}],"scroll-p":[{"scroll-p":de()}],"scroll-px":[{"scroll-px":de()}],"scroll-py":[{"scroll-py":de()}],"scroll-ps":[{"scroll-ps":de()}],"scroll-pe":[{"scroll-pe":de()}],"scroll-pt":[{"scroll-pt":de()}],"scroll-pr":[{"scroll-pr":de()}],"scroll-pb":[{"scroll-pb":de()}],"scroll-pl":[{"scroll-pl":de()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",yn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Jo,Ka,Gb]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},jB=vB(RB);function Kn(...e){return jB(kI(e))}const NB=tB,FI=B.forwardRef(({className:e,...t},n)=>R.jsx(xI,{ref:n,className:Kn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));FI.displayName=xI.displayName;const zB=sE("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),RI=B.forwardRef(({className:e,variant:t,...n},r)=>R.jsx(MI,{ref:r,className:Kn(zB({variant:t}),e),...n}));RI.displayName=MI.displayName;const BB=B.forwardRef(({className:e,...t},n)=>R.jsx(PI,{ref:n,className:Kn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));BB.displayName=PI.displayName;const jI=B.forwardRef(({className:e,...t},n)=>R.jsx(SI,{ref:n,className:Kn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:R.jsx(oB,{className:"h-4 w-4"})}));jI.displayName=SI.displayName;const NI=B.forwardRef(({className:e,...t},n)=>R.jsx(TI,{ref:n,className:Kn("text-sm font-semibold",e),...t}));NI.displayName=TI.displayName;const zI=B.forwardRef(({className:e,...t},n)=>R.jsx(EI,{ref:n,className:Kn("text-sm opacity-90",e),...t}));zI.displayName=EI.displayName;function VB(){const{toasts:e}=JT();return R.jsxs(NB,{children:[e.map(function({id:t,title:n,description:r,action:s,...o}){return R.jsxs(RI,{...o,children:[R.jsxs("div",{className:"grid gap-1",children:[n&&R.jsx(NI,{children:n}),r&&R.jsx(zI,{children:r})]}),s,R.jsx(jI,{})]},t)}),R.jsx(FI,{})]})}var fC=["light","dark"],UB="(prefers-color-scheme: dark)",WB=B.createContext(void 0),GB={setTheme:e=>{},themes:[]},KB=()=>{var e;return(e=B.useContext(WB))!=null?e:GB};B.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:o,value:a,attrs:c,nonce:u})=>{let d=o==="system",h=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(T=>`'${T}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,m=s?fC.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(T,E=!1,O=!0)=>{let b=a?a[T]:T,M=E?T+"|| ''":`'${b}'`,I="";return s&&O&&!E&&fC.includes(T)&&(I+=`d.style.colorScheme = '${T}';`),n==="class"?E||b?I+=`c.add(${M})`:I+="null":b&&(I+=`d[s](n,${M})`),I},v=e?`!function(){${h}${p(e)}}()`:r?`!function(){try{${h}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${UB}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${p(a?"x[e]":"e",!0)}}${d?"":"else{"+p(o,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${h}var e=localStorage.getItem('${t}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${p(a?"x[e]":"e",!0)}}else{${p(o,!1,!1)};}${m}}catch(t){}}();`;return B.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:v}})});var HB=e=>{switch(e){case"success":return YB;case"info":return JB;case"warning":return XB;case"error":return ZB;default:return null}},qB=Array(12).fill(0),QB=({visible:e})=>we.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},we.createElement("div",{className:"sonner-spinner"},qB.map((t,n)=>we.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),YB=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),XB=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),JB=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ZB=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),e5=()=>{let[e,t]=we.useState(document.hidden);return we.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},pM=1,t5=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,s=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:pM++,o=this.toasts.find(c=>c.id===s),a=e.dismissible===void 0?!0:e.dismissible;return o?this.toasts=this.toasts.map(c=>c.id===s?(this.publish({...c,...e,id:s,title:n}),{...c,...e,id:s,dismissible:a,title:n}):c):this.addToast({title:n,...r,dismissible:a,id:s}),s},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),s=n!==void 0;return r.then(async o=>{if(r5(o)&&!o.ok){s=!1;let a=typeof t.error=="function"?await t.error(`HTTP error! status: ${o.status}`):t.error,c=typeof t.description=="function"?await t.description(`HTTP error! status: ${o.status}`):t.description;this.create({id:n,type:"error",message:a,description:c})}else if(t.success!==void 0){s=!1;let a=typeof t.success=="function"?await t.success(o):t.success,c=typeof t.description=="function"?await t.description(o):t.description;this.create({id:n,type:"success",message:a,description:c})}}).catch(async o=>{if(t.error!==void 0){s=!1;let a=typeof t.error=="function"?await t.error(o):t.error,c=typeof t.description=="function"?await t.description(o):t.description;this.create({id:n,type:"error",message:a,description:c})}}).finally(()=>{var o;s&&(this.dismiss(n),n=void 0),(o=t.finally)==null||o.call(t)}),n},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||pM++;return this.create({jsx:e(n),id:n,...t}),n},this.subscribers=[],this.toasts=[]}},ni=new t5,n5=(e,t)=>{let n=(t==null?void 0:t.id)||pM++;return ni.addToast({title:e,...t,id:n}),n},r5=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",s5=n5,i5=()=>ni.toasts,mM=Object.assign(s5,{success:ni.success,info:ni.info,warning:ni.warning,error:ni.error,custom:ni.custom,message:ni.message,promise:ni.promise,dismiss:ni.dismiss,loading:ni.loading},{getHistory:i5});function o5(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}o5(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function xv(e){return e.label!==void 0}var a5=3,l5="32px",c5=4e3,u5=356,d5=14,h5=20,f5=200;function p5(...e){return e.filter(Boolean).join(" ")}var m5=e=>{var t,n,r,s,o,a,c,u,d,h;let{invert:m,toast:p,unstyled:v,interacting:T,setHeights:E,visibleToasts:O,heights:b,index:M,toasts:I,expanded:k,removeToast:$,defaultRichColors:P,closeButton:D,style:j,cancelButtonStyle:Y,actionButtonStyle:q,className:oe="",descriptionClassName:de="",duration:re,position:he,gap:ue,loadingIcon:ye,expandByDefault:xe,classNames:te,icons:ke,closeButtonAriaLabel:De="Close toast",pauseWhenPageIsHidden:me,cn:ee}=e,[ge,Ie]=we.useState(!1),[Be,Ue]=we.useState(!1),[pe,Ye]=we.useState(!1),[Ge,_e]=we.useState(!1),[Ae,He]=we.useState(0),[qe,Qe]=we.useState(0),Ke=we.useRef(null),rt=we.useRef(null),ht=M===0,_t=M+1<=O,ot=p.type,mt=p.dismissible!==!1,Q=p.className||"",ve=p.descriptionClassName||"",ie=we.useMemo(()=>b.findIndex(en=>en.toastId===p.id)||0,[b,p.id]),Ee=we.useMemo(()=>{var en;return(en=p.closeButton)!=null?en:D},[p.closeButton,D]),Re=we.useMemo(()=>p.duration||re||c5,[p.duration,re]),Xe=we.useRef(0),Ze=we.useRef(0),ft=we.useRef(0),gt=we.useRef(null),[St,kt]=he.split("-"),Dt=we.useMemo(()=>b.reduce((en,$n,ln)=>ln>=ie?en:en+$n.height,0),[b,ie]),mn=e5(),An=p.invert||m,Gn=ot==="loading";Ze.current=we.useMemo(()=>ie*ue+Dt,[ie,Dt]),we.useEffect(()=>{Ie(!0)},[]),we.useLayoutEffect(()=>{if(!ge)return;let en=rt.current,$n=en.style.height;en.style.height="auto";let ln=en.getBoundingClientRect().height;en.style.height=$n,Qe(ln),E(fr=>fr.find(Rt=>Rt.toastId===p.id)?fr.map(Rt=>Rt.toastId===p.id?{...Rt,height:ln}:Rt):[{toastId:p.id,height:ln,position:p.position},...fr])},[ge,p.title,p.description,E,p.id]);let zn=we.useCallback(()=>{Ue(!0),He(Ze.current),E(en=>en.filter($n=>$n.toastId!==p.id)),setTimeout(()=>{$(p)},f5)},[p,$,E,Ze]);we.useEffect(()=>{if(p.promise&&ot==="loading"||p.duration===1/0||p.type==="loading")return;let en,$n=Re;return k||T||me&&mn?(()=>{if(ft.current<Xe.current){let ln=new Date().getTime()-Xe.current;$n=$n-ln}ft.current=new Date().getTime()})():$n!==1/0&&(Xe.current=new Date().getTime(),en=setTimeout(()=>{var ln;(ln=p.onAutoClose)==null||ln.call(p,p),zn()},$n)),()=>clearTimeout(en)},[k,T,xe,p,Re,zn,p.promise,ot,me,mn]),we.useEffect(()=>{let en=rt.current;if(en){let $n=en.getBoundingClientRect().height;return Qe($n),E(ln=>[{toastId:p.id,height:$n,position:p.position},...ln]),()=>E(ln=>ln.filter(fr=>fr.toastId!==p.id))}},[E,p.id]),we.useEffect(()=>{p.delete&&zn()},[zn,p.delete]);function Br(){return ke!=null&&ke.loading?we.createElement("div",{className:"sonner-loader","data-visible":ot==="loading"},ke.loading):ye?we.createElement("div",{className:"sonner-loader","data-visible":ot==="loading"},ye):we.createElement(QB,{visible:ot==="loading"})}return we.createElement("li",{"aria-live":p.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:rt,className:ee(oe,Q,te==null?void 0:te.toast,(t=p==null?void 0:p.classNames)==null?void 0:t.toast,te==null?void 0:te.default,te==null?void 0:te[ot],(n=p==null?void 0:p.classNames)==null?void 0:n[ot]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:P,"data-styled":!(p.jsx||p.unstyled||v),"data-mounted":ge,"data-promise":!!p.promise,"data-removed":Be,"data-visible":_t,"data-y-position":St,"data-x-position":kt,"data-index":M,"data-front":ht,"data-swiping":pe,"data-dismissible":mt,"data-type":ot,"data-invert":An,"data-swipe-out":Ge,"data-expanded":!!(k||xe&&ge),style:{"--index":M,"--toasts-before":M,"--z-index":I.length-M,"--offset":`${Be?Ae:Ze.current}px`,"--initial-height":xe?"auto":`${qe}px`,...j,...p.style},onPointerDown:en=>{Gn||!mt||(Ke.current=new Date,He(Ze.current),en.target.setPointerCapture(en.pointerId),en.target.tagName!=="BUTTON"&&(Ye(!0),gt.current={x:en.clientX,y:en.clientY}))},onPointerUp:()=>{var en,$n,ln,fr;if(Ge||!mt)return;gt.current=null;let Rt=Number(((en=rt.current)==null?void 0:en.style.getPropertyValue("--swipe-amount").replace("px",""))||0),bs=new Date().getTime()-(($n=Ke.current)==null?void 0:$n.getTime()),Os=Math.abs(Rt)/bs;if(Math.abs(Rt)>=h5||Os>.11){He(Ze.current),(ln=p.onDismiss)==null||ln.call(p,p),zn(),_e(!0);return}(fr=rt.current)==null||fr.style.setProperty("--swipe-amount","0px"),Ye(!1)},onPointerMove:en=>{var $n;if(!gt.current||!mt)return;let ln=en.clientY-gt.current.y,fr=en.clientX-gt.current.x,Rt=(St==="top"?Math.min:Math.max)(0,ln),bs=en.pointerType==="touch"?10:2;Math.abs(Rt)>bs?($n=rt.current)==null||$n.style.setProperty("--swipe-amount",`${ln}px`):Math.abs(fr)>bs&&(gt.current=null)}},Ee&&!p.jsx?we.createElement("button",{"aria-label":De,"data-disabled":Gn,"data-close-button":!0,onClick:Gn||!mt?()=>{}:()=>{var en;zn(),(en=p.onDismiss)==null||en.call(p,p)},className:ee(te==null?void 0:te.closeButton,(s=p==null?void 0:p.classNames)==null?void 0:s.closeButton)},we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},we.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),we.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,p.jsx||we.isValidElement(p.title)?p.jsx||p.title:we.createElement(we.Fragment,null,ot||p.icon||p.promise?we.createElement("div",{"data-icon":"",className:ee(te==null?void 0:te.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Br():null,p.type!=="loading"?p.icon||(ke==null?void 0:ke[ot])||HB(ot):null):null,we.createElement("div",{"data-content":"",className:ee(te==null?void 0:te.content,(a=p==null?void 0:p.classNames)==null?void 0:a.content)},we.createElement("div",{"data-title":"",className:ee(te==null?void 0:te.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},p.title),p.description?we.createElement("div",{"data-description":"",className:ee(de,ve,te==null?void 0:te.description,(u=p==null?void 0:p.classNames)==null?void 0:u.description)},p.description):null),we.isValidElement(p.cancel)?p.cancel:p.cancel&&xv(p.cancel)?we.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||Y,onClick:en=>{var $n,ln;xv(p.cancel)&&mt&&((ln=($n=p.cancel).onClick)==null||ln.call($n,en),zn())},className:ee(te==null?void 0:te.cancelButton,(d=p==null?void 0:p.classNames)==null?void 0:d.cancelButton)},p.cancel.label):null,we.isValidElement(p.action)?p.action:p.action&&xv(p.action)?we.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||q,onClick:en=>{var $n,ln;xv(p.action)&&(en.defaultPrevented||((ln=($n=p.action).onClick)==null||ln.call($n,en),zn()))},className:ee(te==null?void 0:te.actionButton,(h=p==null?void 0:p.classNames)==null?void 0:h.actionButton)},p.action.label):null))};function pC(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var g5=e=>{let{invert:t,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:s,closeButton:o,className:a,offset:c,theme:u="light",richColors:d,duration:h,style:m,visibleToasts:p=a5,toastOptions:v,dir:T=pC(),gap:E=d5,loadingIcon:O,icons:b,containerAriaLabel:M="Notifications",pauseWhenPageIsHidden:I,cn:k=p5}=e,[$,P]=we.useState([]),D=we.useMemo(()=>Array.from(new Set([n].concat($.filter(me=>me.position).map(me=>me.position)))),[$,n]),[j,Y]=we.useState([]),[q,oe]=we.useState(!1),[de,re]=we.useState(!1),[he,ue]=we.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ye=we.useRef(null),xe=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),te=we.useRef(null),ke=we.useRef(!1),De=we.useCallback(me=>{var ee;(ee=$.find(ge=>ge.id===me.id))!=null&&ee.delete||ni.dismiss(me.id),P(ge=>ge.filter(({id:Ie})=>Ie!==me.id))},[$]);return we.useEffect(()=>ni.subscribe(me=>{if(me.dismiss){P(ee=>ee.map(ge=>ge.id===me.id?{...ge,delete:!0}:ge));return}setTimeout(()=>{eI.flushSync(()=>{P(ee=>{let ge=ee.findIndex(Ie=>Ie.id===me.id);return ge!==-1?[...ee.slice(0,ge),{...ee[ge],...me},...ee.slice(ge+1)]:[me,...ee]})})})}),[]),we.useEffect(()=>{if(u!=="system"){ue(u);return}u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ue("dark"):ue("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:me})=>{ue(me?"dark":"light")})},[u]),we.useEffect(()=>{$.length<=1&&oe(!1)},[$]),we.useEffect(()=>{let me=ee=>{var ge,Ie;r.every(Be=>ee[Be]||ee.code===Be)&&(oe(!0),(ge=ye.current)==null||ge.focus()),ee.code==="Escape"&&(document.activeElement===ye.current||(Ie=ye.current)!=null&&Ie.contains(document.activeElement))&&oe(!1)};return document.addEventListener("keydown",me),()=>document.removeEventListener("keydown",me)},[r]),we.useEffect(()=>{if(ye.current)return()=>{te.current&&(te.current.focus({preventScroll:!0}),te.current=null,ke.current=!1)}},[ye.current]),$.length?we.createElement("section",{"aria-label":`${M} ${xe}`,tabIndex:-1},D.map((me,ee)=>{var ge;let[Ie,Be]=me.split("-");return we.createElement("ol",{key:me,dir:T==="auto"?pC():T,tabIndex:-1,ref:ye,className:a,"data-sonner-toaster":!0,"data-theme":he,"data-y-position":Ie,"data-x-position":Be,style:{"--front-toast-height":`${((ge=j[0])==null?void 0:ge.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||l5,"--width":`${u5}px`,"--gap":`${E}px`,...m},onBlur:Ue=>{ke.current&&!Ue.currentTarget.contains(Ue.relatedTarget)&&(ke.current=!1,te.current&&(te.current.focus({preventScroll:!0}),te.current=null))},onFocus:Ue=>{Ue.target instanceof HTMLElement&&Ue.target.dataset.dismissible==="false"||ke.current||(ke.current=!0,te.current=Ue.relatedTarget)},onMouseEnter:()=>oe(!0),onMouseMove:()=>oe(!0),onMouseLeave:()=>{de||oe(!1)},onPointerDown:Ue=>{Ue.target instanceof HTMLElement&&Ue.target.dataset.dismissible==="false"||re(!0)},onPointerUp:()=>re(!1)},$.filter(Ue=>!Ue.position&&ee===0||Ue.position===me).map((Ue,pe)=>{var Ye,Ge;return we.createElement(m5,{key:Ue.id,icons:b,index:pe,toast:Ue,defaultRichColors:d,duration:(Ye=v==null?void 0:v.duration)!=null?Ye:h,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:t,visibleToasts:p,closeButton:(Ge=v==null?void 0:v.closeButton)!=null?Ge:o,interacting:de,position:me,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:De,toasts:$.filter(_e=>_e.position==Ue.position),heights:j.filter(_e=>_e.position==Ue.position),setHeights:Y,expandByDefault:s,gap:E,loadingIcon:O,expanded:q,pauseWhenPageIsHidden:I,cn:k})}))})):null};const _5=({...e})=>{const{theme:t="system"}=KB();return R.jsx(g5,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var y5=XA.useId||(()=>{}),v5=0;function BI(e){const[t,n]=B.useState(y5());return to(()=>{e||n(r=>r??String(v5++))},[e]),e||(t?`radix-${t}`:"")}const w5=["top","right","bottom","left"],El=Math.min,si=Math.max,Ew=Math.round,Mv=Math.floor,Pl=e=>({x:e,y:e}),b5={left:"right",right:"left",bottom:"top",top:"bottom"},x5={start:"end",end:"start"};function gM(e,t,n){return si(e,El(t,n))}function fa(e,t){return typeof e=="function"?e(t):e}function pa(e){return e.split("-")[0]}function rf(e){return e.split("-")[1]}function oE(e){return e==="x"?"y":"x"}function aE(e){return e==="y"?"height":"width"}function Sl(e){return["top","bottom"].includes(pa(e))?"y":"x"}function lE(e){return oE(Sl(e))}function M5(e,t,n){n===void 0&&(n=!1);const r=rf(e),s=lE(e),o=aE(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=Pw(a)),[a,Pw(a)]}function T5(e){const t=Pw(e);return[_M(e),t,_M(t)]}function _M(e){return e.replace(/start|end/g,t=>x5[t])}function E5(e,t,n){const r=["left","right"],s=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?o:a;default:return[]}}function P5(e,t,n,r){const s=rf(e);let o=E5(pa(e),n==="start",r);return s&&(o=o.map(a=>a+"-"+s),t&&(o=o.concat(o.map(_M)))),o}function Pw(e){return e.replace(/left|right|bottom|top/g,t=>b5[t])}function S5(e){return{top:0,right:0,bottom:0,left:0,...e}}function VI(e){return typeof e!="number"?S5(e):{top:e,right:e,bottom:e,left:e}}function Sw(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function mC(e,t,n){let{reference:r,floating:s}=e;const o=Sl(t),a=lE(t),c=aE(a),u=pa(t),d=o==="y",h=r.x+r.width/2-s.width/2,m=r.y+r.height/2-s.height/2,p=r[c]/2-s[c]/2;let v;switch(u){case"top":v={x:h,y:r.y-s.height};break;case"bottom":v={x:h,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:m};break;case"left":v={x:r.x-s.width,y:m};break;default:v={x:r.x,y:r.y}}switch(rf(t)){case"start":v[a]-=p*(n&&d?-1:1);break;case"end":v[a]+=p*(n&&d?-1:1);break}return v}const C5=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:o=[],platform:a}=n,c=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(t));let d=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:h,y:m}=mC(d,r,u),p=r,v={},T=0;for(let E=0;E<c.length;E++){const{name:O,fn:b}=c[E],{x:M,y:I,data:k,reset:$}=await b({x:h,y:m,initialPlacement:r,placement:p,strategy:s,middlewareData:v,rects:d,platform:a,elements:{reference:e,floating:t}});h=M??h,m=I??m,v={...v,[O]:{...v[O],...k}},$&&T<=50&&(T++,typeof $=="object"&&($.placement&&(p=$.placement),$.rects&&(d=$.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):$.rects),{x:h,y:m}=mC(d,p,u)),E=-1)}return{x:h,y:m,placement:p,strategy:s,middlewareData:v}};async function P0(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:o,rects:a,elements:c,strategy:u}=e,{boundary:d="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:p=!1,padding:v=0}=fa(t,e),T=VI(v),O=c[p?m==="floating"?"reference":"floating":m],b=Sw(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(O)))==null||n?O:O.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:d,rootBoundary:h,strategy:u})),M=m==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,I=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),k=await(o.isElement==null?void 0:o.isElement(I))?await(o.getScale==null?void 0:o.getScale(I))||{x:1,y:1}:{x:1,y:1},$=Sw(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:M,offsetParent:I,strategy:u}):M);return{top:(b.top-$.top+T.top)/k.y,bottom:($.bottom-b.bottom+T.bottom)/k.y,left:(b.left-$.left+T.left)/k.x,right:($.right-b.right+T.right)/k.x}}const k5=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:o,platform:a,elements:c,middlewareData:u}=t,{element:d,padding:h=0}=fa(e,t)||{};if(d==null)return{};const m=VI(h),p={x:n,y:r},v=lE(s),T=aE(v),E=await a.getDimensions(d),O=v==="y",b=O?"top":"left",M=O?"bottom":"right",I=O?"clientHeight":"clientWidth",k=o.reference[T]+o.reference[v]-p[v]-o.floating[T],$=p[v]-o.reference[v],P=await(a.getOffsetParent==null?void 0:a.getOffsetParent(d));let D=P?P[I]:0;(!D||!await(a.isElement==null?void 0:a.isElement(P)))&&(D=c.floating[I]||o.floating[T]);const j=k/2-$/2,Y=D/2-E[T]/2-1,q=El(m[b],Y),oe=El(m[M],Y),de=q,re=D-E[T]-oe,he=D/2-E[T]/2+j,ue=gM(de,he,re),ye=!u.arrow&&rf(s)!=null&&he!==ue&&o.reference[T]/2-(he<de?q:oe)-E[T]/2<0,xe=ye?he<de?he-de:he-re:0;return{[v]:p[v]+xe,data:{[v]:ue,centerOffset:he-ue-xe,...ye&&{alignmentOffset:xe}},reset:ye}}}),A5=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:o,rects:a,initialPlacement:c,platform:u,elements:d}=t,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:p,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:T="none",flipAlignment:E=!0,...O}=fa(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=pa(s),M=Sl(c),I=pa(c)===c,k=await(u.isRTL==null?void 0:u.isRTL(d.floating)),$=p||(I||!E?[Pw(c)]:T5(c)),P=T!=="none";!p&&P&&$.push(...P5(c,E,T,k));const D=[c,...$],j=await P0(t,O),Y=[];let q=((r=o.flip)==null?void 0:r.overflows)||[];if(h&&Y.push(j[b]),m){const he=M5(s,a,k);Y.push(j[he[0]],j[he[1]])}if(q=[...q,{placement:s,overflows:Y}],!Y.every(he=>he<=0)){var oe,de;const he=(((oe=o.flip)==null?void 0:oe.index)||0)+1,ue=D[he];if(ue)return{data:{index:he,overflows:q},reset:{placement:ue}};let ye=(de=q.filter(xe=>xe.overflows[0]<=0).sort((xe,te)=>xe.overflows[1]-te.overflows[1])[0])==null?void 0:de.placement;if(!ye)switch(v){case"bestFit":{var re;const xe=(re=q.filter(te=>{if(P){const ke=Sl(te.placement);return ke===M||ke==="y"}return!0}).map(te=>[te.placement,te.overflows.filter(ke=>ke>0).reduce((ke,De)=>ke+De,0)]).sort((te,ke)=>te[1]-ke[1])[0])==null?void 0:re[0];xe&&(ye=xe);break}case"initialPlacement":ye=c;break}if(s!==ye)return{reset:{placement:ye}}}return{}}}};function gC(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _C(e){return w5.some(t=>e[t]>=0)}const $5=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=fa(e,t);switch(r){case"referenceHidden":{const o=await P0(t,{...s,elementContext:"reference"}),a=gC(o,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:_C(a)}}}case"escaped":{const o=await P0(t,{...s,altBoundary:!0}),a=gC(o,n.floating);return{data:{escapedOffsets:a,escaped:_C(a)}}}default:return{}}}}};async function I5(e,t){const{placement:n,platform:r,elements:s}=e,o=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=pa(n),c=rf(n),u=Sl(n)==="y",d=["left","top"].includes(a)?-1:1,h=o&&u?-1:1,m=fa(t,e);let{mainAxis:p,crossAxis:v,alignmentAxis:T}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof T=="number"&&(v=c==="end"?T*-1:T),u?{x:v*h,y:p*d}:{x:p*d,y:v*h}}const O5=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:o,placement:a,middlewareData:c}=t,u=await I5(t,e);return a===((n=c.offset)==null?void 0:n.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:s+u.x,y:o+u.y,data:{...u,placement:a}}}}},D5=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:o=!0,crossAxis:a=!1,limiter:c={fn:O=>{let{x:b,y:M}=O;return{x:b,y:M}}},...u}=fa(e,t),d={x:n,y:r},h=await P0(t,u),m=Sl(pa(s)),p=oE(m);let v=d[p],T=d[m];if(o){const O=p==="y"?"top":"left",b=p==="y"?"bottom":"right",M=v+h[O],I=v-h[b];v=gM(M,v,I)}if(a){const O=m==="y"?"top":"left",b=m==="y"?"bottom":"right",M=T+h[O],I=T-h[b];T=gM(M,T,I)}const E=c.fn({...t,[p]:v,[m]:T});return{...E,data:{x:E.x-n,y:E.y-r,enabled:{[p]:o,[m]:a}}}}}},L5=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:o,middlewareData:a}=t,{offset:c=0,mainAxis:u=!0,crossAxis:d=!0}=fa(e,t),h={x:n,y:r},m=Sl(s),p=oE(m);let v=h[p],T=h[m];const E=fa(c,t),O=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(u){const I=p==="y"?"height":"width",k=o.reference[p]-o.floating[I]+O.mainAxis,$=o.reference[p]+o.reference[I]-O.mainAxis;v<k?v=k:v>$&&(v=$)}if(d){var b,M;const I=p==="y"?"width":"height",k=["top","left"].includes(pa(s)),$=o.reference[m]-o.floating[I]+(k&&((b=a.offset)==null?void 0:b[m])||0)+(k?0:O.crossAxis),P=o.reference[m]+o.reference[I]+(k?0:((M=a.offset)==null?void 0:M[m])||0)-(k?O.crossAxis:0);T<$?T=$:T>P&&(T=P)}return{[p]:v,[m]:T}}}},F5=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:o,platform:a,elements:c}=t,{apply:u=()=>{},...d}=fa(e,t),h=await P0(t,d),m=pa(s),p=rf(s),v=Sl(s)==="y",{width:T,height:E}=o.floating;let O,b;m==="top"||m==="bottom"?(O=m,b=p===(await(a.isRTL==null?void 0:a.isRTL(c.floating))?"start":"end")?"left":"right"):(b=m,O=p==="end"?"top":"bottom");const M=E-h.top-h.bottom,I=T-h.left-h.right,k=El(E-h[O],M),$=El(T-h[b],I),P=!t.middlewareData.shift;let D=k,j=$;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(j=I),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(D=M),P&&!p){const q=si(h.left,0),oe=si(h.right,0),de=si(h.top,0),re=si(h.bottom,0);v?j=T-2*(q!==0||oe!==0?q+oe:si(h.left,h.right)):D=E-2*(de!==0||re!==0?de+re:si(h.top,h.bottom))}await u({...t,availableWidth:j,availableHeight:D});const Y=await a.getDimensions(c.floating);return T!==Y.width||E!==Y.height?{reset:{rects:!0}}:{}}}};function l1(){return typeof window<"u"}function sf(e){return UI(e)?(e.nodeName||"").toLowerCase():"#document"}function ai(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Fo(e){var t;return(t=(UI(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function UI(e){return l1()?e instanceof Node||e instanceof ai(e).Node:!1}function no(e){return l1()?e instanceof Element||e instanceof ai(e).Element:!1}function Do(e){return l1()?e instanceof HTMLElement||e instanceof ai(e).HTMLElement:!1}function yC(e){return!l1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ai(e).ShadowRoot}function K0(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=ro(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function R5(e){return["table","td","th"].includes(sf(e))}function c1(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function cE(e){const t=uE(),n=no(e)?ro(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function j5(e){let t=Cl(e);for(;Do(t)&&!Wh(t);){if(cE(t))return t;if(c1(t))return null;t=Cl(t)}return null}function uE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Wh(e){return["html","body","#document"].includes(sf(e))}function ro(e){return ai(e).getComputedStyle(e)}function u1(e){return no(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Cl(e){if(sf(e)==="html")return e;const t=e.assignedSlot||e.parentNode||yC(e)&&e.host||Fo(e);return yC(t)?t.host:t}function WI(e){const t=Cl(e);return Wh(t)?e.ownerDocument?e.ownerDocument.body:e.body:Do(t)&&K0(t)?t:WI(t)}function S0(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=WI(e),o=s===((r=e.ownerDocument)==null?void 0:r.body),a=ai(s);if(o){const c=yM(a);return t.concat(a,a.visualViewport||[],K0(s)?s:[],c&&n?S0(c):[])}return t.concat(s,S0(s,[],n))}function yM(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function GI(e){const t=ro(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Do(e),o=s?e.offsetWidth:n,a=s?e.offsetHeight:r,c=Ew(n)!==o||Ew(r)!==a;return c&&(n=o,r=a),{width:n,height:r,$:c}}function dE(e){return no(e)?e:e.contextElement}function Ph(e){const t=dE(e);if(!Do(t))return Pl(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:o}=GI(t);let a=(o?Ew(n.width):n.width)/r,c=(o?Ew(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!c||!Number.isFinite(c))&&(c=1),{x:a,y:c}}const N5=Pl(0);function KI(e){const t=ai(e);return!uE()||!t.visualViewport?N5:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function z5(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ai(e)?!1:t}function Wc(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),o=dE(e);let a=Pl(1);t&&(r?no(r)&&(a=Ph(r)):a=Ph(e));const c=z5(o,n,r)?KI(o):Pl(0);let u=(s.left+c.x)/a.x,d=(s.top+c.y)/a.y,h=s.width/a.x,m=s.height/a.y;if(o){const p=ai(o),v=r&&no(r)?ai(r):r;let T=p,E=yM(T);for(;E&&r&&v!==T;){const O=Ph(E),b=E.getBoundingClientRect(),M=ro(E),I=b.left+(E.clientLeft+parseFloat(M.paddingLeft))*O.x,k=b.top+(E.clientTop+parseFloat(M.paddingTop))*O.y;u*=O.x,d*=O.y,h*=O.x,m*=O.y,u+=I,d+=k,T=ai(E),E=yM(T)}}return Sw({width:h,height:m,x:u,y:d})}function B5(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const o=s==="fixed",a=Fo(r),c=t?c1(t.floating):!1;if(r===a||c&&o)return n;let u={scrollLeft:0,scrollTop:0},d=Pl(1);const h=Pl(0),m=Do(r);if((m||!m&&!o)&&((sf(r)!=="body"||K0(a))&&(u=u1(r)),Do(r))){const p=Wc(r);d=Ph(r),h.x=p.x+r.clientLeft,h.y=p.y+r.clientTop}return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-u.scrollLeft*d.x+h.x,y:n.y*d.y-u.scrollTop*d.y+h.y}}function V5(e){return Array.from(e.getClientRects())}function vM(e,t){const n=u1(e).scrollLeft;return t?t.left+n:Wc(Fo(e)).left+n}function U5(e){const t=Fo(e),n=u1(e),r=e.ownerDocument.body,s=si(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=si(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+vM(e);const c=-n.scrollTop;return ro(r).direction==="rtl"&&(a+=si(t.clientWidth,r.clientWidth)-s),{width:s,height:o,x:a,y:c}}function W5(e,t){const n=ai(e),r=Fo(e),s=n.visualViewport;let o=r.clientWidth,a=r.clientHeight,c=0,u=0;if(s){o=s.width,a=s.height;const d=uE();(!d||d&&t==="fixed")&&(c=s.offsetLeft,u=s.offsetTop)}return{width:o,height:a,x:c,y:u}}function G5(e,t){const n=Wc(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,o=Do(e)?Ph(e):Pl(1),a=e.clientWidth*o.x,c=e.clientHeight*o.y,u=s*o.x,d=r*o.y;return{width:a,height:c,x:u,y:d}}function vC(e,t,n){let r;if(t==="viewport")r=W5(e,n);else if(t==="document")r=U5(Fo(e));else if(no(t))r=G5(t,n);else{const s=KI(e);r={...t,x:t.x-s.x,y:t.y-s.y}}return Sw(r)}function HI(e,t){const n=Cl(e);return n===t||!no(n)||Wh(n)?!1:ro(n).position==="fixed"||HI(n,t)}function K5(e,t){const n=t.get(e);if(n)return n;let r=S0(e,[],!1).filter(c=>no(c)&&sf(c)!=="body"),s=null;const o=ro(e).position==="fixed";let a=o?Cl(e):e;for(;no(a)&&!Wh(a);){const c=ro(a),u=cE(a);!u&&c.position==="fixed"&&(s=null),(o?!u&&!s:!u&&c.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||K0(a)&&!u&&HI(e,a))?r=r.filter(h=>h!==a):s=c,a=Cl(a)}return t.set(e,r),r}function H5(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?c1(t)?[]:K5(t,this._c):[].concat(n),r],c=a[0],u=a.reduce((d,h)=>{const m=vC(t,h,s);return d.top=si(m.top,d.top),d.right=El(m.right,d.right),d.bottom=El(m.bottom,d.bottom),d.left=si(m.left,d.left),d},vC(t,c,s));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function q5(e){const{width:t,height:n}=GI(e);return{width:t,height:n}}function Q5(e,t,n){const r=Do(t),s=Fo(t),o=n==="fixed",a=Wc(e,!0,o,t);let c={scrollLeft:0,scrollTop:0};const u=Pl(0);if(r||!r&&!o)if((sf(t)!=="body"||K0(s))&&(c=u1(t)),r){const v=Wc(t,!0,o,t);u.x=v.x+t.clientLeft,u.y=v.y+t.clientTop}else s&&(u.x=vM(s));let d=0,h=0;if(s&&!r&&!o){const v=s.getBoundingClientRect();h=v.top+c.scrollTop,d=v.left+c.scrollLeft-vM(s,v)}const m=a.left+c.scrollLeft-u.x-d,p=a.top+c.scrollTop-u.y-h;return{x:m,y:p,width:a.width,height:a.height}}function Kb(e){return ro(e).position==="static"}function wC(e,t){if(!Do(e)||ro(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Fo(e)===n&&(n=n.ownerDocument.body),n}function qI(e,t){const n=ai(e);if(c1(e))return n;if(!Do(e)){let s=Cl(e);for(;s&&!Wh(s);){if(no(s)&&!Kb(s))return s;s=Cl(s)}return n}let r=wC(e,t);for(;r&&R5(r)&&Kb(r);)r=wC(r,t);return r&&Wh(r)&&Kb(r)&&!cE(r)?n:r||j5(e)||n}const Y5=async function(e){const t=this.getOffsetParent||qI,n=this.getDimensions,r=await n(e.floating);return{reference:Q5(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function X5(e){return ro(e).direction==="rtl"}const J5={convertOffsetParentRelativeRectToViewportRelativeRect:B5,getDocumentElement:Fo,getClippingRect:H5,getOffsetParent:qI,getElementRects:Y5,getClientRects:V5,getDimensions:q5,getScale:Ph,isElement:no,isRTL:X5};function Z5(e,t){let n=null,r;const s=Fo(e);function o(){var c;clearTimeout(r),(c=n)==null||c.disconnect(),n=null}function a(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),o();const{left:d,top:h,width:m,height:p}=e.getBoundingClientRect();if(c||t(),!m||!p)return;const v=Mv(h),T=Mv(s.clientWidth-(d+m)),E=Mv(s.clientHeight-(h+p)),O=Mv(d),M={rootMargin:-v+"px "+-T+"px "+-E+"px "+-O+"px",threshold:si(0,El(1,u))||1};let I=!0;function k($){const P=$[0].intersectionRatio;if(P!==u){if(!I)return a();P?a(!1,P):r=setTimeout(()=>{a(!1,1e-7)},1e3)}I=!1}try{n=new IntersectionObserver(k,{...M,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,M)}n.observe(e)}return a(!0),o}function e8(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=dE(e),h=s||o?[...d?S0(d):[],...S0(t)]:[];h.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const m=d&&c?Z5(d,n):null;let p=-1,v=null;a&&(v=new ResizeObserver(b=>{let[M]=b;M&&M.target===d&&v&&(v.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(t)})),n()}),d&&!u&&v.observe(d),v.observe(t));let T,E=u?Wc(e):null;u&&O();function O(){const b=Wc(e);E&&(b.x!==E.x||b.y!==E.y||b.width!==E.width||b.height!==E.height)&&n(),E=b,T=requestAnimationFrame(O)}return n(),()=>{var b;h.forEach(M=>{s&&M.removeEventListener("scroll",n),o&&M.removeEventListener("resize",n)}),m==null||m(),(b=v)==null||b.disconnect(),v=null,u&&cancelAnimationFrame(T)}}const t8=O5,n8=D5,r8=A5,s8=F5,i8=$5,bC=k5,o8=L5,a8=(e,t,n)=>{const r=new Map,s={platform:J5,...n},o={...s.platform,_c:r};return C5(e,t,{...s,platform:o})};var qv=typeof document<"u"?B.useLayoutEffect:B.useEffect;function Cw(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Cw(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const o=s[r];if(!(o==="_owner"&&e.$$typeof)&&!Cw(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function QI(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function xC(e,t){const n=QI(e);return Math.round(t*n)/n}function Hb(e){const t=B.useRef(e);return qv(()=>{t.current=e}),t}function l8(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:o,floating:a}={},transform:c=!0,whileElementsMounted:u,open:d}=e,[h,m]=B.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,v]=B.useState(r);Cw(p,r)||v(r);const[T,E]=B.useState(null),[O,b]=B.useState(null),M=B.useCallback(te=>{te!==P.current&&(P.current=te,E(te))},[]),I=B.useCallback(te=>{te!==D.current&&(D.current=te,b(te))},[]),k=o||T,$=a||O,P=B.useRef(null),D=B.useRef(null),j=B.useRef(h),Y=u!=null,q=Hb(u),oe=Hb(s),de=Hb(d),re=B.useCallback(()=>{if(!P.current||!D.current)return;const te={placement:t,strategy:n,middleware:p};oe.current&&(te.platform=oe.current),a8(P.current,D.current,te).then(ke=>{const De={...ke,isPositioned:de.current!==!1};he.current&&!Cw(j.current,De)&&(j.current=De,G0.flushSync(()=>{m(De)}))})},[p,t,n,oe,de]);qv(()=>{d===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,m(te=>({...te,isPositioned:!1})))},[d]);const he=B.useRef(!1);qv(()=>(he.current=!0,()=>{he.current=!1}),[]),qv(()=>{if(k&&(P.current=k),$&&(D.current=$),k&&$){if(q.current)return q.current(k,$,re);re()}},[k,$,re,q,Y]);const ue=B.useMemo(()=>({reference:P,floating:D,setReference:M,setFloating:I}),[M,I]),ye=B.useMemo(()=>({reference:k,floating:$}),[k,$]),xe=B.useMemo(()=>{const te={position:n,left:0,top:0};if(!ye.floating)return te;const ke=xC(ye.floating,h.x),De=xC(ye.floating,h.y);return c?{...te,transform:"translate("+ke+"px, "+De+"px)",...QI(ye.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ke,top:De}},[n,c,ye.floating,h.x,h.y]);return B.useMemo(()=>({...h,update:re,refs:ue,elements:ye,floatingStyles:xe}),[h,re,ue,ye,xe])}const c8=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?bC({element:r.current,padding:s}).fn(n):{}:r?bC({element:r,padding:s}).fn(n):{}}}},u8=(e,t)=>({...t8(e),options:[e,t]}),d8=(e,t)=>({...n8(e),options:[e,t]}),h8=(e,t)=>({...o8(e),options:[e,t]}),f8=(e,t)=>({...r8(e),options:[e,t]}),p8=(e,t)=>({...s8(e),options:[e,t]}),m8=(e,t)=>({...i8(e),options:[e,t]}),g8=(e,t)=>({...c8(e),options:[e,t]});var _8="Arrow",YI=B.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...o}=e;return R.jsx(Nn.svg,{...o,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:R.jsx("polygon",{points:"0,0 30,0 15,10"})})});YI.displayName=_8;var y8=YI;function v8(e,t=[]){let n=[];function r(o,a){const c=B.createContext(a),u=n.length;n=[...n,a];function d(m){const{scope:p,children:v,...T}=m,E=(p==null?void 0:p[e][u])||c,O=B.useMemo(()=>T,Object.values(T));return R.jsx(E.Provider,{value:O,children:v})}function h(m,p){const v=(p==null?void 0:p[e][u])||c,T=B.useContext(v);if(T)return T;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${o}\``)}return d.displayName=o+"Provider",[d,h]}const s=()=>{const o=n.map(a=>B.createContext(a));return function(c){const u=(c==null?void 0:c[e])||o;return B.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return s.scopeName=e,[r,w8(s,...t)]}function w8(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return B.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function XI(e){const[t,n]=B.useState(void 0);return to(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const o=s[0];let a,c;if("borderBoxSize"in o){const u=o.borderBoxSize,d=Array.isArray(u)?u[0]:u;a=d.inlineSize,c=d.blockSize}else a=e.offsetWidth,c=e.offsetHeight;n({width:a,height:c})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var JI="Popper",[ZI,eO]=v8(JI),[vY,tO]=ZI(JI),nO="PopperAnchor",rO=B.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,o=tO(nO,n),a=B.useRef(null),c=Er(t,a);return B.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:R.jsx(Nn.div,{...s,ref:c})});rO.displayName=nO;var hE="PopperContent",[b8,x8]=ZI(hE),sO=B.forwardRef((e,t)=>{var pe,Ye,Ge,_e,Ae,He;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:o="center",alignOffset:a=0,arrowPadding:c=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:h=0,sticky:m="partial",hideWhenDetached:p=!1,updatePositionStrategy:v="optimized",onPlaced:T,...E}=e,O=tO(hE,n),[b,M]=B.useState(null),I=Er(t,qe=>M(qe)),[k,$]=B.useState(null),P=XI(k),D=(P==null?void 0:P.width)??0,j=(P==null?void 0:P.height)??0,Y=r+(o!=="center"?"-"+o:""),q=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},oe=Array.isArray(d)?d:[d],de=oe.length>0,re={padding:q,boundary:oe.filter(T8),altBoundary:de},{refs:he,floatingStyles:ue,placement:ye,isPositioned:xe,middlewareData:te}=l8({strategy:"fixed",placement:Y,whileElementsMounted:(...qe)=>e8(...qe,{animationFrame:v==="always"}),elements:{reference:O.anchor},middleware:[u8({mainAxis:s+j,alignmentAxis:a}),u&&d8({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?h8():void 0,...re}),u&&f8({...re}),p8({...re,apply:({elements:qe,rects:Qe,availableWidth:Ke,availableHeight:rt})=>{const{width:ht,height:_t}=Qe.reference,ot=qe.floating.style;ot.setProperty("--radix-popper-available-width",`${Ke}px`),ot.setProperty("--radix-popper-available-height",`${rt}px`),ot.setProperty("--radix-popper-anchor-width",`${ht}px`),ot.setProperty("--radix-popper-anchor-height",`${_t}px`)}}),k&&g8({element:k,padding:c}),E8({arrowWidth:D,arrowHeight:j}),p&&m8({strategy:"referenceHidden",...re})]}),[ke,De]=aO(ye),me=Qr(T);to(()=>{xe&&(me==null||me())},[xe,me]);const ee=(pe=te.arrow)==null?void 0:pe.x,ge=(Ye=te.arrow)==null?void 0:Ye.y,Ie=((Ge=te.arrow)==null?void 0:Ge.centerOffset)!==0,[Be,Ue]=B.useState();return to(()=>{b&&Ue(window.getComputedStyle(b).zIndex)},[b]),R.jsx("div",{ref:he.setFloating,"data-radix-popper-content-wrapper":"",style:{...ue,transform:xe?ue.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Be,"--radix-popper-transform-origin":[(_e=te.transformOrigin)==null?void 0:_e.x,(Ae=te.transformOrigin)==null?void 0:Ae.y].join(" "),...((He=te.hide)==null?void 0:He.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:R.jsx(b8,{scope:n,placedSide:ke,onArrowChange:$,arrowX:ee,arrowY:ge,shouldHideArrow:Ie,children:R.jsx(Nn.div,{"data-side":ke,"data-align":De,...E,ref:I,style:{...E.style,animation:xe?void 0:"none"}})})})});sO.displayName=hE;var iO="PopperArrow",M8={top:"bottom",right:"left",bottom:"top",left:"right"},oO=B.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,o=x8(iO,r),a=M8[o.placedSide];return R.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:R.jsx(y8,{...s,ref:n,style:{...s.style,display:"block"}})})});oO.displayName=iO;function T8(e){return e!==null}var E8=e=>({name:"transformOrigin",options:e,fn(t){var O,b,M;const{placement:n,rects:r,middlewareData:s}=t,a=((O=s.arrow)==null?void 0:O.centerOffset)!==0,c=a?0:e.arrowWidth,u=a?0:e.arrowHeight,[d,h]=aO(n),m={start:"0%",center:"50%",end:"100%"}[h],p=(((b=s.arrow)==null?void 0:b.x)??0)+c/2,v=(((M=s.arrow)==null?void 0:M.y)??0)+u/2;let T="",E="";return d==="bottom"?(T=a?m:`${p}px`,E=`${-u}px`):d==="top"?(T=a?m:`${p}px`,E=`${r.floating.height+u}px`):d==="right"?(T=`${-u}px`,E=a?m:`${v}px`):d==="left"&&(T=`${r.floating.width+u}px`,E=a?m:`${v}px`),{data:{x:T,y:E}}}});function aO(e){const[t,n="center"]=e.split("-");return[t,n]}var P8=rO,S8=sO,C8=oO,[d1,wY]=tf("Tooltip",[eO]),fE=eO(),lO="TooltipProvider",k8=700,MC="tooltip.open",[A8,cO]=d1(lO),uO=e=>{const{__scopeTooltip:t,delayDuration:n=k8,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:o}=e,[a,c]=B.useState(!0),u=B.useRef(!1),d=B.useRef(0);return B.useEffect(()=>{const h=d.current;return()=>window.clearTimeout(h)},[]),R.jsx(A8,{scope:t,isOpenDelayed:a,delayDuration:n,onOpen:B.useCallback(()=>{window.clearTimeout(d.current),c(!1)},[]),onClose:B.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>c(!0),r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:B.useCallback(h=>{u.current=h},[]),disableHoverableContent:s,children:o})};uO.displayName=lO;var dO="Tooltip",[bY,h1]=d1(dO),wM="TooltipTrigger",$8=B.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=h1(wM,n),o=cO(wM,n),a=fE(n),c=B.useRef(null),u=Er(t,c,s.onTriggerChange),d=B.useRef(!1),h=B.useRef(!1),m=B.useCallback(()=>d.current=!1,[]);return B.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),R.jsx(P8,{asChild:!0,...a,children:R.jsx(Nn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:u,onPointerMove:vn(e.onPointerMove,p=>{p.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(s.onTriggerEnter(),h.current=!0)}),onPointerLeave:vn(e.onPointerLeave,()=>{s.onTriggerLeave(),h.current=!1}),onPointerDown:vn(e.onPointerDown,()=>{d.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:vn(e.onFocus,()=>{d.current||s.onOpen()}),onBlur:vn(e.onBlur,s.onClose),onClick:vn(e.onClick,s.onClose)})})});$8.displayName=wM;var I8="TooltipPortal",[xY,O8]=d1(I8,{forceMount:void 0}),Gh="TooltipContent",hO=B.forwardRef((e,t)=>{const n=O8(Gh,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...o}=e,a=h1(Gh,e.__scopeTooltip);return R.jsx(Dl,{present:r||a.open,children:a.disableHoverableContent?R.jsx(fO,{side:s,...o,ref:t}):R.jsx(D8,{side:s,...o,ref:t})})}),D8=B.forwardRef((e,t)=>{const n=h1(Gh,e.__scopeTooltip),r=cO(Gh,e.__scopeTooltip),s=B.useRef(null),o=Er(t,s),[a,c]=B.useState(null),{trigger:u,onClose:d}=n,h=s.current,{onPointerInTransitChange:m}=r,p=B.useCallback(()=>{c(null),m(!1)},[m]),v=B.useCallback((T,E)=>{const O=T.currentTarget,b={x:T.clientX,y:T.clientY},M=j8(b,O.getBoundingClientRect()),I=N8(b,M),k=z8(E.getBoundingClientRect()),$=V8([...I,...k]);c($),m(!0)},[m]);return B.useEffect(()=>()=>p(),[p]),B.useEffect(()=>{if(u&&h){const T=O=>v(O,h),E=O=>v(O,u);return u.addEventListener("pointerleave",T),h.addEventListener("pointerleave",E),()=>{u.removeEventListener("pointerleave",T),h.removeEventListener("pointerleave",E)}}},[u,h,v,p]),B.useEffect(()=>{if(a){const T=E=>{const O=E.target,b={x:E.clientX,y:E.clientY},M=(u==null?void 0:u.contains(O))||(h==null?void 0:h.contains(O)),I=!B8(b,a);M?p():I&&(p(),d())};return document.addEventListener("pointermove",T),()=>document.removeEventListener("pointermove",T)}},[u,h,a,d,p]),R.jsx(fO,{...e,ref:o})}),[L8,F8]=d1(dO,{isInside:!1}),fO=B.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:o,onPointerDownOutside:a,...c}=e,u=h1(Gh,n),d=fE(n),{onClose:h}=u;return B.useEffect(()=>(document.addEventListener(MC,h),()=>document.removeEventListener(MC,h)),[h]),B.useEffect(()=>{if(u.trigger){const m=p=>{const v=p.target;v!=null&&v.contains(u.trigger)&&h()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[u.trigger,h]),R.jsx(eE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:m=>m.preventDefault(),onDismiss:h,children:R.jsxs(S8,{"data-state":u.stateAttribute,...d,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[R.jsx(rI,{children:r}),R.jsx(L8,{scope:n,isInside:!0,children:R.jsx(Rz,{id:u.contentId,role:"tooltip",children:s||r})})]})})});hO.displayName=Gh;var pO="TooltipArrow",R8=B.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=fE(n);return F8(pO,n).isInside?null:R.jsx(C8,{...s,...r,ref:t})});R8.displayName=pO;function j8(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,s,o)){case o:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function N8(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function z8(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function B8(e,t){const{x:n,y:r}=e;let s=!1;for(let o=0,a=t.length-1;o<t.length;a=o++){const c=t[o].x,u=t[o].y,d=t[a].x,h=t[a].y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function V8(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),U8(t)}function U8(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const o=t[t.length-1],a=t[t.length-2];if((o.x-a.x)*(s.y-a.y)>=(o.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const o=n[n.length-1],a=n[n.length-2];if((o.x-a.x)*(s.y-a.y)>=(o.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var W8=uO,mO=hO;const gO=W8,G8=B.forwardRef(({className:e,sideOffset:t=4,...n},r)=>R.jsx(mO,{ref:r,sideOffset:t,className:Kn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));G8.displayName=mO.displayName;var f1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},p1=typeof window>"u"||"Deno"in globalThis;function Hi(){}function K8(e,t){return typeof e=="function"?e(t):e}function H8(e){return typeof e=="number"&&e>=0&&e!==1/0}function q8(e,t){return Math.max(e+(t||0)-Date.now(),0)}function TC(e,t){return typeof e=="function"?e(t):e}function Q8(e,t){return typeof e=="function"?e(t):e}function EC(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:o,queryKey:a,stale:c}=e;if(a){if(r){if(t.queryHash!==pE(a,t.options))return!1}else if(!k0(t.queryKey,a))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||s&&s!==t.state.fetchStatus||o&&!o(t))}function PC(e,t){const{exact:n,status:r,predicate:s,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(n){if(C0(t.options.mutationKey)!==C0(o))return!1}else if(!k0(t.options.mutationKey,o))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function pE(e,t){return((t==null?void 0:t.queryKeyHashFn)||C0)(e)}function C0(e){return JSON.stringify(e,(t,n)=>bM(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function k0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!k0(e[n],t[n])):!1}function _O(e,t){if(e===t)return e;const n=SC(e)&&SC(t);if(n||bM(e)&&bM(t)){const r=n?e:Object.keys(e),s=r.length,o=n?t:Object.keys(t),a=o.length,c=n?[]:{};let u=0;for(let d=0;d<a;d++){const h=n?d:o[d];(!n&&r.includes(h)||n)&&e[h]===void 0&&t[h]===void 0?(c[h]=void 0,u++):(c[h]=_O(e[h],t[h]),c[h]===e[h]&&e[h]!==void 0&&u++)}return s===a&&u===s?e:c}return t}function SC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function bM(e){if(!CC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!CC(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function CC(e){return Object.prototype.toString.call(e)==="[object Object]"}function Y8(e){return new Promise(t=>{setTimeout(t,e)})}function X8(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?_O(e,t):t}function J8(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function Z8(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var mE=Symbol();function yO(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===mE?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Ac,il,Ch,IA,e6=(IA=class extends f1{constructor(){super();Yn(this,Ac);Yn(this,il);Yn(this,Ch);wn(this,Ch,t=>{if(!p1&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ct(this,il)||this.setEventListener(ct(this,Ch))}onUnsubscribe(){var t;this.hasListeners()||((t=ct(this,il))==null||t.call(this),wn(this,il,void 0))}setEventListener(t){var n;wn(this,Ch,t),(n=ct(this,il))==null||n.call(this),wn(this,il,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){ct(this,Ac)!==t&&(wn(this,Ac,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ct(this,Ac)=="boolean"?ct(this,Ac):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ac=new WeakMap,il=new WeakMap,Ch=new WeakMap,IA),vO=new e6,kh,ol,Ah,OA,t6=(OA=class extends f1{constructor(){super();Yn(this,kh,!0);Yn(this,ol);Yn(this,Ah);wn(this,Ah,t=>{if(!p1&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){ct(this,ol)||this.setEventListener(ct(this,Ah))}onUnsubscribe(){var t;this.hasListeners()||((t=ct(this,ol))==null||t.call(this),wn(this,ol,void 0))}setEventListener(t){var n;wn(this,Ah,t),(n=ct(this,ol))==null||n.call(this),wn(this,ol,t(this.setOnline.bind(this)))}setOnline(t){ct(this,kh)!==t&&(wn(this,kh,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return ct(this,kh)}},kh=new WeakMap,ol=new WeakMap,Ah=new WeakMap,OA),kw=new t6;function n6(){let e,t;const n=new Promise((s,o)=>{e=s,t=o});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}function r6(e){return Math.min(1e3*2**e,3e4)}function wO(e){return(e??"online")==="online"?kw.isOnline():!0}var bO=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function qb(e){return e instanceof bO}function xO(e){let t=!1,n=0,r=!1,s;const o=n6(),a=E=>{var O;r||(p(new bO(E)),(O=e.abort)==null||O.call(e))},c=()=>{t=!0},u=()=>{t=!1},d=()=>vO.isFocused()&&(e.networkMode==="always"||kw.isOnline())&&e.canRun(),h=()=>wO(e.networkMode)&&e.canRun(),m=E=>{var O;r||(r=!0,(O=e.onSuccess)==null||O.call(e,E),s==null||s(),o.resolve(E))},p=E=>{var O;r||(r=!0,(O=e.onError)==null||O.call(e,E),s==null||s(),o.reject(E))},v=()=>new Promise(E=>{var O;s=b=>{(r||d())&&E(b)},(O=e.onPause)==null||O.call(e)}).then(()=>{var E;s=void 0,r||(E=e.onContinue)==null||E.call(e)}),T=()=>{if(r)return;let E;const O=n===0?e.initialPromise:void 0;try{E=O??e.fn()}catch(b){E=Promise.reject(b)}Promise.resolve(E).then(m).catch(b=>{var P;if(r)return;const M=e.retry??(p1?0:3),I=e.retryDelay??r6,k=typeof I=="function"?I(n,b):I,$=M===!0||typeof M=="number"&&n<M||typeof M=="function"&&M(n,b);if(t||!$){p(b);return}n++,(P=e.onFail)==null||P.call(e,n,b),Y8(k).then(()=>d()?void 0:v()).then(()=>{t?p(b):T()})})};return{promise:o,cancel:a,continue:()=>(s==null||s(),o),cancelRetry:c,continueRetry:u,canStart:h,start:()=>(h()?T():v().then(T),o)}}function s6(){let e=[],t=0,n=c=>{c()},r=c=>{c()},s=c=>setTimeout(c,0);const o=c=>{t?e.push(c):s(()=>{n(c)})},a=()=>{const c=e;e=[],c.length&&s(()=>{r(()=>{c.forEach(u=>{n(u)})})})};return{batch:c=>{let u;t++;try{u=c()}finally{t--,t||a()}return u},batchCalls:c=>(...u)=>{o(()=>{c(...u)})},schedule:o,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{s=c}}}var ks=s6(),$c,DA,MO=(DA=class{constructor(){Yn(this,$c)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),H8(this.gcTime)&&wn(this,$c,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(p1?1/0:5*60*1e3))}clearGcTimeout(){ct(this,$c)&&(clearTimeout(ct(this,$c)),wn(this,$c,void 0))}},$c=new WeakMap,DA),$h,Ih,Mi,gs,j0,Ic,qi,ea,LA,i6=(LA=class extends MO{constructor(t){super();Yn(this,qi);Yn(this,$h);Yn(this,Ih);Yn(this,Mi);Yn(this,gs);Yn(this,j0);Yn(this,Ic);wn(this,Ic,!1),wn(this,j0,t.defaultOptions),this.setOptions(t.options),this.observers=[],wn(this,Mi,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,wn(this,$h,a6(this.options)),this.state=t.state??ct(this,$h),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ct(this,gs))==null?void 0:t.promise}setOptions(t){this.options={...ct(this,j0),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ct(this,Mi).remove(this)}setData(t,n){const r=X8(this.state.data,t,this.options);return fs(this,qi,ea).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){fs(this,qi,ea).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=ct(this,gs))==null?void 0:r.promise;return(s=ct(this,gs))==null||s.cancel(t),n?n.then(Hi).catch(Hi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ct(this,$h))}isActive(){return this.observers.some(t=>Q8(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===mE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!q8(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ct(this,gs))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ct(this,gs))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ct(this,Mi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ct(this,gs)&&(ct(this,Ic)?ct(this,gs).cancel({revert:!0}):ct(this,gs).cancelRetry()),this.scheduleGc()),ct(this,Mi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||fs(this,qi,ea).call(this,{type:"invalidate"})}fetch(t,n){var u,d,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ct(this,gs))return ct(this,gs).continueRetry(),ct(this,gs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(p=>p.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(wn(this,Ic,!0),r.signal)})},o=()=>{const m=yO(this.options,n),p={queryKey:this.queryKey,meta:this.meta};return s(p),wn(this,Ic,!1),this.options.persister?this.options.persister(m,p,this):m(p)},a={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:o};s(a),(u=this.options.behavior)==null||u.onFetch(a,this),wn(this,Ih,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&fs(this,qi,ea).call(this,{type:"fetch",meta:(h=a.fetchOptions)==null?void 0:h.meta});const c=m=>{var p,v,T,E;qb(m)&&m.silent||fs(this,qi,ea).call(this,{type:"error",error:m}),qb(m)||((v=(p=ct(this,Mi).config).onError)==null||v.call(p,m,this),(E=(T=ct(this,Mi).config).onSettled)==null||E.call(T,this.state.data,m,this)),this.scheduleGc()};return wn(this,gs,xO({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:m=>{var p,v,T,E;if(m===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(m)}catch(O){c(O);return}(v=(p=ct(this,Mi).config).onSuccess)==null||v.call(p,m,this),(E=(T=ct(this,Mi).config).onSettled)==null||E.call(T,m,this.state.error,this),this.scheduleGc()},onError:c,onFail:(m,p)=>{fs(this,qi,ea).call(this,{type:"failed",failureCount:m,error:p})},onPause:()=>{fs(this,qi,ea).call(this,{type:"pause"})},onContinue:()=>{fs(this,qi,ea).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),ct(this,gs).start()}},$h=new WeakMap,Ih=new WeakMap,Mi=new WeakMap,gs=new WeakMap,j0=new WeakMap,Ic=new WeakMap,qi=new WeakSet,ea=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...o6(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return qb(s)&&s.revert&&ct(this,Ih)?{...ct(this,Ih),fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ks.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ct(this,Mi).notify({query:this,type:"updated",action:t})})},LA);function o6(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:wO(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function a6(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var To,FA,l6=(FA=class extends f1{constructor(t={}){super();Yn(this,To);this.config=t,wn(this,To,new Map)}build(t,n,r){const s=n.queryKey,o=n.queryHash??pE(s,n);let a=this.get(o);return a||(a=new i6({cache:this,queryKey:s,queryHash:o,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(a)),a}add(t){ct(this,To).has(t.queryHash)||(ct(this,To).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ct(this,To).get(t.queryHash);n&&(t.destroy(),n===t&&ct(this,To).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ks.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ct(this,To).get(t)}getAll(){return[...ct(this,To).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>EC(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>EC(t,r)):n}notify(t){ks.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ks.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ks.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},To=new WeakMap,FA),Eo,Ss,Oc,Po,qa,RA,c6=(RA=class extends MO{constructor(t){super();Yn(this,Po);Yn(this,Eo);Yn(this,Ss);Yn(this,Oc);this.mutationId=t.mutationId,wn(this,Ss,t.mutationCache),wn(this,Eo,[]),this.state=t.state||u6(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ct(this,Eo).includes(t)||(ct(this,Eo).push(t),this.clearGcTimeout(),ct(this,Ss).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){wn(this,Eo,ct(this,Eo).filter(n=>n!==t)),this.scheduleGc(),ct(this,Ss).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ct(this,Eo).length||(this.state.status==="pending"?this.scheduleGc():ct(this,Ss).remove(this))}continue(){var t;return((t=ct(this,Oc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,o,a,c,u,d,h,m,p,v,T,E,O,b,M,I,k,$,P,D;wn(this,Oc,xO({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(j,Y)=>{fs(this,Po,qa).call(this,{type:"failed",failureCount:j,error:Y})},onPause:()=>{fs(this,Po,qa).call(this,{type:"pause"})},onContinue:()=>{fs(this,Po,qa).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ct(this,Ss).canRun(this)}));const n=this.state.status==="pending",r=!ct(this,Oc).canStart();try{if(!n){fs(this,Po,qa).call(this,{type:"pending",variables:t,isPaused:r}),await((o=(s=ct(this,Ss).config).onMutate)==null?void 0:o.call(s,t,this));const Y=await((c=(a=this.options).onMutate)==null?void 0:c.call(a,t));Y!==this.state.context&&fs(this,Po,qa).call(this,{type:"pending",context:Y,variables:t,isPaused:r})}const j=await ct(this,Oc).start();return await((d=(u=ct(this,Ss).config).onSuccess)==null?void 0:d.call(u,j,t,this.state.context,this)),await((m=(h=this.options).onSuccess)==null?void 0:m.call(h,j,t,this.state.context)),await((v=(p=ct(this,Ss).config).onSettled)==null?void 0:v.call(p,j,null,this.state.variables,this.state.context,this)),await((E=(T=this.options).onSettled)==null?void 0:E.call(T,j,null,t,this.state.context)),fs(this,Po,qa).call(this,{type:"success",data:j}),j}catch(j){try{throw await((b=(O=ct(this,Ss).config).onError)==null?void 0:b.call(O,j,t,this.state.context,this)),await((I=(M=this.options).onError)==null?void 0:I.call(M,j,t,this.state.context)),await(($=(k=ct(this,Ss).config).onSettled)==null?void 0:$.call(k,void 0,j,this.state.variables,this.state.context,this)),await((D=(P=this.options).onSettled)==null?void 0:D.call(P,void 0,j,t,this.state.context)),j}finally{fs(this,Po,qa).call(this,{type:"error",error:j})}}finally{ct(this,Ss).runNext(this)}}},Eo=new WeakMap,Ss=new WeakMap,Oc=new WeakMap,Po=new WeakSet,qa=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ks.batch(()=>{ct(this,Eo).forEach(r=>{r.onMutationUpdate(t)}),ct(this,Ss).notify({mutation:this,type:"updated",action:t})})},RA);function u6(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ti,N0,jA,d6=(jA=class extends f1{constructor(t={}){super();Yn(this,ti);Yn(this,N0);this.config=t,wn(this,ti,new Map),wn(this,N0,Date.now())}build(t,n,r){const s=new c6({mutationCache:this,mutationId:++nv(this,N0)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){const n=Tv(t),r=ct(this,ti).get(n)??[];r.push(t),ct(this,ti).set(n,r),this.notify({type:"added",mutation:t})}remove(t){var r;const n=Tv(t);if(ct(this,ti).has(n)){const s=(r=ct(this,ti).get(n))==null?void 0:r.filter(o=>o!==t);s&&(s.length===0?ct(this,ti).delete(n):ct(this,ti).set(n,s))}this.notify({type:"removed",mutation:t})}canRun(t){var r;const n=(r=ct(this,ti).get(Tv(t)))==null?void 0:r.find(s=>s.state.status==="pending");return!n||n===t}runNext(t){var r;const n=(r=ct(this,ti).get(Tv(t)))==null?void 0:r.find(s=>s!==t&&s.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){ks.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...ct(this,ti).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>PC(n,r))}findAll(t={}){return this.getAll().filter(n=>PC(t,n))}notify(t){ks.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ks.batch(()=>Promise.all(t.map(n=>n.continue().catch(Hi))))}},ti=new WeakMap,N0=new WeakMap,jA);function Tv(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function kC(e){return{onFetch:(t,n)=>{var h,m,p,v,T;const r=t.options,s=(p=(m=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:m.fetchMore)==null?void 0:p.direction,o=((v=t.state.data)==null?void 0:v.pages)||[],a=((T=t.state.data)==null?void 0:T.pageParams)||[];let c={pages:[],pageParams:[]},u=0;const d=async()=>{let E=!1;const O=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(t.signal.aborted?E=!0:t.signal.addEventListener("abort",()=>{E=!0}),t.signal)})},b=yO(t.options,t.fetchOptions),M=async(I,k,$)=>{if(E)return Promise.reject();if(k==null&&I.pages.length)return Promise.resolve(I);const P={queryKey:t.queryKey,pageParam:k,direction:$?"backward":"forward",meta:t.options.meta};O(P);const D=await b(P),{maxPages:j}=t.options,Y=$?Z8:J8;return{pages:Y(I.pages,D,j),pageParams:Y(I.pageParams,k,j)}};if(s&&o.length){const I=s==="backward",k=I?h6:AC,$={pages:o,pageParams:a},P=k(r,$);c=await M($,P,I)}else{const I=e??o.length;do{const k=u===0?a[0]??r.initialPageParam:AC(r,c);if(u>0&&k==null)break;c=await M(c,k),u++}while(u<I)}return c};t.options.persister?t.fetchFn=()=>{var E,O;return(O=(E=t.options).persister)==null?void 0:O.call(E,d,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function AC(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function h6(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var $r,al,ll,Oh,Dh,cl,Lh,Fh,NA,f6=(NA=class{constructor(e={}){Yn(this,$r);Yn(this,al);Yn(this,ll);Yn(this,Oh);Yn(this,Dh);Yn(this,cl);Yn(this,Lh);Yn(this,Fh);wn(this,$r,e.queryCache||new l6),wn(this,al,e.mutationCache||new d6),wn(this,ll,e.defaultOptions||{}),wn(this,Oh,new Map),wn(this,Dh,new Map),wn(this,cl,0)}mount(){nv(this,cl)._++,ct(this,cl)===1&&(wn(this,Lh,vO.subscribe(async e=>{e&&(await this.resumePausedMutations(),ct(this,$r).onFocus())})),wn(this,Fh,kw.subscribe(async e=>{e&&(await this.resumePausedMutations(),ct(this,$r).onOnline())})))}unmount(){var e,t;nv(this,cl)._--,ct(this,cl)===0&&((e=ct(this,Lh))==null||e.call(this),wn(this,Lh,void 0),(t=ct(this,Fh))==null||t.call(this),wn(this,Fh,void 0))}isFetching(e){return ct(this,$r).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ct(this,al).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ct(this,$r).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=ct(this,$r).build(this,n);return e.revalidateIfStale&&r.isStaleByTime(TC(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return ct(this,$r).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=ct(this,$r).get(r.queryHash),o=s==null?void 0:s.state.data,a=K8(t,o);if(a!==void 0)return ct(this,$r).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return ks.batch(()=>ct(this,$r).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ct(this,$r).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ct(this,$r);ks.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ct(this,$r),r={type:"active",...e};return ks.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries(r,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=ks.batch(()=>ct(this,$r).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Hi).catch(Hi)}invalidateQueries(e={},t={}){return ks.batch(()=>{if(ct(this,$r).findAll(e).forEach(r=>{r.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},r=ks.batch(()=>ct(this,$r).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let o=s.fetch(void 0,n);return n.throwOnError||(o=o.catch(Hi)),s.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(Hi)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ct(this,$r).build(this,t);return n.isStaleByTime(TC(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Hi).catch(Hi)}fetchInfiniteQuery(e){return e.behavior=kC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Hi).catch(Hi)}ensureInfiniteQueryData(e){return e.behavior=kC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return kw.isOnline()?ct(this,al).resumePausedMutations():Promise.resolve()}getQueryCache(){return ct(this,$r)}getMutationCache(){return ct(this,al)}getDefaultOptions(){return ct(this,ll)}setDefaultOptions(e){wn(this,ll,e)}setQueryDefaults(e,t){ct(this,Oh).set(C0(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ct(this,Oh).values()];let n={};return t.forEach(r=>{k0(e,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(e,t){ct(this,Dh).set(C0(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ct(this,Dh).values()];let n={};return t.forEach(r=>{k0(e,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ct(this,ll).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=pE(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===mE&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ct(this,ll).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ct(this,$r).clear(),ct(this,al).clear()}},$r=new WeakMap,al=new WeakMap,ll=new WeakMap,Oh=new WeakMap,Dh=new WeakMap,cl=new WeakMap,Lh=new WeakMap,Fh=new WeakMap,NA),p6=B.createContext(void 0),m6=({client:e,children:t})=>(B.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),R.jsx(p6.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A0.apply(this,arguments)}var hl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(hl||(hl={}));const $C="popstate";function g6(e){e===void 0&&(e={});function t(r,s){let{pathname:o,search:a,hash:c}=r.location;return xM("",{pathname:o,search:a,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:EO(s)}return y6(t,n,null,e)}function Kr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function TO(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function _6(){return Math.random().toString(36).substr(2,8)}function IC(e,t){return{usr:e.state,key:e.key,idx:t}}function xM(e,t,n,r){return n===void 0&&(n=null),A0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?of(t):t,{state:n,key:t&&t.key||r||_6()})}function EO(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function of(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function y6(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,c=hl.Pop,u=null,d=h();d==null&&(d=0,a.replaceState(A0({},a.state,{idx:d}),""));function h(){return(a.state||{idx:null}).idx}function m(){c=hl.Pop;let O=h(),b=O==null?null:O-d;d=O,u&&u({action:c,location:E.location,delta:b})}function p(O,b){c=hl.Push;let M=xM(E.location,O,b);d=h()+1;let I=IC(M,d),k=E.createHref(M);try{a.pushState(I,"",k)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;s.location.assign(k)}o&&u&&u({action:c,location:E.location,delta:1})}function v(O,b){c=hl.Replace;let M=xM(E.location,O,b);d=h();let I=IC(M,d),k=E.createHref(M);a.replaceState(I,"",k),o&&u&&u({action:c,location:E.location,delta:0})}function T(O){let b=s.location.origin!=="null"?s.location.origin:s.location.href,M=typeof O=="string"?O:EO(O);return M=M.replace(/ $/,"%20"),Kr(b,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,b)}let E={get action(){return c},get location(){return e(s,a)},listen(O){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener($C,m),u=O,()=>{s.removeEventListener($C,m),u=null}},createHref(O){return t(s,O)},createURL:T,encodeLocation(O){let b=T(O);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:v,go(O){return a.go(O)}};return E}var OC;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(OC||(OC={}));function v6(e,t,n){return n===void 0&&(n="/"),w6(e,t,n,!1)}function w6(e,t,n,r){let s=typeof t=="string"?of(t):t,o=CO(s.pathname||"/",n);if(o==null)return null;let a=PO(e);b6(a);let c=null;for(let u=0;c==null&&u<a.length;++u){let d=I6(o);c=A6(a[u],d,r)}return c}function PO(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,a,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(Kr(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Fc([r,u.relativePath]),h=n.concat(u);o.children&&o.children.length>0&&(Kr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),PO(o.children,t,h,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:C6(d,o.index),routesMeta:h})};return e.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,a);else for(let u of SO(o.path))s(o,a,u)}),t}function SO(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let a=SO(r.join("/")),c=[];return c.push(...a.map(u=>u===""?o:[o,u].join("/"))),s&&c.push(...a),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function b6(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:k6(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const x6=/^:[\w-]+$/,M6=3,T6=2,E6=1,P6=10,S6=-2,DC=e=>e==="*";function C6(e,t){let n=e.split("/"),r=n.length;return n.some(DC)&&(r+=S6),t&&(r+=T6),n.filter(s=>!DC(s)).reduce((s,o)=>s+(x6.test(o)?M6:o===""?E6:P6),r)}function k6(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function A6(e,t,n){let{routesMeta:r}=e,s={},o="/",a=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=o==="/"?t:t.slice(o.length)||"/",m=LC({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),p=u.route;if(!m&&d&&n&&!r[r.length-1].route.index&&(m=LC({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!m)return null;Object.assign(s,m.params),a.push({params:s,pathname:Fc([o,m.pathname]),pathnameBase:F6(Fc([o,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(o=Fc([o,m.pathnameBase]))}return a}function LC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=$6(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,h,m)=>{let{paramName:p,isOptional:v}=h;if(p==="*"){let E=c[m]||"";a=o.slice(0,o.length-E.length).replace(/(.)\/+$/,"$1")}const T=c[m];return v&&!T?d[p]=void 0:d[p]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:a,pattern:e}}function $6(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),TO(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function I6(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return TO(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function CO(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function O6(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?of(e):e;return{pathname:n?n.startsWith("/")?n:D6(n,t):t,search:R6(r),hash:j6(s)}}function D6(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Qb(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function L6(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function kO(e,t){let n=L6(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function AO(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=of(e):(s=A0({},e),Kr(!s.pathname||!s.pathname.includes("?"),Qb("?","pathname","search",s)),Kr(!s.pathname||!s.pathname.includes("#"),Qb("#","pathname","hash",s)),Kr(!s.search||!s.search.includes("#"),Qb("#","search","hash",s)));let o=e===""||s.pathname==="",a=o?"/":s.pathname,c;if(a==null)c=n;else{let m=t.length-1;if(!r&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}c=m>=0?t[m]:"/"}let u=O6(s,c),d=a&&a!=="/"&&a.endsWith("/"),h=(o||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}const Fc=e=>e.join("/").replace(/\/\/+/g,"/"),F6=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),R6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,j6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function N6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const $O=["post","put","patch","delete"];new Set($O);const z6=["get",...$O];new Set(z6);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$0.apply(this,arguments)}const gE=B.createContext(null),B6=B.createContext(null),H0=B.createContext(null),m1=B.createContext(null),Hc=B.createContext({outlet:null,matches:[],isDataRoute:!1}),IO=B.createContext(null);function q0(){return B.useContext(m1)!=null}function _E(){return q0()||Kr(!1),B.useContext(m1).location}function OO(e){B.useContext(H0).static||B.useLayoutEffect(e)}function yE(){let{isDataRoute:e}=B.useContext(Hc);return e?eV():V6()}function V6(){q0()||Kr(!1);let e=B.useContext(gE),{basename:t,future:n,navigator:r}=B.useContext(H0),{matches:s}=B.useContext(Hc),{pathname:o}=_E(),a=JSON.stringify(kO(s,n.v7_relativeSplatPath)),c=B.useRef(!1);return OO(()=>{c.current=!0}),B.useCallback(function(d,h){if(h===void 0&&(h={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let m=AO(d,JSON.parse(a),o,h.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Fc([t,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[t,r,a,o,e])}function U6(e,t){return W6(e,t)}function W6(e,t,n,r){q0()||Kr(!1);let{navigator:s}=B.useContext(H0),{matches:o}=B.useContext(Hc),a=o[o.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=_E(),h;if(t){var m;let O=typeof t=="string"?of(t):t;u==="/"||(m=O.pathname)!=null&&m.startsWith(u)||Kr(!1),h=O}else h=d;let p=h.pathname||"/",v=p;if(u!=="/"){let O=u.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(O.length).join("/")}let T=v6(e,{pathname:v}),E=Q6(T&&T.map(O=>Object.assign({},O,{params:Object.assign({},c,O.params),pathname:Fc([u,s.encodeLocation?s.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?u:Fc([u,s.encodeLocation?s.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),o,n,r);return t&&E?B.createElement(m1.Provider,{value:{location:$0({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:hl.Pop}},E):E}function G6(){let e=Z6(),t=N6(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},t),n?B.createElement("pre",{style:s},n):null,null)}const K6=B.createElement(G6,null);class H6 extends B.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?B.createElement(Hc.Provider,{value:this.props.routeContext},B.createElement(IO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function q6(e){let{routeContext:t,match:n,children:r}=e,s=B.useContext(gE);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(Hc.Provider,{value:t},r)}function Q6(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,c=(s=n)==null?void 0:s.errors;if(c!=null){let h=a.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);h>=0||Kr(!1),a=a.slice(0,Math.min(a.length,h+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<a.length;h++){let m=a[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=h),m.route.id){let{loaderData:p,errors:v}=n,T=m.route.loader&&p[m.route.id]===void 0&&(!v||v[m.route.id]===void 0);if(m.route.lazy||T){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((h,m,p)=>{let v,T=!1,E=null,O=null;n&&(v=c&&m.route.id?c[m.route.id]:void 0,E=m.route.errorElement||K6,u&&(d<0&&p===0?(T=!0,O=null):d===p&&(T=!0,O=m.route.hydrateFallbackElement||null)));let b=t.concat(a.slice(0,p+1)),M=()=>{let I;return v?I=E:T?I=O:m.route.Component?I=B.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=h,B.createElement(q6,{match:m,routeContext:{outlet:h,matches:b,isDataRoute:n!=null},children:I})};return n&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?B.createElement(H6,{location:n.location,revalidation:n.revalidation,component:E,error:v,children:M(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):M()},null)}var DO=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DO||{}),Aw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Aw||{});function Y6(e){let t=B.useContext(gE);return t||Kr(!1),t}function X6(e){let t=B.useContext(B6);return t||Kr(!1),t}function J6(e){let t=B.useContext(Hc);return t||Kr(!1),t}function LO(e){let t=J6(),n=t.matches[t.matches.length-1];return n.route.id||Kr(!1),n.route.id}function Z6(){var e;let t=B.useContext(IO),n=X6(Aw.UseRouteError),r=LO(Aw.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function eV(){let{router:e}=Y6(DO.UseNavigateStable),t=LO(Aw.UseNavigateStable),n=B.useRef(!1);return OO(()=>{n.current=!0}),B.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,$0({fromRouteId:t},o)))},[e,t])}function tV(e){let{to:t,replace:n,state:r,relative:s}=e;q0()||Kr(!1);let{future:o,static:a}=B.useContext(H0),{matches:c}=B.useContext(Hc),{pathname:u}=_E(),d=yE(),h=AO(t,kO(c,o.v7_relativeSplatPath),u,s==="path"),m=JSON.stringify(h);return B.useEffect(()=>d(JSON.parse(m),{replace:n,state:r,relative:s}),[d,m,s,n,r]),null}function MM(e){Kr(!1)}function nV(e){let{basename:t="/",children:n=null,location:r,navigationType:s=hl.Pop,navigator:o,static:a=!1,future:c}=e;q0()&&Kr(!1);let u=t.replace(/^\/*/,"/"),d=B.useMemo(()=>({basename:u,navigator:o,static:a,future:$0({v7_relativeSplatPath:!1},c)}),[u,c,o,a]);typeof r=="string"&&(r=of(r));let{pathname:h="/",search:m="",hash:p="",state:v=null,key:T="default"}=r,E=B.useMemo(()=>{let O=CO(h,u);return O==null?null:{location:{pathname:O,search:m,hash:p,state:v,key:T},navigationType:s}},[u,h,m,p,v,T,s]);return E==null?null:B.createElement(H0.Provider,{value:d},B.createElement(m1.Provider,{children:n,value:E}))}function rV(e){let{children:t,location:n}=e;return U6(TM(t),n)}new Promise(()=>{});function TM(e,t){t===void 0&&(t=[]);let n=[];return B.Children.forEach(e,(r,s)=>{if(!B.isValidElement(r))return;let o=[...t,s];if(r.type===B.Fragment){n.push.apply(n,TM(r.props.children,o));return}r.type!==MM&&Kr(!1),!r.props.index||!r.props.children||Kr(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=TM(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const sV="6";try{window.__reactRouterVersion=sV}catch{}const iV="startTransition",FC=XA[iV];function oV(e){let{basename:t,children:n,future:r,window:s}=e,o=B.useRef();o.current==null&&(o.current=g6({window:s,v5Compat:!0}));let a=o.current,[c,u]=B.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},h=B.useCallback(m=>{d&&FC?FC(()=>u(m)):u(m)},[u,d]);return B.useLayoutEffect(()=>a.listen(h),[a,h]),B.createElement(nV,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}var RC;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(RC||(RC={}));var jC;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(jC||(jC={}));const aV="modulepreload",lV=function(e){return"/"+e},NC={},Kh=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=lV(u),u in NC)return;NC[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":aV,d||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((p,v)=>{m.addEventListener("load",p),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return s.then(a=>{for(const c of a||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},cV=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Kh(async()=>{const{default:r}=await Promise.resolve().then(()=>af);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class vE extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class uV extends vE{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class dV extends vE{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class hV extends vE{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var EM;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(EM||(EM={}));var fV=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};class pV{constructor(t,{headers:n={},customFetch:r,region:s=EM.Any}={}){this.url=t,this.headers=n,this.region=s,this.fetch=cV(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return fV(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:a}=n;let c={},{region:u}=n;u||(u=this.region),u&&u!=="any"&&(c["x-region"]=u);let d;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(c["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(c["Content-Type"]="application/json",d=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${t}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),s),body:d}).catch(T=>{throw new uV(T)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new dV(h);if(!h.ok)throw new hV(h);let p=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return p==="application/json"?v=yield h.json():p==="application/octet-stream"?v=yield h.blob():p==="text/event-stream"?v=h:p==="multipart/form-data"?v=yield h.formData():v=yield h.text(),{data:v,error:null}}catch(s){return{data:null,error:s}}})}}var Ws={},wE={},g1={},Q0={},_1={},y1={},mV=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Hh=mV();const gV=Hh.fetch,FO=Hh.fetch.bind(Hh),RO=Hh.Headers,_V=Hh.Request,yV=Hh.Response,af=Object.freeze(Object.defineProperty({__proto__:null,Headers:RO,Request:_V,Response:yV,default:FO,fetch:gV},Symbol.toStringTag,{value:"Module"})),vV=j4(af);var v1={};Object.defineProperty(v1,"__esModule",{value:!0});let wV=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};v1.default=wV;var jO=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(y1,"__esModule",{value:!0});const bV=jO(vV),xV=jO(v1);let MV=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=bV.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var a,c,u;let d=null,h=null,m=null,p=o.status,v=o.statusText;if(o.ok){if(this.method!=="HEAD"){const b=await o.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=b:h=JSON.parse(b))}const E=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),O=(c=o.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");E&&O&&O.length>1&&(m=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,m=null,p=406,v="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const E=await o.text();try{d=JSON.parse(E),Array.isArray(d)&&o.status===404&&(h=[],d=null,p=200,v="OK")}catch{o.status===404&&E===""?(p=204,v="No Content"):d={message:E}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,p=200,v="OK"),d&&this.shouldThrowOnError)throw new xV.default(d)}return{error:d,data:h,count:m,status:p,statusText:v}});return this.shouldThrowOnError||(s=s.catch(o=>{var a,c,u;return{error:{message:`${(a=o==null?void 0:o.name)!==null&&a!==void 0?a:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(c=o==null?void 0:o.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(u=o==null?void 0:o.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,n)}};y1.default=MV;var TV=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_1,"__esModule",{value:!0});const EV=TV(y1);let PV=class extends EV.default{select(t){let n=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:o=s}={}){const a=o?`${o}.order`:"order",c=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${c?`${c},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:s=r}={}){const o=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(a,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:o=!1,format:a="text"}={}){var c;const u=[t?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${d}"; options=${u};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};_1.default=PV;var SV=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Q0,"__esModule",{value:!0});const CV=SV(_1);let kV=class extends CV.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${o}fts${a}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};Q0.default=kV;var AV=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(g1,"__esModule",{value:!0});const C_=AV(Q0);let $V=class{constructor(t,{headers:n={},schema:r,fetch:s}){this.url=t,this.headers=n,this.schema=r,this.fetch=s}select(t,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let o=!1;const a=(t??"*").split("").map(c=>/\s/.test(c)&&!o?"":(c==='"'&&(o=!o),c)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new C_.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const s="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const a=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new C_.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:o=!0}={}){const a="POST",c=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&c.push(this.headers.Prefer),s&&c.push(`count=${s}`),o||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(t)){const u=t.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new C_.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new C_.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new C_.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};g1.default=$V;var w1={},b1={};Object.defineProperty(b1,"__esModule",{value:!0});b1.version=void 0;b1.version="0.0.0-automated";Object.defineProperty(w1,"__esModule",{value:!0});w1.DEFAULT_HEADERS=void 0;const IV=b1;w1.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${IV.version}`};var NO=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wE,"__esModule",{value:!0});const OV=NO(g1),DV=NO(Q0),LV=w1;let FV=class zO{constructor(t,{headers:n={},schema:r,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},LV.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=s}from(t){const n=new URL(`${this.url}/${t}`);return new OV.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new zO(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:s=!1,count:o}={}){let a;const c=new URL(`${this.url}/rpc/${t}`);let u;r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([h,m])=>m!==void 0).map(([h,m])=>[h,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([h,m])=>{c.searchParams.append(h,m)})):(a="POST",u=n);const d=Object.assign({},this.headers);return o&&(d.Prefer=`count=${o}`),new DV.default({method:a,url:c,headers:d,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};wE.default=FV;var lf=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.PostgrestError=Ws.PostgrestBuilder=Ws.PostgrestTransformBuilder=Ws.PostgrestFilterBuilder=Ws.PostgrestQueryBuilder=Ws.PostgrestClient=void 0;const BO=lf(wE);Ws.PostgrestClient=BO.default;const VO=lf(g1);Ws.PostgrestQueryBuilder=VO.default;const UO=lf(Q0);Ws.PostgrestFilterBuilder=UO.default;const WO=lf(_1);Ws.PostgrestTransformBuilder=WO.default;const GO=lf(y1);Ws.PostgrestBuilder=GO.default;const KO=lf(v1);Ws.PostgrestError=KO.default;var RV=Ws.default={PostgrestClient:BO.default,PostgrestQueryBuilder:VO.default,PostgrestFilterBuilder:UO.default,PostgrestTransformBuilder:WO.default,PostgrestBuilder:GO.default,PostgrestError:KO.default};const{PostgrestClient:jV,PostgrestQueryBuilder:CY,PostgrestFilterBuilder:kY,PostgrestTransformBuilder:AY,PostgrestBuilder:$Y,PostgrestError:IY}=RV,NV="2.11.2",zV={"X-Client-Info":`realtime-js/${NV}`},BV="1.0.0",HO=1e4,VV=1e3;var Sh;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Sh||(Sh={}));var ei;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ei||(ei={}));var Yi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Yi||(Yi={}));var PM;(function(e){e.websocket="websocket"})(PM||(PM={}));var Tc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Tc||(Tc={}));class UV{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const s=n.getUint8(1),o=n.getUint8(2);let a=this.HEADER_LENGTH+2;const c=r.decode(t.slice(a,a+s));a=a+s;const u=r.decode(t.slice(a,a+o));a=a+o;const d=JSON.parse(r.decode(t.slice(a,t.byteLength)));return{ref:null,topic:c,event:u,payload:d}}}class qO{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var or;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(or||(or={}));const zC=(e,t,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((o,a)=>(o[a]=WV(a,e,t,s),o),{})},WV=(e,t,n,r)=>{const s=t.find(c=>c.name===e),o=s==null?void 0:s.type,a=n[e];return o&&!r.includes(o)?QO(o,a):SM(a)},QO=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return qV(t,n)}switch(e){case or.bool:return GV(t);case or.float4:case or.float8:case or.int2:case or.int4:case or.int8:case or.numeric:case or.oid:return KV(t);case or.json:case or.jsonb:return HV(t);case or.timestamp:return QV(t);case or.abstime:case or.date:case or.daterange:case or.int4range:case or.int8range:case or.money:case or.reltime:case or.text:case or.time:case or.timestamptz:case or.timetz:case or.tsrange:case or.tstzrange:return SM(t);default:return SM(t)}},SM=e=>e,GV=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},KV=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},HV=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},qV=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let o;const a=e.slice(1,n);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(c=>QO(t,c))}return e},QV=e=>typeof e=="string"?e.replace(" ","T"):e,YO=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Yb{constructor(t,n,r={},s=HO){this.channel=t,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var BC;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(BC||(BC={}));class t0{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:a,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=t0.syncState(this.state,s,o,a),this.pendingDiffs.forEach(u=>{this.state=t0.syncDiff(this.state,u,o,a)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:a,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=t0.syncDiff(this.state,s,o,a),c())}),this.onJoin((s,o,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:a})}),this.onLeave((s,o,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,s){const o=this.cloneDeep(t),a=this.transformState(n),c={},u={};return this.map(o,(d,h)=>{a[d]||(u[d]=h)}),this.map(a,(d,h)=>{const m=o[d];if(m){const p=h.map(O=>O.presence_ref),v=m.map(O=>O.presence_ref),T=h.filter(O=>v.indexOf(O.presence_ref)<0),E=m.filter(O=>p.indexOf(O.presence_ref)<0);T.length>0&&(c[d]=T),E.length>0&&(u[d]=E)}else c[d]=h}),this.syncDiff(o,{joins:c,leaves:u},r,s)}static syncDiff(t,n,r,s){const{joins:o,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(c,u)=>{var d;const h=(d=t[c])!==null&&d!==void 0?d:[];if(t[c]=this.cloneDeep(u),h.length>0){const m=t[c].map(v=>v.presence_ref),p=h.filter(v=>m.indexOf(v.presence_ref)<0);t[c].unshift(...p)}r(c,h,u)}),this.map(a,(c,u)=>{let d=t[c];if(!d)return;const h=u.map(m=>m.presence_ref);d=d.filter(m=>h.indexOf(m.presence_ref)<0),t[c]=d,s(c,d,u),d.length===0&&delete t[c]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const s=t[r];return"metas"in s?n[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=s,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var VC;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(VC||(VC={}));var UC;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(UC||(UC={}));var na;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(na||(na={}));class bE{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=ei.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Yb(this,Yi.join,this.params,this.timeout),this.rejoinTimer=new qO(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ei.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ei.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ei.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ei.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yi.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new t0(this),this.broadcastEndpointURL=YO(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:a,private:c}}=this.params;this._onError(h=>t==null?void 0:t(na.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(na.CLOSED));const u={},d={broadcast:o,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(h=>h.filter))!==null&&s!==void 0?s:[],private:c};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:h})=>{var m;if(this.socket.setAuth(),h===void 0){t==null||t(na.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,v=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,T=[];for(let E=0;E<v;E++){const O=p[E],{filter:{event:b,schema:M,table:I,filter:k}}=O,$=h&&h[E];if($&&$.event===b&&$.schema===M&&$.table===I&&$.filter===k)T.push(Object.assign(Object.assign({},O),{id:$.id}));else{this.unsubscribe(),t==null||t(na.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,t&&t(na.SUBSCRIBED);return}}).receive("error",h=>{t==null||t(na.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(na.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:a}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,c,u;const d=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ei.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Yb(this,Yi.leave,{},t);s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,n,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(o),a}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Yb(this,t,n,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var s,o;const a=t.toLocaleLowerCase(),{close:c,error:u,leave:d,join:h}=Yi;if(r&&[c,u,d,h].indexOf(a)>=0&&r!==this._joinRef())return;let p=this._onMessage(a,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var T,E,O;return((T=v.filter)===null||T===void 0?void 0:T.event)==="*"||((O=(E=v.filter)===null||E===void 0?void 0:E.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===a}).map(v=>v.callback(p,r)):(o=this.bindings[a])===null||o===void 0||o.filter(v=>{var T,E,O,b,M,I;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const k=v.id,$=(T=v.filter)===null||T===void 0?void 0:T.event;return k&&((E=n.ids)===null||E===void 0?void 0:E.includes(k))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((O=n.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const k=(M=(b=v==null?void 0:v.filter)===null||b===void 0?void 0:b.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return k==="*"||k===((I=n==null?void 0:n.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof p=="object"&&"ids"in p){const T=p.data,{schema:E,table:O,commit_timestamp:b,type:M,errors:I}=T;p=Object.assign(Object.assign({},{schema:E,table:O,commit_timestamp:b,eventType:M,new:{},old:{},errors:I}),this._getPayloadRecords(T))}v.callback(p,r)})}_isClosed(){return this.state===ei.closed}_isJoined(){return this.state===ei.joined}_isJoining(){return this.state===ei.joining}_isLeaving(){return this.state===ei.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const s=t.toLocaleLowerCase(),o={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&bE.isEqual(s.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Yi.close,{},t)}_onError(t){this._on(Yi.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ei.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=zC(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=zC(t.columns,t.old_record)),n}}const YV=()=>{},XV=typeof WebSocket<"u",JV=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ZV{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=zV,this.params={},this.timeout=HO,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=YV,this.conn=null,this.sendBuffer=[],this.serializer=new UV,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let a;return o?a=o:typeof fetch>"u"?a=(...c)=>Kh(async()=>{const{default:u}=await Promise.resolve().then(()=>af);return{default:u}},void 0).then(({default:u})=>u(...c)):a=fetch,(...c)=>a(...c)},this.endPoint=`${t}/${PM.websocket}`,this.httpEndpoint=YO(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(o,a)=>a(JSON.stringify(o)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new qO(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(XV){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new eU(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Kh(async()=>{const{default:t}=await import("./browser-CgJI_y9M.js").then(n=>n.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:BV}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Sh.connecting:return Tc.Connecting;case Sh.open:return Tc.Open;case Sh.closing:return Tc.Closing;default:return Tc.Closed}}isConnected(){return this.connectionState()===Tc.Open}channel(t,n={config:{}}){const r=new bE(`realtime:${t}`,n,this);return this.channels.push(r),r}push(t){const{topic:n,event:r,payload:s,ref:o}=t,a=()=>{this.encode(t,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${n} ${r} (${o})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(s=>{n&&s.updateJoinPayload({access_token:n}),s.joinedOnce&&s._isJoined()&&s._push(Yi.access_token,{access_token:n})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(VV,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:s,payload:o,ref:a}=n;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,o),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,o,a)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Yi.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${t}${r}${s}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([JV],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class eU{constructor(t,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Sh.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class xE extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Jr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class tU extends xE{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class CM extends xE{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var nU=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};const XO=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Kh(async()=>{const{default:r}=await Promise.resolve().then(()=>af);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},rU=()=>nU(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Kh(()=>Promise.resolve().then(()=>af),void 0)).Response:Response}),kM=e=>{if(Array.isArray(e))return e.map(n=>kM(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[s]=kM(r)}),t};var qc=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};const Xb=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),sU=(e,t,n)=>qc(void 0,void 0,void 0,function*(){const r=yield rU();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(s=>{t(new tU(Xb(s),e.status||500))}).catch(s=>{t(new CM(Xb(s),s))}):t(new CM(Xb(e),e))}),iU=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))};function Y0(e,t,n,r,s,o){return qc(this,void 0,void 0,function*(){return new Promise((a,c)=>{e(n,iU(t,r,s,o)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>sU(u,c,r))})})}function $w(e,t,n,r){return qc(this,void 0,void 0,function*(){return Y0(e,"GET",t,n,r)})}function tl(e,t,n,r,s){return qc(this,void 0,void 0,function*(){return Y0(e,"POST",t,r,s,n)})}function oU(e,t,n,r,s){return qc(this,void 0,void 0,function*(){return Y0(e,"PUT",t,r,s,n)})}function aU(e,t,n,r){return qc(this,void 0,void 0,function*(){return Y0(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function JO(e,t,n,r,s){return qc(this,void 0,void 0,function*(){return Y0(e,"DELETE",t,r,s,n)})}var Vs=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};const lU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},WC={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cU{constructor(t,n={},r,s){this.url=t,this.headers=n,this.bucketId=r,this.fetch=XO(s)}uploadOrUpdate(t,n,r,s){return Vs(this,void 0,void 0,function*(){try{let o;const a=Object.assign(Object.assign({},WC),s);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const u=a.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),u&&o.append("metadata",this.encodeMetadata(u)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",a.cacheControl),u&&o.append("metadata",this.encodeMetadata(u))):(o=r,c["cache-control"]=`max-age=${a.cacheControl}`,c["content-type"]=a.contentType,u&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(c=Object.assign(Object.assign({},c),s.headers));const d=this._removeEmptyFolders(n),h=this._getFinalPath(d),m=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:t,body:o,headers:c},a!=null&&a.duplex?{duplex:a.duplex}:{})),p=yield m.json();return m.ok?{data:{path:d,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}upload(t,n,r){return Vs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,s){return Vs(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),a=this._getFinalPath(o),c=new URL(this.url+`/object/upload/sign/${a}`);c.searchParams.set("token",n);try{let u;const d=Object.assign({upsert:WC.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",d.cacheControl)):(u=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const m=yield this.fetch(c.toString(),{method:"PUT",body:u,headers:h}),p=yield m.json();return m.ok?{data:{path:o,fullPath:p.Key},error:null}:{data:null,error:p}}catch(u){if(Jr(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,n){return Vs(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const o=yield tl(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+o.url),c=a.searchParams.get("token");if(!c)throw new xE("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:c},error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}update(t,n,r){return Vs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return Vs(this,void 0,void 0,function*(){try{return{data:yield tl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}copy(t,n,r){return Vs(this,void 0,void 0,function*(){try{return{data:{path:(yield tl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,n,r){return Vs(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),o=yield tl(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${a}`)},{data:o,error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,n,r){return Vs(this,void 0,void 0,function*(){try{const s=yield tl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${o}`):null})),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}download(t,n){return Vs(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=o?`?${o}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield $w(this.fetch,`${this.url}/${s}/${c}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Jr(c))return{data:null,error:c};throw c}})}info(t){return Vs(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield $w(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:kM(r),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}exists(t){return Vs(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield aU(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Jr(r)&&r instanceof CM){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),s=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&s.push(o);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&s.push(u);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${d}`)}}}remove(t){return Vs(this,void 0,void 0,function*(){try{return{data:yield JO(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(Jr(n))return{data:null,error:n};throw n}})}list(t,n,r){return Vs(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},lU),n),{prefix:t||""});return{data:yield tl(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const uU="2.7.1",dU={"X-Client-Info":`storage-js/${uU}`};var qd=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};class hU{constructor(t,n={},r){this.url=t,this.headers=Object.assign(Object.assign({},dU),n),this.fetch=XO(r)}listBuckets(){return qd(this,void 0,void 0,function*(){try{return{data:yield $w(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Jr(t))return{data:null,error:t};throw t}})}getBucket(t){return qd(this,void 0,void 0,function*(){try{return{data:yield $w(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(Jr(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return qd(this,void 0,void 0,function*(){try{return{data:yield tl(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return qd(this,void 0,void 0,function*(){try{return{data:yield oU(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}emptyBucket(t){return qd(this,void 0,void 0,function*(){try{return{data:yield tl(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Jr(n))return{data:null,error:n};throw n}})}deleteBucket(t){return qd(this,void 0,void 0,function*(){try{return{data:yield JO(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(Jr(n))return{data:null,error:n};throw n}})}}class fU extends hU{constructor(t,n={},r){super(t,n,r)}from(t){return new cU(this.url,this.headers,t,this.fetch)}}const pU="2.47.14";let N_="";typeof Deno<"u"?N_="deno":typeof document<"u"?N_="web":typeof navigator<"u"&&navigator.product==="ReactNative"?N_="react-native":N_="node";const mU={"X-Client-Info":`supabase-js-${N_}/${pU}`},gU={headers:mU},_U={schema:"public"},yU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vU={};var wU=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};const bU=e=>{let t;return e?t=e:typeof fetch>"u"?t=FO:t=fetch,(...n)=>t(...n)},xU=()=>typeof Headers>"u"?RO:Headers,MU=(e,t,n)=>{const r=bU(n),s=xU();return(o,a)=>wU(void 0,void 0,void 0,function*(){var c;const u=(c=yield t())!==null&&c!==void 0?c:e;let d=new s(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${u}`),r(o,Object.assign(Object.assign({},a),{headers:d}))})};var TU=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};function EU(e){return e.replace(/\/$/,"")}function PU(e,t){const{db:n,auth:r,realtime:s,global:o}=e,{db:a,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},d),o),accessToken:()=>TU(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const ZO="2.67.3",SU="http://localhost:9999",CU="supabase.auth.token",kU={"X-Client-Info":`gotrue-js/${ZO}`},GC=10,AM="X-Supabase-Api-Version",eD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function AU(e){return Math.round(Date.now()/1e3)+e}function $U(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const xo=()=>typeof window<"u"&&typeof document<"u",_c={tested:!1,writable:!1},n0=()=>{if(!xo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_c.tested)return _c.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),_c.tested=!0,_c.writable=!0}catch{_c.tested=!0,_c.writable=!1}return _c.writable};function IU(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,o)=>{t[o]=s})}catch{}return n.searchParams.forEach((r,s)=>{t[s]=r}),t}const tD=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Kh(async()=>{const{default:r}=await Promise.resolve().then(()=>af);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},OU=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",nD=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Ev=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Pv=async(e,t)=>{await e.removeItem(t)};function DU(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,s,o,a,c,u,d,h=0;for(e=e.replace("-","+").replace("_","/");h<e.length;)a=t.indexOf(e.charAt(h++)),c=t.indexOf(e.charAt(h++)),u=t.indexOf(e.charAt(h++)),d=t.indexOf(e.charAt(h++)),r=a<<2|c>>4,s=(c&15)<<4|u>>2,o=(u&3)<<6|d,n=n+String.fromCharCode(r),u!=64&&s!=0&&(n=n+String.fromCharCode(s)),d!=64&&o!=0&&(n=n+String.fromCharCode(o));return n}class x1{constructor(){this.promise=new x1.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}x1.promiseConstructor=Promise;function KC(e){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=e.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(DU(r))}async function LU(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function FU(e,t){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await e(o);if(!t(o,null,a)){r(a);return}}catch(a){if(!t(o,a)){s(a);return}}})()})}function RU(e){return("0"+e.toString(16)).substr(-2)}function jU(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let o=0;o<56;o++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,RU).join("")}async function NU(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}function zU(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function BU(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await NU(e);return zU(n)}async function Qd(e,t,n=!1){const r=jU();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await nD(e,`${t}-code-verifier`,s);const o=await BU(r);return[o,r===o?"plain":"s256"]}const VU=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function UU(e){const t=e.headers.get(AM);if(!t||!t.match(VU))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}class ME extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function bn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class rD extends ME{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function WU(e){return bn(e)&&e.name==="AuthApiError"}class sD extends ME{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Qc extends ME{constructor(t,n,r,s){super(t,r,s),this.name=n,this.status=r}}class Qa extends Qc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function GU(e){return bn(e)&&e.name==="AuthSessionMissingError"}class Jb extends Qc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Sv extends Qc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Cv extends Qc{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function KU(e){return bn(e)&&e.name==="AuthImplicitGrantRedirectError"}class HC extends Qc{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $M extends Qc{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Zb(e){return bn(e)&&e.name==="AuthRetryableFetchError"}class qC extends Qc{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var HU=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};const bc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),qU=[502,503,504];async function QC(e){var t;if(!OU(e))throw new $M(bc(e),0);if(qU.includes(e.status))throw new $M(bc(e),e.status);let n;try{n=await e.json()}catch(o){throw new sD(bc(o),o)}let r;const s=UU(e);if(s&&s.getTime()>=eD["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new qC(bc(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Qa}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new qC(bc(n),e.status,n.weak_password.reasons);throw new rD(bc(n),e.status||500,r)}const QU=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function Fn(e,t,n,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[AM]||(o[AM]=eD["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const c=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await YU(e,t,n+c,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function YU(e,t,n,r,s,o){const a=QU(t,r,s,o);let c;try{c=await e(n,Object.assign({},a))}catch(u){throw console.error(u),new $M(bc(u),0)}if(c.ok||await QC(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(u){await QC(u)}}function Ya(e){var t;let n=null;e9(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=AU(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function YC(e){const t=Ya(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function sl(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function XU(e){return{data:e,error:null}}function JU(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=e,a=HU(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},u=Object.assign({},a);return{data:{properties:c,user:u},error:null}}function ZU(e){return e}function e9(e){return e.access_token&&e.refresh_token&&e.expires_in}var t9=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};class n9{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=tD(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n="global"){try{return await Fn(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(bn(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Fn(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:sl})}catch(r){if(bn(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=t9(t,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Fn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:JU,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(bn(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Fn(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:sl})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,s,o,a,c,u;try{const d={nextPage:null,lastPage:0,total:0},h=await Fn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:ZU});if(h.error)throw h.error;const m=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(u=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(T=>{const E=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(T.split(";")[1].split("=")[1]);d[`${O}Page`]=E}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(bn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){try{return await Fn(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:sl})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){try{return await Fn(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:sl})}catch(r){if(bn(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){try{return await Fn(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:sl})}catch(r){if(bn(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){try{const{data:n,error:r}=await Fn(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(bn(n))return{data:null,error:n};throw n}}async _deleteFactor(t){try{return{data:await Fn(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(bn(n))return{data:null,error:n};throw n}}}const r9={getItem:e=>n0()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{n0()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{n0()&&globalThis.localStorage.removeItem(e)}};function XC(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function s9(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Yd={debug:!!(globalThis&&n0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class iD extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class i9 extends iD{}async function o9(e,t,n){Yd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Yd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Yd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{Yd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Yd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new i9(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Yd.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}s9();const a9={url:SU,storageKey:CU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},k_=30*1e3,JC=3;async function ZC(e,t,n){return await n()}class I0{constructor(t){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=I0.nextInstanceID,I0.nextInstanceID+=1,this.instanceID>0&&xo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},a9),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new n9({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=tD(s.fetch),this.lock=s.lock||ZC,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:xo()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=o9:this.lock=ZC,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:n0()?this.storage=r9:(this.memoryStorage={},this.storage=XC(this.memoryStorage)):(this.memoryStorage={},this.storage=XC(this.memoryStorage)),xo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ZO}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=IU(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),xo()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),KU(o)){const u=(t=o.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:a,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",c),await this._saveSession(a),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return bn(n)?{error:n}:{error:new sD("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,s;try{const o=await Fn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ya}),{data:a,error:c}=o;if(c||!a)return{data:{user:null,session:null},error:c};const u=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(o){if(bn(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var n,r,s;try{let o;if("email"in t){const{email:h,password:m,options:p}=t;let v=null,T=null;this.flowType==="pkce"&&([v,T]=await Qd(this.storage,this.storageKey)),o=await Fn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:h,password:m,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:v,code_challenge_method:T},xform:Ya})}else if("phone"in t){const{phone:h,password:m,options:p}=t;o=await Fn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:m,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Ya})}else throw new Sv("You must provide either an email or phone number and a password");const{data:a,error:c}=o;if(c||!a)return{data:{user:null,session:null},error:c};const u=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(o){if(bn(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let n;if("email"in t){const{email:o,password:a,options:c}=t;n=await Fn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:YC})}else if("phone"in t){const{phone:o,password:a,options:c}=t;n=await Fn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:YC})}else throw new Sv("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Jb}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(bn(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,s,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const n=await Ev(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:o,error:a}=await Fn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Ya});if(await Pv(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Jb}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:a})}catch(o){if(bn(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:n,provider:r,token:s,access_token:o,nonce:a}=t,c=await Fn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ya}),{data:u,error:d}=c;return d?{data:{user:null,session:null},error:d}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Jb}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:d})}catch(n){if(bn(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,s,o,a;try{if("email"in t){const{email:c,options:u}=t;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Qd(this.storage,this.storageKey));const{error:m}=await Fn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:c,options:u}=t,{data:d,error:h}=await Fn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(o=u==null?void 0:u.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h}}throw new Sv("You must provide either an email or phone number.")}catch(c){if(bn(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var n,r;try{let s,o;"options"in t&&(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo,o=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:c}=await Fn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Ya});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");const u=a.session,d=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(s){if(bn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var n,r,s;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=await Qd(this.storage,this.storageKey)),await Fn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:XU})}catch(o){if(bn(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new Qa;const{error:s}=await Fn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(bn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:o}=t,{error:a}=await Fn(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:r,type:s,options:o}=t,{data:a,error:c}=await Fn(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:c}}throw new Sv("You must provide either an email or phone number and a type")}catch(n){if(bn(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Ev(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,d,h)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,d,h))})}return{data:{session:t},error:null}}const{session:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Fn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:sl}):await this._useSession(async n=>{var r,s,o;const{data:a,error:c}=n;if(c)throw c;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qa}:await Fn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:sl})})}catch(n){if(bn(n))return GU(n)&&(await this._removeSession(),await Pv(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new Qa;const a=s.session;let c=null,u=null;this.flowType==="pkce"&&t.email!=null&&([c,u]=await Qd(this.storage,this.storageKey));const{data:d,error:h}=await Fn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:u}),jwt:a.access_token,xform:sl});if(h)throw h;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(bn(r))return{data:{user:null},error:r};throw r}}_decodeJWT(t){return KC(t)}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qa;const n=Date.now()/1e3;let r=n,s=!0,o=null;const a=KC(t.access_token);if(a.exp&&(r=a.exp,s=r<=n),s){const{session:c,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!c)return{data:{user:null,session:null},error:null};o=c}else{const{data:c,error:u}=await this._getUser(t.access_token);if(u)throw u;o={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(bn(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:a,error:c}=n;if(c)throw c;t=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Qa;const{session:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(bn(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!xo())throw new Cv("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Cv(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new HC("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Cv("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new HC("No code detected.");const{data:M,error:I}=await this._exchangeCodeForSession(t.code);if(I)throw I;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:a,expires_in:c,expires_at:u,token_type:d}=t;if(!o||!c||!a||!d)throw new Cv("No session defined in URL");const h=Math.round(Date.now()/1e3),m=parseInt(c);let p=h+m;u&&(p=parseInt(u));const v=p-h;v*1e3<=k_&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const T=p-m;h-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,p,h):h-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,p,h);const{data:E,error:O}=await this._getUser(o);if(O)throw O;const b={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:m,expires_at:p,refresh_token:a,token_type:d,user:E.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(r){if(bn(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Ev(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{error:o};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:c}=await this.admin.signOut(a,t);if(c&&!(WU(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await Pv(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=$U(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,s;try{const{data:{session:o},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Qd(this.storage,this.storageKey,!0));try{return await Fn(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(bn(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(bn(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:s}=await this._useSession(async o=>{var a,c,u,d,h;const{data:m,error:p}=o;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Fn(this.fetch,"GET",v,{headers:this.headers,jwt:(h=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return xo()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(bn(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,s;const{data:o,error:a}=n;if(a)throw a;return await Fn(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(bn(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await FU(async s=>(s>0&&await LU(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await Fn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ya})),(s,o)=>{const a=200*Math.pow(2,s);return o&&Zb(o)&&Date.now()+a-r<k_})}catch(r){if(this._debug(n,"error",r),bn(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),xo()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Ev(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),o=((t=r.expires_at)!==null&&t!==void 0?t:1/0)<s+GC;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${GC}s`),o){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Zb(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new Qa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new x1;const{data:o,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!o.session)throw new Qa;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const c={session:o.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(o){if(this._debug(s,"error",o),bn(o)){const a={session:null,error:o};return Zb(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,n,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,n)}catch(u){o.push(u)}});if(await Promise.all(a),o.length>0){for(let c=0;c<o.length;c+=1)console.error(o[c]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await nD(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Pv(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&xo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),k_);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/k_);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${k_}ms, refresh threshold is ${JC} ticks`),s<=JC&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof iD)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,a]=await Qd(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(c.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await Fn(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(bn(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,s;const{data:o,error:a}=n;if(a)return{data:null,error:a};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:d}=await Fn(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(bn(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:a,error:c}=await Fn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:c})})}catch(n){if(bn(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await Fn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(bn(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:s},error:o}=t;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(s.access_token);let c=null;a.aal&&(c=a.aal);let u=c;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=a.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:h},error:null}}))}}I0.nextInstanceID=0;const l9=I0;class c9 extends l9{constructor(t){super(t)}}var u9=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function c(h){try{d(r.next(h))}catch(m){a(m)}}function u(h){try{d(r.throw(h))}catch(m){a(m)}}function d(h){h.done?o(h.value):s(h.value).then(c,u)}d((r=r.apply(e,t||[])).next())})};class d9{constructor(t,n,r){var s,o,a;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=EU(t);this.realtimeUrl=`${c}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${c}/auth/v1`,this.storageUrl=`${c}/storage/v1`,this.functionsUrl=`${c}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,d={db:_U,realtime:vU,auth:Object.assign(Object.assign({},yU),{storageKey:u}),global:gU},h=PU(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=h.global.headers)!==null&&o!==void 0?o:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=MU(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new jV(`${c}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new pV(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new fU(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return u9(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,storageKey:o,flowType:a,lock:c,debug:u},d,h){var m;const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new c9({url:this.authUrl,headers:Object.assign(Object.assign({},p),d),storageKey:o,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,flowType:a,lock:c,debug:u,fetch:h,hasCustomAuthorizationHeader:(m="Authorization"in this.headers)!==null&&m!==void 0?m:!1})}_initRealtimeClient(t){return new ZV(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const h9=(e,t,n)=>new d9(e,t,n),f9="https://dfhqyxcgurlpcvbzdoeg.supabase.co",p9="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRmaHF5eGNndXJscGN2Ynpkb2VnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY0MTM0NzUsImV4cCI6MjA1MTk4OTQ3NX0.eFtBoFBtPwabeYh2XvV2f16mPuBk4bKKpne7I_25a2Y",So=h9(f9,p9);var IM=function(){return(IM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},A_,$_,OM=B.createContext(void 0),ek="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML",tk="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js",oD=function(h){var t=h.config,n=h.version,n=n===void 0?3:n,r=h.src,r=r===void 0?n===2?ek:tk:r,s=h.onStartup,o=h.onLoad,a=h.onError,c=h.typesettingOptions,u=h.renderMode,u=u===void 0?"post":u,d=h.hideUntilTypeset,h=h.children,p=B.useContext(OM);if((p==null?void 0:p.version)!==void 0&&(p==null?void 0:p.version)!==n)throw Error("Cannot nest MathJaxContexts with different versions. MathJaxContexts should not be nested at all but if they are, they cannot have different versions. Stick with one version of MathJax in your app and avoid using more than one MathJaxContext.");if(n===2&&$_!==void 0||n===3&&A_!==void 0)throw Error("Cannot use MathJax versions 2 and 3 simultaneously in the same app due to how MathJax is set up in the browser; either you have multiple MathJaxContexts with different versions or you have mounted and unmounted MathJaxContexts with different versions. Please stick with one version of MathJax in your app. File an issue in the project Github page if you need this feature.");var m=B.useRef(p),p=B.useRef((p==null?void 0:p.version)||null);if(p.current===null)p.current=n;else if(p.current!==n)throw Error("Cannot change version of MathJax in a MathJaxContext after it has mounted. Reload the page with a new version when this must happen.");var v=r||(n===2?ek:tk);function T(E,O){t&&(window.MathJax=t);var b=document.createElement("script");b.type="text/javascript",b.src=v,b.async=!0,b.addEventListener("load",function(){var M=window.MathJax;s&&s(M),E(M),o&&o()}),b.addEventListener("error",function(M){return O(M)}),document.getElementsByTagName("head")[0].appendChild(b)}return m.current===void 0&&(p={typesettingOptions:c,renderMode:u,hideUntilTypeset:d},n===2?A_===void 0&&(typeof window<"u"?(A_=new Promise(T)).catch(function(E){if(!a)throw Error("Failed to download MathJax version 2 from '".concat(v,"' due to: ").concat(JSON.stringify(E)));a(E)}):(A_=Promise.reject()).catch(function(E){})):$_===void 0&&(typeof window<"u"?($_=new Promise(T)).catch(function(E){if(!a)throw Error("Failed to download MathJax version 3 from '".concat(v,"' due to: ").concat(E));a(E)}):($_=Promise.reject()).catch(function(E){})),m.current=IM(IM({},p),n===2?{version:2,promise:A_}:{version:3,promise:$_})),we.createElement(OM.Provider,{value:m.current},h)},Xa=function(){return(Xa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},m9=function(e,t){var n={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]]);return n},I_=function(e){return"Typesetting failed: ".concat(e.message!==void 0?e.message:JSON.stringify(e))},aD=function(e){function t(){var $;E==="every"&&M&&O==="post"&&v.current!==null&&(v.current.style.visibility=($=($=m.style)==null?void 0:$.visibility)!=null?$:"visible"),I.current||(E==="first"&&v.current!==null&&(v.current.style.visibility="visible"),s&&s(),I.current=!0),o&&o(),k.current=!1}var r=e.inline,n=r!==void 0&&r,r=e.hideUntilTypeset,s=e.onInitTypeset,o=e.onTypeset,a=e.text,c=e.dynamic,u=e.typesettingOptions,d=e.renderMode,h=e.children,m=m9(e,["inline","hideUntilTypeset","onInitTypeset","onTypeset","text","dynamic","typesettingOptions","renderMode","children"]),p=B.useRef(""),v=B.useRef(null),T=B.useContext(OM),E=r??(T==null?void 0:T.hideUntilTypeset),O=d??(T==null?void 0:T.renderMode),b=u??(T==null?void 0:T.typesettingOptions),M=c!==!1&&(c||!1),I=B.useRef(!1),k=B.useRef(!1);return!k.current&&v.current!==null&&M&&E==="every"&&O==="post"&&(v.current.style.visibility="hidden"),(typeof window<"u"?B.useLayoutEffect:B.useEffect)(function(){if((M||!I.current)&&v.current!==null){if(!T)throw Error("MathJax was not loaded, did you use the MathJax component outside of a MathJaxContext?");if(O==="pre"){if(!(typeof($=a)=="string"&&0<$.length))throw Error(`Render mode 'pre' requires text prop to be set and non-empty, which was currently "`.concat(a,'"'));if(!u||!u.fn)throw Error("Render mode 'pre' requires 'typesettingOptions' prop with 'fn' property to be set on MathJax element or in the MathJaxContext");if(T.version===2)throw Error("Render mode 'pre' only available with MathJax 3, and version 2 is currently in use")}O!=="post"&&a===p.current||k.current||(k.current=!0,T.version===3?T.promise.then(function(P){var D;O==="pre"?(D=function(j){p.current=a,P.startup.document.clear(),P.startup.document.updateDocument(),v.current!==null&&(v.current.innerHTML=j.outerHTML),t()},u.fn.endsWith("Promise")?P.startup.promise.then(function(){return P[b.fn](a,Xa(Xa({},(b==null?void 0:b.options)||{}),{display:!n}))}).then(D).catch(function(j){throw t(),Error(I_(j))}):P.startup.promise.then(function(){var j=P[b.fn](a,Xa(Xa({},(b==null?void 0:b.options)||{}),{display:!n}));D(j)}).catch(function(j){throw t(),Error(I_(j))})):P.startup.promise.then(function(){return P.typesetClear([v.current]),P.typesetPromise([v.current])}).then(t).catch(function(j){throw t(),Error(I_(j))})}).catch(function(P){throw t(),Error(I_(P))}):T.promise.then(function(P){P.Hub.Queue(["Typeset",P.Hub,v.current]),P.Hub.Queue(t)}).catch(function(P){throw t(),Error(I_(P))}))}var $}),we.createElement("span",Xa({},m,{style:Xa(Xa({display:n?"inline":"block"},m.style),{visibility:E?"hidden":(e=m.style)==null?void 0:e.visibility}),ref:v}),h)};const g9=sE("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ma=B.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...s},o)=>{const a=r?E0:"button";return R.jsx(a,{className:Kn(g9({variant:t,size:n,className:e})),ref:o,...s})});ma.displayName="Button";const Qs=B.forwardRef(({className:e,...t},n)=>R.jsx("div",{ref:n,className:Kn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Qs.displayName="Card";const lD=B.forwardRef(({className:e,...t},n)=>R.jsx("div",{ref:n,className:Kn("flex flex-col space-y-1.5 p-6",e),...t}));lD.displayName="CardHeader";const cD=B.forwardRef(({className:e,...t},n)=>R.jsx("h3",{ref:n,className:Kn("text-2xl font-semibold leading-none tracking-tight",e),...t}));cD.displayName="CardTitle";const _9=B.forwardRef(({className:e,...t},n)=>R.jsx("p",{ref:n,className:Kn("text-sm text-muted-foreground",e),...t}));_9.displayName="CardDescription";const uD=B.forwardRef(({className:e,...t},n)=>R.jsx("div",{ref:n,className:Kn("p-6 pt-0",e),...t}));uD.displayName="CardContent";const y9=B.forwardRef(({className:e,...t},n)=>R.jsx("div",{ref:n,className:Kn("flex items-center p-6 pt-0",e),...t}));y9.displayName="CardFooter";const TE=B.createContext({});function EE(e){const t=B.useRef(null);return t.current===null&&(t.current=e()),t.current}const M1=B.createContext(null),PE=B.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class v9 extends B.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function w9({children:e,isPresent:t}){const n=B.useId(),r=B.useRef(null),s=B.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=B.useContext(PE);return B.useInsertionEffect(()=>{const{width:a,height:c,top:u,left:d}=s.current;if(t||!r.current||!a||!c)return;r.current.dataset.motionPopId=n;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${c}px !important;
            top: ${u}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[t]),R.jsx(v9,{isPresent:t,childRef:r,sizeRef:s,children:B.cloneElement(e,{ref:r})})}const b9=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:o,mode:a})=>{const c=EE(x9),u=B.useId(),d=B.useCallback(m=>{c.set(m,!0);for(const p of c.values())if(!p)return;r&&r()},[c,r]),h=B.useMemo(()=>({id:u,initial:t,isPresent:n,custom:s,onExitComplete:d,register:m=>(c.set(m,!1),()=>c.delete(m))}),o?[Math.random(),d]:[n,d]);return B.useMemo(()=>{c.forEach((m,p)=>c.set(p,!1))},[n]),B.useEffect(()=>{!n&&!c.size&&r&&r()},[n]),a==="popLayout"&&(e=R.jsx(w9,{isPresent:n,children:e})),R.jsx(M1.Provider,{value:h,children:e})};function x9(){return new Map}function dD(e=!0){const t=B.useContext(M1);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,o=B.useId();B.useEffect(()=>{e&&s(o)},[e]);const a=B.useCallback(()=>e&&r&&r(o),[o,r,e]);return!n&&r?[!1,a]:[!0]}const kv=e=>e.key||"";function nk(e){const t=[];return B.Children.forEach(e,n=>{B.isValidElement(n)&&t.push(n)}),t}const SE=typeof window<"u",hD=SE?B.useLayoutEffect:B.useEffect,M9=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:o="sync",propagate:a=!1})=>{const[c,u]=dD(a),d=B.useMemo(()=>nk(e),[e]),h=a&&!c?[]:d.map(kv),m=B.useRef(!0),p=B.useRef(d),v=EE(()=>new Map),[T,E]=B.useState(d),[O,b]=B.useState(d);hD(()=>{m.current=!1,p.current=d;for(let k=0;k<O.length;k++){const $=kv(O[k]);h.includes($)?v.delete($):v.get($)!==!0&&v.set($,!1)}},[O,h.length,h.join("-")]);const M=[];if(d!==T){let k=[...d];for(let $=0;$<O.length;$++){const P=O[$],D=kv(P);h.includes(D)||(k.splice($,0,P),M.push(P))}o==="wait"&&M.length&&(k=M),b(nk(k)),E(d);return}const{forceRender:I}=B.useContext(TE);return R.jsx(R.Fragment,{children:O.map(k=>{const $=kv(k),P=a&&!c?!1:d===O||h.includes($),D=()=>{if(v.has($))v.set($,!0);else return;let j=!0;v.forEach(Y=>{Y||(j=!1)}),j&&(I==null||I(),b(p.current),a&&(u==null||u()),r&&r())};return R.jsx(b9,{isPresent:P,initial:!m.current||n?void 0:!1,custom:P?void 0:t,presenceAffectsLayout:s,mode:o,onExitComplete:P?void 0:D,children:k},$)})})},li=e=>e;let DM=li;function CE(e){let t;return()=>(t===void 0&&(t=e()),t)}const qh=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r},aa=e=>e*1e3,la=e=>e/1e3,T9={skipAnimations:!1,useManualTiming:!1};function E9(e){let t=new Set,n=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(d){o.has(d)&&(u.schedule(d),e()),d(a)}const u={schedule:(d,h=!1,m=!1)=>{const v=m&&r?t:n;return h&&o.add(d),v.has(d)||v.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(a=d,r){s=!0;return}r=!0,[t,n]=[n,t],t.forEach(c),t.clear(),r=!1,s&&(s=!1,u.process(d))}};return u}const Av=["read","resolveKeyframes","update","preRender","render","postRender"],P9=40;function fD(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,a=Av.reduce((b,M)=>(b[M]=E9(o),b),{}),{read:c,resolveKeyframes:u,update:d,preRender:h,render:m,postRender:p}=a,v=()=>{const b=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(b-s.timestamp,P9),1),s.timestamp=b,s.isProcessing=!0,c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),p.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(v))},T=()=>{n=!0,r=!0,s.isProcessing||e(v)};return{schedule:Av.reduce((b,M)=>{const I=a[M];return b[M]=(k,$=!1,P=!1)=>(n||T(),I.schedule(k,$,P)),b},{}),cancel:b=>{for(let M=0;M<Av.length;M++)a[Av[M]].cancel(b)},state:s,steps:a}}const{schedule:hr,cancel:kl,state:ss,steps:ex}=fD(typeof requestAnimationFrame<"u"?requestAnimationFrame:li,!0),pD=B.createContext({strict:!1}),rk={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Qh={};for(const e in rk)Qh[e]={isEnabled:t=>rk[e].some(n=>!!t[n])};function S9(e){for(const t in e)Qh[t]={...Qh[t],...e[t]}}const C9=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Iw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||C9.has(e)}let mD=e=>!Iw(e);function k9(e){e&&(mD=t=>t.startsWith("on")?!Iw(t):e(t))}try{k9(require("@emotion/is-prop-valid").default)}catch{}function A9(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(mD(s)||n===!0&&Iw(s)||!t&&!Iw(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function $9(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const T1=B.createContext({});function O0(e){return typeof e=="string"||Array.isArray(e)}function E1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const kE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],AE=["initial",...kE];function P1(e){return E1(e.animate)||AE.some(t=>O0(e[t]))}function gD(e){return!!(P1(e)||e.variants)}function I9(e,t){if(P1(e)){const{initial:n,animate:r}=e;return{initial:n===!1||O0(n)?n:void 0,animate:O0(r)?r:void 0}}return e.inherit!==!1?t:{}}function O9(e){const{initial:t,animate:n}=I9(e,B.useContext(T1));return B.useMemo(()=>({initial:t,animate:n}),[sk(t),sk(n)])}function sk(e){return Array.isArray(e)?e.join(" "):e}const D9=Symbol.for("motionComponentSymbol");function fh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function L9(e,t,n){return B.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):fh(n)&&(n.current=r))},[t])}const $E=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),F9="framerAppearId",_D="data-"+$E(F9),{schedule:IE,cancel:OY}=fD(queueMicrotask,!1),yD=B.createContext({});function R9(e,t,n,r,s){var o,a;const{visualElement:c}=B.useContext(T1),u=B.useContext(pD),d=B.useContext(M1),h=B.useContext(PE).reducedMotion,m=B.useRef(null);r=r||u.renderer,!m.current&&r&&(m.current=r(e,{visualState:t,parent:c,props:n,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:h}));const p=m.current,v=B.useContext(yD);p&&!p.projection&&s&&(p.type==="html"||p.type==="svg")&&j9(m.current,n,s,v);const T=B.useRef(!1);B.useInsertionEffect(()=>{p&&T.current&&p.update(n,d)});const E=n[_D],O=B.useRef(!!E&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,E))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,E)));return hD(()=>{p&&(T.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),IE.render(p.render),O.current&&p.animationState&&p.animationState.animateChanges())}),B.useEffect(()=>{p&&(!O.current&&p.animationState&&p.animationState.animateChanges(),O.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,E)}),O.current=!1))}),p}function j9(e,t,n,r){const{layoutId:s,layout:o,drag:a,dragConstraints:c,layoutScroll:u,layoutRoot:d}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:vD(e.parent)),e.projection.setOptions({layoutId:s,layout:o,alwaysMeasureLayout:!!a||c&&fh(c),visualElement:e,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:d})}function vD(e){if(e)return e.options.allowProjection!==!1?e.projection:vD(e.parent)}function N9({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){var o,a;e&&S9(e);function c(d,h){let m;const p={...B.useContext(PE),...d,layoutId:z9(d)},{isStatic:v}=p,T=O9(d),E=r(d,v);if(!v&&SE){B9();const O=V9(p);m=O.MeasureLayout,T.visualElement=R9(s,E,p,t,O.ProjectionNode)}return R.jsxs(T1.Provider,{value:T,children:[m&&T.visualElement?R.jsx(m,{visualElement:T.visualElement,...p}):null,n(s,d,L9(E,T.visualElement,h),E,v,T.visualElement)]})}c.displayName=`motion.${typeof s=="string"?s:`create(${(a=(o=s.displayName)!==null&&o!==void 0?o:s.name)!==null&&a!==void 0?a:""})`}`;const u=B.forwardRef(c);return u[D9]=s,u}function z9({layoutId:e}){const t=B.useContext(TE).id;return t&&e!==void 0?t+"-"+e:e}function B9(e,t){B.useContext(pD).strict}function V9(e){const{drag:t,layout:n}=Qh;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const U9=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function OE(e){return typeof e!="string"||e.includes("-")?!1:!!(U9.indexOf(e)>-1||/[A-Z]/u.test(e))}function ik(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function DE(e,t,n,r){if(typeof t=="function"){const[s,o]=ik(r);t=t(n!==void 0?n:e.custom,s,o)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,o]=ik(r);t=t(n!==void 0?n:e.custom,s,o)}return t}const LM=e=>Array.isArray(e),W9=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),G9=e=>LM(e)?e[e.length-1]||0:e,vs=e=>!!(e&&e.getVelocity);function Qv(e){const t=vs(e)?e.get():e;return W9(t)?t.toValue():t}function K9({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},r,s,o){const a={latestValues:H9(r,s,o,e),renderState:t()};return n&&(a.onMount=c=>n({props:r,current:c,...a}),a.onUpdate=c=>n(c)),a}const wD=e=>(t,n)=>{const r=B.useContext(T1),s=B.useContext(M1),o=()=>K9(e,t,r,s);return n?o():EE(o)};function H9(e,t,n,r){const s={},o=r(e,{});for(const p in o)s[p]=Qv(o[p]);let{initial:a,animate:c}=e;const u=P1(e),d=gD(e);t&&d&&!u&&e.inherit!==!1&&(a===void 0&&(a=t.initial),c===void 0&&(c=t.animate));let h=n?n.initial===!1:!1;h=h||a===!1;const m=h?c:a;if(m&&typeof m!="boolean"&&!E1(m)){const p=Array.isArray(m)?m:[m];for(let v=0;v<p.length;v++){const T=DE(e,p[v]);if(T){const{transitionEnd:E,transition:O,...b}=T;for(const M in b){let I=b[M];if(Array.isArray(I)){const k=h?I.length-1:0;I=I[k]}I!==null&&(s[M]=I)}for(const M in E)s[M]=E[M]}}}return s}const cf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Yc=new Set(cf),bD=e=>t=>typeof t=="string"&&t.startsWith(e),xD=bD("--"),q9=bD("var(--"),LE=e=>q9(e)?Q9.test(e.split("/*")[0].trim()):!1,Q9=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,MD=(e,t)=>t&&typeof e=="number"?t.transform(e):e,ga=(e,t,n)=>n>t?t:n<e?e:n,uf={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},D0={...uf,transform:e=>ga(0,1,e)},$v={...uf,default:1},X0=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ja=X0("deg"),$o=X0("%"),an=X0("px"),Y9=X0("vh"),X9=X0("vw"),ok={...$o,parse:e=>$o.parse(e)/100,transform:e=>$o.transform(e*100)},J9={borderWidth:an,borderTopWidth:an,borderRightWidth:an,borderBottomWidth:an,borderLeftWidth:an,borderRadius:an,radius:an,borderTopLeftRadius:an,borderTopRightRadius:an,borderBottomRightRadius:an,borderBottomLeftRadius:an,width:an,maxWidth:an,height:an,maxHeight:an,top:an,right:an,bottom:an,left:an,padding:an,paddingTop:an,paddingRight:an,paddingBottom:an,paddingLeft:an,margin:an,marginTop:an,marginRight:an,marginBottom:an,marginLeft:an,backgroundPositionX:an,backgroundPositionY:an},Z9={rotate:Ja,rotateX:Ja,rotateY:Ja,rotateZ:Ja,scale:$v,scaleX:$v,scaleY:$v,scaleZ:$v,skew:Ja,skewX:Ja,skewY:Ja,distance:an,translateX:an,translateY:an,translateZ:an,x:an,y:an,z:an,perspective:an,transformPerspective:an,opacity:D0,originX:ok,originY:ok,originZ:an},ak={...uf,transform:Math.round},FE={...J9,...Z9,zIndex:ak,size:an,fillOpacity:D0,strokeOpacity:D0,numOctaves:ak},eW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tW=cf.length;function nW(e,t,n){let r="",s=!0;for(let o=0;o<tW;o++){const a=cf[o],c=e[a];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(a.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||n){const d=MD(c,FE[a]);if(!u){s=!1;const h=eW[a]||a;r+=`${h}(${d}) `}n&&(t[a]=d)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function RE(e,t,n){const{style:r,vars:s,transformOrigin:o}=e;let a=!1,c=!1;for(const u in t){const d=t[u];if(Yc.has(u)){a=!0;continue}else if(xD(u)){s[u]=d;continue}else{const h=MD(d,FE[u]);u.startsWith("origin")?(c=!0,o[u]=h):r[u]=h}}if(t.transform||(a||n?r.transform=nW(t,e.transform,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=o;r.transformOrigin=`${u} ${d} ${h}`}}function lk(e,t,n){return typeof e=="string"?e:an.transform(t+n*e)}function rW(e,t,n){const r=lk(t,e.x,e.width),s=lk(n,e.y,e.height);return`${r} ${s}`}const sW={offset:"stroke-dashoffset",array:"stroke-dasharray"},iW={offset:"strokeDashoffset",array:"strokeDasharray"};function oW(e,t,n=1,r=0,s=!0){e.pathLength=1;const o=s?sW:iW;e[o.offset]=an.transform(-r);const a=an.transform(t),c=an.transform(n);e[o.array]=`${a} ${c}`}function jE(e,{attrX:t,attrY:n,attrScale:r,originX:s,originY:o,pathLength:a,pathSpacing:c=1,pathOffset:u=0,...d},h,m){if(RE(e,d,m),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:v,dimensions:T}=e;p.transform&&(T&&(v.transform=p.transform),delete p.transform),T&&(s!==void 0||o!==void 0||v.transform)&&(v.transformOrigin=rW(T,s!==void 0?s:.5,o!==void 0?o:.5)),t!==void 0&&(p.x=t),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),a!==void 0&&oW(p,a,c,u,!1)}const NE=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),TD=()=>({...NE(),attrs:{}}),zE=e=>typeof e=="string"&&e.toLowerCase()==="svg";function ED(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const o in n)e.style.setProperty(o,n[o])}const PD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SD(e,t,n,r){ED(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(PD.has(s)?s:$E(s),t.attrs[s])}const Ow={};function aW(e){Object.assign(Ow,e)}function CD(e,{layout:t,layoutId:n}){return Yc.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Ow[e]||e==="opacity")}function BE(e,t,n){var r;const{style:s}=e,o={};for(const a in s)(vs(s[a])||t.style&&vs(t.style[a])||CD(a,e)||((r=n==null?void 0:n.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[a]=s[a]);return o}function kD(e,t,n){const r=BE(e,t,n);for(const s in e)if(vs(e[s])||vs(t[s])){const o=cf.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[o]=e[s]}return r}function lW(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const ck=["x","y","width","height","cx","cy","r"],cW={useVisualState:wD({scrapeMotionValuesFromProps:kD,createRenderState:TD,onUpdate:({props:e,prevProps:t,current:n,renderState:r,latestValues:s})=>{if(!n)return;let o=!!e.drag;if(!o){for(const c in s)if(Yc.has(c)){o=!0;break}}if(!o)return;let a=!t;if(t)for(let c=0;c<ck.length;c++){const u=ck[c];e[u]!==t[u]&&(a=!0)}a&&(hr.read(()=>lW(n,r)),hr.render(()=>{jE(r,s,zE(n.tagName),e.transformTemplate),SD(n,r)}))}})},uW={useVisualState:wD({scrapeMotionValuesFromProps:BE,createRenderState:NE})};function AD(e,t,n){for(const r in t)!vs(t[r])&&!CD(r,n)&&(e[r]=t[r])}function dW({transformTemplate:e},t){return B.useMemo(()=>{const n=NE();return RE(n,t,e),Object.assign({},n.vars,n.style)},[t])}function hW(e,t){const n=e.style||{},r={};return AD(r,n,e),Object.assign(r,dW(e,t)),r}function fW(e,t){const n={},r=hW(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}function pW(e,t,n,r){const s=B.useMemo(()=>{const o=TD();return jE(o,t,zE(r),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};AD(o,e.style,e),s.style={...o,...s.style}}return s}function mW(e=!1){return(n,r,s,{latestValues:o},a)=>{const u=(OE(n)?pW:fW)(r,o,a,n),d=A9(r,typeof n=="string",e),h=n!==B.Fragment?{...d,...u,ref:s}:{},{children:m}=r,p=B.useMemo(()=>vs(m)?m.get():m,[m]);return B.createElement(n,{...h,children:p})}}function gW(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...OE(r)?cW:uW,preloadedFeatures:e,useRender:mW(s),createVisualElement:t,Component:r};return N9(a)}}function $D(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function S1(e,t,n){const r=e.getProps();return DE(r,t,n!==void 0?n:r.custom,e)}const _W=CE(()=>window.ScrollTimeline!==void 0);class yW{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,n){for(let r=0;r<this.animations.length;r++)this.animations[r][t]=n}attachTimeline(t,n){const r=this.animations.map(s=>{if(_W()&&s.attachTimeline)return s.attachTimeline(t);if(typeof n=="function")return n(s)});return()=>{r.forEach((s,o)=>{s&&s(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class vW extends yW{then(t,n){return Promise.all(this.animations).then(t).catch(n)}}function VE(e,t){return e?e[t]||e.default||e:void 0}const FM=2e4;function ID(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<FM;)t+=n,r=e.next(t);return t>=FM?1/0:t}function UE(e){return typeof e=="function"}function uk(e,t){e.timeline=t,e.onfinish=null}const WE=e=>Array.isArray(e)&&typeof e[0]=="number",wW={linearEasing:void 0};function bW(e,t){const n=CE(e);return()=>{var r;return(r=wW[t])!==null&&r!==void 0?r:n()}}const Dw=bW(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),OD=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let o=0;o<s;o++)r+=e(qh(0,s-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function DD(e){return!!(typeof e=="function"&&Dw()||!e||typeof e=="string"&&(e in RM||Dw())||WE(e)||Array.isArray(e)&&e.every(DD))}const z_=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,RM={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:z_([0,.65,.55,1]),circOut:z_([.55,0,1,.45]),backIn:z_([.31,.01,.66,-.59]),backOut:z_([.33,1.53,.69,.99])};function LD(e,t){if(e)return typeof e=="function"&&Dw()?OD(e,t):WE(e)?z_(e):Array.isArray(e)?e.map(n=>LD(n,t)||RM.easeOut):RM[e]}const Gi={x:!1,y:!1};function FD(){return Gi.x||Gi.y}function xW(e,t,n){var r;if(e instanceof Element)return[e];if(typeof e=="string"){let s=document;const o=(r=void 0)!==null&&r!==void 0?r:s.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}function RD(e,t){const n=xW(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function dk(e){return t=>{t.pointerType==="touch"||FD()||e(t)}}function MW(e,t,n={}){const[r,s,o]=RD(e,n),a=dk(c=>{const{target:u}=c,d=t(c);if(typeof d!="function"||!u)return;const h=dk(m=>{d(m),u.removeEventListener("pointerleave",h)});u.addEventListener("pointerleave",h,s)});return r.forEach(c=>{c.addEventListener("pointerenter",a,s)}),o}const jD=(e,t)=>t?e===t?!0:jD(e,t.parentElement):!1,GE=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,TW=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function EW(e){return TW.has(e.tagName)||e.tabIndex!==-1}const B_=new WeakSet;function hk(e){return t=>{t.key==="Enter"&&e(t)}}function tx(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const PW=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=hk(()=>{if(B_.has(n))return;tx(n,"down");const s=hk(()=>{tx(n,"up")}),o=()=>tx(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",o,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function fk(e){return GE(e)&&!FD()}function SW(e,t,n={}){const[r,s,o]=RD(e,n),a=c=>{const u=c.currentTarget;if(!fk(c)||B_.has(u))return;B_.add(u);const d=t(c),h=(v,T)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",p),!(!fk(v)||!B_.has(u))&&(B_.delete(u),typeof d=="function"&&d(v,{success:T}))},m=v=>{h(v,n.useGlobalTarget||jD(u,v.target))},p=v=>{h(v,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",p,s)};return r.forEach(c=>{!EW(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(n.useGlobalTarget?window:c).addEventListener("pointerdown",a,s),c.addEventListener("focus",d=>PW(d,s),s)}),o}function CW(e){return e==="x"||e==="y"?Gi[e]?null:(Gi[e]=!0,()=>{Gi[e]=!1}):Gi.x||Gi.y?null:(Gi.x=Gi.y=!0,()=>{Gi.x=Gi.y=!1})}const ND=new Set(["width","height","top","left","right","bottom",...cf]);let Yv;function kW(){Yv=void 0}const Io={now:()=>(Yv===void 0&&Io.set(ss.isProcessing||T9.useManualTiming?ss.timestamp:performance.now()),Yv),set:e=>{Yv=e,queueMicrotask(kW)}};function KE(e,t){e.indexOf(t)===-1&&e.push(t)}function HE(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class qE{constructor(){this.subscriptions=[]}add(t){return KE(this.subscriptions,t),()=>HE(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let o=0;o<s;o++){const a=this.subscriptions[o];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function zD(e,t){return t?e*(1e3/t):0}const pk=30,AW=e=>!isNaN(parseFloat(e));class $W{constructor(t,n={}){this.version="11.18.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const o=Io.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Io.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=AW(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new qE);const r=this.events[t].add(n);return t==="change"?()=>{r(),hr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Io.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>pk)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,pk);return zD(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function L0(e,t){return new $W(e,t)}function IW(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,L0(n))}function OW(e,t){const n=S1(e,t);let{transitionEnd:r={},transition:s={},...o}=n||{};o={...o,...r};for(const a in o){const c=G9(o[a]);IW(e,a,c)}}function DW(e){return!!(vs(e)&&e.add)}function jM(e,t){const n=e.getValue("willChange");if(DW(n))return n.add(t)}function BD(e){return e.props[_D]}const VD=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,LW=1e-7,FW=12;function RW(e,t,n,r,s){let o,a,c=0;do a=t+(n-t)/2,o=VD(a,r,s)-e,o>0?n=a:t=a;while(Math.abs(o)>LW&&++c<FW);return a}function J0(e,t,n,r){if(e===t&&n===r)return li;const s=o=>RW(o,0,1,e,n);return o=>o===0||o===1?o:VD(s(o),t,r)}const UD=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,WD=e=>t=>1-e(1-t),GD=J0(.33,1.53,.69,.99),QE=WD(GD),KD=UD(QE),HD=e=>(e*=2)<1?.5*QE(e):.5*(2-Math.pow(2,-10*(e-1))),YE=e=>1-Math.sin(Math.acos(e)),qD=WD(YE),QD=UD(YE),YD=e=>/^0[^.\s]+$/u.test(e);function jW(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||YD(e):!0}const r0=e=>Math.round(e*1e5)/1e5,XE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function NW(e){return e==null}const zW=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,JE=(e,t)=>n=>!!(typeof n=="string"&&zW.test(n)&&n.startsWith(e)||t&&!NW(n)&&Object.prototype.hasOwnProperty.call(n,t)),XD=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,o,a,c]=r.match(XE);return{[e]:parseFloat(s),[t]:parseFloat(o),[n]:parseFloat(a),alpha:c!==void 0?parseFloat(c):1}},BW=e=>ga(0,255,e),nx={...uf,transform:e=>Math.round(BW(e))},Cc={test:JE("rgb","red"),parse:XD("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+nx.transform(e)+", "+nx.transform(t)+", "+nx.transform(n)+", "+r0(D0.transform(r))+")"};function VW(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const NM={test:JE("#"),parse:VW,transform:Cc.transform},ph={test:JE("hsl","hue"),parse:XD("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+$o.transform(r0(t))+", "+$o.transform(r0(n))+", "+r0(D0.transform(r))+")"},_s={test:e=>Cc.test(e)||NM.test(e)||ph.test(e),parse:e=>Cc.test(e)?Cc.parse(e):ph.test(e)?ph.parse(e):NM.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Cc.transform(e):ph.transform(e)},UW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function WW(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(XE))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(UW))===null||n===void 0?void 0:n.length)||0)>0}const JD="number",ZD="color",GW="var",KW="var(",mk="${}",HW=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function F0(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let o=0;const c=t.replace(HW,u=>(_s.test(u)?(r.color.push(o),s.push(ZD),n.push(_s.parse(u))):u.startsWith(KW)?(r.var.push(o),s.push(GW),n.push(u)):(r.number.push(o),s.push(JD),n.push(parseFloat(u))),++o,mk)).split(mk);return{values:n,split:c,indexes:r,types:s}}function eL(e){return F0(e).values}function tL(e){const{split:t,types:n}=F0(e),r=t.length;return s=>{let o="";for(let a=0;a<r;a++)if(o+=t[a],s[a]!==void 0){const c=n[a];c===JD?o+=r0(s[a]):c===ZD?o+=_s.transform(s[a]):o+=s[a]}return o}}const qW=e=>typeof e=="number"?0:e;function QW(e){const t=eL(e);return tL(e)(t.map(qW))}const Al={test:WW,parse:eL,createTransformer:tL,getAnimatableNone:QW},YW=new Set(["brightness","contrast","saturate","opacity"]);function XW(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(XE)||[];if(!r)return e;const s=n.replace(r,"");let o=YW.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+s+")"}const JW=/\b([a-z-]*)\(.*?\)/gu,zM={...Al,getAnimatableNone:e=>{const t=e.match(JW);return t?t.map(XW).join(" "):e}},ZW={...FE,color:_s,backgroundColor:_s,outlineColor:_s,fill:_s,stroke:_s,borderColor:_s,borderTopColor:_s,borderRightColor:_s,borderBottomColor:_s,borderLeftColor:_s,filter:zM,WebkitFilter:zM},ZE=e=>ZW[e];function nL(e,t){let n=ZE(e);return n!==zM&&(n=Al),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const e7=new Set(["auto","none","0"]);function t7(e,t,n){let r=0,s;for(;r<e.length&&!s;){const o=e[r];typeof o=="string"&&!e7.has(o)&&F0(o).values.length&&(s=e[r]),r++}if(s&&n)for(const o of t)e[o]=nL(n,s)}const gk=e=>e===uf||e===an,_k=(e,t)=>parseFloat(e.split(", ")[t]),yk=(e,t)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return _k(s[1],t);{const o=r.match(/^matrix\((.+)\)$/u);return o?_k(o[1],e):0}},n7=new Set(["x","y","z"]),r7=cf.filter(e=>!n7.has(e));function s7(e){const t=[];return r7.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Yh={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:yk(4,13),y:yk(5,14)};Yh.translateX=Yh.x;Yh.translateY=Yh.y;const Rc=new Set;let BM=!1,VM=!1;function rL(){if(VM){const e=Array.from(Rc).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=s7(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([o,a])=>{var c;(c=r.getValue(o))===null||c===void 0||c.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}VM=!1,BM=!1,Rc.forEach(e=>e.complete()),Rc.clear()}function sL(){Rc.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(VM=!0)})}function i7(){sL(),rL()}class e2{constructor(t,n,r,s,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Rc.add(this),BM||(BM=!0,hr.read(sL),hr.resolveKeyframes(rL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;for(let o=0;o<t.length;o++)if(t[o]===null)if(o===0){const a=s==null?void 0:s.get(),c=t[t.length-1];if(a!==void 0)t[0]=a;else if(r&&n){const u=r.readValue(n,c);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=c),s&&a===void 0&&s.set(t[0])}else t[o]=t[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Rc.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Rc.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const iL=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),o7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function a7(e){const t=o7.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function oL(e,t,n=1){const[r,s]=a7(e);if(!r)return;const o=window.getComputedStyle(t).getPropertyValue(r);if(o){const a=o.trim();return iL(a)?parseFloat(a):a}return LE(s)?oL(s,t,n+1):s}const aL=e=>t=>t.test(e),l7={test:e=>e==="auto",parse:e=>e},lL=[uf,an,$o,Ja,X9,Y9,l7],vk=e=>lL.find(aL(e));class cL extends e2{constructor(t,n,r,s,o){super(t,n,r,s,o,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let d=t[u];if(typeof d=="string"&&(d=d.trim(),LE(d))){const h=oL(d,n.current);h!==void 0&&(t[u]=h),u===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!ND.has(r)||t.length!==2)return;const[s,o]=t,a=vk(s),c=vk(o);if(a!==c)if(gk(a)&&gk(c))for(let u=0;u<t.length;u++){const d=t[u];typeof d=="string"&&(t[u]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)jW(t[s])&&r.push(s);r.length&&t7(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Yh[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var t;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const o=n.getValue(r);o&&o.jump(this.measuredOrigin,!1);const a=s.length-1,c=s[a];s[a]=Yh[r](n.measureViewportBox(),window.getComputedStyle(n.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([u,d])=>{n.getValue(u).set(d)}),this.resolveNoneKeyframes()}}const wk=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Al.test(e)||e==="0")&&!e.startsWith("url("));function c7(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function u7(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const o=e[e.length-1],a=wk(s,t),c=wk(o,t);return!a||!c?!1:c7(e)||(n==="spring"||UE(n))&&r}const d7=e=>e!==null;function C1(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(d7),o=t&&n!=="loop"&&t%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const h7=40;class uL{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Io.now(),this.options={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:o,repeatType:a,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>h7?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&i7(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=Io.now(),this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:o,delay:a,onComplete:c,onUpdate:u,isGenerator:d}=this.options;if(!d&&!u7(t,r,s,o))if(a)this.options.duration=0;else{u==null||u(C1(t,this.options,n)),c==null||c(),this.resolveFinishedPromise();return}const h=this.initPlayback(t,n);h!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...h},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const xr=(e,t,n)=>e+(t-e)*n;function rx(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function f7({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,o=0,a=0;if(!t)s=o=a=n;else{const c=n<.5?n*(1+t):n+t-n*t,u=2*n-c;s=rx(u,c,e+1/3),o=rx(u,c,e),a=rx(u,c,e-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:r}}function Lw(e,t){return n=>n>0?t:e}const sx=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},p7=[NM,Cc,ph],m7=e=>p7.find(t=>t.test(e));function bk(e){const t=m7(e);if(!t)return!1;let n=t.parse(e);return t===ph&&(n=f7(n)),n}const xk=(e,t)=>{const n=bk(e),r=bk(t);if(!n||!r)return Lw(e,t);const s={...n};return o=>(s.red=sx(n.red,r.red,o),s.green=sx(n.green,r.green,o),s.blue=sx(n.blue,r.blue,o),s.alpha=xr(n.alpha,r.alpha,o),Cc.transform(s))},g7=(e,t)=>n=>t(e(n)),Z0=(...e)=>e.reduce(g7),UM=new Set(["none","hidden"]);function _7(e,t){return UM.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function y7(e,t){return n=>xr(e,t,n)}function t2(e){return typeof e=="number"?y7:typeof e=="string"?LE(e)?Lw:_s.test(e)?xk:b7:Array.isArray(e)?dL:typeof e=="object"?_s.test(e)?xk:v7:Lw}function dL(e,t){const n=[...e],r=n.length,s=e.map((o,a)=>t2(o)(o,t[a]));return o=>{for(let a=0;a<r;a++)n[a]=s[a](o);return n}}function v7(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=t2(e[s])(e[s],t[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}}function w7(e,t){var n;const r=[],s={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const a=t.types[o],c=e.indexes[a][s[a]],u=(n=e.values[c])!==null&&n!==void 0?n:0;r[o]=u,s[a]++}return r}const b7=(e,t)=>{const n=Al.createTransformer(t),r=F0(e),s=F0(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?UM.has(e)&&!s.values.length||UM.has(t)&&!r.values.length?_7(e,t):Z0(dL(w7(r,s),s.values),n):Lw(e,t)};function hL(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?xr(e,t,n):t2(e)(e,t)}const x7=5;function fL(e,t,n){const r=Math.max(t-x7,0);return zD(n-e(r),t-r)}const Ir={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ix=.001;function M7({duration:e=Ir.duration,bounce:t=Ir.bounce,velocity:n=Ir.velocity,mass:r=Ir.mass}){let s,o,a=1-t;a=ga(Ir.minDamping,Ir.maxDamping,a),e=ga(Ir.minDuration,Ir.maxDuration,la(e)),a<1?(s=d=>{const h=d*a,m=h*e,p=h-n,v=WM(d,a),T=Math.exp(-m);return ix-p/v*T},o=d=>{const m=d*a*e,p=m*n+n,v=Math.pow(a,2)*Math.pow(d,2)*e,T=Math.exp(-m),E=WM(Math.pow(d,2),a);return(-s(d)+ix>0?-1:1)*((p-v)*T)/E}):(s=d=>{const h=Math.exp(-d*e),m=(d-n)*e+1;return-ix+h*m},o=d=>{const h=Math.exp(-d*e),m=(n-d)*(e*e);return h*m});const c=5/e,u=E7(s,o,c);if(e=aa(e),isNaN(u))return{stiffness:Ir.stiffness,damping:Ir.damping,duration:e};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:a*2*Math.sqrt(r*d),duration:e}}}const T7=12;function E7(e,t,n){let r=n;for(let s=1;s<T7;s++)r=r-e(r)/t(r);return r}function WM(e,t){return e*Math.sqrt(1-t*t)}const P7=["duration","bounce"],S7=["stiffness","damping","mass"];function Mk(e,t){return t.some(n=>e[n]!==void 0)}function C7(e){let t={velocity:Ir.velocity,stiffness:Ir.stiffness,damping:Ir.damping,mass:Ir.mass,isResolvedFromDuration:!1,...e};if(!Mk(e,S7)&&Mk(e,P7))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,o=2*ga(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Ir.mass,stiffness:s,damping:o}}else{const n=M7(e);t={...t,...n,mass:Ir.mass},t.isResolvedFromDuration=!0}return t}function pL(e=Ir.visualDuration,t=Ir.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const o=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],c={done:!1,value:o},{stiffness:u,damping:d,mass:h,duration:m,velocity:p,isResolvedFromDuration:v}=C7({...n,velocity:-la(n.velocity||0)}),T=p||0,E=d/(2*Math.sqrt(u*h)),O=a-o,b=la(Math.sqrt(u/h)),M=Math.abs(O)<5;r||(r=M?Ir.restSpeed.granular:Ir.restSpeed.default),s||(s=M?Ir.restDelta.granular:Ir.restDelta.default);let I;if(E<1){const $=WM(b,E);I=P=>{const D=Math.exp(-E*b*P);return a-D*((T+E*b*O)/$*Math.sin($*P)+O*Math.cos($*P))}}else if(E===1)I=$=>a-Math.exp(-b*$)*(O+(T+b*O)*$);else{const $=b*Math.sqrt(E*E-1);I=P=>{const D=Math.exp(-E*b*P),j=Math.min($*P,300);return a-D*((T+E*b*O)*Math.sinh(j)+$*O*Math.cosh(j))/$}}const k={calculatedDuration:v&&m||null,next:$=>{const P=I($);if(v)c.done=$>=m;else{let D=0;E<1&&(D=$===0?aa(T):fL(I,$,P));const j=Math.abs(D)<=r,Y=Math.abs(a-P)<=s;c.done=j&&Y}return c.value=c.done?a:P,c},toString:()=>{const $=Math.min(ID(k),FM),P=OD(D=>k.next($*D).value,$,30);return $+"ms "+P}};return k}function Tk({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:a,min:c,max:u,restDelta:d=.5,restSpeed:h}){const m=e[0],p={done:!1,value:m},v=j=>c!==void 0&&j<c||u!==void 0&&j>u,T=j=>c===void 0?u:u===void 0||Math.abs(c-j)<Math.abs(u-j)?c:u;let E=n*t;const O=m+E,b=a===void 0?O:a(O);b!==O&&(E=b-m);const M=j=>-E*Math.exp(-j/r),I=j=>b+M(j),k=j=>{const Y=M(j),q=I(j);p.done=Math.abs(Y)<=d,p.value=p.done?b:q};let $,P;const D=j=>{v(p.value)&&($=j,P=pL({keyframes:[p.value,T(p.value)],velocity:fL(I,j,p.value),damping:s,stiffness:o,restDelta:d,restSpeed:h}))};return D(0),{calculatedDuration:null,next:j=>{let Y=!1;return!P&&$===void 0&&(Y=!0,k(j),D(j)),$!==void 0&&j>=$?P.next(j-$):(!Y&&k(j),p)}}}const k7=J0(.42,0,1,1),A7=J0(0,0,.58,1),mL=J0(.42,0,.58,1),$7=e=>Array.isArray(e)&&typeof e[0]!="number",Ek={linear:li,easeIn:k7,easeInOut:mL,easeOut:A7,circIn:YE,circInOut:QD,circOut:qD,backIn:QE,backInOut:KD,backOut:GD,anticipate:HD},Pk=e=>{if(WE(e)){DM(e.length===4);const[t,n,r,s]=e;return J0(t,n,r,s)}else if(typeof e=="string")return DM(Ek[e]!==void 0),Ek[e];return e};function I7(e,t,n){const r=[],s=n||hL,o=e.length-1;for(let a=0;a<o;a++){let c=s(e[a],e[a+1]);if(t){const u=Array.isArray(t)?t[a]||li:t;c=Z0(u,c)}r.push(c)}return r}function O7(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const o=e.length;if(DM(o===t.length),o===1)return()=>t[0];if(o===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=I7(t,r,s),u=c.length,d=h=>{if(a&&h<e[0])return t[0];let m=0;if(u>1)for(;m<e.length-2&&!(h<e[m+1]);m++);const p=qh(e[m],e[m+1],h);return c[m](p)};return n?h=>d(ga(e[0],e[o-1],h)):d}function D7(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=qh(0,t,r);e.push(xr(n,1,s))}}function L7(e){const t=[0];return D7(t,e.length-1),t}function F7(e,t){return e.map(n=>n*t)}function R7(e,t){return e.map(()=>t||mL).splice(0,e.length-1)}function Fw({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=$7(r)?r.map(Pk):Pk(r),o={done:!1,value:t[0]},a=F7(n&&n.length===t.length?n:L7(t),e),c=O7(a,t,{ease:Array.isArray(s)?s:R7(t,s)});return{calculatedDuration:e,next:u=>(o.value=c(u),o.done=u>=e,o)}}const j7=e=>{const t=({timestamp:n})=>e(n);return{start:()=>hr.update(t,!0),stop:()=>kl(t),now:()=>ss.isProcessing?ss.timestamp:Io.now()}},N7={decay:Tk,inertia:Tk,tween:Fw,keyframes:Fw,spring:pL},z7=e=>e/100;class n2 extends uL{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:n,motionValue:r,element:s,keyframes:o}=this.options,a=(s==null?void 0:s.KeyframeResolver)||e2,c=(u,d)=>this.onKeyframesResolved(u,d);this.resolver=new a(o,c,n,r,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o,velocity:a=0}=this.options,c=UE(n)?n:N7[n]||Fw;let u,d;c!==Fw&&typeof t[0]!="number"&&(u=Z0(z7,hL(t[0],t[1])),t=[0,100]);const h=c({...this.options,keyframes:t});o==="mirror"&&(d=c({...this.options,keyframes:[...t].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=ID(h));const{calculatedDuration:m}=h,p=m+s,v=p*(r+1)-s;return{generator:h,mirroredGenerator:d,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:p,totalDuration:v}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:r}=this;if(!r){const{keyframes:j}=this.options;return{done:!0,value:j[j.length-1]}}const{finalKeyframe:s,generator:o,mirroredGenerator:a,mapPercentToKeyframes:c,keyframes:u,calculatedDuration:d,totalDuration:h,resolvedDuration:m}=r;if(this.startTime===null)return o.next(0);const{delay:p,repeat:v,repeatType:T,repeatDelay:E,onUpdate:O}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-h/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const b=this.currentTime-p*(this.speed>=0?1:-1),M=this.speed>=0?b<0:b>h;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let I=this.currentTime,k=o;if(v){const j=Math.min(this.currentTime,h)/m;let Y=Math.floor(j),q=j%1;!q&&j>=1&&(q=1),q===1&&Y--,Y=Math.min(Y,v+1),!!(Y%2)&&(T==="reverse"?(q=1-q,E&&(q-=E/m)):T==="mirror"&&(k=a)),I=ga(0,1,q)*m}const $=M?{done:!1,value:u[0]}:k.next(I);c&&($.value=c($.value));let{done:P}=$;!M&&d!==null&&(P=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return D&&s!==void 0&&($.value=C1(u,this.options,s)),O&&O($.value),D&&this.finish(),$}get duration(){const{resolved:t}=this;return t?la(t.calculatedDuration):0}get time(){return la(this.currentTime)}set time(t){t=aa(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=la(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=j7,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const B7=new Set(["opacity","clipPath","filter","transform"]);function V7(e,t,n,{delay:r=0,duration:s=300,repeat:o=0,repeatType:a="loop",ease:c="easeInOut",times:u}={}){const d={[t]:n};u&&(d.offset=u);const h=LD(c,s);return Array.isArray(h)&&(d.easing=h),e.animate(d,{delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const U7=CE(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rw=10,W7=2e4;function G7(e){return UE(e.type)||e.type==="spring"||!DD(e.ease)}function K7(e,t){const n=new n2({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:e[0]};const s=[];let o=0;for(;!r.done&&o<W7;)r=n.sample(o),s.push(r.value),o+=Rw;return{times:void 0,keyframes:s,duration:o-Rw,ease:"linear"}}const gL={anticipate:HD,backInOut:KD,circInOut:QD};function H7(e){return e in gL}class Sk extends uL{constructor(t){super(t);const{name:n,motionValue:r,element:s,keyframes:o}=this.options;this.resolver=new cL(o,(a,c)=>this.onKeyframesResolved(a,c),n,r,s),this.resolver.scheduleResolve()}initPlayback(t,n){var r;let{duration:s=300,times:o,ease:a,type:c,motionValue:u,name:d,startTime:h}=this.options;if(!(!((r=u.owner)===null||r===void 0)&&r.current))return!1;if(typeof a=="string"&&Dw()&&H7(a)&&(a=gL[a]),G7(this.options)){const{onComplete:p,onUpdate:v,motionValue:T,element:E,...O}=this.options,b=K7(t,O);t=b.keyframes,t.length===1&&(t[1]=t[0]),s=b.duration,o=b.times,a=b.ease,c="keyframes"}const m=V7(u.owner.current,d,t,{...this.options,duration:s,times:o,ease:a});return m.startTime=h??this.calcStartTime(),this.pendingTimeline?(uk(m,this.pendingTimeline),this.pendingTimeline=void 0):m.onfinish=()=>{const{onComplete:p}=this.options;u.set(C1(t,this.options,n)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:m,duration:s,times:o,type:c,ease:a,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return la(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return la(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=aa(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return li;const{animation:r}=n;uk(r,t)}return li}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:r,duration:s,type:o,ease:a,times:c}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:h,onComplete:m,element:p,...v}=this.options,T=new n2({...v,keyframes:r,duration:s,type:o,ease:a,times:c,isGenerator:!0}),E=aa(this.time);d.setWithVelocity(T.sample(E-Rw).value,T.sample(E).value,Rw)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:r,repeatDelay:s,repeatType:o,damping:a,type:c}=t;return U7()&&r&&B7.has(r)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!s&&o!=="mirror"&&a!==0&&c!=="inertia"}}const q7={type:"spring",stiffness:500,damping:25,restSpeed:10},Q7=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Y7={type:"keyframes",duration:.8},X7={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},J7=(e,{keyframes:t})=>t.length>2?Y7:Yc.has(e)?e.startsWith("scale")?Q7(t[1]):q7:X7;function Z7({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const r2=(e,t,n,r={},s,o)=>a=>{const c=VE(r,e)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-aa(u);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-d,onUpdate:p=>{t.set(p),c.onUpdate&&c.onUpdate(p)},onComplete:()=>{a(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:o?void 0:s};Z7(c)||(h={...h,...J7(e,h)}),h.duration&&(h.duration=aa(h.duration)),h.repeatDelay&&(h.repeatDelay=aa(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let m=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(m=!0)),m&&!o&&t.get()!==void 0){const p=C1(h.keyframes,c);if(p!==void 0)return hr.update(()=>{h.onUpdate(p),h.onComplete()}),new vW([])}return!o&&Sk.supports(h)?new Sk(h):new n2(h)};function eG({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function _L(e,t,{delay:n=0,transitionOverride:r,type:s}={}){var o;let{transition:a=e.getDefaultTransition(),transitionEnd:c,...u}=t;r&&(a=r);const d=[],h=s&&e.animationState&&e.animationState.getState()[s];for(const m in u){const p=e.getValue(m,(o=e.latestValues[m])!==null&&o!==void 0?o:null),v=u[m];if(v===void 0||h&&eG(h,m))continue;const T={delay:n,...VE(a||{},m)};let E=!1;if(window.MotionHandoffAnimation){const b=BD(e);if(b){const M=window.MotionHandoffAnimation(b,m,hr);M!==null&&(T.startTime=M,E=!0)}}jM(e,m),p.start(r2(m,p,v,e.shouldReduceMotion&&ND.has(m)?{type:!1}:T,e,E));const O=p.animation;O&&d.push(O)}return c&&Promise.all(d).then(()=>{hr.update(()=>{c&&OW(e,c)})}),d}function GM(e,t,n={}){var r;const s=S1(e,t,n.type==="exit"?(r=e.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const a=s?()=>Promise.all(_L(e,s,n)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:h=0,staggerChildren:m,staggerDirection:p}=o;return tG(e,t,h+d,m,p,n)}:()=>Promise.resolve(),{when:u}=o;if(u){const[d,h]=u==="beforeChildren"?[a,c]:[c,a];return d().then(()=>h())}else return Promise.all([a(),c(n.delay)])}function tG(e,t,n=0,r=0,s=1,o){const a=[],c=(e.variantChildren.size-1)*r,u=s===1?(d=0)=>d*r:(d=0)=>c-d*r;return Array.from(e.variantChildren).sort(nG).forEach((d,h)=>{d.notify("AnimationStart",t),a.push(GM(d,t,{...o,delay:n+u(h)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function nG(e,t){return e.sortNodePosition(t)}function rG(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(o=>GM(e,o,n));r=Promise.all(s)}else if(typeof t=="string")r=GM(e,t,n);else{const s=typeof t=="function"?S1(e,t,n.custom):t;r=Promise.all(_L(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}const sG=AE.length;function yL(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?yL(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<sG;n++){const r=AE[n],s=e.props[r];(O0(s)||s===!1)&&(t[r]=s)}return t}const iG=[...kE].reverse(),oG=kE.length;function aG(e){return t=>Promise.all(t.map(({animation:n,options:r})=>rG(e,n,r)))}function lG(e){let t=aG(e),n=Ck(),r=!0;const s=u=>(d,h)=>{var m;const p=S1(e,h,u==="exit"?(m=e.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(p){const{transition:v,transitionEnd:T,...E}=p;d={...d,...E,...T}}return d};function o(u){t=u(e)}function a(u){const{props:d}=e,h=yL(e.parent)||{},m=[],p=new Set;let v={},T=1/0;for(let O=0;O<oG;O++){const b=iG[O],M=n[b],I=d[b]!==void 0?d[b]:h[b],k=O0(I),$=b===u?M.isActive:null;$===!1&&(T=O);let P=I===h[b]&&I!==d[b]&&k;if(P&&r&&e.manuallyAnimateOnMount&&(P=!1),M.protectedKeys={...v},!M.isActive&&$===null||!I&&!M.prevProp||E1(I)||typeof I=="boolean")continue;const D=cG(M.prevProp,I);let j=D||b===u&&M.isActive&&!P&&k||O>T&&k,Y=!1;const q=Array.isArray(I)?I:[I];let oe=q.reduce(s(b),{});$===!1&&(oe={});const{prevResolvedValues:de={}}=M,re={...de,...oe},he=xe=>{j=!0,p.has(xe)&&(Y=!0,p.delete(xe)),M.needsAnimating[xe]=!0;const te=e.getValue(xe);te&&(te.liveStyle=!1)};for(const xe in re){const te=oe[xe],ke=de[xe];if(v.hasOwnProperty(xe))continue;let De=!1;LM(te)&&LM(ke)?De=!$D(te,ke):De=te!==ke,De?te!=null?he(xe):p.add(xe):te!==void 0&&p.has(xe)?he(xe):M.protectedKeys[xe]=!0}M.prevProp=I,M.prevResolvedValues=oe,M.isActive&&(v={...v,...oe}),r&&e.blockInitialAnimation&&(j=!1),j&&(!(P&&D)||Y)&&m.push(...q.map(xe=>({animation:xe,options:{type:b}})))}if(p.size){const O={};p.forEach(b=>{const M=e.getBaseTarget(b),I=e.getValue(b);I&&(I.liveStyle=!0),O[b]=M??null}),m.push({animation:O})}let E=!!m.length;return r&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(E=!1),r=!1,E?t(m):Promise.resolve()}function c(u,d){var h;if(n[u].isActive===d)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(p=>{var v;return(v=p.animationState)===null||v===void 0?void 0:v.setActive(u,d)}),n[u].isActive=d;const m=a(u);for(const p in n)n[p].protectedKeys={};return m}return{animateChanges:a,setActive:c,setAnimateFunction:o,getState:()=>n,reset:()=>{n=Ck(),r=!0}}}function cG(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!$D(t,e):!1}function yc(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ck(){return{animate:yc(!0),whileInView:yc(),whileHover:yc(),whileTap:yc(),whileDrag:yc(),whileFocus:yc(),exit:yc()}}class Ll{constructor(t){this.isMounted=!1,this.node=t}update(){}}class uG extends Ll{constructor(t){super(t),t.animationState||(t.animationState=lG(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();E1(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let dG=0;class hG extends Ll{constructor(){super(...arguments),this.id=dG++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const fG={animation:{Feature:uG},exit:{Feature:hG}};function R0(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function ey(e){return{point:{x:e.pageX,y:e.pageY}}}const pG=e=>t=>GE(t)&&e(t,ey(t));function s0(e,t,n,r){return R0(e,t,pG(n),r)}const kk=(e,t)=>Math.abs(e-t);function mG(e,t){const n=kk(e.x,t.x),r=kk(e.y,t.y);return Math.sqrt(n**2+r**2)}class vL{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=ax(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,v=mG(m.offset,{x:0,y:0})>=3;if(!p&&!v)return;const{point:T}=m,{timestamp:E}=ss;this.history.push({...T,timestamp:E});const{onStart:O,onMove:b}=this.handlers;p||(O&&O(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=ox(p,this.transformPagePoint),hr.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:v,onSessionEnd:T,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const O=ax(m.type==="pointercancel"?this.lastMoveEventInfo:ox(p,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,O),T&&T(m,O)},!GE(t))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=ey(t),c=ox(a,this.transformPagePoint),{point:u}=c,{timestamp:d}=ss;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=n;h&&h(t,ax(c,this.history)),this.removeListeners=Z0(s0(this.contextWindow,"pointermove",this.handlePointerMove),s0(this.contextWindow,"pointerup",this.handlePointerUp),s0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),kl(this.updatePoint)}}function ox(e,t){return t?{point:t(e.point)}:e}function Ak(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ax({point:e},t){return{point:e,delta:Ak(e,wL(t)),offset:Ak(e,gG(t)),velocity:_G(t,.1)}}function gG(e){return e[0]}function wL(e){return e[e.length-1]}function _G(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=wL(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>aa(t)));)n--;if(!r)return{x:0,y:0};const o=la(s.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const a={x:(s.x-r.x)/o,y:(s.y-r.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const bL=1e-4,yG=1-bL,vG=1+bL,xL=.01,wG=0-xL,bG=0+xL;function ui(e){return e.max-e.min}function xG(e,t,n){return Math.abs(e-t)<=n}function $k(e,t,n,r=.5){e.origin=r,e.originPoint=xr(t.min,t.max,e.origin),e.scale=ui(n)/ui(t),e.translate=xr(n.min,n.max,e.origin)-e.originPoint,(e.scale>=yG&&e.scale<=vG||isNaN(e.scale))&&(e.scale=1),(e.translate>=wG&&e.translate<=bG||isNaN(e.translate))&&(e.translate=0)}function i0(e,t,n,r){$k(e.x,t.x,n.x,r?r.originX:void 0),$k(e.y,t.y,n.y,r?r.originY:void 0)}function Ik(e,t,n){e.min=n.min+t.min,e.max=e.min+ui(t)}function MG(e,t,n){Ik(e.x,t.x,n.x),Ik(e.y,t.y,n.y)}function Ok(e,t,n){e.min=t.min-n.min,e.max=e.min+ui(t)}function o0(e,t,n){Ok(e.x,t.x,n.x),Ok(e.y,t.y,n.y)}function TG(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?xr(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?xr(n,e,r.max):Math.min(e,n)),e}function Dk(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function EG(e,{top:t,left:n,bottom:r,right:s}){return{x:Dk(e.x,n,s),y:Dk(e.y,t,r)}}function Lk(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function PG(e,t){return{x:Lk(e.x,t.x),y:Lk(e.y,t.y)}}function SG(e,t){let n=.5;const r=ui(e),s=ui(t);return s>r?n=qh(t.min,t.max-r,e.min):r>s&&(n=qh(e.min,e.max-s,t.min)),ga(0,1,n)}function CG(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const KM=.35;function kG(e=KM){return e===!1?e=0:e===!0&&(e=KM),{x:Fk(e,"left","right"),y:Fk(e,"top","bottom")}}function Fk(e,t,n){return{min:Rk(e,t),max:Rk(e,n)}}function Rk(e,t){return typeof e=="number"?e:e[t]||0}const jk=()=>({translate:0,scale:1,origin:0,originPoint:0}),mh=()=>({x:jk(),y:jk()}),Nk=()=>({min:0,max:0}),jr=()=>({x:Nk(),y:Nk()});function xi(e){return[e("x"),e("y")]}function ML({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function AG({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $G(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function lx(e){return e===void 0||e===1}function HM({scale:e,scaleX:t,scaleY:n}){return!lx(e)||!lx(t)||!lx(n)}function xc(e){return HM(e)||TL(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function TL(e){return zk(e.x)||zk(e.y)}function zk(e){return e&&e!=="0%"}function jw(e,t,n){const r=e-n,s=t*r;return n+s}function Bk(e,t,n,r,s){return s!==void 0&&(e=jw(e,s,r)),jw(e,n,r)+t}function qM(e,t=0,n=1,r,s){e.min=Bk(e.min,t,n,r,s),e.max=Bk(e.max,t,n,r,s)}function EL(e,{x:t,y:n}){qM(e.x,t.translate,t.scale,t.originPoint),qM(e.y,n.translate,n.scale,n.originPoint)}const Vk=.999999999999,Uk=1.0000000000001;function IG(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let o,a;for(let c=0;c<s;c++){o=n[c],a=o.projectionDelta;const{visualElement:u}=o.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&_h(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,EL(e,a)),r&&xc(o.latestValues)&&_h(e,o.latestValues))}t.x<Uk&&t.x>Vk&&(t.x=1),t.y<Uk&&t.y>Vk&&(t.y=1)}function gh(e,t){e.min=e.min+t,e.max=e.max+t}function Wk(e,t,n,r,s=.5){const o=xr(e.min,e.max,s);qM(e,t,n,o,r)}function _h(e,t){Wk(e.x,t.x,t.scaleX,t.scale,t.originX),Wk(e.y,t.y,t.scaleY,t.scale,t.originY)}function PL(e,t){return ML($G(e.getBoundingClientRect(),t))}function OG(e,t,n){const r=PL(e,n),{scroll:s}=t;return s&&(gh(r.x,s.offset.x),gh(r.y,s.offset.y)),r}const SL=({current:e})=>e?e.ownerDocument.defaultView:null,DG=new WeakMap;class LG{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=jr(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=h=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(ey(h).point)},o=(h,m)=>{const{drag:p,dragPropagation:v,onDragStart:T}=this.getProps();if(p&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=CW(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xi(O=>{let b=this.getAxisMotionValue(O).get()||0;if($o.test(b)){const{projection:M}=this.visualElement;if(M&&M.layout){const I=M.layout.layoutBox[O];I&&(b=ui(I)*(parseFloat(b)/100))}}this.originPoint[O]=b}),T&&hr.postRender(()=>T(h,m)),jM(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},a=(h,m)=>{const{dragPropagation:p,dragDirectionLock:v,onDirectionLock:T,onDrag:E}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:O}=m;if(v&&this.currentDirection===null){this.currentDirection=FG(O),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",m.point,O),this.updateAxis("y",m.point,O),this.visualElement.render(),E&&E(h,m)},c=(h,m)=>this.stop(h,m),u=()=>xi(h=>{var m;return this.getAnimationState(h)==="paused"&&((m=this.getAxisMotionValue(h).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new vL(t,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:SL(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&hr.postRender(()=>o(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!Iv(t,s,this.currentDirection))return;const o=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=TG(a,this.constraints[t],this.elastic[t])),o.set(a)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;n&&fh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=EG(s.layoutBox,n):this.constraints=!1,this.elastic=kG(r),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&xi(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=CG(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!fh(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=OG(r,s.root,this.visualElement.getTransformPagePoint());let a=PG(s.layout.layoutBox,o);if(n){const c=n(AG(a));this.hasMutatedConstraints=!!c,c&&(a=ML(c))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=xi(h=>{if(!Iv(h,n,this.currentDirection))return;let m=u&&u[h]||{};a&&(m={min:0,max:0});const p=s?200:1e6,v=s?40:1e7,T={type:"inertia",velocity:r?t[h]:0,bounceStiffness:p,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...o,...m};return this.startAxisValueAnimation(h,T)});return Promise.all(d).then(c)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return jM(this.visualElement,t),r.start(r2(t,r,0,n,this.visualElement,!1))}stopAnimation(){xi(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){xi(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){xi(n=>{const{drag:r}=this.getProps();if(!Iv(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:c}=s.layout.layoutBox[n];o.set(t[n]-xr(a,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!fh(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};xi(a=>{const c=this.getAxisMotionValue(a);if(c&&this.constraints!==!1){const u=c.get();s[a]=SG({min:u,max:u},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),xi(a=>{if(!Iv(a,t,null))return;const c=this.getAxisMotionValue(a),{min:u,max:d}=this.constraints[a];c.set(xr(u,d,s[a]))})}addListeners(){if(!this.visualElement.current)return;DG.set(this.visualElement,this);const t=this.visualElement.current,n=s0(t,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();fh(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),hr.read(r);const a=R0(window,"resize",()=>this.scalePositionWithinConstraints()),c=s.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(xi(h=>{const m=this.getAxisMotionValue(h);m&&(this.originPoint[h]+=u[h].translate,m.set(m.get()+u[h].translate))}),this.visualElement.render())});return()=>{a(),n(),o(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:a=KM,dragMomentum:c=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:o,dragElastic:a,dragMomentum:c}}}function Iv(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function FG(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class RG extends Ll{constructor(t){super(t),this.removeGroupControls=li,this.removeListeners=li,this.controls=new LG(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||li}unmount(){this.removeGroupControls(),this.removeListeners()}}const Gk=e=>(t,n)=>{e&&hr.postRender(()=>e(t,n))};class jG extends Ll{constructor(){super(...arguments),this.removePointerDownListener=li}onPointerDown(t){this.session=new vL(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:SL(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Gk(t),onStart:Gk(n),onMove:r,onEnd:(o,a)=>{delete this.session,s&&hr.postRender(()=>s(o,a))}}}mount(){this.removePointerDownListener=s0(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Xv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Kk(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const O_={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(an.test(e))e=parseFloat(e);else return e;const n=Kk(e,t.target.x),r=Kk(e,t.target.y);return`${n}% ${r}%`}},NG={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Al.parse(e);if(s.length>5)return r;const o=Al.createTransformer(e),a=typeof s[0]!="number"?1:0,c=n.x.scale*t.x,u=n.y.scale*t.y;s[0+a]/=c,s[1+a]/=u;const d=xr(c,u,.5);return typeof s[2+a]=="number"&&(s[2+a]/=d),typeof s[3+a]=="number"&&(s[3+a]/=d),o(s)}};class zG extends B.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:o}=t;aW(BG),o&&(n.group&&n.group.add(o),r&&r.register&&s&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Xv.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:o}=this.props,a=r.projection;return a&&(a.isPresent=o,s||t.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?a.promote():a.relegate()||hr.postRender(()=>{const c=a.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),IE.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function CL(e){const[t,n]=dD(),r=B.useContext(TE);return R.jsx(zG,{...e,layoutGroup:r,switchLayoutGroup:B.useContext(yD),isPresent:t,safeToRemove:n})}const BG={borderRadius:{...O_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:O_,borderTopRightRadius:O_,borderBottomLeftRadius:O_,borderBottomRightRadius:O_,boxShadow:NG};function VG(e,t,n){const r=vs(e)?e:L0(e);return r.start(r2("",r,t,n)),r.animation}function UG(e){return e instanceof SVGElement&&e.tagName!=="svg"}const WG=(e,t)=>e.depth-t.depth;class GG{constructor(){this.children=[],this.isDirty=!1}add(t){KE(this.children,t),this.isDirty=!0}remove(t){HE(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(WG),this.isDirty=!1,this.children.forEach(t)}}function KG(e,t){const n=Io.now(),r=({timestamp:s})=>{const o=s-n;o>=t&&(kl(r),e(o-t))};return hr.read(r,!0),()=>kl(r)}const kL=["TopLeft","TopRight","BottomLeft","BottomRight"],HG=kL.length,Hk=e=>typeof e=="string"?parseFloat(e):e,qk=e=>typeof e=="number"||an.test(e);function qG(e,t,n,r,s,o){s?(e.opacity=xr(0,n.opacity!==void 0?n.opacity:1,QG(r)),e.opacityExit=xr(t.opacity!==void 0?t.opacity:1,0,YG(r))):o&&(e.opacity=xr(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let a=0;a<HG;a++){const c=`border${kL[a]}Radius`;let u=Qk(t,c),d=Qk(n,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||qk(u)===qk(d)?(e[c]=Math.max(xr(Hk(u),Hk(d),r),0),($o.test(d)||$o.test(u))&&(e[c]+="%")):e[c]=d}(t.rotate||n.rotate)&&(e.rotate=xr(t.rotate||0,n.rotate||0,r))}function Qk(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const QG=AL(0,.5,qD),YG=AL(.5,.95,li);function AL(e,t,n){return r=>r<e?0:r>t?1:n(qh(e,t,r))}function Yk(e,t){e.min=t.min,e.max=t.max}function bi(e,t){Yk(e.x,t.x),Yk(e.y,t.y)}function Xk(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Jk(e,t,n,r,s){return e-=t,e=jw(e,1/n,r),s!==void 0&&(e=jw(e,1/s,r)),e}function XG(e,t=0,n=1,r=.5,s,o=e,a=e){if($o.test(t)&&(t=parseFloat(t),t=xr(a.min,a.max,t/100)-a.min),typeof t!="number")return;let c=xr(o.min,o.max,r);e===o&&(c-=t),e.min=Jk(e.min,t,n,c,s),e.max=Jk(e.max,t,n,c,s)}function Zk(e,t,[n,r,s],o,a){XG(e,t[n],t[r],t[s],t.scale,o,a)}const JG=["x","scaleX","originX"],ZG=["y","scaleY","originY"];function eA(e,t,n,r){Zk(e.x,t,JG,n?n.x:void 0,r?r.x:void 0),Zk(e.y,t,ZG,n?n.y:void 0,r?r.y:void 0)}function tA(e){return e.translate===0&&e.scale===1}function $L(e){return tA(e.x)&&tA(e.y)}function nA(e,t){return e.min===t.min&&e.max===t.max}function eK(e,t){return nA(e.x,t.x)&&nA(e.y,t.y)}function rA(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function IL(e,t){return rA(e.x,t.x)&&rA(e.y,t.y)}function sA(e){return ui(e.x)/ui(e.y)}function iA(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class tK{constructor(){this.members=[]}add(t){KE(this.members,t),t.scheduleRender()}remove(t){if(HE(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function nK(e,t,n){let r="";const s=e.x.translate/t.x,o=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||o||a)&&(r=`translate3d(${s}px, ${o}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:d,rotate:h,rotateX:m,rotateY:p,skewX:v,skewY:T}=n;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),m&&(r+=`rotateX(${m}deg) `),p&&(r+=`rotateY(${p}deg) `),v&&(r+=`skewX(${v}deg) `),T&&(r+=`skewY(${T}deg) `)}const c=e.x.scale*t.x,u=e.y.scale*t.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Mc={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},V_=typeof window<"u"&&window.MotionDebug!==void 0,cx=["","X","Y","Z"],rK={visibility:"hidden"},oA=1e3;let sK=0;function ux(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function OL(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=BD(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:o}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",hr,!(s||o))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&OL(r)}function DL({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},c=t==null?void 0:t()){this.id=sK++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,V_&&(Mc.totalNodes=Mc.resolvedTargetDeltas=Mc.recalculatedProjection=0),this.nodes.forEach(aK),this.nodes.forEach(hK),this.nodes.forEach(fK),this.nodes.forEach(lK),V_&&window.MotionDebug.record(Mc)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new GG)}addEventListener(a,c){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new qE),this.eventHandlers.get(a).add(c)}notifyListeners(a,...c){const u=this.eventHandlers.get(a);u&&u.notify(...c)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=UG(a),this.instance=a;const{layoutId:u,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(d||u)&&(this.isLayoutDirty=!0),e){let m;const p=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=KG(p,250),Xv.hasAnimatedSinceResize&&(Xv.hasAnimatedSinceResize=!1,this.nodes.forEach(lA))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||d)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:p,hasRelativeTargetChanged:v,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const E=this.options.transition||h.getDefaultTransition()||yK,{onLayoutAnimationStart:O,onLayoutAnimationComplete:b}=h.getProps(),M=!this.targetLayout||!IL(this.targetLayout,T)||v,I=!p&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||p&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,I);const k={...VE(E,"layout"),onPlay:O,onComplete:b};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else p||lA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,kl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(pK),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&OL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const m=this.path[h];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(aA);return}this.isUpdating||this.nodes.forEach(uK),this.isUpdating=!1,this.nodes.forEach(dK),this.nodes.forEach(iK),this.nodes.forEach(oK),this.clearAllSnapshots();const c=Io.now();ss.delta=ga(0,1e3/60,c-ss.timestamp),ss.timestamp=c,ss.isProcessing=!0,ex.update.process(ss),ex.preRender.process(ss),ex.render.process(ss),ss.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,IE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(cK),this.sharedNodes.forEach(mK)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,hr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){hr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=jr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(c=!1),c){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!$L(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;a&&(c||xc(this.latestValues)||h)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return a&&(u=this.removeTransform(u)),vK(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:c}=this.options;if(!c)return jr();const u=c.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(wK))){const{scroll:h}=this.root;h&&(gh(u.x,h.offset.x),gh(u.y,h.offset.y))}return u}removeElementScroll(a){var c;const u=jr();if(bi(u,a),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return u;for(let d=0;d<this.path.length;d++){const h=this.path[d],{scroll:m,options:p}=h;h!==this.root&&m&&p.layoutScroll&&(m.wasRoot&&bi(u,a),gh(u.x,m.offset.x),gh(u.y,m.offset.y))}return u}applyTransform(a,c=!1){const u=jr();bi(u,a);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&_h(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),xc(h.latestValues)&&_h(u,h.latestValues)}return xc(this.latestValues)&&_h(u,this.latestValues),u}removeTransform(a){const c=jr();bi(c,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!xc(d.latestValues))continue;HM(d.latestValues)&&d.updateSnapshot();const h=jr(),m=d.measurePageBox();bi(h,m),eA(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return xc(this.latestValues)&&eA(c,this.latestValues),c}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ss.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var c;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==u;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:p}=this.options;if(!(!this.layout||!(m||p))){if(this.resolvedRelativeTargetAt=ss.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jr(),this.relativeTargetOrigin=jr(),o0(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),bi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=jr(),this.targetWithTransforms=jr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),MG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):bi(this.target,this.layout.layoutBox),EL(this.target,this.targetDelta)):bi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jr(),this.relativeTargetOrigin=jr(),o0(this.relativeTargetOrigin,this.target,v.target),bi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}V_&&Mc.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||HM(this.parent.latestValues)||TL(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const c=this.getLead(),u=!!this.resumingFrom||this!==c;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===ss.timestamp&&(d=!1),d)return;const{layout:h,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||m))return;bi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,v=this.treeScale.y;IG(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=jr());const{target:T}=c;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Xk(this.prevProjectionDelta.x,this.projectionDelta.x),Xk(this.prevProjectionDelta.y,this.projectionDelta.y)),i0(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==v||!iA(this.projectionDelta.x,this.prevProjectionDelta.x)||!iA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),V_&&Mc.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),a){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mh(),this.projectionDelta=mh(),this.projectionDeltaWithTransform=mh()}setAnimationOrigin(a,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},m=mh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const p=jr(),v=u?u.source:void 0,T=this.layout?this.layout.source:void 0,E=v!==T,O=this.getStack(),b=!O||O.members.length<=1,M=!!(E&&!b&&this.options.crossfade===!0&&!this.path.some(_K));this.animationProgress=0;let I;this.mixTargetDelta=k=>{const $=k/1e3;cA(m.x,a.x,$),cA(m.y,a.y,$),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(o0(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),gK(this.relativeTarget,this.relativeTargetOrigin,p,$),I&&eK(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=jr()),bi(I,this.relativeTarget)),E&&(this.animationValues=h,qG(h,d,this.latestValues,$,M,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=$},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(kl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=hr.update(()=>{Xv.hasAnimatedSinceResize=!0,this.currentAnimation=VG(0,oA,{...a,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(oA),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=a;if(!(!c||!u||!d)){if(this!==a&&this.layout&&d&&LL(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||jr();const m=ui(this.layout.layoutBox.x);u.x.min=a.target.x.min,u.x.max=u.x.min+m;const p=ui(this.layout.layoutBox.y);u.y.min=a.target.y.min,u.y.max=u.y.min+p}bi(c,u),_h(c,h),i0(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(a,c){this.sharedNodes.has(a)||this.sharedNodes.set(a,new tK),this.sharedNodes.get(a).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:c}=this.options;return c?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:c}=this.options;return c?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),a&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let c=!1;const{latestValues:u}=a;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&ux("z",a,d,this.animationValues);for(let h=0;h<cx.length;h++)ux(`rotate${cx[h]}`,a,d,this.animationValues),ux(`skew${cx[h]}`,a,d,this.animationValues);a.render();for(const h in d)a.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);a.scheduleRender()}getProjectionStyles(a){var c,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return rK;const d={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Qv(a==null?void 0:a.pointerEvents)||"",d.transform=h?h(this.latestValues,""):"none",d;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const E={};return this.options.layoutId&&(E.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,E.pointerEvents=Qv(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!xc(this.latestValues)&&(E.transform=h?h({},""):"none",this.hasProjected=!1),E}const p=m.animationValues||m.latestValues;this.applyTransformsToTarget(),d.transform=nK(this.projectionDeltaWithTransform,this.treeScale,p),h&&(d.transform=h(p,d.transform));const{x:v,y:T}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${T.origin*100}% 0`,m.animationValues?d.opacity=m===this?(u=(c=p.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=m===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const E in Ow){if(p[E]===void 0)continue;const{correct:O,applyTo:b}=Ow[E],M=d.transform==="none"?p[E]:O(p[E],m);if(b){const I=b.length;for(let k=0;k<I;k++)d[b[k]]=M}else d[E]=M}return this.options.layoutId&&(d.pointerEvents=m===this?Qv(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var c;return(c=a.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(aA),this.root.sharedNodes.clear()}}}function iK(e){e.updateLayout()}function oK(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:o}=e.options,a=n.source!==e.layout.source;o==="size"?xi(m=>{const p=a?n.measuredBox[m]:n.layoutBox[m],v=ui(p);p.min=r[m].min,p.max=p.min+v}):LL(o,n.layoutBox,r)&&xi(m=>{const p=a?n.measuredBox[m]:n.layoutBox[m],v=ui(r[m]);p.max=p.min+v,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+v)});const c=mh();i0(c,r,n.layoutBox);const u=mh();a?i0(u,e.applyTransform(s,!0),n.measuredBox):i0(u,r,n.layoutBox);const d=!$L(c);let h=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:p,layout:v}=m;if(p&&v){const T=jr();o0(T,n.layoutBox,p.layoutBox);const E=jr();o0(E,r,v.layoutBox),IL(T,E)||(h=!0),m.options.layoutRoot&&(e.relativeTarget=E,e.relativeTargetOrigin=T,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:u,layoutDelta:c,hasLayoutChanged:d,hasRelativeTargetChanged:h})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function aK(e){V_&&Mc.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function lK(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function cK(e){e.clearSnapshot()}function aA(e){e.clearMeasurements()}function uK(e){e.isLayoutDirty=!1}function dK(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function lA(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function hK(e){e.resolveTargetDelta()}function fK(e){e.calcProjection()}function pK(e){e.resetSkewAndRotation()}function mK(e){e.removeLeadSnapshot()}function cA(e,t,n){e.translate=xr(t.translate,0,n),e.scale=xr(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function uA(e,t,n,r){e.min=xr(t.min,n.min,r),e.max=xr(t.max,n.max,r)}function gK(e,t,n,r){uA(e.x,t.x,n.x,r),uA(e.y,t.y,n.y,r)}function _K(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const yK={duration:.45,ease:[.4,0,.1,1]},dA=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),hA=dA("applewebkit/")&&!dA("chrome/")?Math.round:li;function fA(e){e.min=hA(e.min),e.max=hA(e.max)}function vK(e){fA(e.x),fA(e.y)}function LL(e,t,n){return e==="position"||e==="preserve-aspect"&&!xG(sA(t),sA(n),.2)}function wK(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const bK=DL({attachResizeListener:(e,t)=>R0(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),dx={current:void 0},FL=DL({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!dx.current){const e=new bK({});e.mount(window),e.setOptions({layoutScroll:!0}),dx.current=e}return dx.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),xK={pan:{Feature:jG},drag:{Feature:RG,ProjectionNode:FL,MeasureLayout:CL}};function pA(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,o=r[s];o&&hr.postRender(()=>o(t,ey(t)))}class MK extends Ll{mount(){const{current:t}=this.node;t&&(this.unmount=MW(t,n=>(pA(this.node,n,"Start"),r=>pA(this.node,r,"End"))))}unmount(){}}class TK extends Ll{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Z0(R0(this.node.current,"focus",()=>this.onFocus()),R0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function mA(e,t,n){const{props:r}=e;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),o=r[s];o&&hr.postRender(()=>o(t,ey(t)))}class EK extends Ll{mount(){const{current:t}=this.node;t&&(this.unmount=SW(t,n=>(mA(this.node,n,"Start"),(r,{success:s})=>mA(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const QM=new WeakMap,hx=new WeakMap,PK=e=>{const t=QM.get(e.target);t&&t(e)},SK=e=>{e.forEach(PK)};function CK({root:e,...t}){const n=e||document;hx.has(n)||hx.set(n,{});const r=hx.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(SK,{root:e,...t})),r[s]}function kK(e,t,n){const r=CK(t);return QM.set(e,n),r.observe(e),()=>{QM.delete(e),r.unobserve(e)}}const AK={some:0,all:1};class $K extends Ll{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:o}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:AK[s]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:m}=this.node.getProps(),p=d?h:m;p&&p(u)};return kK(this.node.current,a,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(IK(t,n))&&this.startObserver()}unmount(){}}function IK({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const OK={inView:{Feature:$K},tap:{Feature:EK},focus:{Feature:TK},hover:{Feature:MK}},DK={layout:{ProjectionNode:FL,MeasureLayout:CL}},YM={current:null},RL={current:!1};function LK(){if(RL.current=!0,!!SE)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>YM.current=e.matches;e.addListener(t),t()}else YM.current=!1}const FK=[...lL,_s,Al],RK=e=>FK.find(aL(e)),gA=new WeakMap;function jK(e,t,n){for(const r in t){const s=t[r],o=n[r];if(vs(s))e.addValue(r,s);else if(vs(o))e.addValue(r,L0(s,{owner:e}));else if(o!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,L0(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const _A=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class NK{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:o,visualState:a},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=e2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=Io.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,hr.render(this.render,!1,!0))};const{latestValues:u,renderState:d,onUpdate:h}=a;this.onUpdate=h,this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=c,this.blockInitialAnimation=!!o,this.isControllingVariants=P1(n),this.isVariantNode=gD(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:m,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const v in p){const T=p[v];u[v]!==void 0&&vs(T)&&T.set(u[v],!1)}}mount(t){this.current=t,gA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),RL.current||LK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:YM.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){gA.delete(this.current),this.projection&&this.projection.unmount(),kl(this.notifyUpdate),kl(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Yc.has(t),s=n.on("change",c=>{this.latestValues[t]=c,this.props.onUpdate&&hr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),o(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Qh){const n=Qh[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const o=this.features[t];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):jr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<_A.length;r++){const s=_A[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,a=t[o];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=jK(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=L0(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){var r;let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(iL(s)||YD(s))?s=parseFloat(s):!RK(s)&&Al.test(n)&&(s=nL(t,n)),this.setBaseTarget(t,vs(s)?s.get():s)),vs(s)?s.get():s}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const a=DE(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(s=a[t])}if(r&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!vs(o)?o:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new qE),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class jL extends NK{constructor(){super(...arguments),this.KeyframeResolver=cL}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;vs(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function zK(e){return window.getComputedStyle(e)}class BK extends jL{constructor(){super(...arguments),this.type="html",this.renderInstance=ED}readValueFromInstance(t,n){if(Yc.has(n)){const r=ZE(n);return r&&r.default||0}else{const r=zK(t),s=(xD(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return PL(t,n)}build(t,n,r){RE(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return BE(t,n,r)}}class VK extends jL{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=jr}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Yc.has(n)){const r=ZE(n);return r&&r.default||0}return n=PD.has(n)?n:$E(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return kD(t,n,r)}build(t,n,r){jE(t,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,n,r,s){SD(t,n,r,s)}mount(t){this.isSVGTag=zE(t.tagName),super.mount(t)}}const UK=(e,t)=>OE(e)?new VK(t):new BK(t,{allowProjection:e!==B.Fragment}),WK=gW({...fG,...OK,...xK,...DK},UK),Nt=$9(WK),GK=({isPaused:e,setIsPaused:t,handleNextStep:n,isProcessing:r,canProgress:s})=>{const o={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return R.jsxs(Nt.div,{className:"flex justify-center gap-4 my-4",variants:o,initial:"hidden",animate:"visible",children:[R.jsx(ma,{variant:"outline",onClick:()=>t(!e),disabled:!r,className:"transition-all duration-300 hover:scale-105",children:e?"Resume":"Pause"}),R.jsx(ma,{onClick:n,disabled:!r||!s,className:"transition-all duration-300 hover:scale-105",children:"Next Step"})]})},KK=({step:e,index:t,currentStep:n,layerOutput:r})=>{var a,c,u,d;const s={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:t*.1}}},o={hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{duration:.4,ease:"easeOut"}}};return R.jsxs(Nt.div,{variants:s,initial:"hidden",animate:"visible",className:`p-4 rounded-lg ${t===n?"bg-blue-100 shadow-lg":"bg-white"}`,style:{scale:t===n?1.02:1,opacity:t<=n?1:.5,transition:"all 0.3s ease-out"},children:[R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h4",{className:"font-semibold",children:e.title}),R.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),R.jsx(Nt.div,{className:"bg-blue-200 px-3 py-1 rounded text-sm font-mono",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.formula})]}),t===n&&R.jsx(Nt.div,{variants:o,initial:"hidden",animate:"visible",className:"mt-4 bg-blue-50 p-4 rounded-lg space-y-4",children:R.jsxs("div",{children:[R.jsx("h5",{className:"font-medium text-lg",children:e.explanation.title}),R.jsx("p",{className:"text-gray-700 mt-2",children:e.explanation.simpleExplanation}),R.jsx("p",{className:"text-gray-600 mt-2",children:e.explanation.vectorExplanation}),R.jsx("p",{className:"text-gray-600 mt-2 italic",children:e.explanation.example})]})}),R.jsx(Nt.ul,{className:"mt-2 space-y-1",variants:o,children:e.details.map((h,m)=>R.jsx(Nt.li,{className:"text-sm text-gray-600",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:m*.1},children:h},m))}),r&&t===n&&R.jsxs(Nt.div,{className:"mt-4 space-y-3 bg-blue-50 p-3 rounded",variants:o,initial:"hidden",animate:"visible",children:[((a=r.intermediateOutputs)==null?void 0:a.queryVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-blue-700",children:"Query Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:r.intermediateOutputs.queryVectors.map((h,m)=>R.jsxs("div",{children:["[",h.map(p=>p.toFixed(3)).join(", "),"]"]},m))})]}),((c=r.intermediateOutputs)==null?void 0:c.keyVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-blue-700",children:"Key Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:r.intermediateOutputs.keyVectors.map((h,m)=>R.jsxs("div",{children:["[",h.map(p=>p.toFixed(3)).join(", "),"]"]},m))})]}),((u=r.intermediateOutputs)==null?void 0:u.valueVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-blue-700",children:"Value Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:r.intermediateOutputs.valueVectors.map((h,m)=>R.jsxs("div",{children:["[",h.map(p=>p.toFixed(3)).join(", "),"]"]},m))})]}),((d=r.intermediateOutputs)==null?void 0:d.weightedSum)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-blue-700",children:"Weighted Sum:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:r.intermediateOutputs.weightedSum.map((h,m)=>R.jsxs("div",{children:["[",h.map(p=>p.toFixed(3)).join(", "),"]"]},m))})]})]})]})},HK=({step:e,index:t,currentStep:n,encoderStepsLength:r,layerOutput:s})=>{var c,u,d,h;const o={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:t*.1}}},a={hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{duration:.4,ease:"easeOut"}}};return R.jsxs(Nt.div,{variants:o,initial:"hidden",animate:"visible",className:`p-4 rounded-lg ${t+r===n?"bg-green-100 shadow-lg":"bg-white"}`,style:{scale:t+r===n?1.02:1,opacity:t+r<=n?1:.5,transition:"all 0.3s ease-out"},children:[R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h4",{className:"font-semibold",children:e.title}),R.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),R.jsx(Nt.div,{className:"bg-green-200 px-3 py-1 rounded text-sm font-mono",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.formula})]}),t+r===n&&R.jsx(Nt.div,{variants:a,initial:"hidden",animate:"visible",className:"mt-4 bg-green-50 p-4 rounded-lg space-y-4",children:R.jsxs("div",{children:[R.jsx("h5",{className:"font-medium text-lg",children:e.explanation.title}),R.jsx("p",{className:"text-gray-700 mt-2",children:e.explanation.simpleExplanation}),R.jsx("p",{className:"text-gray-600 mt-2",children:e.explanation.vectorExplanation}),R.jsx("p",{className:"text-gray-600 mt-2 italic",children:e.explanation.example})]})}),R.jsx(Nt.ul,{className:"mt-2 space-y-1",variants:a,children:e.details.map((m,p)=>R.jsx(Nt.li,{className:"text-sm text-gray-600",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:p*.1},children:m},p))}),s&&t+r===n&&R.jsxs(Nt.div,{className:"mt-4 space-y-3 bg-green-50 p-3 rounded",variants:a,initial:"hidden",animate:"visible",children:[((c=s.intermediateOutputs)==null?void 0:c.queryVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-green-700",children:"Query Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:s.intermediateOutputs.queryVectors.map((m,p)=>R.jsxs("div",{children:["[",m.map(v=>v.toFixed(3)).join(", "),"]"]},p))})]}),((u=s.intermediateOutputs)==null?void 0:u.keyVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-green-700",children:"Key Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:s.intermediateOutputs.keyVectors.map((m,p)=>R.jsxs("div",{children:["[",m.map(v=>v.toFixed(3)).join(", "),"]"]},p))})]}),((d=s.intermediateOutputs)==null?void 0:d.valueVectors)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-green-700",children:"Value Vectors:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:s.intermediateOutputs.valueVectors.map((m,p)=>R.jsxs("div",{children:["[",m.map(v=>v.toFixed(3)).join(", "),"]"]},p))})]}),((h=s.intermediateOutputs)==null?void 0:h.weightedSum)&&R.jsxs("div",{className:"text-sm",children:[R.jsx("div",{className:"font-medium text-green-700",children:"Weighted Sum:"}),R.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:s.intermediateOutputs.weightedSum.map((m,p)=>R.jsxs("div",{children:["[",m.map(v=>v.toFixed(3)).join(", "),"]"]},p))})]})]})]})},Ti=[{title:"Token Embeddings",description:"Converting tokens into learnable vector representations",formula:"E(x) = WᵉX",details:["1. Each token is mapped to a unique vector","2. These vectors are learned during training","3. Similar tokens have similar embeddings"],explanation:{title:"Token to Vector Conversion",simpleExplanation:"Each word or subword is converted into a vector of numbers that captures its meaning.",vectorExplanation:"The embedding vectors are learned parameters that encode semantic relationships between tokens.",example:"For example, 'king' and 'queen' would have similar but distinct vector representations."}},{title:"Positional Encoding",description:"Adding position information to token embeddings",formula:"PE(pos,2i) = sin(pos/10000^{2i/d})",details:["1. Generate unique patterns for each position","2. Use sine and cosine functions","3. Add to token embeddings"],explanation:{title:"Position Information",simpleExplanation:"Since transformers process all tokens at once, we need to tell them about token order.",vectorExplanation:"We use sine and cosine waves of different frequencies to encode positions.",example:"This helps the model understand that 'bark' means different things in 'tree bark' vs 'dogs bark'."}},{title:"Multi-Head Attention",description:"Parallel attention computation across different representation subspaces",formula:"Attention(Q,K,V) = softmax(QK^T/√d)V",details:["1. Project input into Query, Key, Value vectors","2. Compute scaled dot-product attention","3. Combine multiple attention heads","4. Project to output space"],explanation:{title:"Parallel Attention Mechanism",simpleExplanation:"The model looks at the input sequence from multiple perspectives simultaneously.",vectorExplanation:"Each attention head can focus on different aspects of the relationships between tokens.",example:"One head might focus on syntax while another focuses on semantics."}}],Jv=[{title:"Masked Self-Attention",description:"Preventing attention to future tokens during generation",formula:"MaskedAttn(Q,K,V) = softmax(mask(QK^T)/√d)V",details:["1. Create attention mask matrix","2. Apply mask before softmax","3. Ensure causal attention pattern","4. Process masked attention output"],explanation:{title:"Causal Attention",simpleExplanation:"When generating text, we can only look at what we've generated so far.",vectorExplanation:"The mask ensures each position can only attend to previous positions.",example:"When predicting the next word, we can't 'peek' at future words."}},{title:"Cross-Attention",description:"Attending to encoder outputs",formula:"CrossAttn(Q,K,V) = softmax(QK^T/√d)V",details:["1. Use decoder hidden states as queries","2. Use encoder outputs as keys and values","3. Compute cross-attention scores","4. Combine information from both sequences"],explanation:{title:"Encoder-Decoder Connection",simpleExplanation:"This layer allows the decoder to focus on relevant parts of the input sequence.",vectorExplanation:"The decoder learns which input tokens are most important for generating each output token.",example:"In translation, this helps align output words with relevant input words."}},{title:"Feed-Forward Network",description:"Token-wise transformations with non-linearity",formula:"FFN(x) = max(0, xW₁ + b₁)W₂ + b₂",details:["1. Project to larger dimension","2. Apply ReLU activation","3. Project back to model dimension","4. Add residual connection"],explanation:{title:"Non-linear Processing",simpleExplanation:"Each token's representation is processed through a small neural network.",vectorExplanation:"This allows the model to learn complex token-wise transformations.",example:"The network can learn to combine or modify features extracted by attention layers."}}],qK=({currentStep:e,layerOutputs:t,nextWordProbabilities:n})=>{const r={initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1,transition:{duration:.5,ease:"easeOut"}}},s={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return R.jsxs(Nt.div,{className:"space-y-8",variants:r,initial:"initial",animate:"animate",children:[R.jsxs(Nt.div,{className:"bg-blue-50 p-4 rounded-lg",variants:s,children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Encoder Layers"}),R.jsx("div",{className:"space-y-4",children:Ti.map((o,a)=>R.jsx(KK,{step:o,index:a,currentStep:e,layerOutput:t[a]},`encoder-${a}`))})]}),R.jsxs(Nt.div,{className:"bg-green-50 p-4 rounded-lg",variants:s,children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Decoder Layers"}),R.jsx("div",{className:"space-y-4",children:Jv.map((o,a)=>R.jsx(HK,{step:o,index:a,currentStep:e,encoderStepsLength:Ti.length,layerOutput:t[a+Ti.length]},`decoder-${a}`))})]}),e>=Ti.length&&n.length>0&&R.jsxs(Nt.div,{className:"bg-purple-50 p-4 rounded-lg",variants:s,children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Next Word Predictions"}),R.jsx("div",{className:"space-y-2",children:n.slice(0,5).map((o,a)=>R.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded-lg shadow-sm",children:[R.jsx("span",{className:"font-medium",children:o.word}),R.jsxs("span",{className:"text-sm text-gray-600",children:[(o.probability*100).toFixed(1),"%"]})]},a))})]})]})},QK=({title:e})=>R.jsx(Nt.h2,{className:"text-2xl font-bold text-primary mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e}),NL=B.forwardRef(({className:e,type:t,...n},r)=>R.jsx("input",{type:t,className:Kn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));NL.displayName="Input";function s2(e,[t,n]){return Math.min(n,Math.max(t,e))}var YK=B.createContext(void 0);function k1(e){const t=B.useContext(YK);return e||t||"ltr"}function XK(e){const t=B.useRef({value:e,previous:e});return B.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var zL=["PageUp","PageDown"],BL=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],VL={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},df="Slider",[XM,JK,ZK]=ZT(df),[UL,LY]=tf(df,[ZK]),[eH,A1]=UL(df),WL=B.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:o=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:d=[r],value:h,onValueChange:m=()=>{},onValueCommit:p=()=>{},inverted:v=!1,form:T,...E}=e,O=B.useRef(new Set),b=B.useRef(0),I=a==="horizontal"?tH:nH,[k=[],$]=s1({prop:h,defaultProp:d,onChange:oe=>{var re;(re=[...O.current][b.current])==null||re.focus(),m(oe)}}),P=B.useRef(k);function D(oe){const de=aH(k,oe);q(oe,de)}function j(oe){q(oe,b.current)}function Y(){const oe=P.current[b.current];k[b.current]!==oe&&p(k)}function q(oe,de,{commit:re}={commit:!1}){const he=dH(o),ue=hH(Math.round((oe-r)/o)*o+r,he),ye=s2(ue,[r,s]);$((xe=[])=>{const te=iH(xe,ye,de);if(uH(te,u*o)){b.current=te.indexOf(ye);const ke=String(te)!==String(xe);return ke&&re&&p(te),ke?te:xe}else return xe})}return R.jsx(eH,{scope:e.__scopeSlider,name:n,disabled:c,min:r,max:s,valueIndexToChangeRef:b,thumbs:O.current,values:k,orientation:a,form:T,children:R.jsx(XM.Provider,{scope:e.__scopeSlider,children:R.jsx(XM.Slot,{scope:e.__scopeSlider,children:R.jsx(I,{"aria-disabled":c,"data-disabled":c?"":void 0,...E,ref:t,onPointerDown:vn(E.onPointerDown,()=>{c||(P.current=k)}),min:r,max:s,inverted:v,onSlideStart:c?void 0:D,onSlideMove:c?void 0:j,onSlideEnd:c?void 0:Y,onHomeKeyDown:()=>!c&&q(r,0,{commit:!0}),onEndKeyDown:()=>!c&&q(s,k.length-1,{commit:!0}),onStepKeyDown:({event:oe,direction:de})=>{if(!c){const ue=zL.includes(oe.key)||oe.shiftKey&&BL.includes(oe.key)?10:1,ye=b.current,xe=k[ye],te=o*ue*de;q(xe+te,ye,{commit:!0})}}})})})})});WL.displayName=df;var[GL,KL]=UL(df,{startEdge:"left",endEdge:"right",size:"width",direction:1}),tH=B.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:o,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:d,...h}=e,[m,p]=B.useState(null),v=Er(t,I=>p(I)),T=B.useRef(),E=k1(s),O=E==="ltr",b=O&&!o||!O&&o;function M(I){const k=T.current||m.getBoundingClientRect(),$=[0,k.width],D=i2($,b?[n,r]:[r,n]);return T.current=k,D(I-k.left)}return R.jsx(GL,{scope:e.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:R.jsx(HL,{dir:E,"data-orientation":"horizontal",...h,ref:v,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const k=M(I.clientX);a==null||a(k)},onSlideMove:I=>{const k=M(I.clientX);c==null||c(k)},onSlideEnd:()=>{T.current=void 0,u==null||u()},onStepKeyDown:I=>{const $=VL[b?"from-left":"from-right"].includes(I.key);d==null||d({event:I,direction:$?-1:1})}})})}),nH=B.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...d}=e,h=B.useRef(null),m=Er(t,h),p=B.useRef(),v=!s;function T(E){const O=p.current||h.current.getBoundingClientRect(),b=[0,O.height],I=i2(b,v?[r,n]:[n,r]);return p.current=O,I(E-O.top)}return R.jsx(GL,{scope:e.__scopeSlider,startEdge:v?"bottom":"top",endEdge:v?"top":"bottom",size:"height",direction:v?1:-1,children:R.jsx(HL,{"data-orientation":"vertical",...d,ref:m,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:E=>{const O=T(E.clientY);o==null||o(O)},onSlideMove:E=>{const O=T(E.clientY);a==null||a(O)},onSlideEnd:()=>{p.current=void 0,c==null||c()},onStepKeyDown:E=>{const b=VL[v?"from-bottom":"from-top"].includes(E.key);u==null||u({event:E,direction:b?-1:1})}})})}),HL=B.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:o,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...d}=e,h=A1(df,n);return R.jsx(Nn.span,{...d,ref:t,onKeyDown:vn(e.onKeyDown,m=>{m.key==="Home"?(a(m),m.preventDefault()):m.key==="End"?(c(m),m.preventDefault()):zL.concat(BL).includes(m.key)&&(u(m),m.preventDefault())}),onPointerDown:vn(e.onPointerDown,m=>{const p=m.target;p.setPointerCapture(m.pointerId),m.preventDefault(),h.thumbs.has(p)?p.focus():r(m)}),onPointerMove:vn(e.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&s(m)}),onPointerUp:vn(e.onPointerUp,m=>{const p=m.target;p.hasPointerCapture(m.pointerId)&&(p.releasePointerCapture(m.pointerId),o(m))})})}),qL="SliderTrack",QL=B.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=A1(qL,n);return R.jsx(Nn.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});QL.displayName=qL;var JM="SliderRange",YL=B.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=A1(JM,n),o=KL(JM,n),a=B.useRef(null),c=Er(t,a),u=s.values.length,d=s.values.map(p=>JL(p,s.min,s.max)),h=u>1?Math.min(...d):0,m=100-Math.max(...d);return R.jsx(Nn.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:c,style:{...e.style,[o.startEdge]:h+"%",[o.endEdge]:m+"%"}})});YL.displayName=JM;var ZM="SliderThumb",XL=B.forwardRef((e,t)=>{const n=JK(e.__scopeSlider),[r,s]=B.useState(null),o=Er(t,c=>s(c)),a=B.useMemo(()=>r?n().findIndex(c=>c.ref.current===r):-1,[n,r]);return R.jsx(rH,{...e,ref:o,index:a})}),rH=B.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...o}=e,a=A1(ZM,n),c=KL(ZM,n),[u,d]=B.useState(null),h=Er(t,M=>d(M)),m=u?a.form||!!u.closest("form"):!0,p=XI(u),v=a.values[r],T=v===void 0?0:JL(v,a.min,a.max),E=oH(r,a.values.length),O=p==null?void 0:p[c.size],b=O?lH(O,T,c.direction):0;return B.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),R.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${T}% + ${b}px)`},children:[R.jsx(XM.ItemSlot,{scope:e.__scopeSlider,children:R.jsx(Nn.span,{role:"slider","aria-label":e["aria-label"]||E,"aria-valuemin":a.min,"aria-valuenow":v,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...o,ref:h,style:v===void 0?{display:"none"}:e.style,onFocus:vn(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),m&&R.jsx(sH,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:v},r)]})});XL.displayName=ZM;var sH=e=>{const{value:t,...n}=e,r=B.useRef(null),s=XK(t);return B.useEffect(()=>{const o=r.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[s,t]),R.jsx("input",{style:{display:"none"},...n,ref:r,defaultValue:t})};function iH(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,o)=>s-o)}function JL(e,t,n){const o=100/(n-t)*(e-t);return s2(o,[0,100])}function oH(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function aH(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function lH(e,t,n){const r=e/2,o=i2([0,50],[0,r]);return(r-o(t)*n)*n}function cH(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function uH(e,t){if(t>0){const n=cH(e);return Math.min(...n)>=t}return!0}function i2(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function dH(e){return(String(e).split(".")[1]||"").length}function hH(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var ZL=WL,fH=QL,pH=YL,mH=XL;const eF=B.forwardRef(({className:e,...t},n)=>R.jsxs(ZL,{ref:n,className:Kn("relative flex w-full touch-none select-none items-center",e),...t,children:[R.jsx(fH,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:R.jsx(pH,{className:"absolute h-full bg-primary"})}),R.jsx(mH,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));eF.displayName=ZL.displayName;const gH=({inputText:e,setInputText:t,learningRate:n,setLearningRate:r,handleProcess:s,isProcessing:o})=>{const a={initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1,transition:{duration:.5,ease:"easeOut"}}};return R.jsxs(Nt.div,{className:"space-y-4",variants:a,initial:"initial",animate:"animate",children:[R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium mb-2",children:"Input Text"}),R.jsxs("div",{className:"flex gap-2",children:[R.jsx(NL,{value:e,onChange:c=>t(c.target.value),placeholder:"Enter text (e.g., 'Hello')",disabled:o,className:"transition-all duration-300 hover:border-primary"}),R.jsx(ma,{onClick:s,disabled:!e||o,className:"transition-all duration-300 hover:scale-105",children:"Process"})]})]}),R.jsxs(Nt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[R.jsx("label",{className:"block text-sm font-medium mb-2",children:"Learning Rate"}),R.jsx(eF,{value:[n],onValueChange:c=>r(c[0]),min:.01,max:1,step:.01,disabled:o,className:"transition-all duration-300"}),R.jsxs("div",{className:"text-sm text-muted-foreground mt-1 animate-fade-in",children:["Current: ",n]})]})]})},_H=({outputText:e})=>{const t={initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1,transition:{duration:.5,ease:"easeOut"}}};return R.jsxs(Nt.div,{variants:t,initial:"initial",animate:"animate",children:[R.jsx("label",{className:"block text-sm font-medium mb-2",children:"Output"}),R.jsx("div",{className:"h-10 flex items-center border rounded-md px-3 bg-muted animate-fade-in",children:e||"Translation will appear here"})]})},yH=({inputText:e,setInputText:t,outputText:n,learningRate:r,setLearningRate:s,handleProcess:o,isProcessing:a})=>{const c={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1,transition:{duration:.6,ease:"easeOut",staggerChildren:.1}}};return R.jsxs(Nt.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",variants:c,initial:"hidden",animate:"visible",children:[R.jsx(Nt.div,{variants:c,children:R.jsx(gH,{inputText:e,setInputText:t,learningRate:r,setLearningRate:s,handleProcess:o,isProcessing:a})}),R.jsx(Nt.div,{variants:c,children:R.jsx(_H,{outputText:n})})]})},vH=({embeddings:e,currentStep:t})=>{if(e.length===0)return null;const n={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,staggerChildren:.15}}},r={hidden:{opacity:0,x:-20},visible:o=>({opacity:1,x:0,transition:{delay:o*.1,duration:.4,ease:"easeOut"}})},s={hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{duration:.3,ease:"easeOut"}}};return R.jsxs(Nt.div,{initial:"hidden",animate:"visible",variants:n,className:"bg-muted p-4 rounded-lg space-y-4",children:[R.jsx(Nt.h3,{className:"font-semibold mb-2",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:"Word Embeddings:"}),R.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map((o,a)=>R.jsxs(Nt.div,{className:"bg-white p-4 rounded-lg shadow-sm space-y-3 hover:shadow-md transition-shadow",variants:r,custom:a,whileHover:{scale:1.02,transition:{duration:.2}},children:[R.jsx(Nt.div,{className:"font-medium text-primary text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:a*.1},children:o.word}),R.jsxs("div",{className:"space-y-2",children:[R.jsxs(Nt.div,{className:"text-sm",variants:s,children:[R.jsx("span",{className:"text-muted-foreground font-medium",children:"Base Vector: "}),R.jsxs("span",{className:"font-mono text-xs bg-gray-50 p-1 rounded",children:["[",o.vector.map(c=>c.toFixed(3)).join(", "),"]"]})]}),o.positionalVector&&R.jsxs(Nt.div,{className:"text-sm",variants:s,children:[R.jsx("span",{className:"text-muted-foreground font-medium",children:"Position Encoding: "}),R.jsxs("span",{className:"font-mono text-xs bg-gray-50 p-1 rounded",children:["[",o.positionalVector.map(c=>c.toFixed(3)).join(", "),"]"]})]}),o.contextualVector&&R.jsxs(Nt.div,{className:"text-sm",variants:s,children:[R.jsx("span",{className:"text-muted-foreground font-medium",children:"Contextual Vector: "}),R.jsxs("span",{className:"font-mono text-xs bg-gray-50 p-1 rounded",children:["[",o.contextualVector.map(c=>c.toFixed(3)).join(", "),"]"]})]})]})]},`${o.word}-${a}`))})]})},wH=({attentionWeights:e,currentStep:t})=>{if(e.length===0||t<1)return null;const n={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,staggerChildren:.1}}},r={hidden:{opacity:0,x:-20},visible:o=>({opacity:1,x:0,transition:{delay:o*.1,duration:.4,ease:"easeOut"}})},s={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{duration:.3,ease:"easeOut"}}};return R.jsxs(Nt.div,{initial:"hidden",animate:"visible",variants:n,className:"bg-muted p-4 rounded-lg",children:[R.jsx(Nt.h3,{className:"font-semibold mb-4",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:"Attention Weights:"}),R.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.map((o,a)=>R.jsx(Nt.div,{className:"flex gap-2",custom:a,variants:r,children:o.map((c,u)=>R.jsx(Nt.div,{variants:s,className:"w-12 h-12 flex items-center justify-center rounded transition-colors duration-300 text-sm font-medium",style:{backgroundColor:`rgba(59, 130, 246, ${c})`,color:c>.5?"white":"black"},whileHover:{scale:1.1,transition:{duration:.2}},whileTap:{scale:.95},children:c.toFixed(2)},u))},a))})]})},bH=({currentStep:e,embeddings:t,attentionWeights:n,nextWordProbabilities:r})=>{const s={initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}},exit:{scale:.9,opacity:0,y:-20,transition:{duration:.4,ease:"easeIn"}}};return R.jsx(M9,{mode:"wait",children:R.jsxs(Nt.div,{variants:s,initial:"initial",animate:"animate",exit:"exit",className:"space-y-6",children:[R.jsx(Nt.div,{whileHover:{scale:1.02},transition:{duration:.2},children:R.jsx(vH,{embeddings:t,currentStep:e})}),R.jsx(Nt.div,{whileHover:{scale:1.02},transition:{duration:.2},children:R.jsx(wH,{attentionWeights:n,currentStep:e})}),r.length>0&&R.jsxs(Nt.div,{whileHover:{scale:1.02},transition:{duration:.2},className:"bg-white p-4 rounded-lg shadow-sm",children:[R.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Token Probabilities"}),R.jsx("div",{className:"grid grid-cols-2 gap-3",children:r.slice(0,6).map((o,a)=>R.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[R.jsx("span",{className:"font-medium",children:o.word}),R.jsxs("span",{className:"text-sm text-gray-600",children:[(o.probability*100).toFixed(1),"%"]})]},a))})]})]},e)})},xH=({tokens:e,currentStep:t,tokenizedOutput:n=[]})=>R.jsxs(Qs,{className:"p-4",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Token Processing"}),n.length>0&&R.jsxs("div",{className:"mb-4",children:[R.jsx("h4",{className:"text-md font-medium mb-2",children:"Tokenized Input"}),R.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:n.map((r,s)=>R.jsxs("div",{className:"p-2 bg-accent/10 rounded-md flex justify-between items-center",children:[R.jsx("span",{className:"font-mono text-sm",children:r.text}),R.jsxs("span",{className:"text-xs text-muted-foreground",children:["ID: ",r.id]})]},s))})]}),R.jsx("div",{className:"space-y-4",children:e.map((r,s)=>R.jsxs("div",{className:"p-4 border rounded-lg space-y-2 bg-white shadow-sm",children:[R.jsxs("div",{className:"flex justify-between items-center",children:[R.jsxs("span",{className:"font-medium",children:["Token ",s+1,": ",r.word]}),R.jsxs("span",{className:"text-sm text-muted-foreground",children:["Step ",t+1]})]}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[R.jsxs("div",{children:[R.jsx("h4",{className:"text-sm font-medium mb-1",children:"Base Vector"}),R.jsxs("div",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:["[",r.vector.map(o=>o.toFixed(3)).join(", "),"]"]})]}),r.positionalVector&&R.jsxs("div",{children:[R.jsx("h4",{className:"text-sm font-medium mb-1",children:"Position Encoding"}),R.jsxs("div",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:["[",r.positionalVector.map(o=>o.toFixed(3)).join(", "),"]"]})]}),r.contextualVector&&R.jsxs("div",{className:"md:col-span-2",children:[R.jsx("h4",{className:"text-sm font-medium mb-1",children:"Contextual Vector"}),R.jsxs("div",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:["[",r.contextualVector.map(o=>o.toFixed(3)).join(", "),"]"]})]})]})]},s))})]}),MH=({predictions:e})=>e.length?R.jsxs(Nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white p-6 rounded-xl shadow-sm",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Next Word Predictions"}),R.jsx("div",{className:"grid gap-2",children:e.slice(0,5).map((t,n)=>R.jsxs(Nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.1},className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[R.jsx("span",{className:"font-medium",children:t.word}),R.jsxs("span",{className:"text-sm text-gray-600",children:[(t.probability*100).toFixed(1),"%"]})]},n))})]}):null;var Zo={},tF={"./node_modules/onnxruntime-web/dist/ort-wasm-simd-threaded.jsep.wasm":(e,t,n)=>{e.exports=n.p+"ort-wasm-simd-threaded.jsep.wasm"},"./node_modules/onnxruntime-web/dist/ort.bundle.min.mjs?46eb":(e,t,n)=>{e.exports=n.p+"ort.bundle.min.mjs"},"?2ce3":()=>{},"?7a2c":()=>{},"?a42a":()=>{},"?2b25":()=>{},"?569f":()=>{},"?3f59":()=>{},"?154a":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,t,n)=>{n.r(t),n.d(t,{Environment:()=>rt,Interpreter:()=>ht,Template:()=>mt,parse:()=>me,tokenize:()=>m});var r=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",NullLiteral:"NullLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator",Macro:"Macro",EndMacro:"EndMacro"}),s=Object.freeze({set:r.Set,for:r.For,in:r.In,is:r.Is,if:r.If,else:r.Else,endif:r.EndIf,elif:r.ElseIf,endfor:r.EndFor,and:r.And,or:r.Or,not:r.Not,"not in":r.NotIn,macro:r.Macro,endmacro:r.EndMacro,true:r.BooleanLiteral,false:r.BooleanLiteral,none:r.NullLiteral,True:r.BooleanLiteral,False:r.BooleanLiteral,None:r.NullLiteral}),o=class{constructor(Q,ve){this.value=Q,this.type=ve}};function a(Q){return/\w/.test(Q)}function c(Q){return/[0-9]/.test(Q)}var u=[["{%",r.OpenStatement],["%}",r.CloseStatement],["{{",r.OpenExpression],["}}",r.CloseExpression],["(",r.OpenParen],[")",r.CloseParen],["{",r.OpenCurlyBracket],["}",r.CloseCurlyBracket],["[",r.OpenSquareBracket],["]",r.CloseSquareBracket],[",",r.Comma],[".",r.Dot],[":",r.Colon],["|",r.Pipe],["<=",r.ComparisonBinaryOperator],[">=",r.ComparisonBinaryOperator],["==",r.ComparisonBinaryOperator],["!=",r.ComparisonBinaryOperator],["<",r.ComparisonBinaryOperator],[">",r.ComparisonBinaryOperator],["+",r.AdditiveBinaryOperator],["-",r.AdditiveBinaryOperator],["*",r.MultiplicativeBinaryOperator],["/",r.MultiplicativeBinaryOperator],["%",r.MultiplicativeBinaryOperator],["=",r.Equals]],d=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function h(Q,ve={}){return Q.endsWith(`
`)&&(Q=Q.slice(0,-1)),Q=Q.replace(/{#.*?#}/gs,"{##}"),ve.lstrip_blocks&&(Q=Q.replace(/^[ \t]*({[#%])/gm,"$1")),ve.trim_blocks&&(Q=Q.replace(/([#%]})\n/g,"$1")),Q.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}function m(Q,ve={}){var Ze,ft,gt;const ie=[],Ee=h(Q,ve);let Re=0;const Xe=St=>{let kt="";for(;St(Ee[Re]);){if(Ee[Re]==="\\"){if(++Re,Re>=Ee.length)throw new SyntaxError("Unexpected end of input");const Dt=Ee[Re++],mn=d.get(Dt);if(mn===void 0)throw new SyntaxError(`Unexpected escaped character: ${Dt}`);kt+=mn;continue}if(kt+=Ee[Re++],Re>=Ee.length)throw new SyntaxError("Unexpected end of input")}return kt};e:for(;Re<Ee.length;){const St=(Ze=ie.at(-1))==null?void 0:Ze.type;if(St===void 0||St===r.CloseStatement||St===r.CloseExpression){let Dt="";for(;Re<Ee.length&&!(Ee[Re]==="{"&&(Ee[Re+1]==="%"||Ee[Re+1]==="{"));)Dt+=Ee[Re++];if(Dt.length>0){ie.push(new o(Dt,r.Text));continue}}Xe(Dt=>/\s/.test(Dt));const kt=Ee[Re];if(kt==="-"||kt==="+"){const Dt=(ft=ie.at(-1))==null?void 0:ft.type;if(Dt===r.Text||Dt===void 0)throw new SyntaxError(`Unexpected character: ${kt}`);switch(Dt){case r.Identifier:case r.NumericLiteral:case r.BooleanLiteral:case r.NullLiteral:case r.StringLiteral:case r.CloseParen:case r.CloseSquareBracket:break;default:{++Re;const mn=Xe(c);ie.push(new o(`${kt}${mn}`,mn.length>0?r.NumericLiteral:r.UnaryOperator));continue}}}for(const[Dt,mn]of u)if(Ee.slice(Re,Re+Dt.length)===Dt){ie.push(new o(Dt,mn)),Re+=Dt.length;continue e}if(kt==="'"||kt==='"'){++Re;const Dt=Xe(mn=>mn!==kt);ie.push(new o(Dt,r.StringLiteral)),++Re;continue}if(c(kt)){const Dt=Xe(c);ie.push(new o(Dt,r.NumericLiteral));continue}if(a(kt)){const Dt=Xe(a),mn=Object.hasOwn(s,Dt)?s[Dt]:r.Identifier;mn===r.In&&((gt=ie.at(-1))==null?void 0:gt.type)===r.Not?(ie.pop(),ie.push(new o("not in",r.NotIn))):ie.push(new o(Dt,mn));continue}throw new SyntaxError(`Unexpected character: ${kt}`)}return ie}var p=class{constructor(){Pe(this,"type","Statement")}},v=class extends p{constructor(ve){super();Pe(this,"type","Program");this.body=ve}},T=class extends p{constructor(ve,ie,Ee){super();Pe(this,"type","If");this.test=ve,this.body=ie,this.alternate=Ee}},E=class extends p{constructor(ve,ie,Ee,Re){super();Pe(this,"type","For");this.loopvar=ve,this.iterable=ie,this.body=Ee,this.defaultBlock=Re}},O=class extends p{constructor(ve,ie){super();Pe(this,"type","Set");this.assignee=ve,this.value=ie}},b=class extends p{constructor(ve,ie,Ee){super();Pe(this,"type","Macro");this.name=ve,this.args=ie,this.body=Ee}},M=class extends p{constructor(){super(...arguments);Pe(this,"type","Expression")}},I=class extends M{constructor(ve,ie,Ee){super();Pe(this,"type","MemberExpression");this.object=ve,this.property=ie,this.computed=Ee}},k=class extends M{constructor(ve,ie){super();Pe(this,"type","CallExpression");this.callee=ve,this.args=ie}},$=class extends M{constructor(ve){super();Pe(this,"type","Identifier");this.value=ve}},P=class extends M{constructor(ve){super();Pe(this,"type","Literal");this.value=ve}},D=class extends P{constructor(){super(...arguments);Pe(this,"type","NumericLiteral")}},j=class extends P{constructor(){super(...arguments);Pe(this,"type","StringLiteral")}},Y=class extends P{constructor(){super(...arguments);Pe(this,"type","BooleanLiteral")}},q=class extends P{constructor(){super(...arguments);Pe(this,"type","NullLiteral")}},oe=class extends P{constructor(){super(...arguments);Pe(this,"type","ArrayLiteral")}},de=class extends P{constructor(){super(...arguments);Pe(this,"type","TupleLiteral")}},re=class extends P{constructor(){super(...arguments);Pe(this,"type","ObjectLiteral")}},he=class extends M{constructor(ve,ie,Ee){super();Pe(this,"type","BinaryExpression");this.operator=ve,this.left=ie,this.right=Ee}},ue=class extends M{constructor(ve,ie){super();Pe(this,"type","FilterExpression");this.operand=ve,this.filter=ie}},ye=class extends M{constructor(ve,ie){super();Pe(this,"type","SelectExpression");this.iterable=ve,this.test=ie}},xe=class extends M{constructor(ve,ie,Ee){super();Pe(this,"type","TestExpression");this.operand=ve,this.negate=ie,this.test=Ee}},te=class extends M{constructor(ve,ie){super();Pe(this,"type","UnaryExpression");this.operator=ve,this.argument=ie}},ke=class extends M{constructor(ve=void 0,ie=void 0,Ee=void 0){super();Pe(this,"type","SliceExpression");this.start=ve,this.stop=ie,this.step=Ee}},De=class extends M{constructor(ve,ie){super();Pe(this,"type","KeywordArgumentExpression");this.key=ve,this.value=ie}};function me(Q){const ve=new v([]);let ie=0;function Ee(ut,At){const Wt=Q[ie++];if(!Wt||Wt.type!==ut)throw new Error(`Parser Error: ${At}. ${Wt.type} !== ${ut}.`);return Wt}function Re(){switch(Q[ie].type){case r.Text:return ft();case r.OpenStatement:return gt();case r.OpenExpression:return St();default:throw new SyntaxError(`Unexpected token type: ${Q[ie].type}`)}}function Xe(...ut){return ie+ut.length<=Q.length&&ut.some((At,Wt)=>At!==Q[ie+Wt].type)}function Ze(...ut){return ie+ut.length<=Q.length&&ut.every((At,Wt)=>At===Q[ie+Wt].type)}function ft(){return new j(Ee(r.Text,"Expected text token").value)}function gt(){Ee(r.OpenStatement,"Expected opening statement token");let ut;switch(Q[ie].type){case r.Set:++ie,ut=kt(),Ee(r.CloseStatement,"Expected closing statement token");break;case r.If:++ie,ut=Dt(),Ee(r.OpenStatement,"Expected {% token"),Ee(r.EndIf,"Expected endif token"),Ee(r.CloseStatement,"Expected %} token");break;case r.Macro:++ie,ut=mn(),Ee(r.OpenStatement,"Expected {% token"),Ee(r.EndMacro,"Expected endmacro token"),Ee(r.CloseStatement,"Expected %} token");break;case r.For:++ie,ut=Gn(),Ee(r.OpenStatement,"Expected {% token"),Ee(r.EndFor,"Expected endfor token"),Ee(r.CloseStatement,"Expected %} token");break;default:throw new SyntaxError(`Unknown statement type: ${Q[ie].type}`)}return ut}function St(){Ee(r.OpenExpression,"Expected opening expression token");const ut=zn();return Ee(r.CloseExpression,"Expected closing expression token"),ut}function kt(){const ut=zn();if(Ze(r.Equals)){++ie;const At=kt();return new O(ut,At)}return ut}function Dt(){var Pr,Li,mi,Bn,cs,sr,Ys,fn;const ut=zn();Ee(r.CloseStatement,"Expected closing statement token");const At=[],Wt=[];for(;!(((Pr=Q[ie])==null?void 0:Pr.type)===r.OpenStatement&&(((Li=Q[ie+1])==null?void 0:Li.type)===r.ElseIf||((mi=Q[ie+1])==null?void 0:mi.type)===r.Else||((Bn=Q[ie+1])==null?void 0:Bn.type)===r.EndIf));)At.push(Re());if(((cs=Q[ie])==null?void 0:cs.type)===r.OpenStatement&&((sr=Q[ie+1])==null?void 0:sr.type)!==r.EndIf)if(++ie,Ze(r.ElseIf))Ee(r.ElseIf,"Expected elseif token"),Wt.push(Dt());else for(Ee(r.Else,"Expected else token"),Ee(r.CloseStatement,"Expected closing statement token");!(((Ys=Q[ie])==null?void 0:Ys.type)===r.OpenStatement&&((fn=Q[ie+1])==null?void 0:fn.type)===r.EndIf);)Wt.push(Re());return new T(ut,At,Wt)}function mn(){const ut=ls();if(ut.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const At=fi();Ee(r.CloseStatement,"Expected closing statement token");const Wt=[];for(;Xe(r.OpenStatement,r.EndMacro);)Wt.push(Re());return new b(ut,At,Wt)}function An(ut=!1){const At=ut?ls:zn,Wt=[At()],Pr=Ze(r.Comma);for(;Pr&&(++ie,Wt.push(At()),!!Ze(r.Comma)););return Pr?new de(Wt):Wt[0]}function Gn(){const ut=An(!0);if(!(ut instanceof $||ut instanceof de))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${ut.type} instead`);Ee(r.In,"Expected `in` keyword following loop variable");const At=zn();Ee(r.CloseStatement,"Expected closing statement token");const Wt=[];for(;Xe(r.OpenStatement,r.EndFor)&&Xe(r.OpenStatement,r.Else);)Wt.push(Re());const Pr=[];if(Ze(r.OpenStatement,r.Else))for(++ie,++ie,Ee(r.CloseStatement,"Expected closing statement token");Xe(r.OpenStatement,r.EndFor);)Pr.push(Re());return new E(ut,At,Wt,Pr)}function zn(){return Br()}function Br(){const ut=en();if(Ze(r.If)){++ie;const At=en();if(Ze(r.Else)){++ie;const Wt=en();return new T(At,[ut],[Wt])}else return new ye(ut,At)}return ut}function en(){let ut=$n();for(;Ze(r.Or);){const At=Q[ie];++ie;const Wt=$n();ut=new he(At,ut,Wt)}return ut}function $n(){let ut=ln();for(;Ze(r.And);){const At=Q[ie];++ie;const Wt=ln();ut=new he(At,ut,Wt)}return ut}function ln(){let ut;for(;Ze(r.Not);){const At=Q[ie];++ie;const Wt=ln();ut=new te(At,Wt)}return ut??fr()}function fr(){let ut=Rt();for(;Ze(r.ComparisonBinaryOperator)||Ze(r.In)||Ze(r.NotIn);){const At=Q[ie];++ie;const Wt=Rt();ut=new he(At,ut,Wt)}return ut}function Rt(){let ut=pi();for(;Ze(r.AdditiveBinaryOperator);){const At=Q[ie];++ie;const Wt=pi();ut=new he(At,ut,Wt)}return ut}function bs(){const ut=io();return Ze(r.OpenParen)?Os(ut):ut}function Os(ut){let At=new k(ut,fi());return Ze(r.OpenParen)&&(At=Os(At)),At}function fi(){Ee(r.OpenParen,"Expected opening parenthesis for arguments list");const ut=so();return Ee(r.CloseParen,"Expected closing parenthesis for arguments list"),ut}function so(){const ut=[];for(;!Ze(r.CloseParen);){let At=zn();if(Ze(r.Equals)){if(++ie,!(At instanceof $))throw new SyntaxError("Expected identifier for keyword argument");const Wt=zn();At=new De(At,Wt)}ut.push(At),Ze(r.Comma)&&++ie}return ut}function xs(){const ut=[];let At=!1;for(;!Ze(r.CloseSquareBracket);)Ze(r.Colon)?(ut.push(void 0),++ie,At=!0):(ut.push(zn()),Ze(r.Colon)&&(++ie,At=!0));if(ut.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(At){if(ut.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new ke(...ut)}return ut[0]}function io(){let ut=ls();for(;Ze(r.Dot)||Ze(r.OpenSquareBracket);){const At=Q[ie];++ie;let Wt;const Pr=At.type!==r.Dot;if(Pr)Wt=xs(),Ee(r.CloseSquareBracket,"Expected closing square bracket");else if(Wt=ls(),Wt.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");ut=new I(ut,Wt,Pr)}return ut}function pi(){let ut=Oi();for(;Ze(r.MultiplicativeBinaryOperator);){const At=Q[ie];++ie;const Wt=Oi();ut=new he(At,ut,Wt)}return ut}function Oi(){let ut=Di();for(;Ze(r.Is);){++ie;const At=Ze(r.Not);At&&++ie;let Wt=ls();if(Wt instanceof Y?Wt=new $(Wt.value.toString()):Wt instanceof q&&(Wt=new $("none")),!(Wt instanceof $))throw new SyntaxError("Expected identifier for the test");ut=new xe(ut,At,Wt)}return ut}function Di(){let ut=bs();for(;Ze(r.Pipe);){++ie;let At=ls();if(!(At instanceof $))throw new SyntaxError("Expected identifier for the filter");Ze(r.OpenParen)&&(At=Os(At)),ut=new ue(ut,At)}return ut}function ls(){const ut=Q[ie];switch(ut.type){case r.NumericLiteral:return++ie,new D(Number(ut.value));case r.StringLiteral:return++ie,new j(ut.value);case r.BooleanLiteral:return++ie,new Y(ut.value.toLowerCase()==="true");case r.NullLiteral:return++ie,new q(null);case r.Identifier:return++ie,new $(ut.value);case r.OpenParen:{++ie;const At=An();if(Q[ie].type!==r.CloseParen)throw new SyntaxError(`Expected closing parenthesis, got ${Q[ie].type} instead`);return++ie,At}case r.OpenSquareBracket:{++ie;const At=[];for(;!Ze(r.CloseSquareBracket);)At.push(zn()),Ze(r.Comma)&&++ie;return++ie,new oe(At)}case r.OpenCurlyBracket:{++ie;const At=new Map;for(;!Ze(r.CloseCurlyBracket);){const Wt=zn();Ee(r.Colon,"Expected colon between key and value in object literal");const Pr=zn();At.set(Wt,Pr),Ze(r.Comma)&&++ie}return++ie,new re(At)}default:throw new SyntaxError(`Unexpected token: ${ut.type}`)}}for(;ie<Q.length;)ve.body.push(Re());return ve}function ee(Q,ve,ie=1){ve===void 0&&(ve=Q,Q=0);const Ee=[];for(let Re=Q;Re<ve;Re+=ie)Ee.push(Re);return Ee}function ge(Q,ve,ie,Ee=1){const Re=Math.sign(Ee);Re>=0?(ve=(ve??(ve=0))<0?Math.max(Q.length+ve,0):Math.min(ve,Q.length),ie=(ie??(ie=Q.length))<0?Math.max(Q.length+ie,0):Math.min(ie,Q.length)):(ve=(ve??(ve=Q.length-1))<0?Math.max(Q.length+ve,-1):Math.min(ve,Q.length-1),ie=(ie??(ie=-1))<-1?Math.max(Q.length+ie,-1):Math.min(ie,Q.length-1));const Xe=[];for(let Ze=ve;Re*Ze<Re*ie;Ze+=Ee)Xe.push(Q[Ze]);return Xe}function Ie(Q){return Q.replace(/\b\w/g,ve=>ve.toUpperCase())}var Be=class{constructor(Q=void 0){Pe(this,"type","RuntimeValue");Pe(this,"value");Pe(this,"builtins",new Map);this.value=Q}__bool__(){return new Ye(!!this.value)}},Ue=class extends Be{constructor(){super(...arguments);Pe(this,"type","NumericValue")}},pe=class extends Be{constructor(){super(...arguments);Pe(this,"type","StringValue");Pe(this,"builtins",new Map([["upper",new qe(()=>new pe(this.value.toUpperCase()))],["lower",new qe(()=>new pe(this.value.toLowerCase()))],["strip",new qe(()=>new pe(this.value.trim()))],["title",new qe(()=>new pe(Ie(this.value)))],["length",new Ue(this.value.length)],["rstrip",new qe(()=>new pe(this.value.trimEnd()))],["lstrip",new qe(()=>new pe(this.value.trimStart()))]]))}},Ye=class extends Be{constructor(){super(...arguments);Pe(this,"type","BooleanValue")}},Ge=class extends Be{constructor(){super(...arguments);Pe(this,"type","ObjectValue");Pe(this,"builtins",new Map([["get",new qe(([ve,ie])=>{if(!(ve instanceof pe))throw new Error(`Object key must be a string: got ${ve.type}`);return this.value.get(ve.value)??ie??new Qe})],["items",new qe(()=>new Ae(Array.from(this.value.entries()).map(([ve,ie])=>new Ae([new pe(ve),ie]))))]]))}__bool__(){return new Ye(this.value.size>0)}},_e=class extends Ge{constructor(){super(...arguments);Pe(this,"type","KeywordArgumentsValue")}},Ae=class extends Be{constructor(){super(...arguments);Pe(this,"type","ArrayValue");Pe(this,"builtins",new Map([["length",new Ue(this.value.length)]]))}__bool__(){return new Ye(this.value.length>0)}},He=class extends Ae{constructor(){super(...arguments);Pe(this,"type","TupleValue")}},qe=class extends Be{constructor(){super(...arguments);Pe(this,"type","FunctionValue")}},Qe=class extends Be{constructor(){super(...arguments);Pe(this,"type","NullValue")}},Ke=class extends Be{constructor(){super(...arguments);Pe(this,"type","UndefinedValue")}},rt=class{constructor(Q){Pe(this,"variables",new Map([["namespace",new qe(Q=>{if(Q.length===0)return new Ge(new Map);if(Q.length!==1||!(Q[0]instanceof Ge))throw new Error("`namespace` expects either zero arguments or a single object argument");return Q[0]})]]));Pe(this,"tests",new Map([["boolean",Q=>Q.type==="BooleanValue"],["callable",Q=>Q instanceof qe],["odd",Q=>{if(Q.type!=="NumericValue")throw new Error(`Cannot apply test "odd" to type: ${Q.type}`);return Q.value%2!==0}],["even",Q=>{if(Q.type!=="NumericValue")throw new Error(`Cannot apply test "even" to type: ${Q.type}`);return Q.value%2===0}],["false",Q=>Q.type==="BooleanValue"&&!Q.value],["true",Q=>Q.type==="BooleanValue"&&Q.value],["none",Q=>Q.type==="NullValue"],["string",Q=>Q.type==="StringValue"],["number",Q=>Q.type==="NumericValue"],["integer",Q=>Q.type==="NumericValue"&&Number.isInteger(Q.value)],["iterable",Q=>Q.type==="ArrayValue"||Q.type==="StringValue"],["mapping",Q=>Q.type==="ObjectValue"],["lower",Q=>{const ve=Q.value;return Q.type==="StringValue"&&ve===ve.toLowerCase()}],["upper",Q=>{const ve=Q.value;return Q.type==="StringValue"&&ve===ve.toUpperCase()}],["none",Q=>Q.type==="NullValue"],["defined",Q=>Q.type!=="UndefinedValue"],["undefined",Q=>Q.type==="UndefinedValue"],["equalto",(Q,ve)=>Q.value===ve.value],["eq",(Q,ve)=>Q.value===ve.value]]));this.parent=Q}set(Q,ve){return this.declareVariable(Q,_t(ve))}declareVariable(Q,ve){if(this.variables.has(Q))throw new SyntaxError(`Variable already declared: ${Q}`);return this.variables.set(Q,ve),ve}setVariable(Q,ve){return this.variables.set(Q,ve),ve}resolve(Q){if(this.variables.has(Q))return this;if(this.parent)return this.parent.resolve(Q);throw new Error(`Unknown variable: ${Q}`)}lookupVariable(Q){try{return this.resolve(Q).variables.get(Q)??new Ke}catch{return new Ke}}},ht=class{constructor(Q){Pe(this,"global");this.global=Q??new rt}run(Q){return this.evaluate(Q,this.global)}evaluateBinaryExpression(Q,ve){const ie=this.evaluate(Q.left,ve);switch(Q.operator.value){case"and":return ie.__bool__().value?this.evaluate(Q.right,ve):ie;case"or":return ie.__bool__().value?ie:this.evaluate(Q.right,ve)}const Ee=this.evaluate(Q.right,ve);switch(Q.operator.value){case"==":return new Ye(ie.value==Ee.value);case"!=":return new Ye(ie.value!=Ee.value)}if(ie instanceof Ke||Ee instanceof Ke)throw new Error("Cannot perform operation on undefined values");if(ie instanceof Qe||Ee instanceof Qe)throw new Error("Cannot perform operation on null values");if(ie instanceof Ue&&Ee instanceof Ue)switch(Q.operator.value){case"+":return new Ue(ie.value+Ee.value);case"-":return new Ue(ie.value-Ee.value);case"*":return new Ue(ie.value*Ee.value);case"/":return new Ue(ie.value/Ee.value);case"%":return new Ue(ie.value%Ee.value);case"<":return new Ye(ie.value<Ee.value);case">":return new Ye(ie.value>Ee.value);case">=":return new Ye(ie.value>=Ee.value);case"<=":return new Ye(ie.value<=Ee.value)}else if(ie instanceof Ae&&Ee instanceof Ae)switch(Q.operator.value){case"+":return new Ae(ie.value.concat(Ee.value))}else if(Ee instanceof Ae){const Re=Ee.value.find(Xe=>Xe.value===ie.value)!==void 0;switch(Q.operator.value){case"in":return new Ye(Re);case"not in":return new Ye(!Re)}}if(ie instanceof pe||Ee instanceof pe)switch(Q.operator.value){case"+":return new pe(ie.value.toString()+Ee.value.toString())}if(ie instanceof pe&&Ee instanceof pe)switch(Q.operator.value){case"in":return new Ye(Ee.value.includes(ie.value));case"not in":return new Ye(!Ee.value.includes(ie.value))}if(ie instanceof pe&&Ee instanceof Ge)switch(Q.operator.value){case"in":return new Ye(Ee.value.has(ie.value));case"not in":return new Ye(!Ee.value.has(ie.value))}throw new SyntaxError(`Unknown operator "${Q.operator.value}" between ${ie.type} and ${Ee.type}`)}evaluateArguments(Q,ve){const ie=[],Ee=new Map;for(const Re of Q)if(Re.type==="KeywordArgumentExpression"){const Xe=Re;Ee.set(Xe.key.value,this.evaluate(Xe.value,ve))}else{if(Ee.size>0)throw new Error("Positional arguments must come before keyword arguments");ie.push(this.evaluate(Re,ve))}return[ie,Ee]}evaluateFilterExpression(Q,ve){const ie=this.evaluate(Q.operand,ve);if(Q.filter.type==="Identifier"){const Ee=Q.filter;if(Ee.value==="tojson")return new pe(ot(ie));if(ie instanceof Ae)switch(Ee.value){case"list":return ie;case"first":return ie.value[0];case"last":return ie.value[ie.value.length-1];case"length":return new Ue(ie.value.length);case"reverse":return new Ae(ie.value.reverse());case"sort":return new Ae(ie.value.sort((Re,Xe)=>{if(Re.type!==Xe.type)throw new Error(`Cannot compare different types: ${Re.type} and ${Xe.type}`);switch(Re.type){case"NumericValue":return Re.value-Xe.value;case"StringValue":return Re.value.localeCompare(Xe.value);default:throw new Error(`Cannot compare type: ${Re.type}`)}}));default:throw new Error(`Unknown ArrayValue filter: ${Ee.value}`)}else if(ie instanceof pe)switch(Ee.value){case"length":return new Ue(ie.value.length);case"upper":return new pe(ie.value.toUpperCase());case"lower":return new pe(ie.value.toLowerCase());case"title":return new pe(Ie(ie.value));case"capitalize":return new pe(ie.value.charAt(0).toUpperCase()+ie.value.slice(1));case"trim":return new pe(ie.value.trim());case"indent":return new pe(ie.value.split(`
`).map((Re,Xe)=>Xe===0||Re.length===0?Re:"    "+Re).join(`
`));case"string":return ie;default:throw new Error(`Unknown StringValue filter: ${Ee.value}`)}else if(ie instanceof Ue)switch(Ee.value){case"abs":return new Ue(Math.abs(ie.value));default:throw new Error(`Unknown NumericValue filter: ${Ee.value}`)}else if(ie instanceof Ge)switch(Ee.value){case"items":return new Ae(Array.from(ie.value.entries()).map(([Re,Xe])=>new Ae([new pe(Re),Xe])));case"length":return new Ue(ie.value.size);default:throw new Error(`Unknown ObjectValue filter: ${Ee.value}`)}throw new Error(`Cannot apply filter "${Ee.value}" to type: ${ie.type}`)}else if(Q.filter.type==="CallExpression"){const Ee=Q.filter;if(Ee.callee.type!=="Identifier")throw new Error(`Unknown filter: ${Ee.callee.type}`);const Re=Ee.callee.value;if(Re==="tojson"){const[,Xe]=this.evaluateArguments(Ee.args,ve),Ze=Xe.get("indent")??new Qe;if(!(Ze instanceof Ue||Ze instanceof Qe))throw new Error("If set, indent must be a number");return new pe(ot(ie,Ze.value))}if(ie instanceof Ae){switch(Re){case"selectattr":case"rejectattr":{const Xe=Re==="selectattr";if(ie.value.some(Dt=>!(Dt instanceof Ge)))throw new Error(`\`${Re}\` can only be applied to array of objects`);if(Ee.args.some(Dt=>Dt.type!=="StringLiteral"))throw new Error(`arguments of \`${Re}\` must be strings`);const[Ze,ft,gt]=Ee.args.map(Dt=>this.evaluate(Dt,ve));let St;if(ft){const Dt=ve.tests.get(ft.value);if(!Dt)throw new Error(`Unknown test: ${ft.value}`);St=Dt}else St=(...Dt)=>Dt[0].__bool__().value;const kt=ie.value.filter(Dt=>{const mn=Dt.value.get(Ze.value),An=mn?St(mn,gt):!1;return Xe?An:!An});return new Ae(kt)}case"map":{const[,Xe]=this.evaluateArguments(Ee.args,ve);if(Xe.has("attribute")){const Ze=Xe.get("attribute");if(!(Ze instanceof pe))throw new Error("attribute must be a string");const ft=Xe.get("default"),gt=ie.value.map(St=>{if(!(St instanceof Ge))throw new Error("items in map must be an object");return St.value.get(Ze.value)??ft??new Ke});return new Ae(gt)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${Re}`)}else if(ie instanceof pe){switch(Re){case"indent":{const[Xe,Ze]=this.evaluateArguments(Ee.args,ve),ft=Xe.at(0)??Ze.get("width")??new Ue(4);if(!(ft instanceof Ue))throw new Error("width must be a number");const gt=Xe.at(1)??Ze.get("first")??new Ye(!1),St=Xe.at(2)??Ze.get("blank")??new Ye(!1),kt=ie.value.split(`
`),Dt=" ".repeat(ft.value),mn=kt.map((An,Gn)=>!gt.value&&Gn===0||!St.value&&An.length===0?An:Dt+An);return new pe(mn.join(`
`))}}throw new Error(`Unknown StringValue filter: ${Re}`)}else throw new Error(`Cannot apply filter "${Re}" to type: ${ie.type}`)}throw new Error(`Unknown filter: ${Q.filter.type}`)}evaluateTestExpression(Q,ve){const ie=this.evaluate(Q.operand,ve),Ee=ve.tests.get(Q.test.value);if(!Ee)throw new Error(`Unknown test: ${Q.test.value}`);const Re=Ee(ie);return new Ye(Q.negate?!Re:Re)}evaluateUnaryExpression(Q,ve){const ie=this.evaluate(Q.argument,ve);switch(Q.operator.value){case"not":return new Ye(!ie.value);default:throw new SyntaxError(`Unknown operator: ${Q.operator.value}`)}}evalProgram(Q,ve){return this.evaluateBlock(Q.body,ve)}evaluateBlock(Q,ve){let ie="";for(const Ee of Q){const Re=this.evaluate(Ee,ve);Re.type!=="NullValue"&&Re.type!=="UndefinedValue"&&(ie+=Re.value)}return new pe(ie)}evaluateIdentifier(Q,ve){return ve.lookupVariable(Q.value)}evaluateCallExpression(Q,ve){const[ie,Ee]=this.evaluateArguments(Q.args,ve);Ee.size>0&&ie.push(new _e(Ee));const Re=this.evaluate(Q.callee,ve);if(Re.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${Re.type}`);return Re.value(ie,ve)}evaluateSliceExpression(Q,ve,ie){if(!(Q instanceof Ae||Q instanceof pe))throw new Error("Slice object must be an array or string");const Ee=this.evaluate(ve.start,ie),Re=this.evaluate(ve.stop,ie),Xe=this.evaluate(ve.step,ie);if(!(Ee instanceof Ue||Ee instanceof Ke))throw new Error("Slice start must be numeric or undefined");if(!(Re instanceof Ue||Re instanceof Ke))throw new Error("Slice stop must be numeric or undefined");if(!(Xe instanceof Ue||Xe instanceof Ke))throw new Error("Slice step must be numeric or undefined");return Q instanceof Ae?new Ae(ge(Q.value,Ee.value,Re.value,Xe.value)):new pe(ge(Array.from(Q.value),Ee.value,Re.value,Xe.value).join(""))}evaluateMemberExpression(Q,ve){const ie=this.evaluate(Q.object,ve);let Ee;if(Q.computed){if(Q.property.type==="SliceExpression")return this.evaluateSliceExpression(ie,Q.property,ve);Ee=this.evaluate(Q.property,ve)}else Ee=new pe(Q.property.value);let Re;if(ie instanceof Ge){if(!(Ee instanceof pe))throw new Error(`Cannot access property with non-string: got ${Ee.type}`);Re=ie.value.get(Ee.value)??ie.builtins.get(Ee.value)}else if(ie instanceof Ae||ie instanceof pe)if(Ee instanceof Ue)Re=ie.value.at(Ee.value),ie instanceof pe&&(Re=new pe(ie.value.at(Ee.value)));else if(Ee instanceof pe)Re=ie.builtins.get(Ee.value);else throw new Error(`Cannot access property with non-string/non-number: got ${Ee.type}`);else{if(!(Ee instanceof pe))throw new Error(`Cannot access property with non-string: got ${Ee.type}`);Re=ie.builtins.get(Ee.value)}return Re instanceof Be?Re:new Ke}evaluateSet(Q,ve){const ie=this.evaluate(Q.value,ve);if(Q.assignee.type==="Identifier"){const Ee=Q.assignee.value;ve.setVariable(Ee,ie)}else if(Q.assignee.type==="MemberExpression"){const Ee=Q.assignee,Re=this.evaluate(Ee.object,ve);if(!(Re instanceof Ge))throw new Error("Cannot assign to member of non-object");if(Ee.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");Re.value.set(Ee.property.value,ie)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(Q.assignee)}`);return new Qe}evaluateIf(Q,ve){const ie=this.evaluate(Q.test,ve);return this.evaluateBlock(ie.__bool__().value?Q.body:Q.alternate,ve)}evaluateFor(Q,ve){const ie=new rt(ve);let Ee,Re;if(Q.iterable.type==="SelectExpression"){const St=Q.iterable;Re=this.evaluate(St.iterable,ie),Ee=St.test}else Re=this.evaluate(Q.iterable,ie);if(!(Re instanceof Ae))throw new Error(`Expected iterable type in for loop: got ${Re.type}`);const Xe=[],Ze=[];for(let St=0;St<Re.value.length;++St){const kt=new rt(ie),Dt=Re.value[St];let mn;if(Q.loopvar.type==="Identifier")mn=An=>An.setVariable(Q.loopvar.value,Dt);else if(Q.loopvar.type==="TupleLiteral"){const An=Q.loopvar;if(Dt.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${Dt.type}`);const Gn=Dt;if(An.value.length!==Gn.value.length)throw new Error(`Too ${An.value.length>Gn.value.length?"few":"many"} items to unpack`);mn=zn=>{for(let Br=0;Br<An.value.length;++Br){if(An.value[Br].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${An.value[Br].type}`);zn.setVariable(An.value[Br].value,Gn.value[Br])}}}else throw new Error(`Invalid loop variable(s): ${Q.loopvar.type}`);Ee&&(mn(kt),!this.evaluate(Ee,kt).__bool__().value)||(Xe.push(Dt),Ze.push(mn))}let ft="",gt=!0;for(let St=0;St<Xe.length;++St){const kt=new Map([["index",new Ue(St+1)],["index0",new Ue(St)],["revindex",new Ue(Xe.length-St)],["revindex0",new Ue(Xe.length-St-1)],["first",new Ye(St===0)],["last",new Ye(St===Xe.length-1)],["length",new Ue(Xe.length)],["previtem",St>0?Xe[St-1]:new Ke],["nextitem",St<Xe.length-1?Xe[St+1]:new Ke]]);ie.setVariable("loop",new Ge(kt)),Ze[St](ie);const Dt=this.evaluateBlock(Q.body,ie);ft+=Dt.value,gt=!1}if(gt){const St=this.evaluateBlock(Q.defaultBlock,ie);ft+=St.value}return new pe(ft)}evaluateMacro(Q,ve){return ve.setVariable(Q.name.value,new qe((ie,Ee)=>{var Ze;const Re=new rt(Ee);ie=ie.slice();let Xe;((Ze=ie.at(-1))==null?void 0:Ze.type)==="KeywordArgumentsValue"&&(Xe=ie.pop());for(let ft=0;ft<Q.args.length;++ft){const gt=Q.args[ft],St=ie[ft];if(gt.type==="Identifier"){const kt=gt;if(!St)throw new Error(`Missing positional argument: ${kt.value}`);Re.setVariable(kt.value,St)}else if(gt.type==="KeywordArgumentExpression"){const kt=gt,Dt=St??(Xe==null?void 0:Xe.value.get(kt.key.value))??this.evaluate(kt.value,Re);Re.setVariable(kt.key.value,Dt)}else throw new Error(`Unknown argument type: ${gt.type}`)}return this.evaluateBlock(Q.body,Re)})),new Qe}evaluate(Q,ve){if(Q===void 0)return new Ke;switch(Q.type){case"Program":return this.evalProgram(Q,ve);case"Set":return this.evaluateSet(Q,ve);case"If":return this.evaluateIf(Q,ve);case"For":return this.evaluateFor(Q,ve);case"Macro":return this.evaluateMacro(Q,ve);case"NumericLiteral":return new Ue(Number(Q.value));case"StringLiteral":return new pe(Q.value);case"BooleanLiteral":return new Ye(Q.value);case"NullLiteral":return new Qe(Q.value);case"ArrayLiteral":return new Ae(Q.value.map(ie=>this.evaluate(ie,ve)));case"TupleLiteral":return new He(Q.value.map(ie=>this.evaluate(ie,ve)));case"ObjectLiteral":{const ie=new Map;for(const[Ee,Re]of Q.value){const Xe=this.evaluate(Ee,ve);if(!(Xe instanceof pe))throw new Error(`Object keys must be strings: got ${Xe.type}`);ie.set(Xe.value,this.evaluate(Re,ve))}return new Ge(ie)}case"Identifier":return this.evaluateIdentifier(Q,ve);case"CallExpression":return this.evaluateCallExpression(Q,ve);case"MemberExpression":return this.evaluateMemberExpression(Q,ve);case"UnaryExpression":return this.evaluateUnaryExpression(Q,ve);case"BinaryExpression":return this.evaluateBinaryExpression(Q,ve);case"FilterExpression":return this.evaluateFilterExpression(Q,ve);case"TestExpression":return this.evaluateTestExpression(Q,ve);default:throw new SyntaxError(`Unknown node type: ${Q.type}`)}}};function _t(Q){switch(typeof Q){case"number":return new Ue(Q);case"string":return new pe(Q);case"boolean":return new Ye(Q);case"undefined":return new Ke;case"object":return Q===null?new Qe:Array.isArray(Q)?new Ae(Q.map(_t)):new Ge(new Map(Object.entries(Q).map(([ve,ie])=>[ve,_t(ie)])));case"function":return new qe((ve,ie)=>{const Ee=Q(...ve.map(Re=>Re.value))??null;return _t(Ee)});default:throw new Error(`Cannot convert to runtime value: ${Q}`)}}function ot(Q,ve,ie){const Ee=ie??0;switch(Q.type){case"NullValue":case"UndefinedValue":return"null";case"NumericValue":case"StringValue":case"BooleanValue":return JSON.stringify(Q.value);case"ArrayValue":case"ObjectValue":{const Re=ve?" ".repeat(ve):"",Xe=`
`+Re.repeat(Ee),Ze=Xe+Re;if(Q.type==="ArrayValue"){const ft=Q.value.map(gt=>ot(gt,ve,Ee+1));return ve?`[${Ze}${ft.join(`,${Ze}`)}${Xe}]`:`[${ft.join(", ")}]`}else{const ft=Array.from(Q.value.entries()).map(([gt,St])=>{const kt=`"${gt}": ${ot(St,ve,Ee+1)}`;return ve?`${Ze}${kt}`:kt});return ve?`{${ft.join(",")}${Xe}}`:`{${ft.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${Q.type}`)}}var mt=class{constructor(Q){Pe(this,"parsed");const ve=m(Q,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=me(ve)}render(Q){const ve=new rt;ve.set("false",!1),ve.set("true",!0),ve.set("raise_exception",Re=>{throw new Error(Re)}),ve.set("range",ee);for(const[Re,Xe]of Object.entries(Q))ve.set(Re,Xe);return new ht(ve).run(this.parsed).value}}},"./node_modules/onnxruntime-common/dist/esm/backend-impl.js":(e,t,n)=>{n.r(t),n.d(t,{registerBackend:()=>o,resolveBackendAndExecutionProviders:()=>c});const r=new Map,s=[],o=(u,d,h)=>{if(d&&typeof d.init=="function"&&typeof d.createInferenceSessionHandler=="function"){const m=r.get(u);if(m===void 0)r.set(u,{backend:d,priority:h});else{if(m.priority>h)return;if(m.priority===h&&m.backend!==d)throw new Error(`cannot register backend "${u}" using priority ${h}`)}if(h>=0){const p=s.indexOf(u);p!==-1&&s.splice(p,1);for(let v=0;v<s.length;v++)if(r.get(s[v]).priority<=h){s.splice(v,0,u);return}s.push(u)}return}throw new TypeError("not a valid backend")},a=async u=>{const d=r.get(u);if(!d)return"backend not found.";if(d.initialized)return d.backend;if(d.aborted)return d.error;{const h=!!d.initPromise;try{return h||(d.initPromise=d.backend.init(u)),await d.initPromise,d.initialized=!0,d.backend}catch(m){return h||(d.error=`${m}`,d.aborted=!0),d.error}finally{delete d.initPromise}}},c=async u=>{const d=u.executionProviders||[],h=d.map(O=>typeof O=="string"?O:O.name),m=h.length===0?s:h;let p;const v=[],T=new Set;for(const O of m){const b=await a(O);typeof b=="string"?v.push({name:O,err:b}):(p||(p=b),p===b&&T.add(O))}if(!p)throw new Error(`no available backend found. ERR: ${v.map(O=>`[${O.name}] ${O.err}`).join(", ")}`);for(const{name:O,err:b}of v)h.includes(O)&&console.warn(`removing requested execution provider "${O}" from session options because it is not available: ${b}`);const E=d.filter(O=>T.has(typeof O=="string"?O:O.name));return[p,new Proxy(u,{get:(O,b)=>b==="executionProviders"?E:Reflect.get(O,b)})]}},"./node_modules/onnxruntime-common/dist/esm/backend.js":(e,t,n)=>{n.r(t),n.d(t,{registerBackend:()=>r.registerBackend});var r=n("./node_modules/onnxruntime-common/dist/esm/backend-impl.js")},"./node_modules/onnxruntime-common/dist/esm/env-impl.js":(e,t,n)=>{n.r(t),n.d(t,{env:()=>o});var r=n("./node_modules/onnxruntime-common/dist/esm/version.js");let s="warning";const o={wasm:{},webgl:{},webgpu:{},versions:{common:r.version},set logLevel(a){if(a!==void 0){if(typeof a!="string"||["verbose","info","warning","error","fatal"].indexOf(a)===-1)throw new Error(`Unsupported logging level: ${a}`);s=a}},get logLevel(){return s}};Object.defineProperty(o,"logLevel",{enumerable:!0})},"./node_modules/onnxruntime-common/dist/esm/env.js":(e,t,n)=>{n.r(t),n.d(t,{env:()=>s});var r=n("./node_modules/onnxruntime-common/dist/esm/env-impl.js");const s=r.env},"./node_modules/onnxruntime-common/dist/esm/index.js":(e,t,n)=>{n.r(t),n.d(t,{InferenceSession:()=>o.InferenceSession,TRACE:()=>c.TRACE,TRACE_FUNC_BEGIN:()=>c.TRACE_FUNC_BEGIN,TRACE_FUNC_END:()=>c.TRACE_FUNC_END,Tensor:()=>a.Tensor,TrainingSession:()=>u.TrainingSession,env:()=>s.env,registerBackend:()=>r.registerBackend});var r=n("./node_modules/onnxruntime-common/dist/esm/backend.js"),s=n("./node_modules/onnxruntime-common/dist/esm/env.js"),o=n("./node_modules/onnxruntime-common/dist/esm/inference-session.js"),a=n("./node_modules/onnxruntime-common/dist/esm/tensor.js");n("./node_modules/onnxruntime-common/dist/esm/tensor-conversion.js"),n("./node_modules/onnxruntime-common/dist/esm/tensor-factory.js");var c=n("./node_modules/onnxruntime-common/dist/esm/trace.js");n("./node_modules/onnxruntime-common/dist/esm/onnx-model.js"),n("./node_modules/onnxruntime-common/dist/esm/onnx-value.js");var u=n("./node_modules/onnxruntime-common/dist/esm/training-session.js")},"./node_modules/onnxruntime-common/dist/esm/inference-session-impl.js":(e,t,n)=>{n.r(t),n.d(t,{InferenceSession:()=>a});var r=n("./node_modules/onnxruntime-common/dist/esm/backend-impl.js"),s=n("./node_modules/onnxruntime-common/dist/esm/tensor.js"),o=n("./node_modules/onnxruntime-common/dist/esm/trace.js");class a{constructor(u){this.handler=u}async run(u,d,h){(0,o.TRACE_FUNC_BEGIN)();const m={};let p={};if(typeof u!="object"||u===null||u instanceof s.Tensor||Array.isArray(u))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let v=!0;if(typeof d=="object"){if(d===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(d instanceof s.Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(d)){if(d.length===0)throw new TypeError("'fetches' cannot be an empty array.");v=!1;for(const O of d){if(typeof O!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(O)===-1)throw new RangeError(`'fetches' contains invalid output name: ${O}.`);m[O]=null}if(typeof h=="object"&&h!==null)p=h;else if(typeof h<"u")throw new TypeError("'options' must be an object.")}else{let O=!1;const b=Object.getOwnPropertyNames(d);for(const M of this.outputNames)if(b.indexOf(M)!==-1){const I=d[M];(I===null||I instanceof s.Tensor)&&(O=!0,v=!1,m[M]=I)}if(O){if(typeof h=="object"&&h!==null)p=h;else if(typeof h<"u")throw new TypeError("'options' must be an object.")}else p=d}}else if(typeof d<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const O of this.inputNames)if(typeof u[O]>"u")throw new Error(`input '${O}' is missing in 'feeds'.`);if(v)for(const O of this.outputNames)m[O]=null;const T=await this.handler.run(u,m,p),E={};for(const O in T)if(Object.hasOwnProperty.call(T,O)){const b=T[O];b instanceof s.Tensor?E[O]=b:E[O]=new s.Tensor(b.type,b.data,b.dims)}return(0,o.TRACE_FUNC_END)(),E}async release(){return this.handler.dispose()}static async create(u,d,h,m){(0,o.TRACE_FUNC_BEGIN)();let p,v={};if(typeof u=="string"){if(p=u,typeof d=="object"&&d!==null)v=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else if(u instanceof Uint8Array){if(p=u,typeof d=="object"&&d!==null)v=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer){const b=u;let M=0,I=u.byteLength;if(typeof d=="object"&&d!==null)v=d;else if(typeof d=="number"){if(M=d,!Number.isSafeInteger(M))throw new RangeError("'byteOffset' must be an integer.");if(M<0||M>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(I=u.byteLength-M,typeof h=="number"){if(I=h,!Number.isSafeInteger(I))throw new RangeError("'byteLength' must be an integer.");if(I<=0||M+I>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-M}].`);if(typeof m=="object"&&m!==null)v=m;else if(typeof m<"u")throw new TypeError("'options' must be an object.")}else if(typeof h<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof d<"u")throw new TypeError("'options' must be an object.");p=new Uint8Array(b,M,I)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[T,E]=await(0,r.resolveBackendAndExecutionProviders)(v),O=await T.createInferenceSessionHandler(p,E);return(0,o.TRACE_FUNC_END)(),new a(O)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}},"./node_modules/onnxruntime-common/dist/esm/inference-session.js":(e,t,n)=>{n.r(t),n.d(t,{InferenceSession:()=>s});var r=n("./node_modules/onnxruntime-common/dist/esm/inference-session-impl.js");const s=r.InferenceSession},"./node_modules/onnxruntime-common/dist/esm/onnx-model.js":(e,t,n)=>{n.r(t)},"./node_modules/onnxruntime-common/dist/esm/onnx-value.js":(e,t,n)=>{n.r(t)},"./node_modules/onnxruntime-common/dist/esm/tensor-conversion-impl.js":(e,t,n)=>{n.r(t),n.d(t,{tensorToDataURL:()=>r,tensorToImageData:()=>s});const r=(o,a)=>{const c=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);c.width=o.dims[3],c.height=o.dims[2];const u=c.getContext("2d");if(u!=null){let d,h;(a==null?void 0:a.tensorLayout)!==void 0&&a.tensorLayout==="NHWC"?(d=o.dims[2],h=o.dims[3]):(d=o.dims[3],h=o.dims[2]);const m=(a==null?void 0:a.format)!==void 0?a.format:"RGB",p=a==null?void 0:a.norm;let v,T;p===void 0||p.mean===void 0?v=[255,255,255,255]:typeof p.mean=="number"?v=[p.mean,p.mean,p.mean,p.mean]:(v=[p.mean[0],p.mean[1],p.mean[2],0],p.mean[3]!==void 0&&(v[3]=p.mean[3])),p===void 0||p.bias===void 0?T=[0,0,0,0]:typeof p.bias=="number"?T=[p.bias,p.bias,p.bias,p.bias]:(T=[p.bias[0],p.bias[1],p.bias[2],0],p.bias[3]!==void 0&&(T[3]=p.bias[3]));const E=h*d;let O=0,b=E,M=E*2,I=-1;m==="RGBA"?(O=0,b=E,M=E*2,I=E*3):m==="RGB"?(O=0,b=E,M=E*2):m==="RBG"&&(O=0,M=E,b=E*2);for(let k=0;k<h;k++)for(let $=0;$<d;$++){const P=(o.data[O++]-T[0])*v[0],D=(o.data[b++]-T[1])*v[1],j=(o.data[M++]-T[2])*v[2],Y=I===-1?255:(o.data[I++]-T[3])*v[3];u.fillStyle="rgba("+P+","+D+","+j+","+Y+")",u.fillRect($,k,1,1)}if("toDataURL"in c)return c.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},s=(o,a)=>{const c=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let u;if(c!=null){let d,h,m;(a==null?void 0:a.tensorLayout)!==void 0&&a.tensorLayout==="NHWC"?(d=o.dims[2],h=o.dims[1],m=o.dims[3]):(d=o.dims[3],h=o.dims[2],m=o.dims[1]);const p=a!==void 0&&a.format!==void 0?a.format:"RGB",v=a==null?void 0:a.norm;let T,E;v===void 0||v.mean===void 0?T=[255,255,255,255]:typeof v.mean=="number"?T=[v.mean,v.mean,v.mean,v.mean]:(T=[v.mean[0],v.mean[1],v.mean[2],255],v.mean[3]!==void 0&&(T[3]=v.mean[3])),v===void 0||v.bias===void 0?E=[0,0,0,0]:typeof v.bias=="number"?E=[v.bias,v.bias,v.bias,v.bias]:(E=[v.bias[0],v.bias[1],v.bias[2],0],v.bias[3]!==void 0&&(E[3]=v.bias[3]));const O=h*d;if(a!==void 0&&(a.format!==void 0&&m===4&&a.format!=="RGBA"||m===3&&a.format!=="RGB"&&a.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const b=4;let M=0,I=1,k=2,$=3,P=0,D=O,j=O*2,Y=-1;p==="RGBA"?(P=0,D=O,j=O*2,Y=O*3):p==="RGB"?(P=0,D=O,j=O*2):p==="RBG"&&(P=0,j=O,D=O*2),u=c.createImageData(d,h);for(let q=0;q<h*d;M+=b,I+=b,k+=b,$+=b,q++)u.data[M]=(o.data[P++]-E[0])*T[0],u.data[I]=(o.data[D++]-E[1])*T[1],u.data[k]=(o.data[j++]-E[2])*T[2],u.data[$]=Y===-1?255:(o.data[Y++]-E[3])*T[3]}else throw new Error("Can not access image data");return u}},"./node_modules/onnxruntime-common/dist/esm/tensor-conversion.js":(e,t,n)=>{n.r(t)},"./node_modules/onnxruntime-common/dist/esm/tensor-factory-impl.js":(e,t,n)=>{n.r(t),n.d(t,{bufferToTensor:()=>s,tensorFromGpuBuffer:()=>c,tensorFromImage:()=>o,tensorFromMLTensor:()=>u,tensorFromPinnedBuffer:()=>d,tensorFromTexture:()=>a});var r=n("./node_modules/onnxruntime-common/dist/esm/tensor-impl.js");const s=(h,m)=>{if(h===void 0)throw new Error("Image buffer must be defined");if(m.height===void 0||m.width===void 0)throw new Error("Image height and width must be defined");if(m.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:p,width:v}=m,T=m.norm??{mean:255,bias:0};let E,O;typeof T.mean=="number"?E=[T.mean,T.mean,T.mean,T.mean]:E=[T.mean[0],T.mean[1],T.mean[2],T.mean[3]??255],typeof T.bias=="number"?O=[T.bias,T.bias,T.bias,T.bias]:O=[T.bias[0],T.bias[1],T.bias[2],T.bias[3]??0];const b=m.format!==void 0?m.format:"RGBA",M=m.tensorFormat!==void 0&&m.tensorFormat!==void 0?m.tensorFormat:"RGB",I=p*v,k=M==="RGBA"?new Float32Array(I*4):new Float32Array(I*3);let $=4,P=0,D=1,j=2,Y=3,q=0,oe=I,de=I*2,re=-1;b==="RGB"&&($=3,P=0,D=1,j=2,Y=-1),M==="RGBA"?re=I*3:M==="RBG"?(q=0,de=I,oe=I*2):M==="BGR"&&(de=0,oe=I,q=I*2);for(let ue=0;ue<I;ue++,P+=$,j+=$,D+=$,Y+=$)k[q++]=(h[P]+O[0])/E[0],k[oe++]=(h[D]+O[1])/E[1],k[de++]=(h[j]+O[2])/E[2],re!==-1&&Y!==-1&&(k[re++]=(h[Y]+O[3])/E[3]);return M==="RGBA"?new r.Tensor("float32",k,[1,4,p,v]):new r.Tensor("float32",k,[1,3,p,v])},o=async(h,m)=>{const p=typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement,v=typeof ImageData<"u"&&h instanceof ImageData,T=typeof ImageBitmap<"u"&&h instanceof ImageBitmap,E=typeof h=="string";let O,b=m??{};const M=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},I=k=>typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||k instanceof OffscreenCanvas?k.getContext("2d"):null;if(p){const k=M();k.width=h.width,k.height=h.height;const $=I(k);if($!=null){let P=h.height,D=h.width;if(m!==void 0&&m.resizedHeight!==void 0&&m.resizedWidth!==void 0&&(P=m.resizedHeight,D=m.resizedWidth),m!==void 0){if(b=m,m.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");b.tensorFormat="RGBA",b.height=P,b.width=D}else b.tensorFormat="RGBA",b.height=P,b.width=D;$.drawImage(h,0,0),O=$.getImageData(0,0,D,P).data}else throw new Error("Can not access image data")}else if(v){let k,$;if(m!==void 0&&m.resizedWidth!==void 0&&m.resizedHeight!==void 0?(k=m.resizedHeight,$=m.resizedWidth):(k=h.height,$=h.width),m!==void 0&&(b=m),b.format="RGBA",b.height=k,b.width=$,m!==void 0){const P=M();P.width=$,P.height=k;const D=I(P);if(D!=null)D.putImageData(h,0,0),O=D.getImageData(0,0,$,k).data;else throw new Error("Can not access image data")}else O=h.data}else if(T){if(m===void 0)throw new Error("Please provide image config with format for Imagebitmap");const k=M();k.width=h.width,k.height=h.height;const $=I(k);if($!=null){const P=h.height,D=h.width;return $.drawImage(h,0,0,D,P),O=$.getImageData(0,0,D,P).data,b.height=P,b.width=D,s(O,b)}else throw new Error("Can not access image data")}else{if(E)return new Promise((k,$)=>{const P=M(),D=I(P);if(!h||!D)return $();const j=new Image;j.crossOrigin="Anonymous",j.src=h,j.onload=()=>{P.width=j.width,P.height=j.height,D.drawImage(j,0,0,P.width,P.height);const Y=D.getImageData(0,0,P.width,P.height);b.height=P.height,b.width=P.width,k(s(Y.data,b))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(O!==void 0)return s(O,b);throw new Error("Input data provided is not supported - aborted tensor creation")},a=(h,m)=>{const{width:p,height:v,download:T,dispose:E}=m,O=[1,v,p,4];return new r.Tensor({location:"texture",type:"float32",texture:h,dims:O,download:T,dispose:E})},c=(h,m)=>{const{dataType:p,dims:v,download:T,dispose:E}=m;return new r.Tensor({location:"gpu-buffer",type:p??"float32",gpuBuffer:h,dims:v,download:T,dispose:E})},u=(h,m)=>{const{dataType:p,dims:v,download:T,dispose:E}=m;return new r.Tensor({location:"ml-tensor",type:p??"float32",mlTensor:h,dims:v,download:T,dispose:E})},d=(h,m,p)=>new r.Tensor({location:"cpu-pinned",type:h,data:m,dims:p??[m.length]})},"./node_modules/onnxruntime-common/dist/esm/tensor-factory.js":(e,t,n)=>{n.r(t)},"./node_modules/onnxruntime-common/dist/esm/tensor-impl-type-mapping.js":(e,t,n)=>{n.r(t),n.d(t,{NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP:()=>s,NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP:()=>r,checkTypedArray:()=>a});const r=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),s=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let o=!1;const a=()=>{if(!o){o=!0;const c=typeof BigInt64Array<"u"&&BigInt64Array.from,u=typeof BigUint64Array<"u"&&BigUint64Array.from,d=typeof Float16Array<"u"&&Float16Array.from;c&&(r.set("int64",BigInt64Array),s.set(BigInt64Array,"int64")),u&&(r.set("uint64",BigUint64Array),s.set(BigUint64Array,"uint64")),d?(r.set("float16",Float16Array),s.set(Float16Array,"float16")):r.set("float16",Uint16Array)}}},"./node_modules/onnxruntime-common/dist/esm/tensor-impl.js":(e,t,n)=>{n.r(t),n.d(t,{Tensor:()=>c});var r=n("./node_modules/onnxruntime-common/dist/esm/tensor-conversion-impl.js"),s=n("./node_modules/onnxruntime-common/dist/esm/tensor-factory-impl.js"),o=n("./node_modules/onnxruntime-common/dist/esm/tensor-impl-type-mapping.js"),a=n("./node_modules/onnxruntime-common/dist/esm/tensor-utils-impl.js");class c{constructor(d,h,m){(0,o.checkTypedArray)();let p,v;if(typeof d=="object"&&"location"in d)switch(this.dataLocation=d.location,p=d.type,v=d.dims,d.location){case"cpu-pinned":{const E=o.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(p);if(!E)throw new TypeError(`unsupported type "${p}" to create tensor from pinned buffer`);if(!(d.data instanceof E))throw new TypeError(`buffer should be of type ${E.name}`);this.cpuData=d.data;break}case"texture":{if(p!=="float32")throw new TypeError(`unsupported type "${p}" to create tensor from texture`);this.gpuTextureData=d.texture,this.downloader=d.download,this.disposer=d.dispose;break}case"gpu-buffer":{if(p!=="float32"&&p!=="float16"&&p!=="int32"&&p!=="int64"&&p!=="uint32"&&p!=="uint8"&&p!=="bool"&&p!=="uint4"&&p!=="int4")throw new TypeError(`unsupported type "${p}" to create tensor from gpu buffer`);this.gpuBufferData=d.gpuBuffer,this.downloader=d.download,this.disposer=d.dispose;break}case"ml-tensor":{if(p!=="float32"&&p!=="float16"&&p!=="int32"&&p!=="int64"&&p!=="uint32"&&p!=="uint64"&&p!=="int8"&&p!=="uint8"&&p!=="bool")throw new TypeError(`unsupported type "${p}" to create tensor from MLTensor`);this.mlTensorData=d.mlTensor,this.downloader=d.download,this.disposer=d.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let E,O;if(typeof d=="string")if(p=d,O=m,d==="string"){if(!Array.isArray(h))throw new TypeError("A string tensor's data must be a string array.");E=h}else{const b=o.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(d);if(b===void 0)throw new TypeError(`Unsupported tensor type: ${d}.`);if(Array.isArray(h)){if(d==="float16"&&b===Uint16Array||d==="uint4"||d==="int4")throw new TypeError(`Creating a ${d} tensor from number array is not supported. Please use ${b.name} as data.`);d==="uint64"||d==="int64"?E=b.from(h,BigInt):E=b.from(h)}else if(h instanceof b)E=h;else if(h instanceof Uint8ClampedArray)if(d==="uint8")E=Uint8Array.from(h);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else throw new TypeError(`A ${p} tensor's data must be type of ${b}`)}else if(O=h,Array.isArray(d)){if(d.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const b=typeof d[0];if(b==="string")p="string",E=d;else if(b==="boolean")p="bool",E=Uint8Array.from(d);else throw new TypeError(`Invalid element type of data array: ${b}.`)}else if(d instanceof Uint8ClampedArray)p="uint8",E=Uint8Array.from(d);else{const b=o.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(d.constructor);if(b===void 0)throw new TypeError(`Unsupported type for tensor data: ${d.constructor}.`);p=b,E=d}if(O===void 0)O=[E.length];else if(!Array.isArray(O))throw new TypeError("A tensor's dims must be a number array");v=O,this.cpuData=E,this.dataLocation="cpu"}const T=(0,a.calculateSize)(v);if(this.cpuData&&T!==this.cpuData.length&&!((p==="uint4"||p==="int4")&&Math.ceil(T/2)===this.cpuData.length))throw new Error(`Tensor's size(${T}) does not match data length(${this.cpuData.length}).`);this.type=p,this.dims=v,this.size=T}static async fromImage(d,h){return(0,s.tensorFromImage)(d,h)}static fromTexture(d,h){return(0,s.tensorFromTexture)(d,h)}static fromGpuBuffer(d,h){return(0,s.tensorFromGpuBuffer)(d,h)}static fromMLTensor(d,h){return(0,s.tensorFromMLTensor)(d,h)}static fromPinnedBuffer(d,h,m){return(0,s.tensorFromPinnedBuffer)(d,h,m)}toDataURL(d){return(0,r.tensorToDataURL)(this,d)}toImageData(d){return(0,r.tensorToImageData)(this,d)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(d){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const h=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=h,d&&this.disposer&&(this.disposer(),this.disposer=void 0),h}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(d){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return(0,a.tensorReshape)(this,d)}}},"./node_modules/onnxruntime-common/dist/esm/tensor-utils-impl.js":(e,t,n)=>{n.r(t),n.d(t,{calculateSize:()=>s,tensorReshape:()=>o});var r=n("./node_modules/onnxruntime-common/dist/esm/tensor-impl.js");const s=a=>{let c=1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d!="number"||!Number.isSafeInteger(d))throw new TypeError(`dims[${u}] must be an integer, got: ${d}`);if(d<0)throw new RangeError(`dims[${u}] must be a non-negative integer, got: ${d}`);c*=d}return c},o=(a,c)=>{switch(a.location){case"cpu":return new r.Tensor(a.type,a.data,c);case"cpu-pinned":return new r.Tensor({location:"cpu-pinned",data:a.data,type:a.type,dims:c});case"texture":return new r.Tensor({location:"texture",texture:a.texture,type:a.type,dims:c});case"gpu-buffer":return new r.Tensor({location:"gpu-buffer",gpuBuffer:a.gpuBuffer,type:a.type,dims:c});case"ml-tensor":return new r.Tensor({location:"ml-tensor",mlTensor:a.mlTensor,type:a.type,dims:c});default:throw new Error(`tensorReshape: tensor location ${a.location} is not supported`)}}},"./node_modules/onnxruntime-common/dist/esm/tensor.js":(e,t,n)=>{n.r(t),n.d(t,{Tensor:()=>s});var r=n("./node_modules/onnxruntime-common/dist/esm/tensor-impl.js");const s=r.Tensor},"./node_modules/onnxruntime-common/dist/esm/trace.js":(e,t,n)=>{n.r(t),n.d(t,{TRACE:()=>s,TRACE_FUNC_BEGIN:()=>a,TRACE_FUNC_END:()=>c});var r=n("./node_modules/onnxruntime-common/dist/esm/env-impl.js");const s=(u,d)=>{(typeof r.env.trace>"u"?!r.env.wasm.trace:!r.env.trace)||console.timeStamp(`${u}::ORT::${d}`)},o=(u,d)=>{var p;const h=((p=new Error().stack)==null?void 0:p.split(/\r\n|\r|\n/g))||[];let m=!1;for(let v=0;v<h.length;v++){if(m&&!h[v].includes("TRACE_FUNC")){let T=`FUNC_${u}::${h[v].trim().split(" ")[1]}`;d&&(T+=`::${d}`),s("CPU",T);return}h[v].includes("TRACE_FUNC")&&(m=!0)}},a=u=>{(typeof r.env.trace>"u"?!r.env.wasm.trace:!r.env.trace)||o("BEGIN",u)},c=u=>{(typeof r.env.trace>"u"?!r.env.wasm.trace:!r.env.trace)||o("END",u)}},"./node_modules/onnxruntime-common/dist/esm/training-session-impl.js":(e,t,n)=>{n.r(t),n.d(t,{TrainingSession:()=>a});var r=n("./node_modules/onnxruntime-common/dist/esm/backend-impl.js"),s=n("./node_modules/onnxruntime-common/dist/esm/tensor.js");const o="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.";class a{constructor(u,d,h){this.handler=u,this.hasOptimizerModel=d,this.hasEvalModel=h}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(u,d){const h=u.evalModel||"",m=u.optimizerModel||"",p=d||{},[v,T]=await(0,r.resolveBackendAndExecutionProviders)(p);if(v.createTrainingSessionHandler){const E=await v.createTrainingSessionHandler(u.checkpointState,u.trainModel,h,m,T);return new a(E,!!u.optimizerModel,!!u.evalModel)}else throw new Error(o)}typeNarrowingForRunStep(u,d,h,m,p){const v={};let T={};if(typeof h!="object"||h===null||h instanceof s.Tensor||Array.isArray(h))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let E=!0;if(typeof m=="object"){if(m===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(m instanceof s.Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(m)){if(m.length===0)throw new TypeError("'fetches' cannot be an empty array.");E=!1;for(const O of m){if(typeof O!="string")throw new TypeError("'fetches' must be a string array or an object.");if(d.indexOf(O)===-1)throw new RangeError(`'fetches' contains invalid output name: ${O}.`);v[O]=null}if(typeof p=="object"&&p!==null)T=p;else if(typeof p<"u")throw new TypeError("'options' must be an object.")}else{let O=!1;const b=Object.getOwnPropertyNames(m);for(const M of d)if(b.indexOf(M)!==-1){const I=m[M];(I===null||I instanceof s.Tensor)&&(O=!0,E=!1,v[M]=I)}if(O){if(typeof p=="object"&&p!==null)T=p;else if(typeof p<"u")throw new TypeError("'options' must be an object.")}else T=m}}else if(typeof m<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const O of u)if(typeof h[O]>"u")throw new Error(`input '${O}' is missing in 'feeds'.`);if(E)for(const O of d)v[O]=null;return[v,T]}convertHandlerReturnTypeToMapOfTensors(u){const d={};for(const h in u)if(Object.hasOwnProperty.call(u,h)){const m=u[h];m instanceof s.Tensor?d[h]=m:d[h]=new s.Tensor(m.type,m.data,m.dims)}return d}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(u,d,h){const[m,p]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,u,d,h),v=await this.handler.runTrainStep(u,m,p);return this.convertHandlerReturnTypeToMapOfTensors(v)}async runOptimizerStep(u){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(u||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(u,d,h){if(this.hasEvalModel){const[m,p]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,u,d,h),v=await this.handler.runEvalStep(u,m,p);return this.convertHandlerReturnTypeToMapOfTensors(v)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(u=!0){return this.handler.getParametersSize(u)}async loadParametersBuffer(u,d=!0){const h=await this.getParametersSize(d);if(u.length!==4*h)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(u,d)}async getContiguousParameters(u=!0){return this.handler.getContiguousParameters(u)}async release(){return this.handler.dispose()}}},"./node_modules/onnxruntime-common/dist/esm/training-session.js":(e,t,n)=>{n.r(t),n.d(t,{TrainingSession:()=>s});var r=n("./node_modules/onnxruntime-common/dist/esm/training-session-impl.js");const s=r.TrainingSession},"./node_modules/onnxruntime-common/dist/esm/version.js":(e,t,n)=>{n.r(t),n.d(t,{version:()=>r});const r="1.20.1"},"./node_modules/onnxruntime-web/dist/ort.bundle.min.mjs?3a96":(e,t,n)=>{n.r(t),n.d(t,{InferenceSession:()=>ot,TRACE:()=>He,TRACE_FUNC_BEGIN:()=>Qe,TRACE_FUNC_END:()=>Ke,Tensor:()=>_e,default:()=>gR,env:()=>j,registerBackend:()=>T});/*!
 * ONNX Runtime Web v1.21.0-dev.20250111-73f5b0c597
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,c=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(l,f)=>(typeof require<"u"?require:l)[f]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+i+'" is not supported')}),u=(i,l)=>()=>(i&&(l=i(i=0)),l),d=(i,l)=>{for(var f in l)r(i,f,{get:l[f],enumerable:!0})},h=(i,l,f,g)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of o(l))!a.call(i,_)&&_!==f&&r(i,_,{get:()=>l[_],enumerable:!(g=s(l,_))||g.enumerable});return i},m=i=>h(r({},"__esModule",{value:!0}),i),p,v,T,E,O,b=u(()=>{p=new Map,v=[],T=(i,l,f)=>{if(l&&typeof l.init=="function"&&typeof l.createInferenceSessionHandler=="function"){let g=p.get(i);if(g===void 0)p.set(i,{backend:l,priority:f});else{if(g.priority>f)return;if(g.priority===f&&g.backend!==l)throw new Error(`cannot register backend "${i}" using priority ${f}`)}if(f>=0){let _=v.indexOf(i);_!==-1&&v.splice(_,1);for(let w=0;w<v.length;w++)if(p.get(v[w]).priority<=f){v.splice(w,0,i);return}v.push(i)}return}throw new TypeError("not a valid backend")},E=async i=>{let l=p.get(i);if(!l)return"backend not found.";if(l.initialized)return l.backend;if(l.aborted)return l.error;{let f=!!l.initPromise;try{return f||(l.initPromise=l.backend.init(i)),await l.initPromise,l.initialized=!0,l.backend}catch(g){return f||(l.error=`${g}`,l.aborted=!0),l.error}finally{delete l.initPromise}}},O=async i=>{let l=i.executionProviders||[],f=l.map(L=>typeof L=="string"?L:L.name),g=f.length===0?v:f,_,w=[],y=new Set;for(let L of g){let F=await E(L);typeof F=="string"?w.push({name:L,err:F}):(_||(_=F),_===F&&y.add(L))}if(!_)throw new Error(`no available backend found. ERR: ${w.map(L=>`[${L.name}] ${L.err}`).join(", ")}`);for(let{name:L,err:F}of w)f.includes(L)&&console.warn(`removing requested execution provider "${L}" from session options because it is not available: ${F}`);let S=l.filter(L=>y.has(typeof L=="string"?L:L.name));return[_,new Proxy(i,{get:(L,F)=>F==="executionProviders"?S:Reflect.get(L,F)})]}}),M=u(()=>{b()}),I,k=u(()=>{I="1.21.0-dev.20241212-1f88284f96"}),$,P,D=u(()=>{k(),$="warning",P={wasm:{},webgl:{},webgpu:{},versions:{common:I},set logLevel(i){if(i!==void 0){if(typeof i!="string"||["verbose","info","warning","error","fatal"].indexOf(i)===-1)throw new Error(`Unsupported logging level: ${i}`);$=i}},get logLevel(){return $}},Object.defineProperty(P,"logLevel",{enumerable:!0})}),j,Y=u(()=>{D(),j=P}),q,oe,de=u(()=>{q=(i,l)=>{let f=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);f.width=i.dims[3],f.height=i.dims[2];let g=f.getContext("2d");if(g!=null){let _,w;(l==null?void 0:l.tensorLayout)!==void 0&&l.tensorLayout==="NHWC"?(_=i.dims[2],w=i.dims[3]):(_=i.dims[3],w=i.dims[2]);let y=(l==null?void 0:l.format)!==void 0?l.format:"RGB",S=l==null?void 0:l.norm,L,F;S===void 0||S.mean===void 0?L=[255,255,255,255]:typeof S.mean=="number"?L=[S.mean,S.mean,S.mean,S.mean]:(L=[S.mean[0],S.mean[1],S.mean[2],0],S.mean[3]!==void 0&&(L[3]=S.mean[3])),S===void 0||S.bias===void 0?F=[0,0,0,0]:typeof S.bias=="number"?F=[S.bias,S.bias,S.bias,S.bias]:(F=[S.bias[0],S.bias[1],S.bias[2],0],S.bias[3]!==void 0&&(F[3]=S.bias[3]));let K=w*_,W=0,C=K,X=K*2,J=-1;y==="RGBA"?(W=0,C=K,X=K*2,J=K*3):y==="RGB"?(W=0,C=K,X=K*2):y==="RBG"&&(W=0,X=K,C=K*2);for(let ne=0;ne<w;ne++)for(let ce=0;ce<_;ce++){let fe=(i.data[W++]-F[0])*L[0],le=(i.data[C++]-F[1])*L[1],Te=(i.data[X++]-F[2])*L[2],Me=J===-1?255:(i.data[J++]-F[3])*L[3];g.fillStyle="rgba("+fe+","+le+","+Te+","+Me+")",g.fillRect(ce,ne,1,1)}if("toDataURL"in f)return f.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},oe=(i,l)=>{let f=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),g;if(f!=null){let _,w,y;(l==null?void 0:l.tensorLayout)!==void 0&&l.tensorLayout==="NHWC"?(_=i.dims[2],w=i.dims[1],y=i.dims[3]):(_=i.dims[3],w=i.dims[2],y=i.dims[1]);let S=l!==void 0&&l.format!==void 0?l.format:"RGB",L=l==null?void 0:l.norm,F,K;L===void 0||L.mean===void 0?F=[255,255,255,255]:typeof L.mean=="number"?F=[L.mean,L.mean,L.mean,L.mean]:(F=[L.mean[0],L.mean[1],L.mean[2],255],L.mean[3]!==void 0&&(F[3]=L.mean[3])),L===void 0||L.bias===void 0?K=[0,0,0,0]:typeof L.bias=="number"?K=[L.bias,L.bias,L.bias,L.bias]:(K=[L.bias[0],L.bias[1],L.bias[2],0],L.bias[3]!==void 0&&(K[3]=L.bias[3]));let W=w*_;if(l!==void 0&&(l.format!==void 0&&y===4&&l.format!=="RGBA"||y===3&&l.format!=="RGB"&&l.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let C=4,X=0,J=1,ne=2,ce=3,fe=0,le=W,Te=W*2,Me=-1;S==="RGBA"?(fe=0,le=W,Te=W*2,Me=W*3):S==="RGB"?(fe=0,le=W,Te=W*2):S==="RBG"&&(fe=0,Te=W,le=W*2),g=f.createImageData(_,w);for(let $e=0;$e<w*_;X+=C,J+=C,ne+=C,ce+=C,$e++)g.data[X]=(i.data[fe++]-K[0])*F[0],g.data[J]=(i.data[le++]-K[1])*F[1],g.data[ne]=(i.data[Te++]-K[2])*F[2],g.data[ce]=Me===-1?255:(i.data[Me++]-K[3])*F[3]}else throw new Error("Can not access image data");return g}}),re,he,ue,ye,xe,te,ke=u(()=>{Ge(),re=(i,l)=>{if(i===void 0)throw new Error("Image buffer must be defined");if(l.height===void 0||l.width===void 0)throw new Error("Image height and width must be defined");if(l.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:f,width:g}=l,_=l.norm??{mean:255,bias:0},w,y;typeof _.mean=="number"?w=[_.mean,_.mean,_.mean,_.mean]:w=[_.mean[0],_.mean[1],_.mean[2],_.mean[3]??255],typeof _.bias=="number"?y=[_.bias,_.bias,_.bias,_.bias]:y=[_.bias[0],_.bias[1],_.bias[2],_.bias[3]??0];let S=l.format!==void 0?l.format:"RGBA",L=l.tensorFormat!==void 0&&l.tensorFormat!==void 0?l.tensorFormat:"RGB",F=f*g,K=L==="RGBA"?new Float32Array(F*4):new Float32Array(F*3),W=4,C=0,X=1,J=2,ne=3,ce=0,fe=F,le=F*2,Te=-1;S==="RGB"&&(W=3,C=0,X=1,J=2,ne=-1),L==="RGBA"?Te=F*3:L==="RBG"?(ce=0,le=F,fe=F*2):L==="BGR"&&(le=0,fe=F,ce=F*2);for(let Me=0;Me<F;Me++,C+=W,J+=W,X+=W,ne+=W)K[ce++]=(i[C]+y[0])/w[0],K[fe++]=(i[X]+y[1])/w[1],K[le++]=(i[J]+y[2])/w[2],Te!==-1&&ne!==-1&&(K[Te++]=(i[ne]+y[3])/w[3]);return L==="RGBA"?new Ye("float32",K,[1,4,f,g]):new Ye("float32",K,[1,3,f,g])},he=async(i,l)=>{let f=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,g=typeof ImageData<"u"&&i instanceof ImageData,_=typeof ImageBitmap<"u"&&i instanceof ImageBitmap,w=typeof i=="string",y,S=l??{},L=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},F=K=>typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||K instanceof OffscreenCanvas?K.getContext("2d"):null;if(f){let K=L();K.width=i.width,K.height=i.height;let W=F(K);if(W!=null){let C=i.height,X=i.width;if(l!==void 0&&l.resizedHeight!==void 0&&l.resizedWidth!==void 0&&(C=l.resizedHeight,X=l.resizedWidth),l!==void 0){if(S=l,l.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");S.tensorFormat="RGBA",S.height=C,S.width=X}else S.tensorFormat="RGBA",S.height=C,S.width=X;W.drawImage(i,0,0),y=W.getImageData(0,0,X,C).data}else throw new Error("Can not access image data")}else if(g){let K,W;if(l!==void 0&&l.resizedWidth!==void 0&&l.resizedHeight!==void 0?(K=l.resizedHeight,W=l.resizedWidth):(K=i.height,W=i.width),l!==void 0&&(S=l),S.format="RGBA",S.height=K,S.width=W,l!==void 0){let C=L();C.width=W,C.height=K;let X=F(C);if(X!=null)X.putImageData(i,0,0),y=X.getImageData(0,0,W,K).data;else throw new Error("Can not access image data")}else y=i.data}else if(_){if(l===void 0)throw new Error("Please provide image config with format for Imagebitmap");let K=L();K.width=i.width,K.height=i.height;let W=F(K);if(W!=null){let C=i.height,X=i.width;return W.drawImage(i,0,0,X,C),y=W.getImageData(0,0,X,C).data,S.height=C,S.width=X,re(y,S)}else throw new Error("Can not access image data")}else{if(w)return new Promise((K,W)=>{let C=L(),X=F(C);if(!i||!X)return W();let J=new Image;J.crossOrigin="Anonymous",J.src=i,J.onload=()=>{C.width=J.width,C.height=J.height,X.drawImage(J,0,0,C.width,C.height);let ne=X.getImageData(0,0,C.width,C.height);S.height=C.height,S.width=C.width,K(re(ne.data,S))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(y!==void 0)return re(y,S);throw new Error("Input data provided is not supported - aborted tensor creation")},ue=(i,l)=>{let{width:f,height:g,download:_,dispose:w}=l,y=[1,g,f,4];return new Ye({location:"texture",type:"float32",texture:i,dims:y,download:_,dispose:w})},ye=(i,l)=>{let{dataType:f,dims:g,download:_,dispose:w}=l;return new Ye({location:"gpu-buffer",type:f??"float32",gpuBuffer:i,dims:g,download:_,dispose:w})},xe=(i,l)=>{let{dataType:f,dims:g,download:_,dispose:w}=l;return new Ye({location:"ml-tensor",type:f??"float32",mlTensor:i,dims:g,download:_,dispose:w})},te=(i,l,f)=>new Ye({location:"cpu-pinned",type:i,data:l,dims:f??[l.length]})}),De,me,ee,ge,Ie=u(()=>{De=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),me=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ee=!1,ge=()=>{if(!ee){ee=!0;let i=typeof BigInt64Array<"u"&&BigInt64Array.from,l=typeof BigUint64Array<"u"&&BigUint64Array.from,f=typeof Float16Array<"u"&&Float16Array.from;i&&(De.set("int64",BigInt64Array),me.set(BigInt64Array,"int64")),l&&(De.set("uint64",BigUint64Array),me.set(BigUint64Array,"uint64")),f?(De.set("float16",Float16Array),me.set(Float16Array,"float16")):De.set("float16",Uint16Array)}}}),Be,Ue,pe=u(()=>{Ge(),Be=i=>{let l=1;for(let f=0;f<i.length;f++){let g=i[f];if(typeof g!="number"||!Number.isSafeInteger(g))throw new TypeError(`dims[${f}] must be an integer, got: ${g}`);if(g<0)throw new RangeError(`dims[${f}] must be a non-negative integer, got: ${g}`);l*=g}return l},Ue=(i,l)=>{switch(i.location){case"cpu":return new Ye(i.type,i.data,l);case"cpu-pinned":return new Ye({location:"cpu-pinned",data:i.data,type:i.type,dims:l});case"texture":return new Ye({location:"texture",texture:i.texture,type:i.type,dims:l});case"gpu-buffer":return new Ye({location:"gpu-buffer",gpuBuffer:i.gpuBuffer,type:i.type,dims:l});case"ml-tensor":return new Ye({location:"ml-tensor",mlTensor:i.mlTensor,type:i.type,dims:l});default:throw new Error(`tensorReshape: tensor location ${i.location} is not supported`)}}}),Ye,Ge=u(()=>{de(),ke(),Ie(),pe(),Ye=class{constructor(i,l,f){ge();let g,_;if(typeof i=="object"&&"location"in i)switch(this.dataLocation=i.location,g=i.type,_=i.dims,i.location){case"cpu-pinned":{let y=De.get(g);if(!y)throw new TypeError(`unsupported type "${g}" to create tensor from pinned buffer`);if(!(i.data instanceof y))throw new TypeError(`buffer should be of type ${y.name}`);this.cpuData=i.data;break}case"texture":{if(g!=="float32")throw new TypeError(`unsupported type "${g}" to create tensor from texture`);this.gpuTextureData=i.texture,this.downloader=i.download,this.disposer=i.dispose;break}case"gpu-buffer":{if(g!=="float32"&&g!=="float16"&&g!=="int32"&&g!=="int64"&&g!=="uint32"&&g!=="uint8"&&g!=="bool"&&g!=="uint4"&&g!=="int4")throw new TypeError(`unsupported type "${g}" to create tensor from gpu buffer`);this.gpuBufferData=i.gpuBuffer,this.downloader=i.download,this.disposer=i.dispose;break}case"ml-tensor":{if(g!=="float32"&&g!=="float16"&&g!=="int32"&&g!=="int64"&&g!=="uint32"&&g!=="uint64"&&g!=="int8"&&g!=="uint8"&&g!=="bool"&&g!=="uint4"&&g!=="int4")throw new TypeError(`unsupported type "${g}" to create tensor from MLTensor`);this.mlTensorData=i.mlTensor,this.downloader=i.download,this.disposer=i.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let y,S;if(typeof i=="string")if(g=i,S=f,i==="string"){if(!Array.isArray(l))throw new TypeError("A string tensor's data must be a string array.");y=l}else{let L=De.get(i);if(L===void 0)throw new TypeError(`Unsupported tensor type: ${i}.`);if(Array.isArray(l)){if(i==="float16"&&L===Uint16Array||i==="uint4"||i==="int4")throw new TypeError(`Creating a ${i} tensor from number array is not supported. Please use ${L.name} as data.`);i==="uint64"||i==="int64"?y=L.from(l,BigInt):y=L.from(l)}else if(l instanceof L)y=l;else if(l instanceof Uint8ClampedArray)if(i==="uint8")y=Uint8Array.from(l);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else throw new TypeError(`A ${g} tensor's data must be type of ${L}`)}else if(S=l,Array.isArray(i)){if(i.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let L=typeof i[0];if(L==="string")g="string",y=i;else if(L==="boolean")g="bool",y=Uint8Array.from(i);else throw new TypeError(`Invalid element type of data array: ${L}.`)}else if(i instanceof Uint8ClampedArray)g="uint8",y=Uint8Array.from(i);else{let L=me.get(i.constructor);if(L===void 0)throw new TypeError(`Unsupported type for tensor data: ${i.constructor}.`);g=L,y=i}if(S===void 0)S=[y.length];else if(!Array.isArray(S))throw new TypeError("A tensor's dims must be a number array");_=S,this.cpuData=y,this.dataLocation="cpu"}let w=Be(_);if(this.cpuData&&w!==this.cpuData.length&&!((g==="uint4"||g==="int4")&&Math.ceil(w/2)===this.cpuData.length))throw new Error(`Tensor's size(${w}) does not match data length(${this.cpuData.length}).`);this.type=g,this.dims=_,this.size=w}static async fromImage(i,l){return he(i,l)}static fromTexture(i,l){return ue(i,l)}static fromGpuBuffer(i,l){return ye(i,l)}static fromMLTensor(i,l){return xe(i,l)}static fromPinnedBuffer(i,l,f){return te(i,l,f)}toDataURL(i){return q(this,i)}toImageData(i){return oe(this,i)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(i){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let l=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=l,i&&this.disposer&&(this.disposer(),this.disposer=void 0),l}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(i){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Ue(this,i)}}}),_e,Ae=u(()=>{Ge(),_e=Ye}),He,qe,Qe,Ke,rt=u(()=>{D(),He=(i,l)=>{(typeof P.trace>"u"?!P.wasm.trace:!P.trace)||console.timeStamp(`${i}::ORT::${l}`)},qe=(i,l)=>{var _;let f=((_=new Error().stack)==null?void 0:_.split(/\r\n|\r|\n/g))||[],g=!1;for(let w=0;w<f.length;w++){if(g&&!f[w].includes("TRACE_FUNC")){let y=`FUNC_${i}::${f[w].trim().split(" ")[1]}`;l&&(y+=`::${l}`),He("CPU",y);return}f[w].includes("TRACE_FUNC")&&(g=!0)}},Qe=i=>{(typeof P.trace>"u"?!P.wasm.trace:!P.trace)||qe("BEGIN",i)},Ke=i=>{(typeof P.trace>"u"?!P.wasm.trace:!P.trace)||qe("END",i)}}),ht,_t=u(()=>{b(),Ae(),rt(),ht=class nF{constructor(l){this.handler=l}async run(l,f,g){Qe();let _={},w={};if(typeof l!="object"||l===null||l instanceof _e||Array.isArray(l))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let y=!0;if(typeof f=="object"){if(f===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(f instanceof _e)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(f)){if(f.length===0)throw new TypeError("'fetches' cannot be an empty array.");y=!1;for(let F of f){if(typeof F!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(F)===-1)throw new RangeError(`'fetches' contains invalid output name: ${F}.`);_[F]=null}if(typeof g=="object"&&g!==null)w=g;else if(typeof g<"u")throw new TypeError("'options' must be an object.")}else{let F=!1,K=Object.getOwnPropertyNames(f);for(let W of this.outputNames)if(K.indexOf(W)!==-1){let C=f[W];(C===null||C instanceof _e)&&(F=!0,y=!1,_[W]=C)}if(F){if(typeof g=="object"&&g!==null)w=g;else if(typeof g<"u")throw new TypeError("'options' must be an object.")}else w=f}}else if(typeof f<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let F of this.inputNames)if(typeof l[F]>"u")throw new Error(`input '${F}' is missing in 'feeds'.`);if(y)for(let F of this.outputNames)_[F]=null;let S=await this.handler.run(l,_,w),L={};for(let F in S)if(Object.hasOwnProperty.call(S,F)){let K=S[F];K instanceof _e?L[F]=K:L[F]=new _e(K.type,K.data,K.dims)}return Ke(),L}async release(){return this.handler.dispose()}static async create(l,f,g,_){Qe();let w,y={};if(typeof l=="string"){if(w=l,typeof f=="object"&&f!==null)y=f;else if(typeof f<"u")throw new TypeError("'options' must be an object.")}else if(l instanceof Uint8Array){if(w=l,typeof f=="object"&&f!==null)y=f;else if(typeof f<"u")throw new TypeError("'options' must be an object.")}else if(l instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&l instanceof SharedArrayBuffer){let K=l,W=0,C=l.byteLength;if(typeof f=="object"&&f!==null)y=f;else if(typeof f=="number"){if(W=f,!Number.isSafeInteger(W))throw new RangeError("'byteOffset' must be an integer.");if(W<0||W>=K.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${K.byteLength}).`);if(C=l.byteLength-W,typeof g=="number"){if(C=g,!Number.isSafeInteger(C))throw new RangeError("'byteLength' must be an integer.");if(C<=0||W+C>K.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${K.byteLength-W}].`);if(typeof _=="object"&&_!==null)y=_;else if(typeof _<"u")throw new TypeError("'options' must be an object.")}else if(typeof g<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof f<"u")throw new TypeError("'options' must be an object.");w=new Uint8Array(K,W,C)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[S,L]=await O(y),F=await S.createInferenceSessionHandler(w,L);return Ke(),new nF(F)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),ot,mt=u(()=>{_t(),ot=ht}),Q=u(()=>{}),ve=u(()=>{}),ie=u(()=>{}),Ee=u(()=>{}),Re={};d(Re,{InferenceSession:()=>ot,TRACE:()=>He,TRACE_FUNC_BEGIN:()=>Qe,TRACE_FUNC_END:()=>Ke,Tensor:()=>_e,env:()=>j,registerBackend:()=>T});var Xe=u(()=>{M(),Y(),mt(),Ae(),Q(),ve(),rt(),ie(),Ee()}),Ze=u(()=>{}),ft={};d(ft,{default:()=>kt});var gt,St,kt,Dt=u(()=>{var i;g2(),cs(),Di(),gt="ort-wasm-proxy-worker",St=((i=globalThis.self)==null?void 0:i.name)===gt,St&&(self.onmessage=l=>{let{type:f,in:g}=l.data;try{switch(f){case"init-wasm":mi(g.wasm).then(()=>{u_(g).then(()=>{postMessage({type:f})},_=>{postMessage({type:f,err:_})})},_=>{postMessage({type:f,err:_})});break;case"init-ep":{let{epName:_,env:w}=g;d_(w,_).then(()=>{postMessage({type:f})},y=>{postMessage({type:f,err:y})});break}case"copy-from":{let{buffer:_}=g,w=hs(_);postMessage({type:f,out:w});break}case"create":{let{model:_,options:w}=g;F1(_,w).then(y=>{postMessage({type:f,out:y})},y=>{postMessage({type:f,err:y})});break}case"release":R1(g),postMessage({type:f});break;case"run":{let{sessionId:_,inputIndices:w,inputs:y,outputIndices:S,options:L}=g;N1(_,w,y,S,new Array(S.length).fill(null),L).then(F=>{F.some(K=>K[3]!=="cpu")?postMessage({type:f,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:f,out:F},B1([...y,...F]))},F=>{postMessage({type:f,err:F})});break}case"end-profiling":z1(g),postMessage({type:f});break;default:}}catch(_){postMessage({type:f,err:_})}}),kt=St?null:l=>new Worker(l??ln,{type:"module",name:gt})}),mn={};d(mn,{default:()=>zn});var An,Gn,zn,Br=u(()=>{var i;Gn=(An=import.meta.url,async function(l={}){function f(){return Bt.buffer!=qt.buffer&&Qn(),qt}function g(){return Bt.buffer!=qt.buffer&&Qn(),Ln}function _(){return Bt.buffer!=qt.buffer&&Qn(),dt}function w(){return Bt.buffer!=qt.buffer&&Qn(),It}function y(){return Bt.buffer!=qt.buffer&&Qn(),Sn}function S(){return Bt.buffer!=qt.buffer&&Qn(),vr}function L(){return Bt.buffer!=qt.buffer&&Qn(),Bs}function F(){return Bt.buffer!=qt.buffer&&Qn(),fc}var K,W,C=Object.assign({},l),X=new Promise((x,N)=>{K=x,W=N}),J=typeof window=="object",ne=typeof importScripts=="function",ce=ne&&self.name=="em-pthread";C.mountExternalData=(x,N)=>{x.startsWith("./")&&(x=x.substring(2)),(C.Fb||(C.Fb=new Map)).set(x,N)},C.unmountExternalData=()=>{delete C.Fb};var fe=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor;let le=()=>{let x=(U,H,se)=>(...Ce)=>{let nt=vo,lt=H==null?void 0:H();Ce=U(...Ce);let Mt=H==null?void 0:H();return lt!==Mt&&(U=Mt,se(lt),H=se=null),vo!=nt?new Promise((Ot,Jt)=>{ab={resolve:Ot,reject:Jt}}):Ce},N=U=>async(...H)=>{var se;try{if(C.Gb)throw Error("Session already started");let Ce=C.Gb={hc:H[0],errors:[]},nt=await U(...H);if(C.Gb!==Ce)throw Error("Session mismatch");(se=C.Hb)==null||se.flush();let lt=Ce.errors;if(0<lt.length){let Mt=await Promise.all(lt);if(Mt=Mt.filter(Ot=>Ot),0<Mt.length)throw Error(Mt.join(`
`))}return nt}finally{C.Gb=null}};C._OrtCreateSession=x(C._OrtCreateSession,()=>C._OrtCreateSession,U=>C._OrtCreateSession=U),C._OrtRun=N(x(C._OrtRun,()=>C._OrtRun,U=>C._OrtRun=U)),C._OrtRunWithBinding=N(x(C._OrtRunWithBinding,()=>C._OrtRunWithBinding,U=>C._OrtRunWithBinding=U)),C._OrtBindInput=x(C._OrtBindInput,()=>C._OrtBindInput,U=>C._OrtBindInput=U),le=void 0};C.jsepInit=(x,N)=>{if(le==null||le(),x==="webgpu"){[C.Hb,C.Vb,C.Zb,C.Ob,C.Yb,C.kb,C.$b,C.cc,C.Wb,C.Xb,C.ac]=N;let U=C.Hb;C.jsepRegisterBuffer=(H,se,Ce,nt)=>U.registerBuffer(H,se,Ce,nt),C.jsepGetBuffer=H=>U.getBuffer(H),C.jsepCreateDownloader=(H,se,Ce)=>U.createDownloader(H,se,Ce),C.jsepOnCreateSession=H=>{U.onCreateSession(H)},C.jsepOnReleaseSession=H=>{U.onReleaseSession(H)},C.jsepOnRunStart=H=>U.onRunStart(H),C.dc=(H,se)=>{U.upload(H,se)}}else if(x==="webnn"){[C.Hb,C.bc,C.Pb,C.jsepEnsureTensor,C.ec,C.jsepDownloadTensor]=N,C.jsepReleaseTensorId=C.Pb;let U=C.Hb;C.jsepOnRunStart=H=>U.onRunStart(H),C.jsepRegisterMLContext=(H,se)=>{U.registerMLContext(H,se)},C.jsepOnReleaseSession=H=>{U.onReleaseSession(H)},C.jsepCreateMLTensorDownloader=(H,se)=>U.createMLTensorDownloader(H,se),C.jsepRegisterMLTensor=(H,se,Ce)=>U.registerMLTensor(H,se,Ce),C.jsepCreateMLContext=H=>U.createMLContext(H),C.jsepRegisterMLConstant=(H,se,Ce,nt,lt)=>U.registerMLConstant(H,se,Ce,nt,lt,C.Fb)}};var Te,Me,$e=Object.assign({},C),ze="./this.program",Ve=(x,N)=>{throw N},st="";(J||ne)&&(ne?st=self.location.href:typeof document<"u"&&document.currentScript&&(st=document.currentScript.src),An&&(st=An),st=st.startsWith("blob:")?"":st.substr(0,st.replace(/[?#].*/,"").lastIndexOf("/")+1),ne&&(Me=x=>{var N=new XMLHttpRequest;return N.open("GET",x,!1),N.responseType="arraybuffer",N.send(null),new Uint8Array(N.response)}),Te=(x,N,U)=>{var H=new XMLHttpRequest;H.open("GET",x,!0),H.responseType="arraybuffer",H.onload=()=>{H.status==200||H.status==0&&H.response?N(H.response):U()},H.onerror=U,H.send(null)});var pt,$t=console.log.bind(console),on=console.error.bind(console),dn=$t,Pt=on;if(Object.assign(C,$e),$e=null,ce){let x=function(N){try{var U=N.data,H=U.cmd;if(H==="load"){let se=[];self.onmessage=Ce=>se.push(Ce),self.startWorker=()=>{postMessage({cmd:"loaded"});for(let Ce of se)x(Ce);self.onmessage=x};for(let Ce of U.handlers)C[Ce]&&!C[Ce].proxy||(C[Ce]=(...nt)=>{postMessage({Nb:"callHandler",pc:Ce,args:nt})},Ce=="print"&&(dn=C[Ce]),Ce=="printErr"&&(Pt=C[Ce]));Bt=U.wasmMemory,Qn(),pn(U.wasmModule)}else if(H==="run"){db(U.pthread_ptr,0,0,1,0,0),ib(U.pthread_ptr),vR(),z2(),Lt||(RP(),Lt=!0);try{wR(U.start_routine,U.arg)}catch(se){if(se!="unwind")throw se}}else H==="cancel"?Kd()&&ev(-1):U.target!=="setimmediate"&&(H==="checkMailbox"?Lt&&Wy():H&&(Pt(`worker: received unknown command ${H}`),Pt(U)))}catch(se){throw jP(),se}};var pn,Lt=!1;Pt=function(...N){N=N.join(" "),console.error(N)},self.alert=function(...N){postMessage({Nb:"alert",text:N.join(" "),rc:Kd()})},C.instantiateWasm=(N,U)=>new Promise(H=>{pn=se=>{se=new WebAssembly.Instance(se,L2()),U(se),H()}}),self.onunhandledrejection=N=>{throw N.reason||N},self.onmessage=x}C.wasmBinary&&(pt=C.wasmBinary);var Bt,Vn,nn,qt,Ln,dt,It,Sn,vr,Bs,Wr,go,fc,gr=!1;function Qn(){var x=Bt.buffer;C.HEAP8=qt=new Int8Array(x),C.HEAP16=dt=new Int16Array(x),C.HEAPU8=Ln=new Uint8Array(x),C.HEAPU16=It=new Uint16Array(x),C.HEAP32=Sn=new Int32Array(x),C.HEAPU32=vr=new Uint32Array(x),C.HEAPF32=Bs=new Float32Array(x),C.HEAPF64=fc=new Float64Array(x),C.HEAP64=Wr=new BigInt64Array(x),C.HEAPU64=go=new BigUint64Array(x)}if(!ce){if(!((Bt=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0})).buffer instanceof fe))throw Pt("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),Error("bad memory");Qn()}var Na=[],p_=[],K1=[],m_=0,g_=null;function A2(){if(--m_==0&&g_){var x=g_;g_=null,x()}}function za(x){throw Pt(x="Aborted("+x+")"),gr=!0,nn=1,x=new WebAssembly.RuntimeError(x+". Build with -sASSERTIONS for more info."),W(x),x}var H1,$2=x=>x.startsWith("data:application/octet-stream;base64,"),I2=x=>x.startsWith("file://");function O2(x){if(x==H1&&pt)return new Uint8Array(pt);if(Me)return Me(x);throw"both async and sync fetching of the wasm failed"}function D2(x,N,U){return function(H){if(!pt&&(J||ne)){if(typeof fetch=="function"&&!I2(H))return fetch(H,{credentials:"same-origin"}).then(se=>{if(!se.ok)throw`failed to load wasm binary file at '${H}'`;return se.arrayBuffer()}).catch(()=>O2(H));if(Te)return new Promise((se,Ce)=>{Te(H,nt=>se(new Uint8Array(nt)),Ce)})}return Promise.resolve().then(()=>O2(H))}(x).then(H=>WebAssembly.instantiate(H,N)).then(U,H=>{Pt(`failed to asynchronously prepare wasm: ${H}`),za(H)})}function L2(){return{a:{O:yR,Aa:_R,b:xR,aa:W2,B:H2,qa:q2,Y:Y2,_:X2,ra:J2,oa:Z2,ha:eP,na:tP,L:nP,Z:rP,W:sP,pa:iP,X:oP,va:MR,F:TR,Q:ER,P:SR,E:kR,u:AR,q:$R,G:IR,A:NR,R:zR,ua:BR,ka:VR,U:UR,ba:WR,H:GR,ja:ib,ta:KR,t:HR,Ba:qR,x:XR,n:JR,l:e4,c:rb,o:t4,j:s4,w:i4,p:o4,f:a4,s:l4,m:c4,e:u4,k:d4,i:h4,h:f4,d:p4,ea:m4,fa:g4,ga:_4,ca:wP,da:bP,T:y4,g:v4,D:w4,I:b4,M:x4,y:M4,sa:T4,V:E4,v:MP,z:P4,N:S4,S:C4,za:k4,ya:A4,la:PP,ma:SP,$:J1,C:CP,K:kP,ia:AP,J:$P,a:Bt,xa:X1,wa:DP,r:O4}}}var q1={878484:(x,N,U,H,se)=>{if(C===void 0||!C.Fb)return 1;if((x=Ar(Number(x>>>0))).startsWith("./")&&(x=x.substring(2)),!(x=C.Fb.get(x)))return 2;if(N=Number(N>>>0),U=Number(U>>>0),H=Number(H>>>0),N+U>x.byteLength)return 3;try{let Ce=x.subarray(N,N+U);switch(se){case 0:g().set(Ce,H>>>0);break;case 1:C.dc(H,Ce);break;default:return 4}return 0}catch{return 4}},879199:(x,N,U)=>{C.ec(x,g().subarray(N>>>0,N+U>>>0))},879262:()=>C.bc(),879303:x=>{C.Pb(x)},879339:()=>{C.Wb()},879370:()=>{C.Xb()},879399:()=>{C.ac()},879424:x=>C.Vb(x),879457:x=>C.Zb(x),879489:(x,N,U)=>{C.Ob(Number(x),Number(N),Number(U),!0)},879552:(x,N,U)=>{C.Ob(Number(x),Number(N),Number(U))},879609:()=>typeof wasmOffsetConverter<"u",879666:x=>{C.kb("Abs",x,void 0)},879717:x=>{C.kb("Neg",x,void 0)},879768:x=>{C.kb("Floor",x,void 0)},879821:x=>{C.kb("Ceil",x,void 0)},879873:x=>{C.kb("Reciprocal",x,void 0)},879931:x=>{C.kb("Sqrt",x,void 0)},879983:x=>{C.kb("Exp",x,void 0)},880034:x=>{C.kb("Erf",x,void 0)},880085:x=>{C.kb("Sigmoid",x,void 0)},880140:(x,N,U)=>{C.kb("HardSigmoid",x,{alpha:N,beta:U})},880219:x=>{C.kb("Log",x,void 0)},880270:x=>{C.kb("Sin",x,void 0)},880321:x=>{C.kb("Cos",x,void 0)},880372:x=>{C.kb("Tan",x,void 0)},880423:x=>{C.kb("Asin",x,void 0)},880475:x=>{C.kb("Acos",x,void 0)},880527:x=>{C.kb("Atan",x,void 0)},880579:x=>{C.kb("Sinh",x,void 0)},880631:x=>{C.kb("Cosh",x,void 0)},880683:x=>{C.kb("Asinh",x,void 0)},880736:x=>{C.kb("Acosh",x,void 0)},880789:x=>{C.kb("Atanh",x,void 0)},880842:x=>{C.kb("Tanh",x,void 0)},880894:x=>{C.kb("Not",x,void 0)},880945:(x,N,U)=>{C.kb("Clip",x,{min:N,max:U})},881014:x=>{C.kb("Clip",x,void 0)},881066:(x,N)=>{C.kb("Elu",x,{alpha:N})},881124:x=>{C.kb("Gelu",x,void 0)},881176:x=>{C.kb("Relu",x,void 0)},881228:(x,N)=>{C.kb("LeakyRelu",x,{alpha:N})},881292:(x,N)=>{C.kb("ThresholdedRelu",x,{alpha:N})},881362:(x,N)=>{C.kb("Cast",x,{to:N})},881420:x=>{C.kb("Add",x,void 0)},881471:x=>{C.kb("Sub",x,void 0)},881522:x=>{C.kb("Mul",x,void 0)},881573:x=>{C.kb("Div",x,void 0)},881624:x=>{C.kb("Pow",x,void 0)},881675:x=>{C.kb("Equal",x,void 0)},881728:x=>{C.kb("Greater",x,void 0)},881783:x=>{C.kb("GreaterOrEqual",x,void 0)},881845:x=>{C.kb("Less",x,void 0)},881897:x=>{C.kb("LessOrEqual",x,void 0)},881956:(x,N,U,H,se)=>{C.kb("ReduceMean",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},882131:(x,N,U,H,se)=>{C.kb("ReduceMax",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},882305:(x,N,U,H,se)=>{C.kb("ReduceMin",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},882479:(x,N,U,H,se)=>{C.kb("ReduceProd",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},882654:(x,N,U,H,se)=>{C.kb("ReduceSum",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},882828:(x,N,U,H,se)=>{C.kb("ReduceL1",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},883001:(x,N,U,H,se)=>{C.kb("ReduceL2",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},883174:(x,N,U,H,se)=>{C.kb("ReduceLogSum",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},883351:(x,N,U,H,se)=>{C.kb("ReduceSumSquare",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},883531:(x,N,U,H,se)=>{C.kb("ReduceLogSumExp",x,{keepDims:!!N,noopWithEmptyAxes:!!U,axes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},883711:x=>{C.kb("Where",x,void 0)},883764:(x,N,U)=>{C.kb("Transpose",x,{perm:N?Array.from(y().subarray(Number(N)>>>0,Number(U)>>>0)):[]})},883888:(x,N,U,H)=>{C.kb("DepthToSpace",x,{blocksize:N,mode:Ar(U),format:H?"NHWC":"NCHW"})},884021:(x,N,U,H)=>{C.kb("DepthToSpace",x,{blocksize:N,mode:Ar(U),format:H?"NHWC":"NCHW"})},884154:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je,Tn)=>{C.kb("ConvTranspose",x,{format:Mt?"NHWC":"NCHW",autoPad:N,dilations:[U],group:H,kernelShape:[se],pads:[Ce,nt],strides:[lt],wIsConst:()=>!!f()[Ot>>>0],outputPadding:Jt?Array.from(y().subarray(Number(Jt)>>>0,Number(Cn)>>>0)):[],outputShape:Wn?Array.from(y().subarray(Number(Wn)>>>0,Number(Je)>>>0)):[],activation:Ar(Tn)})},884587:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("ConvTranspose",x,{format:lt?"NHWC":"NCHW",autoPad:N,dilations:Array.from(y().subarray(Number(U)>>>0,2+(Number(U)>>>0)>>>0)),group:H,kernelShape:Array.from(y().subarray(Number(se)>>>0,2+(Number(se)>>>0)>>>0)),pads:Array.from(y().subarray(Number(Ce)>>>0,4+(Number(Ce)>>>0)>>>0)),strides:Array.from(y().subarray(Number(nt)>>>0,2+(Number(nt)>>>0)>>>0)),wIsConst:()=>!!f()[Mt>>>0],outputPadding:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],outputShape:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[],activation:Ar(Je)})},885248:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je,Tn)=>{C.kb("ConvTranspose",x,{format:Mt?"NHWC":"NCHW",autoPad:N,dilations:[U],group:H,kernelShape:[se],pads:[Ce,nt],strides:[lt],wIsConst:()=>!!f()[Ot>>>0],outputPadding:Jt?Array.from(y().subarray(Number(Jt)>>>0,Number(Cn)>>>0)):[],outputShape:Wn?Array.from(y().subarray(Number(Wn)>>>0,Number(Je)>>>0)):[],activation:Ar(Tn)})},885681:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("ConvTranspose",x,{format:lt?"NHWC":"NCHW",autoPad:N,dilations:Array.from(y().subarray(Number(U)>>>0,2+(Number(U)>>>0)>>>0)),group:H,kernelShape:Array.from(y().subarray(Number(se)>>>0,2+(Number(se)>>>0)>>>0)),pads:Array.from(y().subarray(Number(Ce)>>>0,4+(Number(Ce)>>>0)>>>0)),strides:Array.from(y().subarray(Number(nt)>>>0,2+(Number(nt)>>>0)>>>0)),wIsConst:()=>!!f()[Mt>>>0],outputPadding:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],outputShape:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[],activation:Ar(Je)})},886342:(x,N)=>{C.kb("GlobalAveragePool",x,{format:N?"NHWC":"NCHW"})},886433:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("AveragePool",x,{format:Je?"NHWC":"NCHW",auto_pad:N,ceil_mode:U,count_include_pad:H,storage_order:se,dilations:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[],kernel_shape:lt?Array.from(y().subarray(Number(lt)>>>0,Number(Mt)>>>0)):[],pads:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],strides:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[]})},886912:(x,N)=>{C.kb("GlobalAveragePool",x,{format:N?"NHWC":"NCHW"})},887003:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("AveragePool",x,{format:Je?"NHWC":"NCHW",auto_pad:N,ceil_mode:U,count_include_pad:H,storage_order:se,dilations:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[],kernel_shape:lt?Array.from(y().subarray(Number(lt)>>>0,Number(Mt)>>>0)):[],pads:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],strides:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[]})},887482:(x,N)=>{C.kb("GlobalMaxPool",x,{format:N?"NHWC":"NCHW"})},887569:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("MaxPool",x,{format:Je?"NHWC":"NCHW",auto_pad:N,ceil_mode:U,count_include_pad:H,storage_order:se,dilations:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[],kernel_shape:lt?Array.from(y().subarray(Number(lt)>>>0,Number(Mt)>>>0)):[],pads:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],strides:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[]})},888044:(x,N)=>{C.kb("GlobalMaxPool",x,{format:N?"NHWC":"NCHW"})},888131:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je)=>{C.kb("MaxPool",x,{format:Je?"NHWC":"NCHW",auto_pad:N,ceil_mode:U,count_include_pad:H,storage_order:se,dilations:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[],kernel_shape:lt?Array.from(y().subarray(Number(lt)>>>0,Number(Mt)>>>0)):[],pads:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],strides:Cn?Array.from(y().subarray(Number(Cn)>>>0,Number(Wn)>>>0)):[]})},888606:(x,N,U,H,se)=>{C.kb("Gemm",x,{alpha:N,beta:U,transA:H,transB:se})},888710:x=>{C.kb("MatMul",x,void 0)},888764:(x,N,U,H)=>{C.kb("ArgMax",x,{keepDims:!!N,selectLastIndex:!!U,axis:H})},888872:(x,N,U,H)=>{C.kb("ArgMin",x,{keepDims:!!N,selectLastIndex:!!U,axis:H})},888980:(x,N)=>{C.kb("Softmax",x,{axis:N})},889043:(x,N)=>{C.kb("Concat",x,{axis:N})},889103:(x,N,U,H,se)=>{C.kb("Split",x,{axis:N,numOutputs:U,splitSizes:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},889259:x=>{C.kb("Expand",x,void 0)},889313:(x,N)=>{C.kb("Gather",x,{axis:Number(N)})},889384:(x,N)=>{C.kb("GatherElements",x,{axis:Number(N)})},889463:(x,N)=>{C.kb("GatherND",x,{batch_dims:Number(N)})},889542:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt)=>{C.kb("Resize",x,{antialias:N,axes:U?Array.from(y().subarray(Number(U)>>>0,Number(H)>>>0)):[],coordinateTransformMode:Ar(se),cubicCoeffA:Ce,excludeOutside:nt,extrapolationValue:lt,keepAspectRatioPolicy:Ar(Mt),mode:Ar(Ot),nearestMode:Ar(Jt)})},889904:(x,N,U,H,se,Ce,nt)=>{C.kb("Slice",x,{starts:N?Array.from(y().subarray(Number(N)>>>0,Number(U)>>>0)):[],ends:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[],axes:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[]})},890168:x=>{C.kb("Tile",x,void 0)},890220:(x,N,U)=>{C.kb("InstanceNormalization",x,{epsilon:N,format:U?"NHWC":"NCHW"})},890334:(x,N,U)=>{C.kb("InstanceNormalization",x,{epsilon:N,format:U?"NHWC":"NCHW"})},890448:x=>{C.kb("Range",x,void 0)},890501:(x,N)=>{C.kb("Einsum",x,{equation:Ar(N)})},890582:(x,N,U,H,se)=>{C.kb("Pad",x,{mode:N,value:U,pads:H?Array.from(y().subarray(Number(H)>>>0,Number(se)>>>0)):[]})},890725:(x,N,U,H,se,Ce)=>{C.kb("BatchNormalization",x,{epsilon:N,momentum:U,spatial:!!se,trainingMode:!!H,format:Ce?"NHWC":"NCHW"})},890894:(x,N,U,H,se,Ce)=>{C.kb("BatchNormalization",x,{epsilon:N,momentum:U,spatial:!!se,trainingMode:!!H,format:Ce?"NHWC":"NCHW"})},891063:(x,N,U)=>{C.kb("CumSum",x,{exclusive:Number(N),reverse:Number(U)})},891160:(x,N,U)=>{C.kb("DequantizeLinear",x,{axis:N,blockSize:U})},891250:(x,N,U,H,se)=>{C.kb("GridSample",x,{align_corners:N,mode:Ar(U),padding_mode:Ar(H),format:se?"NHWC":"NCHW"})},891420:(x,N,U,H,se)=>{C.kb("GridSample",x,{align_corners:N,mode:Ar(U),padding_mode:Ar(H),format:se?"NHWC":"NCHW"})},891590:(x,N,U,H,se,Ce,nt,lt,Mt)=>{C.kb("Attention",x,{numHeads:N,isUnidirectional:U,maskFilterValue:H,scale:se,doRotary:Ce,qkvHiddenSizes:nt?Array.from(y().subarray(Number(lt)>>>0,Number(lt)+nt>>>0)):[],pastPresentShareBuffer:!!Mt})},891862:x=>{C.kb("BiasAdd",x,void 0)},891917:x=>{C.kb("BiasSplitGelu",x,void 0)},891978:x=>{C.kb("FastGelu",x,void 0)},892034:(x,N,U,H,se,Ce,nt,lt,Mt,Ot,Jt,Cn,Wn,Je,Tn,wr)=>{C.kb("Conv",x,{format:Cn?"NHWC":"NCHW",auto_pad:N,dilations:U?Array.from(y().subarray(Number(U)>>>0,Number(H)>>>0)):[],group:se,kernel_shape:Ce?Array.from(y().subarray(Number(Ce)>>>0,Number(nt)>>>0)):[],pads:lt?Array.from(y().subarray(Number(lt)>>>0,Number(Mt)>>>0)):[],strides:Ot?Array.from(y().subarray(Number(Ot)>>>0,Number(Jt)>>>0)):[],w_is_const:()=>!!f()[Number(Wn)>>>0],activation:Ar(Je),activation_params:Tn?Array.from(L().subarray(Number(Tn)>>>0,Number(wr)>>>0)):[]})},892618:x=>{C.kb("Gelu",x,void 0)},892670:(x,N,U,H,se,Ce,nt,lt,Mt)=>{C.kb("GroupQueryAttention",x,{numHeads:N,kvNumHeads:U,scale:H,softcap:se,doRotary:Ce,rotaryInterleaved:nt,smoothSoftmax:lt,localWindowSize:Mt})},892887:(x,N,U,H)=>{C.kb("LayerNormalization",x,{axis:N,epsilon:U,simplified:!!H})},892998:(x,N,U,H)=>{C.kb("LayerNormalization",x,{axis:N,epsilon:U,simplified:!!H})},893109:(x,N,U,H,se,Ce)=>{C.kb("MatMulNBits",x,{k:N,n:U,accuracyLevel:H,bits:se,blockSize:Ce})},893236:(x,N,U,H,se,Ce)=>{C.kb("MultiHeadAttention",x,{numHeads:N,isUnidirectional:U,maskFilterValue:H,scale:se,doRotary:Ce})},893395:(x,N)=>{C.kb("QuickGelu",x,{alpha:N})},893459:(x,N,U,H,se)=>{C.kb("RotaryEmbedding",x,{interleaved:!!N,numHeads:U,rotaryEmbeddingDim:H,scale:se})},893598:(x,N,U)=>{C.kb("SkipLayerNormalization",x,{epsilon:N,simplified:!!U})},893700:(x,N,U)=>{C.kb("SkipLayerNormalization",x,{epsilon:N,simplified:!!U})},893802:(x,N,U,H)=>{C.kb("GatherBlockQuantized",x,{gatherAxis:N,quantizeAxis:U,blockSize:H})},893923:x=>{C.$b(x)},893957:(x,N)=>C.cc(Number(x),Number(N),C.Gb.hc,C.Gb.errors)};function _R(x,N,U){return mP(async()=>{await C.Yb(Number(x),Number(N),Number(U))})}function yR(){return typeof wasmOffsetConverter<"u"}function Q1(x){this.name="ExitStatus",this.message=`Program terminated with exit(${x})`,this.status=x}var Y1=x=>{x.terminate(),x.onmessage=()=>{}},F2=x=>{Ba.length==0&&(V2(),B2(Ba[0]));var N=Ba.pop();if(!N)return 6;mc.push(N),_o[x.Bb]=N,N.Bb=x.Bb;var U={cmd:"run",start_routine:x.ic,arg:x.Rb,pthread_ptr:x.Bb};return N.postMessage(U,x.nc),0},pc=0,_r=(x,N,...U)=>{for(var H=2*U.length,se=pb(),Ce=fb(8*H),nt=Ce>>>3,lt=0;lt<U.length;lt++){var Mt=U[lt];typeof Mt=="bigint"?(Wr[nt+2*lt]=1n,Wr[nt+2*lt+1]=Mt):(Wr[nt+2*lt]=0n,F()[nt+2*lt+1>>>0]=Mt)}return x=NP(x,0,H,Ce,N),tv(se),x};function X1(x){if(ce)return _r(0,1,x);if(nn=x,!(0<pc)){for(var N of mc)Y1(N);for(N of Ba)Y1(N);Ba=[],mc=[],_o=[],gr=!0}Ve(x,new Q1(x))}function R2(x){if(ce)return _r(1,0,x);J1(x)}var J1=x=>{if(nn=x,ce)throw R2(x),"unwind";X1(x)},Ba=[],mc=[],j2=[],_o={},N2=x=>{var N=x.Bb;delete _o[N],Ba.push(x),mc.splice(mc.indexOf(x),1),x.Bb=0,hb(N)};function z2(){j2.forEach(x=>x())}var B2=x=>new Promise(N=>{x.onmessage=se=>{var Ce=(se=se.data).cmd;if(se.targetThread&&se.targetThread!=Kd()){var nt=_o[se.targetThread];nt?nt.postMessage(se,se.transferList):Pt(`Internal error! Worker sent a message "${Ce}" to target pthread ${se.targetThread}, but that thread no longer exists!`)}else Ce==="checkMailbox"?Wy():Ce==="spawnThread"?F2(se):Ce==="cleanupThread"?N2(_o[se.thread]):Ce==="killThread"?(se=se.thread,Ce=_o[se],delete _o[se],Y1(Ce),hb(se),mc.splice(mc.indexOf(Ce),1),Ce.Bb=0):Ce==="cancelThread"?_o[se.thread].postMessage({cmd:"cancel"}):Ce==="loaded"?(x.loaded=!0,N(x)):Ce==="alert"?alert(`Thread ${se.threadId}: ${se.text}`):se.target==="setimmediate"?x.postMessage(se):Ce==="callHandler"?C[se.handler](...se.args):Ce&&Pt(`worker sent an unknown command ${Ce}`)},x.onerror=se=>{throw Pt(`worker sent an error! ${se.filename}:${se.lineno}: ${se.message}`),se};var U,H=[];for(U of[])C.hasOwnProperty(U)&&H.push(U);x.postMessage({cmd:"load",handlers:H,wasmMemory:Bt,wasmModule:Vn})});function V2(){var x=new Worker(import.meta.url.startsWith("file:")?new URL(n("./node_modules/onnxruntime-web/dist/ort.bundle.min.mjs?46eb"),n.b):new URL(import.meta.url),{type:"module",workerData:"em-pthread",name:"em-pthread"});Ba.push(x)}var Uy=x=>{for(;0<x.length;)x.shift()(C)},vR=()=>{var x=Kd(),N=S()[x+52>>>2>>>0];x=S()[x+56>>>2>>>0],BP(N,N-x),tv(N)},wR=(x,N)=>{pc=0,x=VP(x,N),0<pc?nn=x:ev(x)};class bR{constructor(N){this.Kb=N-24}}function xR(x,N,U){var H=new bR(x>>>=0);throw N>>>=0,U>>>=0,S()[H.Kb+16>>>2>>>0]=0,S()[H.Kb+4>>>2>>>0]=N,S()[H.Kb+8>>>2>>>0]=U,x}function U2(x,N,U,H){return ce?_r(2,1,x,N,U,H):W2(x,N,U,H)}function W2(x,N,U,H){if(x>>>=0,N>>>=0,U>>>=0,H>>>=0,fe===void 0)return Pt("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var se=[];return ce&&se.length===0?U2(x,N,U,H):(x={ic:U,Bb:x,Rb:H,nc:se},ce?(x.Nb="spawnThread",postMessage(x,se),0):F2(x))}var G2=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,K2=(x,N,U)=>{var H=(N>>>=0)+U;for(U=N;x[U]&&!(U>=H);)++U;if(16<U-N&&x.buffer&&G2)return G2.decode(x.buffer instanceof fe?x.slice(N,U):x.subarray(N,U));for(H="";N<U;){var se=x[N++];if(128&se){var Ce=63&x[N++];if((224&se)==192)H+=String.fromCharCode((31&se)<<6|Ce);else{var nt=63&x[N++];65536>(se=(240&se)==224?(15&se)<<12|Ce<<6|nt:(7&se)<<18|Ce<<12|nt<<6|63&x[N++])?H+=String.fromCharCode(se):(se-=65536,H+=String.fromCharCode(55296|se>>10,56320|1023&se))}}else H+=String.fromCharCode(se)}return H},Ar=(x,N)=>(x>>>=0)?K2(g(),x,N):"";function H2(x,N,U){return ce?_r(3,1,x,N,U):0}function q2(x,N){if(ce)return _r(4,1,x,N)}var Z1=x=>{for(var N=0,U=0;U<x.length;++U){var H=x.charCodeAt(U);127>=H?N++:2047>=H?N+=2:55296<=H&&57343>=H?(N+=4,++U):N+=3}return N},Q2=(x,N,U,H)=>{if(!(0<H))return 0;var se=U>>>=0;H=U+H-1;for(var Ce=0;Ce<x.length;++Ce){var nt=x.charCodeAt(Ce);if(55296<=nt&&57343>=nt&&(nt=65536+((1023&nt)<<10)|1023&x.charCodeAt(++Ce)),127>=nt){if(U>=H)break;N[U++>>>0]=nt}else{if(2047>=nt){if(U+1>=H)break;N[U++>>>0]=192|nt>>6}else{if(65535>=nt){if(U+2>=H)break;N[U++>>>0]=224|nt>>12}else{if(U+3>=H)break;N[U++>>>0]=240|nt>>18,N[U++>>>0]=128|nt>>12&63}N[U++>>>0]=128|nt>>6&63}N[U++>>>0]=128|63&nt}}return N[U>>>0]=0,U-se},Wd=(x,N,U)=>Q2(x,g(),N,U);function Y2(x,N){if(ce)return _r(5,1,x,N)}function X2(x,N,U){if(ce)return _r(6,1,x,N,U)}function J2(x,N,U){return ce?_r(7,1,x,N,U):0}function Z2(x,N){if(ce)return _r(8,1,x,N)}function eP(x,N,U){if(ce)return _r(9,1,x,N,U)}function tP(x,N,U,H){if(ce)return _r(10,1,x,N,U,H)}function nP(x,N,U,H){if(ce)return _r(11,1,x,N,U,H)}function rP(x,N,U,H){if(ce)return _r(12,1,x,N,U,H)}function sP(x){if(ce)return _r(13,1,x)}function iP(x,N){if(ce)return _r(14,1,x,N)}function oP(x,N,U){if(ce)return _r(15,1,x,N,U)}var aP,Va,MR=()=>{za("")},yo=x=>{for(var N="";g()[x>>>0];)N+=aP[g()[x++>>>0]];return N},eb={},tb={};function Yo(x,N,U={}){if(!("argPackAdvance"in N))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(H,se,Ce={}){var nt=se.name;if(!H)throw new Va(`type "${nt}" must have a positive integer typeid pointer`);if(tb.hasOwnProperty(H)){if(Ce.Tb)return;throw new Va(`Cannot register type '${nt}' twice`)}tb[H]=se,eb.hasOwnProperty(H)&&(se=eb[H],delete eb[H],se.forEach(lt=>lt()))}(x,N,U)}var lP=(x,N,U)=>{switch(N){case 1:return U?H=>f()[H>>>0]:H=>g()[H>>>0];case 2:return U?H=>_()[H>>>1>>>0]:H=>w()[H>>>1>>>0];case 4:return U?H=>y()[H>>>2>>>0]:H=>S()[H>>>2>>>0];case 8:return U?H=>Wr[H>>>3]:H=>go[H>>>3];default:throw new TypeError(`invalid integer width (${N}): ${x}`)}};function TR(x,N,U){U>>>=0,Yo(x>>>=0,{name:N=yo(N>>>0),fromWireType:H=>H,toWireType:function(H,se){if(typeof se!="bigint"&&typeof se!="number")throw se=se===null?"null":(H=typeof se)=="object"||H==="array"||H==="function"?se.toString():""+se,new TypeError(`Cannot convert "${se}" to ${this.name}`);return typeof se=="number"&&(se=BigInt(se)),se},argPackAdvance:Ua,readValueFromPointer:lP(N,U,N.indexOf("u")==-1),Eb:null})}var Ua=8;function ER(x,N,U,H){Yo(x>>>=0,{name:N=yo(N>>>0),fromWireType:function(se){return!!se},toWireType:function(se,Ce){return Ce?U:H},argPackAdvance:Ua,readValueFromPointer:function(se){return this.fromWireType(g()[se>>>0])},Eb:null})}var nb=[],Xo=[];function rb(x){9<(x>>>=0)&&--Xo[x+1]==0&&(Xo[x]=void 0,nb.push(x))}var Zs=x=>{if(!x)throw new Va("Cannot use deleted val. handle = "+x);return Xo[x]},wi=x=>{switch(x){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let N=nb.pop()||Xo.length;return Xo[N]=x,Xo[N+1]=1,N}};function sb(x){return this.fromWireType(S()[x>>>2>>>0])}var PR={name:"emscripten::val",fromWireType:x=>{var N=Zs(x);return rb(x),N},toWireType:(x,N)=>wi(N),argPackAdvance:Ua,readValueFromPointer:sb,Eb:null};function SR(x){return Yo(x>>>0,PR)}var CR=(x,N)=>{switch(N){case 4:return function(U){return this.fromWireType(L()[U>>>2>>>0])};case 8:return function(U){return this.fromWireType(F()[U>>>3>>>0])};default:throw new TypeError(`invalid float width (${N}): ${x}`)}};function kR(x,N,U){U>>>=0,Yo(x>>>=0,{name:N=yo(N>>>0),fromWireType:H=>H,toWireType:(H,se)=>se,argPackAdvance:Ua,readValueFromPointer:CR(N,U),Eb:null})}function AR(x,N,U,H,se){if(x>>>=0,U>>>=0,N=yo(N>>>0),se===-1&&(se=4294967295),se=lt=>lt,H===0){var Ce=32-8*U;se=lt=>lt<<Ce>>>Ce}var nt=N.includes("unsigned")?function(lt,Mt){return Mt>>>0}:function(lt,Mt){return Mt};Yo(x,{name:N,fromWireType:se,toWireType:nt,argPackAdvance:Ua,readValueFromPointer:lP(N,U,H!==0),Eb:null})}function $R(x,N,U){function H(Ce){var nt=S()[Ce>>>2>>>0];return Ce=S()[Ce+4>>>2>>>0],new se(f().buffer,Ce,nt)}var se=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][N];Yo(x>>>=0,{name:U=yo(U>>>0),fromWireType:H,argPackAdvance:Ua,readValueFromPointer:H},{Tb:!0})}function IR(x,N){x>>>=0;var U=(N=yo(N>>>0))==="std::string";Yo(x,{name:N,fromWireType:function(H){var se=S()[H>>>2>>>0],Ce=H+4;if(U)for(var nt=Ce,lt=0;lt<=se;++lt){var Mt=Ce+lt;if(lt==se||g()[Mt>>>0]==0){if(nt=Ar(nt,Mt-nt),Ot===void 0)var Ot=nt;else Ot+="\0",Ot+=nt;nt=Mt+1}}else{for(Ot=Array(se),lt=0;lt<se;++lt)Ot[lt]=String.fromCharCode(g()[Ce+lt>>>0]);Ot=Ot.join("")}return wo(H),Ot},toWireType:function(H,se){se instanceof ArrayBuffer&&(se=new Uint8Array(se));var Ce=typeof se=="string";if(!(Ce||se instanceof Uint8Array||se instanceof Uint8ClampedArray||se instanceof Int8Array))throw new Va("Cannot pass non-string to std::string");var nt=U&&Ce?Z1(se):se.length,lt=Zy(4+nt+1),Mt=lt+4;if(S()[lt>>>2>>>0]=nt,U&&Ce)Wd(se,Mt,nt+1);else if(Ce)for(Ce=0;Ce<nt;++Ce){var Ot=se.charCodeAt(Ce);if(255<Ot)throw wo(Mt),new Va("String has UTF-16 code units that do not fit in 8 bits");g()[Mt+Ce>>>0]=Ot}else for(Ce=0;Ce<nt;++Ce)g()[Mt+Ce>>>0]=se[Ce];return H!==null&&H.push(wo,lt),lt},argPackAdvance:Ua,readValueFromPointer:sb,Eb(H){wo(H)}})}var cP=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,OR=(x,N)=>{for(var U=x>>1,H=U+N/2;!(U>=H)&&w()[U>>>0];)++U;if(32<(U<<=1)-x&&cP)return cP.decode(g().slice(x,U));for(U="",H=0;!(H>=N/2);++H){var se=_()[x+2*H>>>1>>>0];if(se==0)break;U+=String.fromCharCode(se)}return U},DR=(x,N,U)=>{if(U??(U=2147483647),2>U)return 0;var H=N;U=(U-=2)<2*x.length?U/2:x.length;for(var se=0;se<U;++se){var Ce=x.charCodeAt(se);_()[N>>>1>>>0]=Ce,N+=2}return _()[N>>>1>>>0]=0,N-H},LR=x=>2*x.length,FR=(x,N)=>{for(var U=0,H="";!(U>=N/4);){var se=y()[x+4*U>>>2>>>0];if(se==0)break;++U,65536<=se?(se-=65536,H+=String.fromCharCode(55296|se>>10,56320|1023&se)):H+=String.fromCharCode(se)}return H},RR=(x,N,U)=>{if(N>>>=0,U??(U=2147483647),4>U)return 0;var H=N;U=H+U-4;for(var se=0;se<x.length;++se){var Ce=x.charCodeAt(se);if(55296<=Ce&&57343>=Ce&&(Ce=65536+((1023&Ce)<<10)|1023&x.charCodeAt(++se)),y()[N>>>2>>>0]=Ce,(N+=4)+4>U)break}return y()[N>>>2>>>0]=0,N-H},jR=x=>{for(var N=0,U=0;U<x.length;++U){var H=x.charCodeAt(U);55296<=H&&57343>=H&&++U,N+=4}return N};function NR(x,N,U){if(x>>>=0,N>>>=0,U=yo(U>>>=0),N===2)var H=OR,se=DR,Ce=LR,nt=lt=>w()[lt>>>1>>>0];else N===4&&(H=FR,se=RR,Ce=jR,nt=lt=>S()[lt>>>2>>>0]);Yo(x,{name:U,fromWireType:lt=>{for(var Mt,Ot=S()[lt>>>2>>>0],Jt=lt+4,Cn=0;Cn<=Ot;++Cn){var Wn=lt+4+Cn*N;Cn!=Ot&&nt(Wn)!=0||(Jt=H(Jt,Wn-Jt),Mt===void 0?Mt=Jt:(Mt+="\0",Mt+=Jt),Jt=Wn+N)}return wo(lt),Mt},toWireType:(lt,Mt)=>{if(typeof Mt!="string")throw new Va(`Cannot pass non-string to C++ string type ${U}`);var Ot=Ce(Mt),Jt=Zy(4+Ot+N);return S()[Jt>>>2>>>0]=Ot/N,se(Mt,Jt+4,Ot+N),lt!==null&&lt.push(wo,Jt),Jt},argPackAdvance:Ua,readValueFromPointer:sb,Eb(lt){wo(lt)}})}function zR(x,N){Yo(x>>>=0,{Ub:!0,name:N=yo(N>>>0),argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})}var BR=()=>1;function VR(x){db(x>>>0,!ne,1,!J,131072,!1),z2()}var uP=x=>{if(!gr)try{if(x(),!(0<pc))try{ce?ev(nn):J1(nn)}catch(N){N instanceof Q1||N=="unwind"||Ve(1,N)}}catch(N){N instanceof Q1||N=="unwind"||Ve(1,N)}};function ib(x){x>>>=0,typeof Atomics.oc=="function"&&(Atomics.oc(y(),x>>>2,x).value.then(Wy),x+=128,Atomics.store(y(),x>>>2,1))}var Wy=()=>{var x=Kd();x&&(ib(x),uP(zP))};function UR(x,N){(x>>>=0)==N>>>0?setTimeout(Wy):ce?postMessage({targetThread:x,cmd:"checkMailbox"}):(x=_o[x])&&x.postMessage({cmd:"checkMailbox"})}var ob=[];function WR(x,N,U,H,se){for(N>>>=0,H/=2,ob.length=H,U=se>>>0>>>3,se=0;se<H;se++)ob[se]=Wr[U+2*se]?Wr[U+2*se+1]:F()[U+2*se+1>>>0];return(N?q1[N]:D4[x])(...ob)}function GR(x){x>>>=0,ce?postMessage({cmd:"cleanupThread",thread:x}):N2(_o[x])}function KR(x){}var Gy=(x,N)=>{var U=tb[x];if(U===void 0)throw x=FP(x),U=yo(x),wo(x),new Va(`${N} has unknown type ${U}`);return U},dP=(x,N,U)=>{var H=[];return x=x.toWireType(H,U),H.length&&(S()[N>>>2>>>0]=wi(H)),x};function HR(x,N,U){return N>>>=0,U>>>=0,x=Zs(x>>>0),N=Gy(N,"emval::as"),dP(N,U,x)}function qR(x,N){return N>>>=0,x=Zs(x>>>0),(N=Gy(N,"emval::as")).toWireType(null,x)}var Ky=x=>{try{x()}catch(N){za(N)}},Wa=0,vo=null,hP=0,Hy=[],fP={},pP={},QR=0,ab=null,YR=[];function mP(x){return function(N){if(!gr){if(Wa===0){var U=!1,H=!1;N((se=0)=>{if(!gr&&(hP=se,U=!0,H)){Wa=2,Ky(()=>GP(vo)),typeof Browser<"u"&&Browser.Lb.Sb&&Browser.Lb.resume(),se=!1;try{var Ce=function(){var Mt=y()[vo+8>>>2>>>0];return Mt=Yt[pP[Mt]],--pc,Mt()}()}catch(Mt){Ce=Mt,se=!0}var nt=!1;if(!vo){var lt=ab;lt&&(ab=null,(se?lt.reject:lt.resolve)(Ce),nt=!0)}if(se&&!nt)throw Ce}}),H=!0,U||(Wa=1,vo=function(){var se=Zy(65548),Ce=se+12;S()[se>>>2>>>0]=Ce,S()[se+4>>>2>>>0]=Ce+65536,Ce=Hy[0];var nt=fP[Ce];return nt===void 0&&(nt=QR++,fP[Ce]=nt,pP[nt]=Ce),Ce=nt,y()[se+8>>>2>>>0]=Ce,se}(),typeof Browser<"u"&&Browser.Lb.Sb&&Browser.Lb.pause(),Ky(()=>UP(vo)))}else Wa===2?(Wa=0,Ky(KP),wo(vo),vo=null,YR.forEach(uP)):za(`invalid state: ${Wa}`);return hP}}(N=>{x().then(N)})}function XR(x){return x>>>=0,mP(()=>(x=Zs(x)).then(wi))}var qy=[];function JR(x,N,U,H){return U>>>=0,H>>>=0,(x=qy[x>>>0])(null,N=Zs(N>>>0),U,H)}var ZR={},Qy=x=>{var N=ZR[x];return N===void 0?yo(x):N};function e4(x,N,U,H,se){return U>>>=0,H>>>=0,se>>>=0,(x=qy[x>>>0])(N=Zs(N>>>0),N[U=Qy(U)],H,se)}var gP=()=>typeof globalThis=="object"?globalThis:Function("return this")();function t4(x){return(x>>>=0)==0?wi(gP()):(x=Qy(x),wi(gP()[x]))}var n4=x=>{var N=qy.length;return qy.push(x),N},r4=(x,N)=>{for(var U=Array(x),H=0;H<x;++H)U[H]=Gy(S()[N+4*H>>>2>>>0],"parameter "+H);return U},_P=(x,N)=>Object.defineProperty(N,"name",{value:x});function s4(x,N,U){var H=(N=r4(x,N>>>0)).shift();x--;var se=`return function (obj, func, destructorsRef, args) {
`,Ce=0,nt=[];U===0&&nt.push("obj");for(var lt=["retType"],Mt=[H],Ot=0;Ot<x;++Ot)nt.push("arg"+Ot),lt.push("argType"+Ot),Mt.push(N[Ot]),se+=`  var arg${Ot} = argType${Ot}.readValueFromPointer(args${Ce?"+"+Ce:""});
`,Ce+=N[Ot].argPackAdvance;return se+=`  var rv = ${U===1?"new func":"func.call"}(${nt.join(", ")});
`,H.Ub||(lt.push("emval_returnValue"),Mt.push(dP),se+=`  return emval_returnValue(retType, destructorsRef, rv);
`),lt.push(se+`};
`),x=function(Jt){var Cn=Function;if(!(Cn instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Cn} which is not a function`);var Wn=_P(Cn.name||"unknownFunctionName",function(){});return Wn.prototype=Cn.prototype,Wn=new Wn,(Jt=Cn.apply(Wn,Jt))instanceof Object?Jt:Wn}(lt)(...Mt),U=`methodCaller<(${N.map(Jt=>Jt.name).join(", ")}) => ${H.name}>`,n4(_P(U,x))}function i4(x){return x=Qy(x>>>0),wi(C[x])}function o4(x,N){return N>>>=0,x=Zs(x>>>0),N=Zs(N),wi(x[N])}function a4(x){9<(x>>>=0)&&(Xo[x+1]+=1)}function l4(){return wi([])}function c4(x){x=Zs(x>>>0);for(var N=Array(x.length),U=0;U<x.length;U++)N[U]=x[U];return wi(N)}function u4(x){return wi(Qy(x>>>0))}function d4(){return wi({})}function h4(x){for(var N=Zs(x>>>=0);N.length;){var U=N.pop();N.pop()(U)}rb(x)}function f4(x,N,U){N>>>=0,U>>>=0,x=Zs(x>>>0),N=Zs(N),U=Zs(U),x[N]=U}function p4(x,N){return N>>>=0,x=(x=Gy(x>>>0,"_emval_take_value")).readValueFromPointer(N),wi(x)}function m4(x,N){x=-9007199254740992>x||9007199254740992<x?NaN:Number(x),N>>>=0,x=new Date(1e3*x),y()[N>>>2>>>0]=x.getUTCSeconds(),y()[N+4>>>2>>>0]=x.getUTCMinutes(),y()[N+8>>>2>>>0]=x.getUTCHours(),y()[N+12>>>2>>>0]=x.getUTCDate(),y()[N+16>>>2>>>0]=x.getUTCMonth(),y()[N+20>>>2>>>0]=x.getUTCFullYear()-1900,y()[N+24>>>2>>>0]=x.getUTCDay(),x=(x.getTime()-Date.UTC(x.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,y()[N+28>>>2>>>0]=x}var Gd=x=>x%4==0&&(x%100!=0||x%400==0),yP=[0,31,60,91,121,152,182,213,244,274,305,335],vP=[0,31,59,90,120,151,181,212,243,273,304,334];function g4(x,N){x=-9007199254740992>x||9007199254740992<x?NaN:Number(x),N>>>=0,x=new Date(1e3*x),y()[N>>>2>>>0]=x.getSeconds(),y()[N+4>>>2>>>0]=x.getMinutes(),y()[N+8>>>2>>>0]=x.getHours(),y()[N+12>>>2>>>0]=x.getDate(),y()[N+16>>>2>>>0]=x.getMonth(),y()[N+20>>>2>>>0]=x.getFullYear()-1900,y()[N+24>>>2>>>0]=x.getDay();var U=(Gd(x.getFullYear())?yP:vP)[x.getMonth()]+x.getDate()-1|0;y()[N+28>>>2>>>0]=U,y()[N+36>>>2>>>0]=-60*x.getTimezoneOffset(),U=new Date(x.getFullYear(),6,1).getTimezoneOffset();var H=new Date(x.getFullYear(),0,1).getTimezoneOffset();x=0|(U!=H&&x.getTimezoneOffset()==Math.min(H,U)),y()[N+32>>>2>>>0]=x}function _4(x){x>>>=0;var N=new Date(y()[x+20>>>2>>>0]+1900,y()[x+16>>>2>>>0],y()[x+12>>>2>>>0],y()[x+8>>>2>>>0],y()[x+4>>>2>>>0],y()[x>>>2>>>0],0),U=y()[x+32>>>2>>>0],H=N.getTimezoneOffset(),se=new Date(N.getFullYear(),6,1).getTimezoneOffset(),Ce=new Date(N.getFullYear(),0,1).getTimezoneOffset(),nt=Math.min(Ce,se);return 0>U?y()[x+32>>>2>>>0]=+(se!=Ce&&nt==H):0<U!=(nt==H)&&(se=Math.max(Ce,se),N.setTime(N.getTime()+6e4*((0<U?nt:se)-H))),y()[x+24>>>2>>>0]=N.getDay(),U=(Gd(N.getFullYear())?yP:vP)[N.getMonth()]+N.getDate()-1|0,y()[x+28>>>2>>>0]=U,y()[x>>>2>>>0]=N.getSeconds(),y()[x+4>>>2>>>0]=N.getMinutes(),y()[x+8>>>2>>>0]=N.getHours(),y()[x+12>>>2>>>0]=N.getDate(),y()[x+16>>>2>>>0]=N.getMonth(),y()[x+20>>>2>>>0]=N.getYear(),x=N.getTime(),BigInt(isNaN(x)?-1:x/1e3)}function wP(x,N,U,H,se,Ce,nt){return ce?_r(16,1,x,N,U,H,se,Ce,nt):-52}function bP(x,N,U,H,se,Ce){if(ce)return _r(17,1,x,N,U,H,se,Ce)}function y4(x,N,U,H){x>>>=0,N>>>=0,U>>>=0,H>>>=0;var se=new Date().getFullYear(),Ce=new Date(se,0,1),nt=new Date(se,6,1);se=Ce.getTimezoneOffset();var lt=nt.getTimezoneOffset(),Mt=Math.max(se,lt);S()[x>>>2>>>0]=60*Mt,y()[N>>>2>>>0]=+(se!=lt),Ce=(x=Ot=>Ot.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1])(Ce),nt=x(nt),lt<se?(Wd(Ce,U,17),Wd(nt,H,17)):(Wd(Ce,H,17),Wd(nt,U,17))}var lb=[],xP=(x,N)=>{lb.length=0;for(var U;U=g()[x++>>>0];){var H=U!=105;N+=(H&=U!=112)&&N%8?4:0,lb.push(U==112?S()[N>>>2>>>0]:U==106?Wr[N>>>3]:U==105?y()[N>>>2>>>0]:F()[N>>>3>>>0]),N+=H?8:4}return lb};function v4(x,N,U){return x>>>=0,N=xP(N>>>0,U>>>0),q1[x](...N)}function w4(x,N,U){return x>>>=0,N=xP(N>>>0,U>>>0),q1[x](...N)}var b4=()=>{},x4=()=>Date.now();function M4(x,N){return Pt(Ar(x>>>0,N>>>0))}var MP,T4=()=>{throw pc+=1,"unwind"};function E4(){return 4294901760}MP=()=>performance.timeOrigin+performance.now();var P4=()=>navigator.hardwareConcurrency;function S4(){return za("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function C4(x){x>>>=0;var N=g().length;if(x<=N||4294901760<x)return!1;for(var U=1;4>=U;U*=2){var H=N*(1+.2/U);H=Math.min(H,x+100663296);var se=Math;H=Math.max(x,H);e:{se=(se.min.call(se,4294901760,H+(65536-H%65536)%65536)-Bt.buffer.byteLength+65535)/65536;try{Bt.grow(se),Qn();var Ce=1;break e}catch{}Ce=void 0}if(Ce)return!0}return!1}var Yy=()=>(za("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),__={},TP=x=>{x.forEach(N=>{Yy()})};function k4(){var x=Error().stack.toString().split(`
`);return x[0]=="Error"&&x.shift(),TP(x),__.Qb=Yy(),__.fc=x,__.Qb}function A4(x,N,U){if(x>>>=0,N>>>=0,__.Qb==x)var H=__.fc;else(H=Error().stack.toString().split(`
`))[0]=="Error"&&H.shift(),TP(H);for(var se=3;H[se]&&Yy()!=x;)++se;for(x=0;x<U&&H[x+se];++x)y()[N+4*x>>>2>>>0]=Yy();return x}var cb,ub={},EP=()=>{if(!cb){var x,N={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:ze};for(x in ub)ub[x]===void 0?delete N[x]:N[x]=ub[x];var U=[];for(x in N)U.push(`${x}=${N[x]}`);cb=U}return cb};function PP(x,N){if(ce)return _r(18,1,x,N);x>>>=0,N>>>=0;var U=0;return EP().forEach((H,se)=>{var Ce=N+U;for(se=S()[x+4*se>>>2>>>0]=Ce,Ce=0;Ce<H.length;++Ce)f()[se++>>>0]=H.charCodeAt(Ce);f()[se>>>0]=0,U+=H.length+1}),0}function SP(x,N){if(ce)return _r(19,1,x,N);x>>>=0,N>>>=0;var U=EP();S()[x>>>2>>>0]=U.length;var H=0;return U.forEach(se=>H+=se.length+1),S()[N>>>2>>>0]=H,0}function CP(x){return ce?_r(20,1,x):52}function kP(x,N,U,H){return ce?_r(21,1,x,N,U,H):52}function AP(x,N,U,H){return ce?_r(22,1,x,N,U,H):70}var $4=[null,[],[]];function $P(x,N,U,H){if(ce)return _r(23,1,x,N,U,H);N>>>=0,U>>>=0,H>>>=0;for(var se=0,Ce=0;Ce<U;Ce++){var nt=S()[N>>>2>>>0],lt=S()[N+4>>>2>>>0];N+=8;for(var Mt=0;Mt<lt;Mt++){var Ot=g()[nt+Mt>>>0],Jt=$4[x];Ot===0||Ot===10?((x===1?dn:Pt)(K2(Jt,0)),Jt.length=0):Jt.push(Ot)}se+=lt}return S()[H>>>2>>>0]=se,0}var IP=[31,29,31,30,31,30,31,31,30,31,30,31],OP=[31,28,31,30,31,30,31,31,30,31,30,31],I4=(x,N)=>{f().set(x,N>>>0)};function DP(x,N,U,H){function se(Je,Tn,wr){for(Je=typeof Je=="number"?Je.toString():Je||"";Je.length<Tn;)Je=wr[0]+Je;return Je}function Ce(Je,Tn){return se(Je,Tn,"0")}function nt(Je,Tn){function wr(qP){return 0>qP?-1:0<qP?1:0}var gc;return(gc=wr(Je.getFullYear()-Tn.getFullYear()))===0&&(gc=wr(Je.getMonth()-Tn.getMonth()))===0&&(gc=wr(Je.getDate()-Tn.getDate())),gc}function lt(Je){switch(Je.getDay()){case 0:return new Date(Je.getFullYear()-1,11,29);case 1:return Je;case 2:return new Date(Je.getFullYear(),0,3);case 3:return new Date(Je.getFullYear(),0,2);case 4:return new Date(Je.getFullYear(),0,1);case 5:return new Date(Je.getFullYear()-1,11,31);case 6:return new Date(Je.getFullYear()-1,11,30)}}function Mt(Je){var Tn=Je.Cb;for(Je=new Date(new Date(Je.Db+1900,0,1).getTime());0<Tn;){var wr=Je.getMonth(),gc=(Gd(Je.getFullYear())?IP:OP)[wr];if(!(Tn>gc-Je.getDate())){Je.setDate(Je.getDate()+Tn);break}Tn-=gc-Je.getDate()+1,Je.setDate(1),11>wr?Je.setMonth(wr+1):(Je.setMonth(0),Je.setFullYear(Je.getFullYear()+1))}return wr=new Date(Je.getFullYear()+1,0,4),Tn=lt(new Date(Je.getFullYear(),0,4)),wr=lt(wr),0>=nt(Tn,Je)?0>=nt(wr,Je)?Je.getFullYear()+1:Je.getFullYear():Je.getFullYear()-1}x>>>=0,N>>>=0,U>>>=0,H>>>=0;var Ot=S()[H+40>>>2>>>0];for(var Jt in H={lc:y()[H>>>2>>>0],kc:y()[H+4>>>2>>>0],Ib:y()[H+8>>>2>>>0],Mb:y()[H+12>>>2>>>0],Jb:y()[H+16>>>2>>>0],Db:y()[H+20>>>2>>>0],vb:y()[H+24>>>2>>>0],Cb:y()[H+28>>>2>>>0],sc:y()[H+32>>>2>>>0],jc:y()[H+36>>>2>>>0],mc:Ot?Ar(Ot):""},U=Ar(U),Ot={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})U=U.replace(new RegExp(Jt,"g"),Ot[Jt]);var Cn="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Wn="January February March April May June July August September October November December".split(" ");for(Jt in Ot={"%a":Je=>Cn[Je.vb].substring(0,3),"%A":Je=>Cn[Je.vb],"%b":Je=>Wn[Je.Jb].substring(0,3),"%B":Je=>Wn[Je.Jb],"%C":Je=>Ce((Je.Db+1900)/100|0,2),"%d":Je=>Ce(Je.Mb,2),"%e":Je=>se(Je.Mb,2," "),"%g":Je=>Mt(Je).toString().substring(2),"%G":Mt,"%H":Je=>Ce(Je.Ib,2),"%I":Je=>((Je=Je.Ib)==0?Je=12:12<Je&&(Je-=12),Ce(Je,2)),"%j":Je=>{for(var Tn=0,wr=0;wr<=Je.Jb-1;Tn+=(Gd(Je.Db+1900)?IP:OP)[wr++]);return Ce(Je.Mb+Tn,3)},"%m":Je=>Ce(Je.Jb+1,2),"%M":Je=>Ce(Je.kc,2),"%n":()=>`
`,"%p":Je=>0<=Je.Ib&&12>Je.Ib?"AM":"PM","%S":Je=>Ce(Je.lc,2),"%t":()=>"	","%u":Je=>Je.vb||7,"%U":Je=>Ce(Math.floor((Je.Cb+7-Je.vb)/7),2),"%V":Je=>{var Tn=Math.floor((Je.Cb+7-(Je.vb+6)%7)/7);if(2>=(Je.vb+371-Je.Cb-2)%7&&Tn++,Tn)Tn==53&&((wr=(Je.vb+371-Je.Cb)%7)==4||wr==3&&Gd(Je.Db)||(Tn=1));else{Tn=52;var wr=(Je.vb+7-Je.Cb-1)%7;(wr==4||wr==5&&Gd(Je.Db%400-1))&&Tn++}return Ce(Tn,2)},"%w":Je=>Je.vb,"%W":Je=>Ce(Math.floor((Je.Cb+7-(Je.vb+6)%7)/7),2),"%y":Je=>(Je.Db+1900).toString().substring(2),"%Y":Je=>Je.Db+1900,"%z":Je=>{var Tn=0<=(Je=Je.jc);return Je=Math.abs(Je)/60,(Tn?"+":"-")+("0000"+(Je/60*100+Je%60)).slice(-4)},"%Z":Je=>Je.mc,"%%":()=>"%"},U=U.replace(/%%/g,"\0\0"),Ot)U.includes(Jt)&&(U=U.replace(new RegExp(Jt,"g"),Ot[Jt](H)));return Jt=function(Je){var Tn=Array(Z1(Je)+1);return Q2(Je,Tn,0,Tn.length),Tn}(U=U.replace(/\0\0/g,"%")),Jt.length>N?0:(I4(Jt,x),Jt.length-1)}function O4(x,N,U,H){return DP(x>>>0,N>>>0,U>>>0,H>>>0)}ce||function(){for(var x=C.numThreads-1;x--;)V2();Na.unshift(()=>{m_++,function(N){ce?N():Promise.all(Ba.map(B2)).then(N)}(()=>A2())})}();for(var LP=Array(256),Xy=0;256>Xy;++Xy)LP[Xy]=String.fromCharCode(Xy);aP=LP,Va=C.BindingError=class extends Error{constructor(x){super(x),this.name="BindingError"}},C.InternalError=class extends Error{constructor(x){super(x),this.name="InternalError"}},Xo.push(0,1,void 0,1,null,1,!0,1,!1,1),C.count_emval_handles=()=>Xo.length/2-5-nb.length;var D4=[X1,R2,U2,H2,q2,Y2,X2,J2,Z2,eP,tP,nP,rP,sP,iP,oP,wP,bP,PP,SP,CP,kP,AP,$P],Yt=function(){function x(U,H){return Yt=U.exports,Yt=function(){var se=Yt,Ce={};for(let[nt,lt]of Object.entries(se))Ce[nt]=typeof lt=="function"?(...Mt)=>{Hy.push(nt);try{return lt(...Mt)}finally{gr||(Hy.pop(),vo&&Wa===1&&Hy.length===0&&(Wa=0,pc+=1,Ky(WP),typeof Fibers<"u"&&Fibers.tc()))}}:lt;return Ce}(),Yt=function(){var se=Yt,Ce=lt=>Mt=>lt(Mt)>>>0,nt=lt=>()=>lt()>>>0;return(se=Object.assign({},se)).Da=Ce(se.Da),se.gb=nt(se.gb),se.ib=Ce(se.ib),se.emscripten_main_runtime_thread_id=nt(se.emscripten_main_runtime_thread_id),se.tb=Ce(se.tb),se.ub=nt(se.ub),se}(),j2.push(Yt.jb),p_.unshift(Yt.Ca),Vn=H,A2(),Yt}var N=L2();if(m_++,C.instantiateWasm)try{return C.instantiateWasm(N,x)}catch(U){Pt(`Module.instantiateWasm callback failed with error: ${U}`),W(U)}return H1||(H1=C.locateFile?$2("ort-wasm-simd-threaded.jsep.wasm")?"ort-wasm-simd-threaded.jsep.wasm":C.locateFile?C.locateFile("ort-wasm-simd-threaded.jsep.wasm",st):st+"ort-wasm-simd-threaded.jsep.wasm":new URL(n("./node_modules/onnxruntime-web/dist/ort-wasm-simd-threaded.jsep.wasm"),n.b).href),function(U,H){var se=H1;return pt||typeof WebAssembly.instantiateStreaming!="function"||$2(se)||I2(se)||typeof fetch!="function"?D2(se,U,H):fetch(se,{credentials:"same-origin"}).then(Ce=>WebAssembly.instantiateStreaming(Ce,U).then(H,function(nt){return Pt(`wasm streaming compile failed: ${nt}`),Pt("falling back to ArrayBuffer instantiation"),D2(se,U,H)}))}(N,function(U){x(U.instance,U.module)}).catch(W),{}}(),FP=x=>(FP=Yt.Da)(x),RP=()=>(RP=Yt.Ea)();C._OrtInit=(x,N)=>(C._OrtInit=Yt.Fa)(x,N),C._OrtGetLastError=(x,N)=>(C._OrtGetLastError=Yt.Ga)(x,N),C._OrtCreateSessionOptions=(x,N,U,H,se,Ce,nt,lt,Mt,Ot)=>(C._OrtCreateSessionOptions=Yt.Ha)(x,N,U,H,se,Ce,nt,lt,Mt,Ot),C._OrtAppendExecutionProvider=(x,N)=>(C._OrtAppendExecutionProvider=Yt.Ia)(x,N),C._OrtAddFreeDimensionOverride=(x,N,U)=>(C._OrtAddFreeDimensionOverride=Yt.Ja)(x,N,U),C._OrtAddSessionConfigEntry=(x,N,U)=>(C._OrtAddSessionConfigEntry=Yt.Ka)(x,N,U),C._OrtReleaseSessionOptions=x=>(C._OrtReleaseSessionOptions=Yt.La)(x),C._OrtCreateSession=(x,N,U)=>(C._OrtCreateSession=Yt.Ma)(x,N,U),C._OrtReleaseSession=x=>(C._OrtReleaseSession=Yt.Na)(x),C._OrtGetInputOutputCount=(x,N,U)=>(C._OrtGetInputOutputCount=Yt.Oa)(x,N,U),C._OrtGetInputName=(x,N)=>(C._OrtGetInputName=Yt.Pa)(x,N),C._OrtGetOutputName=(x,N)=>(C._OrtGetOutputName=Yt.Qa)(x,N),C._OrtFree=x=>(C._OrtFree=Yt.Ra)(x),C._OrtCreateTensor=(x,N,U,H,se,Ce)=>(C._OrtCreateTensor=Yt.Sa)(x,N,U,H,se,Ce),C._OrtGetTensorData=(x,N,U,H,se)=>(C._OrtGetTensorData=Yt.Ta)(x,N,U,H,se),C._OrtReleaseTensor=x=>(C._OrtReleaseTensor=Yt.Ua)(x),C._OrtCreateRunOptions=(x,N,U,H)=>(C._OrtCreateRunOptions=Yt.Va)(x,N,U,H),C._OrtAddRunConfigEntry=(x,N,U)=>(C._OrtAddRunConfigEntry=Yt.Wa)(x,N,U),C._OrtReleaseRunOptions=x=>(C._OrtReleaseRunOptions=Yt.Xa)(x),C._OrtCreateBinding=x=>(C._OrtCreateBinding=Yt.Ya)(x),C._OrtBindInput=(x,N,U)=>(C._OrtBindInput=Yt.Za)(x,N,U),C._OrtBindOutput=(x,N,U,H)=>(C._OrtBindOutput=Yt._a)(x,N,U,H),C._OrtClearBoundOutputs=x=>(C._OrtClearBoundOutputs=Yt.$a)(x),C._OrtReleaseBinding=x=>(C._OrtReleaseBinding=Yt.ab)(x),C._OrtRunWithBinding=(x,N,U,H,se)=>(C._OrtRunWithBinding=Yt.bb)(x,N,U,H,se),C._OrtRun=(x,N,U,H,se,Ce,nt,lt)=>(C._OrtRun=Yt.cb)(x,N,U,H,se,Ce,nt,lt),C._OrtEndProfiling=x=>(C._OrtEndProfiling=Yt.db)(x),C._JsepOutput=(x,N,U)=>(C._JsepOutput=Yt.eb)(x,N,U),C._JsepGetNodeName=x=>(C._JsepGetNodeName=Yt.fb)(x);var Jy,Kd=()=>(Kd=Yt.gb)(),wo=C._free=x=>(wo=C._free=Yt.hb)(x),Zy=C._malloc=x=>(Zy=C._malloc=Yt.ib)(x),db=(x,N,U,H,se,Ce)=>(db=Yt.lb)(x,N,U,H,se,Ce),jP=()=>(jP=Yt.mb)(),NP=(x,N,U,H,se)=>(NP=Yt.nb)(x,N,U,H,se),hb=x=>(hb=Yt.ob)(x),ev=x=>(ev=Yt.pb)(x),zP=()=>(zP=Yt.qb)(),BP=(x,N)=>(BP=Yt.rb)(x,N),tv=x=>(tv=Yt.sb)(x),fb=x=>(fb=Yt.tb)(x),pb=()=>(pb=Yt.ub)(),VP=C.dynCall_ii=(x,N)=>(VP=C.dynCall_ii=Yt.wb)(x,N),UP=x=>(UP=Yt.xb)(x),WP=()=>(WP=Yt.yb)(),GP=x=>(GP=Yt.zb)(x),KP=()=>(KP=Yt.Ab)();function HP(){0<m_||(ce?(K(C),ce||Uy(p_),startWorker(C)):(Uy(Na),0<m_||Jy||(Jy=!0,C.calledRun=!0,gr||(ce||Uy(p_),K(C),ce||Uy(K1)))))}return C.___start_em_js=894085,C.___stop_em_js=894331,C.stackSave=()=>pb(),C.stackRestore=x=>tv(x),C.stackAlloc=x=>fb(x),C.setValue=function(x,N,U="i8"){switch(U.endsWith("*")&&(U="*"),U){case"i1":case"i8":f()[x>>>0]=N;break;case"i16":_()[x>>>1>>>0]=N;break;case"i32":y()[x>>>2>>>0]=N;break;case"i64":Wr[x>>>3]=BigInt(N);break;case"float":L()[x>>>2>>>0]=N;break;case"double":F()[x>>>3>>>0]=N;break;case"*":S()[x>>>2>>>0]=N;break;default:za(`invalid type for setValue: ${U}`)}},C.getValue=function(x,N="i8"){switch(N.endsWith("*")&&(N="*"),N){case"i1":case"i8":return f()[x>>>0];case"i16":return _()[x>>>1>>>0];case"i32":return y()[x>>>2>>>0];case"i64":return Wr[x>>>3];case"float":return L()[x>>>2>>>0];case"double":return F()[x>>>3>>>0];case"*":return S()[x>>>2>>>0];default:za(`invalid type for getValue: ${N}`)}},C.UTF8ToString=Ar,C.stringToUTF8=Wd,C.lengthBytesUTF8=Z1,g_=function x(){Jy||HP(),Jy||(g_=x)},HP(),C.PTR_SIZE=4,X}),zn=Gn,((i=globalThis.self)==null?void 0:i.name)==="em-pthread"&&Gn()}),en,$n,ln,fr,Rt,bs,Os,fi,so,xs,io,pi,Oi,Di=u(()=>{Ze(),en=typeof location>"u"?void 0:location.origin,$n=()=>{var i;return(i=import.meta.url)!=null&&i.startsWith("file:")?new URL(new URL(n("./node_modules/onnxruntime-web/dist/ort.bundle.min.mjs?46eb"),n.b).href,en).href:import.meta.url},ln=$n(),fr=()=>{if(ln&&!ln.startsWith("blob:"))return ln.substring(0,ln.lastIndexOf("/")+1)},Rt=(i,l)=>{try{let f=l??ln;return(f?new URL(i,f):new URL(i)).origin===en}catch{return!1}},bs=(i,l)=>{let f=l??ln;try{return(f?new URL(i,f):new URL(i)).href}catch{return}},Os=(i,l)=>`${l??"./"}${i}`,fi=async i=>{let l=await(await fetch(i,{credentials:"same-origin"})).blob();return URL.createObjectURL(l)},so=async i=>(await import(i)).default,xs=(Dt(),m(ft)).default,io=async()=>{if(!ln)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(Rt(ln))return[void 0,xs()];let i=await fi(ln);return[i,xs(i)]},pi=(Br(),m(mn)).default,Oi=async(i,l,f)=>{if(!i&&!l&&pi&&ln&&Rt(ln))return[void 0,pi];{let g="ort-wasm-simd-threaded.jsep.mjs",_=i??bs(g,l),w=f&&_&&!Rt(_,l),y=w?await fi(_):_??Os(g,l);return[w?y:void 0,await so(y)]}}}),ls,ut,At,Wt,Pr,Li,mi,Bn,cs=u(()=>{Di(),ut=!1,At=!1,Wt=!1,Pr=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Li=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},mi=async i=>{if(ut)return Promise.resolve();if(At)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Wt)throw new Error("previous call to 'initializeWebAssembly()' failed.");At=!0;let l=i.initTimeout,f=i.numThreads;if(!Li())throw new Error("WebAssembly SIMD is not supported in the current environment.");let g=Pr();f>1&&!g&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+f+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),i.numThreads=f=1);let _=i.wasmPaths,w=typeof _=="string"?_:void 0,y=_==null?void 0:_.mjs,S=(y==null?void 0:y.href)??y,L=_==null?void 0:_.wasm,F=(L==null?void 0:L.href)??L,K=i.wasmBinary,[W,C]=await Oi(S,w,f>1),X=!1,J=[];if(l>0&&J.push(new Promise(ne=>{setTimeout(()=>{X=!0,ne()},l)})),J.push(new Promise((ne,ce)=>{let fe={numThreads:f};if(K)fe.wasmBinary=K;else if(F||w)fe.locateFile=le=>F??w+le;else if(S&&S.indexOf("blob:")!==0)fe.locateFile=le=>new URL(le,S).href;else if(W){let le=fr();le&&(fe.locateFile=Te=>le+Te)}C(fe).then(le=>{At=!1,ut=!0,ls=le,ne(),W&&URL.revokeObjectURL(W)},le=>{At=!1,Wt=!0,ce(le)})})),await Promise.race(J),X)throw new Error(`WebAssembly backend initializing failed due to timeout: ${l}ms`)},Bn=()=>{if(ut&&ls)return ls;throw new Error("WebAssembly is not initialized yet.")}}),sr,Ys,fn,jo=u(()=>{cs(),sr=(i,l)=>{let f=Bn(),g=f.lengthBytesUTF8(i)+1,_=f._malloc(g);return f.stringToUTF8(i,_,g),l.push(_),_},Ys=(i,l,f,g)=>{if(typeof i=="object"&&i!==null){if(f.has(i))throw new Error("Circular reference in options");f.add(i)}Object.entries(i).forEach(([_,w])=>{let y=l?l+_:_;if(typeof w=="object")Ys(w,y+".",f,g);else if(typeof w=="string"||typeof w=="number")g(y,w.toString());else if(typeof w=="boolean")g(y,w?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof w}`)})},fn=i=>{let l=Bn(),f=l.stackSave();try{let g=l.PTR_SIZE,_=l.stackAlloc(2*g);l._OrtGetLastError(_,_+g);let w=Number(l.getValue(_,g===4?"i32":"i64")),y=l.getValue(_+g,"*"),S=y?l.UTF8ToString(y):"";throw new Error(`${i} ERROR_CODE: ${w}, ERROR_MESSAGE: ${S}`)}finally{l.stackRestore(f)}}}),Fi,Fl=u(()=>{cs(),jo(),Fi=i=>{let l=Bn(),f=0,g=[],_=i||{};try{if((i==null?void 0:i.logSeverityLevel)===void 0)_.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if((i==null?void 0:i.logVerbosityLevel)===void 0)_.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);(i==null?void 0:i.terminate)===void 0&&(_.terminate=!1);let w=0;return(i==null?void 0:i.tag)!==void 0&&(w=sr(i.tag,g)),f=l._OrtCreateRunOptions(_.logSeverityLevel,_.logVerbosityLevel,!!_.terminate,w),f===0&&fn("Can't create run options."),(i==null?void 0:i.extra)!==void 0&&Ys(i.extra,"",new WeakSet,(y,S)=>{let L=sr(y,g),F=sr(S,g);l._OrtAddRunConfigEntry(f,L,F)!==0&&fn(`Can't set a run config entry: ${y} - ${S}.`)}),[f,g]}catch(w){throw f!==0&&l._OrtReleaseRunOptions(f),g.forEach(y=>l._free(y)),w}}}),wa,ba,xa,Ri,Ma,Rl=u(()=>{cs(),jo(),wa=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},ba=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},xa=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let l=i.extra.session;l.use_ort_model_bytes_directly||(l.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(f=>(typeof f=="string"?f:f.name)==="webgpu")&&(i.enableMemPattern=!1)},Ri=(i,l,f)=>{for(let g of l){let _=typeof g=="string"?g:g.name;switch(_){case"webnn":if(_="WEBNN",typeof g!="string"){let y=g==null?void 0:g.deviceType;if(y){let S=sr("deviceType",f),L=sr(y,f);Bn()._OrtAddSessionConfigEntry(i,S,L)!==0&&fn(`Can't set a session config entry: 'deviceType' - ${y}.`)}}break;case"webgpu":if(_="JS",typeof g!="string"){let y=g;if(y!=null&&y.preferredLayout){if(y.preferredLayout!=="NCHW"&&y.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${y.preferredLayout}`);let S=sr("preferredLayout",f),L=sr(y.preferredLayout,f);Bn()._OrtAddSessionConfigEntry(i,S,L)!==0&&fn(`Can't set a session config entry: 'preferredLayout' - ${y.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${_}`)}let w=sr(_,f);Bn()._OrtAppendExecutionProvider(i,w)!==0&&fn(`Can't append execution provider: ${_}.`)}},Ma=i=>{let l=Bn(),f=0,g=[],_=i||{};xa(_);try{let w=wa(_.graphOptimizationLevel??"all"),y=ba(_.executionMode??"sequential"),S=typeof _.logId=="string"?sr(_.logId,g):0,L=_.logSeverityLevel??2;if(!Number.isInteger(L)||L<0||L>4)throw new Error(`log serverity level is not valid: ${L}`);let F=_.logVerbosityLevel??0;if(!Number.isInteger(F)||F<0||F>4)throw new Error(`log verbosity level is not valid: ${F}`);let K=typeof _.optimizedModelFilePath=="string"?sr(_.optimizedModelFilePath,g):0;if(f=l._OrtCreateSessionOptions(w,!!_.enableCpuMemArena,!!_.enableMemPattern,y,!!_.enableProfiling,0,S,L,F,K),f===0&&fn("Can't create session options."),_.executionProviders&&Ri(f,_.executionProviders,g),_.enableGraphCapture!==void 0){if(typeof _.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${_.enableGraphCapture}`);let W=sr("enableGraphCapture",g),C=sr(_.enableGraphCapture.toString(),g);l._OrtAddSessionConfigEntry(f,W,C)!==0&&fn(`Can't set a session config entry: 'enableGraphCapture' - ${_.enableGraphCapture}.`)}if(_.freeDimensionOverrides)for(let[W,C]of Object.entries(_.freeDimensionOverrides)){if(typeof W!="string")throw new Error(`free dimension override name must be a string: ${W}`);if(typeof C!="number"||!Number.isInteger(C)||C<0)throw new Error(`free dimension override value must be a non-negative integer: ${C}`);let X=sr(W,g);l._OrtAddFreeDimensionOverride(f,X,C)!==0&&fn(`Can't set a free dimension override: ${W} - ${C}.`)}return _.extra!==void 0&&Ys(_.extra,"",new WeakSet,(W,C)=>{let X=sr(W,g),J=sr(C,g);l._OrtAddSessionConfigEntry(f,X,J)!==0&&fn(`Can't set a session config entry: ${W} - ${C}.`)}),[f,g]}catch(w){throw f!==0&&l._OrtReleaseSessionOptions(f)!==0&&fn("Can't release session options."),g.forEach(y=>l._free(y)),w}}}),ji,Ds,us,No,oo,zo,Bo,Vo,Kt=u(()=>{ji=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${i}`)}},Ds=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${i}`)}},us=(i,l)=>{let f=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][i],g=typeof l=="number"?l:l.reduce((_,w)=>_*w,1);return f>0?Math.ceil(g*f):void 0},No=i=>{switch(i){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},oo=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},zo=i=>i==="float32"||i==="float16"||i==="int32"||i==="int64"||i==="uint32"||i==="uint8"||i==="bool"||i==="uint4"||i==="int4",Bo=i=>i==="float32"||i==="float16"||i==="int32"||i==="int64"||i==="uint32"||i==="uint64"||i==="int8"||i==="uint8"||i==="bool"||i==="uint4"||i==="int4",Vo=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${i}`)}}}),Uo,Ta=u(()=>{Ze(),Uo=async i=>{if(typeof i=="string"){let l=await fetch(i);if(!l.ok)throw new Error(`failed to load external data file: ${i}`);let f=l.headers.get("Content-Length"),g=f?parseInt(f,10):0;if(g<1073741824)return new Uint8Array(await l.arrayBuffer());{if(!l.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let _=l.body.getReader(),w;try{w=new ArrayBuffer(g)}catch(S){if(S instanceof RangeError){let L=Math.ceil(g/65536);w=new WebAssembly.Memory({initial:L,maximum:L}).buffer}else throw S}let y=0;for(;;){let{done:S,value:L}=await _.read();if(S)break;let F=L.byteLength;new Uint8Array(w,y,F).set(L),y+=F}return new Uint8Array(w,0,g)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)}}),Ea,Pa,Ni,Sa,Wo,Ca,Mn,Le=u(()=>{Kt(),Ea=["V","I","W","E","F"],Pa=(i,l)=>{console.log(`[${Ea[i]},${new Date().toISOString()}]${l}`)},Wo=(i,l)=>{Ni=i,Sa=l},Ca=(i,l)=>{let f=oo(i),g=oo(Ni);f>=g&&Pa(f,typeof l=="function"?l():l)},Mn=(...i)=>{Sa&&Ca(...i)}}),G,ae=u(()=>{Kt(),G=(i,l)=>new(No(l))(i)}),be=u(()=>{}),Oe,Fe,tt,yt,xt,wt,Ct,tn,In,En=u(()=>{Le(),be(),Oe=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),Fe=[],tt=i=>Math.ceil(Number(i)/16)*16,yt=i=>{for(let l=0;l<Fe.length;l++){let f=Fe[l];if(i<=f)return f}return Math.ceil(i/16)*16},xt=1,wt=()=>xt++,Ct=async(i,l,f,g)=>{let _=tt(f),w=i.device.createBuffer({size:_,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let y=i.getCommandEncoder();i.endComputePass(),y.copyBufferToBuffer(l,0,w,0,_),i.flush(),await w.mapAsync(GPUMapMode.READ);let S=w.getMappedRange();if(g){let L=g();return L.set(new Uint8Array(S,0,f)),L}else return new Uint8Array(S.slice(0,f))}finally{w.destroy()}},tn=class{constructor(i){this.backend=i,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[l]of Oe)Fe.push(l),this.freeBuffers.set(l,[]),this.freeUniformBuffers.set(l,[]);this.sessionCount=0}upload(i,l){let f=l.buffer,g=l.byteOffset,_=l.byteLength,w=tt(_),y=this.storageCache.get(i);if(!y)throw new Error("gpu data for uploading does not exist");if(Number(y.originalSize)!==_)throw new Error(`inconsistent data size. gpu data size=${y.originalSize}, data size=${_}`);let S=this.backend.device.createBuffer({mappedAtCreation:!0,size:w,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),L=S.getMappedRange();new Uint8Array(L).set(new Uint8Array(f,g,_)),S.unmap();let F=this.backend.device.createCommandEncoder();F.copyBufferToBuffer(S,0,y.gpuData.buffer,0,w),this.backend.device.queue.submit([F.finish()]),S.destroy(),Mn("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${i})`)}memcpy(i,l){let f=this.storageCache.get(i);if(!f)throw new Error("source gpu data for memcpy does not exist");let g=this.storageCache.get(l);if(!g)throw new Error("destination gpu data for memcpy does not exist");if(f.originalSize!==g.originalSize)throw new Error("inconsistent source and destination gpu data size");let _=tt(f.originalSize),w=this.backend.getCommandEncoder();this.backend.endComputePass(),w.copyBufferToBuffer(f.gpuData.buffer,0,g.gpuData.buffer,0,_)}registerExternalBuffer(i,l,f){let g;if(f){if(g=f[0],i===f[1])return Mn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${l}) => id=${g}, buffer is the same, skip.`),g;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else g=wt();return this.storageCache.set(g,{gpuData:{id:g,type:0,buffer:i},originalSize:l}),Mn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${l}) => id=${g}, registered.`),g}unregisterExternalBuffer(i){i!==void 0&&(this.storageCache.delete(i),Mn("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${i}`))}create(i,l=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let f=yt(i),g,_=(l&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,w=(l&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(_||w){let S=(_?this.freeBuffers:this.freeUniformBuffers).get(f);S?S.length>0?g=S.pop():g=this.backend.device.createBuffer({size:f,usage:l}):g=this.backend.device.createBuffer({size:f,usage:l})}else g=this.backend.device.createBuffer({size:f,usage:l});let y={id:wt(),type:0,buffer:g};return this.storageCache.set(y.id,{gpuData:y,originalSize:Number(i)}),Mn("verbose",()=>`[WebGPU] GpuDataManager.create(size=${i}) => id=${y.id}`),y}get(i){var l;return(l=this.storageCache.get(i))==null?void 0:l.gpuData}release(i){let l=typeof i=="bigint"?Number(i):i,f=this.storageCache.get(l);if(!f){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Mn("verbose",()=>`[WebGPU] GpuDataManager.release(id=${l}), gpuDataId=${f.gpuData.id}`),this.storageCache.delete(l),this.buffersPending.push(f.gpuData.buffer),f.originalSize}async download(i,l){let f=this.storageCache.get(Number(i));if(!f)throw new Error("data does not exist");await Ct(this.backend,f.gpuData.buffer,f.originalSize,l)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let i of this.buffersPending){let l=Oe.get(i.size);if((i.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let f=this.freeBuffers.get(i.size)||[];l===void 0||f.length>=l?i.destroy():f.push(i)}else if((i.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let f=this.freeUniformBuffers.get(i.size)||[];l===void 0||f.length>=l?i.destroy():f.push(i)}else i.destroy()}this.buffersPending=[]}else{let i=this.capturedPendingBuffers.get(this.backend.currentSessionId);i||(i=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,i));for(let l of this.buffersPending)i.push(l);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(i=>{i.forEach(l=>{l.destroy()})}),this.freeUniformBuffers.forEach(i=>{i.forEach(l=>{l.destroy()})}),this.storageCache.forEach(i=>{i.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(i=>{i.forEach(l=>{l.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(i){let l=this.capturedPendingBuffers.get(i);l&&(l.forEach(f=>{f.destroy()}),this.capturedPendingBuffers.delete(i)),this.sessionCount-=1,this.sessionCount===0&&(Mn("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(f=>{f.gpuData.buffer.destroy()}),this.storageCache=new Map)}},In=(...i)=>new tn(...i)}),lr,Ht,gn=u(()=>{lr=class{constructor(i){Object.assign(this,i)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(i=>`${this[i]}`).join(";")),this.key}},Ht=i=>new lr(i)}),Xr,Sr,We,Vr,gi,tr,Dr,zt=u(()=>{Xr=class{static calcMatMulShape(i,l){return i[1]!==l[0]?void 0:[i[0],l[1]]}},Sr=class{static calcShape(i,l,f=!1){let g=i.length,_=l.length;if(g===0)return l;if(_===0)return i;let w=Math.max(i.length,l.length),y=new Array(w);if(f){if(g<2||_<2)return;let S=Xr.calcMatMulShape([i[g-2],i[g-1]],[l[_-2],l[_-1]]);if(S===void 0)return;[y[w-2],y[w-1]]=S}for(let S=f?3:1;S<=w;S++){let L=g-S<0?1:i[g-S],F=_-S<0?1:l[_-S];if(L!==F&&L>1&&F>1)return;let K=Math.max(L,F);if(L&&F)y[w-S]=Math.max(L,F);else{if(K>1)return;y[w-S]=0}}return y}static isValidBroadcast(i,l){let f=i.length,g=l.length;if(f>g)return!1;for(let _=1;_<=f;_++)if(i[f-_]!==1&&i[f-_]!==l[g-_])return!1;return!0}},We=class Zv{static size(l){return Zv.getSizeFromDimensionRange(l,0,l.length)}static convertShape(l,f=4){let g=l.length;if(g===0)return[];let _=new Array(g),w=g-1;for(;w>=0;){if(l[w]%f===0){_[w]=l[w]/f;break}if(f%l[w]!==0)throw new Error("cannot convert shape");_[w]=1,f/=l[w],w--}for(w--;w>=0;w--)_[w]=l[w];return _}static sizeFromDimension(l,f){if(f<0||f>l.length)throw new Error(`invalid dimension of ${f} for sizeFromDimension as Tensor has ${l.length} dimensions.`);return Zv.getSizeFromDimensionRange(l,f,l.length)}static sizeToDimension(l,f){if(f<0||f>l.length)throw new Error(`invalid dimension of ${f} for sizeToDimension as Tensor has ${l.length} dimensions.`);return Zv.getSizeFromDimensionRange(l,0,f)}static getSizeFromDimensionRange(l,f,g){let _=1;for(let w=f;w<g;w++){if(l[w]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");_*=Number(l[w])}return _}static computeStrides(l){let f=l.length;if(f===0)return[];if(f===1)return[1];let g=new Array(f);g[f-1]=1,g[f-2]=l[f-1];for(let _=f-3;_>=0;--_)g[_]=g[_+1]*l[_+1];return g}static normalizeAxis(l,f){if(l<-f&&l>=f)throw new Error("unsupported axis for this operation.");return l<0?l+f:l}static normalizeAxes(l,f){return l.map(g=>this.normalizeAxis(g,f??l.length))}static sortBasedOnPerm(l,f){return f?f.map(g=>l[g]):l.slice().reverse()}static padShape(l,f){let g=l.length;return l.map((_,w)=>_+f[w]+f[w+g])}static areEqual(l,f){return l.length!==f.length?!1:l.every((g,_)=>g===f[_])}},Vr=class U_{static adjustPoolAttributes(l,f,g,_,w,y){if(!l&&g.length!==f.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(l)for(let S=0;S<f.length-2;S++)S>=g.length?g.push(f[S+2]):g[S]=f[S+2];for(let S=0;S<g.length;S++)if(S<_.length){if(_[S]<0)throw new Error("strides should be greater than or equal to 1")}else _.push(1);for(let S=0;S<g.length;S++)if(S<w.length){if(w[S]<0)throw new Error("dilations should be greater than or equal to 1")}else w.push(1);for(let S=0;S<g.length*2;S++)if(S<y.length){if(y[S]<0)throw new Error("pad should be greater than or equal to 1")}else y.push(0);for(let S=0;S<g.length;S++){if(g[S]<=0)throw new Error("kernel shapes need to be greater than 0");if(y[S]>=g[S]||y[S+g.length]>=g[S])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(l,f,g,_,w,y,S){if(S){if(w.length!==2*(l.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(f.length!==l.length-2)throw new Error("length of strides should be the length of data dimensions");if(_.length!==l.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let L=0;L<l.length-2;L++)U_.adjustPadAndReturnShape(l[L+(y?1:2)],f[L],g[L],_[L],w,L,L+l.length-2,S)}}static computePoolOutputShape(l,f,g,_,w,y,S){if(f.length<=0)throw new Error("input shape must be of size greater than 0");let L=[f[0],f[1]];return U_.computeShapeHelper(l,f,L,g,_,w,y,S),L}static computeConvOutputShape(l,f,g,_,w,y,S){if(l.length<=0||f.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let L=[l[0],f[0]];return U_.computeShapeHelper(!1,l,L,g,_,w,y,S),L}static computeShapeHelper(l,f,g,_,w,y,S,L){if(l)for(let F=0;F<f.length-2;F++)g.push(1);else for(let F=0;F<f.length-2;F++)g.push(U_.adjustPadAndReturnShape(f[F+2],_[F],w[F],y[F],S,F,F+f.length-2,L))}static adjustPadAndReturnShape(l,f,g,_,w,y,S,L){let F=g*(_-1)+1;if(L&&L!=="NOTSET")switch(L){case"VALID":return w[y]=0,w[S]=0,Math.floor((l-F)/f+1);case"SAME_LOWER":case"SAME_UPPER":if(g!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let K=((l+f-1)/f-1)*f+_-l;return w[y]=Math.floor(L==="SAME_LOWER"?(K+1)/2:K/2),w[S]=K-w[y],Math.floor((l+K-_)/f+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((l+w[y]+w[S]-F)/f+1)}},gi=class{static getShapeOfGemmResult(i,l,f,g,_){if(i.length!==2||f.length!==2)throw new Error("shape need to be of size 2");let w,y,S;l?(w=i[1],y=i[0]):(w=i[0],y=i[1]);let L=-1;if(g?(S=f[0],L=1):(S=f[1],L=0),f[L]!==y)throw new Error("dimension mismatch");if(w<=0||S<=0||y<=0)throw new Error("invalid shape specified");if(_&&!Sr.isValidBroadcast(_,[w,S]))throw new Error("gemm: invalid bias shape for broadcast");return[w,S,y]}},tr=-34028234663852886e22,Dr=34028234663852886e22}),ts,Ls,On,nr,Tt,rn,pr,rr,Cr,Ft,ao,et,jt,pf,Jc,mf,gf,cn=u(()=>{Kt(),zt(),ts=64,Ls=(i,l)=>{if(l===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(i)){case 10:return l>1?`vec${l}<f16>`:"f16";case 1:return l>1?`vec${l}<f32>`:"f32";case 6:return l>1?`vec${l}<i32>`:"i32";case 12:return l>1?`vec${l}<u32>`:"u32";case 7:if(l>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(l>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(l!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${i}`)}},On=(i,l=1)=>{let f=Ls(i,l);return typeof f=="string"?f:f[0]},nr=(i,l=1)=>{let f=Ls(i,l);return typeof f=="string"?f:f[1]},Tt=(...i)=>{let l=[];return i.forEach(f=>{f.length!==0&&l.push({type:12,data:f},{type:12,data:We.computeStrides(f)})}),l},rn=i=>i%4===0?4:i%2===0?2:1,pr=(i="f32",l,f="0")=>!l||l===1?`${i}(${f})`:`vec${l}<${i}>(${f})`,rr=(i,l,f)=>i==="f32"?f:l===1?`f32(${f})`:`vec${l}<f32>(${f})`,Cr=(i,l)=>l===4?`(${i}.x + ${i}.y + ${i}.z + ${i}.w)`:l===2?`(${i}.x + ${i}.y)`:l===3?`(${i}.x + ${i}.y + ${i}.z)`:i,Ft=(i,l,f,g)=>i.startsWith("uniforms.")&&f>4?typeof l=="string"?g==="f16"?`${i}[(${l}) / 8][(${l}) % 8 / 4][(${l}) % 8 % 4]`:`${i}[(${l}) / 4][(${l}) % 4]`:g==="f16"?`${i}[${Math.floor(l/8)}][${Math.floor(l%8/4)}][${l%8%4}]`:`${i}[${Math.floor(l/4)}][${l%4}]`:f>1?`${i}[${l}]`:i,ao=(i,l,f,g,_)=>{let w=typeof f=="number",y=w?f:f.length,S=[...new Array(y).keys()],L=y<2?"u32":y<=4?`vec${y}<u32>`:`array<u32, ${y}>`,F=Ls(l,_),K=typeof F=="string"?F:F[1],W=typeof F=="string"?F:F[0],C={indices:L,value:K,storage:W,tensor:l},X=dt=>typeof dt=="string"?dt:`${dt}u`,J={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},ne=w?"uniforms.":"",ce=`${ne}${i}_shape`,fe=`${ne}${i}_strides`,le="";for(let dt=0;dt<y-1;dt++)le+=`
    let dim${dt} = current / ${Ft(fe,dt,y)};
    let rest${dt} = current % ${Ft(fe,dt,y)};
    indices[${dt}] = dim${dt};
    current = rest${dt};
    `;le+=`indices[${y-1}] = current;`;let Te=y<2?"":`
  fn o2i_${i}(offset: u32) -> ${C.indices} {
    var indices: ${C.indices};
    var current = offset;
    ${le}
    return indices;
  }`,Me=dt=>(J.offsetToIndices=!0,y<2?dt:`o2i_${i}(${dt})`),$e=[];if(y>=2)for(let dt=y-1;dt>=0;dt--)$e.push(`${Ft(fe,dt,y)} * (indices[${dt}])`);let ze=y<2?"":`
  fn i2o_${i}(indices: ${C.indices}) -> u32 {
    return ${$e.join("+")};
  }`,Ve=dt=>(J.indicesToOffset=!0,y<2?dt:`i2o_${i}(${dt})`),st=(...dt)=>y===0?"0u":`${C.indices}(${dt.map(X).join(",")})`,pt=(dt,It)=>y<2?`${dt}`:`${Ft(dt,It,y)}`,$t=(dt,It,Sn)=>y<2?`${dt}=${Sn};`:`${Ft(dt,It,y)}=${Sn};`,on={},dn=(dt,It)=>{J.broadcastedIndicesToOffset=!0;let Sn=`${It.name}broadcastedIndicesTo${i}Offset`;if(Sn in on)return`${Sn}(${dt})`;let vr=[];for(let Bs=y-1;Bs>=0;Bs--){let Wr=It.indicesGet("outputIndices",Bs+It.rank-y);vr.push(`${pt(fe,Bs)} * (${Wr} % ${pt(ce,Bs)})`)}return on[Sn]=`fn ${Sn}(outputIndices: ${It.type.indices}) -> u32 {
             return ${vr.length>0?vr.join("+"):"0u"};
           }`,`${Sn}(${dt})`},Pt=(dt,It)=>(()=>{if(C.storage===C.value)return`${i}[${dt}]=${It};`;if(C.storage==="vec2<u32>"&&C.value==="i32")return`${i}[${dt}]=vec2<u32>(u32(${It}), select(0u, 0xFFFFFFFFu, ${It} < 0));`;if(C.storage==="vec2<u32>"&&C.value==="u32")return`${i}[${dt}]=vec2<u32>(u32(${It}), 0u);`;if(C.storage==="u32"&&C.value==="vec4<bool>")return`${i}[${dt}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${It}));`;throw new Error(`not supported combination of storage type ${C.storage} and value type ${C.value} yet`)})(),pn=dt=>(()=>{if(C.storage===C.value)return`${i}[${dt}]`;if(C.storage==="vec2<u32>"&&C.value==="i32")return`i32(${i}[${dt}].x)`;if(C.storage==="vec2<u32>"&&C.value==="u32")return`u32(${i}[${dt}].x)`;if(C.storage==="u32"&&C.value==="vec4<bool>")return`vec4<bool>(bool(${i}[${dt}] & 0xFFu), bool(${i}[${dt}] & 0xFF00u), bool(${i}[${dt}] & 0xFF0000u), bool(${i}[${dt}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${C.storage} and value type ${C.value} yet`)})(),Lt=y<2?"":`
  fn get_${i}ByIndices(indices: ${C.indices}) -> ${K} {
    return ${pn(`i2o_${i}(indices)`)};
  }`,Bt=y<2?"":(()=>{let dt=S.map(Sn=>`d${Sn}: u32`).join(", "),It=S.map(Sn=>`d${Sn}`).join(", ");return`
  fn get_${i}(${dt}) -> ${K} {
    return get_${i}ByIndices(${st(It)});
  }`})(),Vn=(...dt)=>{if(dt.length!==y)throw new Error(`indices length must be ${y}`);let It=dt.map(X).join(",");return y===0?pn("0u"):y===1?pn(It[0]):(J.get=!0,J.getByIndices=!0,J.indicesToOffset=!0,`get_${i}(${It})`)},nn=dt=>y<2?pn(dt):(J.getByIndices=!0,J.indicesToOffset=!0,`get_${i}ByIndices(${dt})`),qt=y<2?"":`
  fn set_${i}ByIndices(indices: ${C.indices}, value: ${K}) {
    ${Pt(`i2o_${i}(indices)`,"value")}
  }`,Ln=y<2?"":(()=>{let dt=S.map(Sn=>`d${Sn}: u32`).join(", "),It=S.map(Sn=>`d${Sn}`).join(", ");return`
  fn set_${i}(${dt}, value: ${K}) {
    set_${i}ByIndices(${st(It)}, value);
  }`})();return{impl:()=>{let dt=[],It=!1;return J.offsetToIndices&&(dt.push(Te),It=!0),J.indicesToOffset&&(dt.push(ze),It=!0),J.broadcastedIndicesToOffset&&(Object.values(on).forEach(Sn=>dt.push(Sn)),It=!0),J.set&&(dt.push(Ln),It=!0),J.setByIndices&&(dt.push(qt),It=!0),J.get&&(dt.push(Bt),It=!0),J.getByIndices&&(dt.push(Lt),It=!0),!w&&It&&dt.unshift(`const ${ce} = ${C.indices}(${f.join(",")});`,`const ${fe} = ${C.indices}(${We.computeStrides(f).join(",")});`),dt.join(`
`)},type:C,offsetToIndices:Me,indicesToOffset:Ve,broadcastedIndicesToOffset:dn,indices:st,indicesGet:pt,indicesSet:$t,set:(...dt)=>{if(dt.length!==y+1)throw new Error(`indices length must be ${y}`);let It=dt[y];if(typeof It!="string")throw new Error("value must be string");let Sn=dt.slice(0,y).map(X).join(",");return y===0?Pt("0u",It):y===1?Pt(Sn[0],It):(J.set=!0,J.setByIndices=!0,J.indicesToOffset=!0,`set_${i}(${Sn}, ${It})`)},setByOffset:Pt,setByIndices:(dt,It)=>y<2?Pt(dt,It):(J.setByIndices=!0,J.indicesToOffset=!0,`set_${i}ByIndices(${dt}, ${It});`),get:Vn,getByOffset:pn,getByIndices:nn,usage:g,name:i,strides:fe,shape:ce,rank:y}},et=(i,l,f,g=1)=>ao(i,l,f,"input",g),jt=(i,l,f,g=1)=>ao(i,l,f,"output",g),pf=(i,l,f)=>ao(i,l,f,"atomicOutput",1),Jc=(i,l,f,g=1)=>ao(i,l,f,"internal",g),mf=class{constructor(i,l){this.normalizedDispatchGroup=i,this.limits=l,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(i){return`if (global_idx >= ${typeof i=="number"?`${i}u`:i}) { return; }`}mainStart(i=ts){let l=typeof i=="number"?i:i[0],f=typeof i=="number"?1:i[1],g=typeof i=="number"?1:i[2];if(l>this.limits.maxComputeWorkgroupSizeX||f>this.limits.maxComputeWorkgroupSizeY||g>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${l}, ${f}, ${g}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(l*f*g>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${l}, ${f}, ${g}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let _=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,w=_?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,y=_?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${l*f*g}u + local_idx;`;return`@compute @workgroup_size(${l}, ${f}, ${g})
  fn main(${w}) {
    ${y}
  `}appendVariableUniforms(i){i.rank!==0&&(i.shape.startsWith("uniforms.")&&this.uniforms.push({name:i.shape.replace("uniforms.",""),type:"u32",length:i.rank}),i.strides.startsWith("uniforms.")&&this.uniforms.push({name:i.strides.replace("uniforms.",""),type:"u32",length:i.rank}))}declareVariable(i,l){if(i.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(i),this.appendVariableUniforms(i);let f=i.usage==="input"?"read":"read_write",g=i.usage==="atomicOutput"?"atomic<i32>":i.type.storage;return`@group(0) @binding(${l}) var<storage, ${f}> ${i.name}: array<${g}>;`}declareVariables(...i){return i.map(l=>this.declareVariable(l,this.variableIndex++)).join(`
`)}registerInternalVariable(i){if(i.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(i),this.appendVariableUniforms(i)}registerInternalVariables(...i){return i.forEach(l=>this.registerInternalVariable(l)),this}registerUniform(i,l,f=1){return this.uniforms.push({name:i,type:l,length:f}),this}registerUniforms(i){return this.uniforms=this.uniforms.concat(i),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let i=[];for(let{name:l,type:f,length:g}of this.uniforms)if(g&&g>4)f==="f16"?i.push(`@align(16) ${l}:array<mat2x4<${f}>, ${Math.ceil(g/8)}>`):i.push(`${l}:array<vec4<${f}>, ${Math.ceil(g/4)}>`);else{let _=g==null||g===1?f:`vec${g}<${f}>`;i.push(`${l}:${_}`)}return`
      struct Uniforms { ${i.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(i=>i.impl()).join(`
`)+this.internalVariables.map(i=>i.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let i=l=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(l)];return this.uniforms.map(l=>[i(l.type),l.length??1])}},gf=(i,l)=>new mf(i,l)}),_f,Zc,eu,yf,vf,tu,Ms,wf,nu,zi=u(()=>{Kt(),zt(),gn(),cn(),_f=(i,l)=>{if(!i||i.length!==1)throw new Error("Transpose requires 1 input.");if(l.length!==0&&l.length!==i[0].dims.length)throw new Error(`perm size ${l.length} does not match input rank ${i[0].dims.length}`)},Zc=(i,l)=>l.length!==0?l:[...new Array(i).keys()].reverse(),eu=(i,l)=>We.sortBasedOnPerm(i,Zc(i.length,l)),yf=(i,l,f,g)=>{let _=`fn perm(i: ${g.type.indices}) -> ${f.type.indices} {
    var a: ${f.type.indices};`;for(let w=0;w<l;++w)_+=`a[${i[w]}]=i[${w}];`;return _+="return a;}"},vf=(i,l)=>{let f=[],g=[];for(let _=0;_<i.length;++_)i[_]!==1&&f.push(i[_]),i[l[_]]!==1&&g.push(l[_]);return{newShape:f,newPerm:g}},tu=(i,l)=>{let f=0;for(let g=0;g<i.length;++g)if(l[i[g]]!==1){if(i[g]<f)return!1;f=i[g]}return!0},Ms=(i,l)=>{let f=i.dataType,g=i.dims.length,_=Zc(g,l),w=eu(i.dims,_),y=i.dims,S=w,L=g<2||tu(_,i.dims),F;if(L)return F=J=>{let ne=et("input",f,y,4),ce=jt("output",f,S,4);return`
  ${J.registerUniform("output_size","u32").declareVariables(ne,ce)}
  ${J.mainStart()}
    ${J.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let J=We.size(w);return{outputs:[{dims:w,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(J/64/4)},programUniforms:[{type:12,data:Math.ceil(J/4)}]}},getShaderSource:F};let{newShape:K,newPerm:W}=vf(i.dims,_),C=We.areEqual(W,[2,3,1]),X=We.areEqual(W,[3,1,2]);if(K.length===2||C||X){y=C?[K[0],K[1]*K[2]]:X?[K[0]*K[1],K[2]]:K,S=[y[1],y[0]];let J=16;return F=ne=>{let ce=et("a",f,y.length),fe=jt("output",f,S.length);return`
  ${ne.registerUniform("output_size","u32").declareVariables(ce,fe)}
  var<workgroup> tile : array<array<${fe.type.value}, ${J+1}>, ${J}>;
  ${ne.mainStart([J,J,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${J} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${J}u + local_id.x;
    let input_row = workgroup_id_x * ${J}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${ce.getByIndices(`${ce.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${J}u + local_id.x;
    let output_row = workgroup_id_y * ${J}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${fe.setByIndices(`${fe.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let ne=We.size(w);return{outputs:[{dims:w,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(S[1]/J),y:Math.ceil(S[0]/J)},programUniforms:[{type:12,data:ne},...Tt(y,S)]}},getShaderSource:F}}return F=J=>{let ne=et("a",f,y.length),ce=jt("output",f,S.length);return`
  ${J.registerUniform("output_size","u32").declareVariables(ne,ce)}

  ${yf(_,g,ne,ce)}

  ${J.mainStart()}
    ${J.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${ce.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${ce.setByOffset("global_idx",ne.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${l}`,inputDependencies:["rank"]},getRunData:()=>{let J=We.size(w);return{outputs:[{dims:w,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(J/64)},programUniforms:[{type:12,data:J},...Tt(y,S)]}},getShaderSource:F}},wf=(i,l)=>{_f(i.inputs,l.perm),i.compute(Ms(i.inputs[0],l.perm))},nu=i=>Ht({perm:i.perm})}),jl,bf,xf,Mf,Tf,Ef,Pf,Sf,ru,Cf,Ts,lo,kf,ny,Af,ry,$f,su,If,Of,Df,sy=u(()=>{Kt(),zt(),cn(),Bl(),zi(),jl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},bf={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},xf={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Mf={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Tf=(i,l)=>{let f=[];for(let g=l-i;g<l;++g)f.push(g);return f},Ef=(i,l)=>{let f=[],g=i.length;for(let w=0;w<g;w++)l.indexOf(w)===-1&&f.push(i[w]);let _=l.map(w=>i[w]);return[f,_]},Pf=(i,l)=>{let f=i.length+l.length,g=[],_=0;for(let w=0;w<f;w++)l.indexOf(w)===-1?g.push(i[_++]):g.push(1);return g},Sf=(i,l)=>{for(let f=0;f<i.length;++f)if(i[i.length-f-1]!==l-1-f)return!1;return!0},ru=(i,l)=>{let f=[];if(!Sf(i,l)){for(let g=0;g<l;++g)i.indexOf(g)===-1&&f.push(g);i.forEach(g=>f.push(g))}return f},Cf=(i,l,f,g,_,w,y)=>{let S=f[0].dims,L=We.size(w),F=We.size(y),K=et("_A",f[0].dataType,S),W=jt("output",_,w),C=64;L===1&&(C=256);let X=`
          var<workgroup> aBestValues : array<f32, ${C}>;
       `,J=ne=>`
        ${ne.registerUniform("reduceSize","u32").declareVariables(K,W)}
        ${X}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${ne.mainStart(C)}

          let outputIndex = global_idx / ${C};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${xf[g]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${C}) {
           let candidate = f32(${K.getByOffset("offset + k")});
           bestValue = ${jl[g]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${C}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${bf[g]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${W.setByOffset("outputIndex",`${g==="mean"?`${W.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${W.type.storage}(${Mf[g]})`}`)};
         }
        }`;return{name:i,shaderCache:{hint:`${l};${C}`,inputDependencies:["type"]},getShaderSource:J,getRunData:()=>({outputs:[{dims:w,dataType:_}],dispatchGroup:{x:L},programUniforms:[{type:12,data:F}]})}},Ts=(i,l,f,g)=>{let _=i.inputs.length===1?f:iu(i.inputs,f),w=_.axes;w.length===0&&!_.noopWithEmptyAxes&&(w=i.inputs[0].dims.map((X,J)=>J));let y=We.normalizeAxes(w,i.inputs[0].dims.length),S=y,L=i.inputs[0],F=ru(S,i.inputs[0].dims.length);F.length>0&&(L=i.compute(Ms(i.inputs[0],F),{inputs:[0],outputs:[-1]})[0],S=Tf(S.length,L.dims.length));let[K,W]=Ef(L.dims,S),C=K;_.keepDims&&(C=Pf(K,y)),i.compute(Cf(l,_.cacheKey,[L],g,i.inputs[0].dataType,C,W),{inputs:[L]})},lo=(i,l)=>{Ts(i,"ReduceMeanShared",l,"mean")},kf=(i,l)=>{Ts(i,"ReduceL1Shared",l,"l1")},ny=(i,l)=>{Ts(i,"ReduceL2Shared",l,"l2")},Af=(i,l)=>{Ts(i,"ReduceLogSumExpShared",l,"logSumExp")},ry=(i,l)=>{Ts(i,"ReduceMaxShared",l,"max")},$f=(i,l)=>{Ts(i,"ReduceMinShared",l,"min")},su=(i,l)=>{Ts(i,"ReduceProdShared",l,"prod")},If=(i,l)=>{Ts(i,"ReduceSumShared",l,"sum")},Of=(i,l)=>{Ts(i,"ReduceSumSquareShared",l,"sumSquare")},Df=(i,l)=>{Ts(i,"ReduceLogSumShared",l,"logSum")}}),Fs,Nl,zl,iu,Rs,ou,Lf,Ff,au,Rf,jf,lu,Nf,zf,cu,js,Bf,uu,Vf,Uf,du,Wf,Gf,hu,Kf,Hf,Bl=u(()=>{Kt(),zt(),gn(),cn(),sy(),Fs=i=>{if(!i||i.length===0||i.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(i.length===2&&i[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Nl=i=>["","",`var value = ${i.getByIndices("input_indices")};`,""],zl=(i,l,f,g,_,w,y=!1,S=!1)=>{let L=[],F=f[0].dims,K=F.length,W=We.normalizeAxes(_,K),C=!S&&W.length===0;F.forEach((ne,ce)=>{C||W.indexOf(ce)>=0?y&&L.push(1):L.push(ne)});let X=L.length,J=We.size(L);return{name:i,shaderCache:l,getShaderSource:ne=>{let ce=[],fe=et("_A",f[0].dataType,K),le=jt("output",w,X),Te=g(fe,le,W),Me=Te[2];for(let $e=0,ze=0;$e<K;$e++)C||W.indexOf($e)>=0?(y&&ze++,Me=`for(var j${$e}: u32 = 0; j${$e} < ${F[$e]}; j${$e}++) {
                  ${Te[2].includes("last_index")?`let last_index = j${$e};`:""}
                  ${fe.indicesSet("input_indices",$e,`j${$e}`)}
                  ${Me}
                }`):(ce.push(`${fe.indicesSet("input_indices",$e,le.indicesGet("output_indices",ze))};`),ze++);return`

        ${ne.registerUniform("output_size","u32").declareVariables(fe,le)}

        ${ne.mainStart()}
          ${ne.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${fe.type.indices};
          let output_indices = ${le.offsetToIndices("global_idx")};

          ${ce.join(`
`)}
          ${Te[0]}       // init ops for reduce max/min
          ${Te[1]}
          ${Me}
          ${Te[3]}
          ${Te.length===4?le.setByOffset("global_idx","value"):Te.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:L,dataType:w}],dispatchGroup:{x:Math.ceil(J/64)},programUniforms:[{type:12,data:J},...Tt(F,L)]})}},iu=(i,l)=>{let f=[];return i[1].dims[0]>0&&i[1].getBigInt64Array().forEach(g=>f.push(Number(g))),Ht({axes:f,keepDims:l.keepDims,noopWithEmptyAxes:l.noopWithEmptyAxes})},Rs=(i,l,f,g)=>{let _=i.inputs,w=_.length===1?f:iu(_,f);i.compute(zl(l,{hint:w.cacheKey,inputDependencies:["rank"]},[_[0]],w.noopWithEmptyAxes&&w.axes.length===0?Nl:g,w.axes,_[0].dataType,w.keepDims,w.noopWithEmptyAxes),{inputs:[0]})},ou=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceLogSum",l,(f,g)=>[`var value = ${g.type.storage}(0);`,"",`value += ${f.getByIndices("input_indices")};`,"value = log(value);"])},Lf=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceL1",l,(f,g)=>[`var value = ${g.type.storage}(0);`,"",`value += abs(${f.getByIndices("input_indices")});`,""])},Ff=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceL2",l,(f,g)=>[`var t = ${g.type.value}(0); var value = ${g.type.value}(0);`,"",`t = ${f.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},au=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceLogSumExp",l,(f,g)=>[`var value = ${g.type.storage}(0);`,"",`value += exp(${f.getByIndices("input_indices")});`,"value = log(value);"])},Rf=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceMax",l,(f,g,_)=>{let w=[];for(let y=0;y<f.rank;y++)(_.indexOf(y)>=0||_.length===0)&&w.push(f.indicesSet("input_indices",y,0));return[`${w.join(`
`)}`,`var value = ${f.getByIndices("input_indices")};`,`value = max(value, ${f.getByIndices("input_indices")});`,""]})},jf=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceMean",l,(f,g,_)=>{let w=1;for(let y=0;y<f.rank;y++)(_.indexOf(y)>=0||_.length===0)&&(w*=i.inputs[0].dims[y]);return["var sum = f32(0);","",`sum += f32(${f.getByIndices("input_indices")});`,`let value = ${g.type.value}(sum / ${w});`]})},lu=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceMin",l,(f,g,_)=>{let w=[];for(let y=0;y<f.rank;y++)(_.indexOf(y)>=0||_.length===0)&&w.push(`input_indices[${y}] = 0;`);return[`${w.join(`
`)}`,`var value = ${f.getByIndices("input_indices")};`,`value = min(value, ${f.getByIndices("input_indices")});`,""]})},Nf=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceProd",l,(f,g)=>[`var value = ${g.type.storage}(1);`,"",`value *= ${f.getByIndices("input_indices")};`,""])},zf=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceSum",l,(f,g)=>[`var value = ${g.type.storage}(0);`,"",`value += ${f.getByIndices("input_indices")};`,""])},cu=(i,l)=>{Fs(i.inputs),Rs(i,"ReduceSumSquare",l,(f,g)=>[`var t = ${g.type.value}(0); var value = ${g.type.value}(0);`,"",`t = ${f.getByIndices("input_indices")}; value += t * t;`,""])},js=(i,l,f)=>{if(l.length===0)return f;let g=1,_=1;for(let w=0;w<l.length;w++)l.indexOf(w)===-1?g*=i[w]:_*=i[w];return _<32&&g>1024},Bf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?jf(i,l):lo(i,l)},uu=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?Lf(i,l):kf(i,l)},Vf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?Ff(i,l):ny(i,l)},Uf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?au(i,l):Af(i,l)},du=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?Rf(i,l):ry(i,l)},Wf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?lu(i,l):$f(i,l)},Gf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?Nf(i,l):su(i,l)},hu=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?zf(i,l):If(i,l)},Kf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?cu(i,l):Of(i,l)},Hf=(i,l)=>{js(i.inputs[0].dims,l.axes,l.noopWithEmptyAxes)?ou(i,l):Df(i,l)}}),fu,qf,pu,mu,iy=u(()=>{Kt(),gn(),Bl(),fu=i=>{if(!i||i.length===0||i.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(i[0].dataType!==1)throw new Error("Invalid input type.")},qf=(i,l)=>{fu(i.inputs);let f=(g,_,w)=>{let y=[];for(let S=0;S<g.rank;S++)(w.indexOf(S)>=0||w.length===0)&&y.push(`input_indices[${S}] = 0;`);return[`${y.join(`
`)}`,`var value = ${g.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${g.getByIndices("input_indices")} ${l.selectLastIndex>0?"<=":"<"} value) {
         value = ${g.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",_.setByOffset("global_idx","best_index")]};i.compute(zl("ArgMin",{hint:l.cacheKey,inputDependencies:["rank"]},[i.inputs[0]],f,[l.axis],7,l.keepDims),{inputs:[0]})},pu=(i,l)=>{fu(i.inputs);let f=(g,_,w)=>{let y=[];for(let S=0;S<g.rank;S++)(w.indexOf(S)>=0||w.length===0)&&y.push(`input_indices[${S}] = 0;`);return[`${y.join(`
`)}`,`var value = ${g.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${g.getByIndices("input_indices")} ${l.selectLastIndex>0?">=":">"} value) {
         value = ${g.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",_.setByOffset("global_idx","best_index")]};i.compute(zl("argMax",{hint:l.cacheKey,inputDependencies:["rank"]},[i.inputs[0]],f,[l.axis],7,l.keepDims),{inputs:[0]})},mu=i=>Ht(i)}),gu,Vl,Qf,_u,Yf,ka,yu,Xf,vu=u(()=>{Kt(),zt(),be(),cn(),gu=(i,l)=>{let f=i[0],g=i[1],_=i[2],w=i[3],y=i[4],S=i[5];if(y&&S)throw new Error("Attention cannot have both past and attention_bias");if(f.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let L=f.dims[0],F=f.dims[1],K=f.dims[2];if(_.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(g.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(g.dims[0]!==K)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(_.dims[0]!==g.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let W=_.dims[0]/3,C=W,X=C;if(l.qkvHiddenSizes.length>0){if(l.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let Te of l.qkvHiddenSizes)if(Te%l.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");W=l.qkvHiddenSizes[0],C=l.qkvHiddenSizes[1],X=l.qkvHiddenSizes[2]}let J=F;if(W!==C)throw new Error("qkv_hidden_sizes first element should be same as the second");if(_.dims[0]!==W+C+X)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let ne=0;if(y){if(C!==X)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(y.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(y.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(y.dims[1]!==L)throw new Error('Input "past" second dimension must be batch_size');if(y.dims[2]!==l.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(y.dims[4]!==C/l.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');l.pastPresentShareBuffer||(ne=y.dims[3])}let ce=J+ne,fe=-1,le=0;if(w)throw new Error("Mask not supported");if(y)throw new Error("past is not supported");if(S){if(S.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(S.dims[0]!==L||S.dims[1]!==l.numHeads||S.dims[2]!==F||S.dims[3]!==ce)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:L,sequenceLength:F,pastSequenceLength:ne,kvSequenceLength:J,totalSequenceLength:ce,maxSequenceLength:fe,inputHiddenSize:K,hiddenSize:W,vHiddenSize:X,headSize:Math.floor(W/l.numHeads),vHeadSize:Math.floor(X/l.numHeads),numHeads:l.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:l.maskFilterValue,maskType:le,scale:l.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Vl=(i,l,f)=>l&&i?`
      let total_sequence_length_input = u32(${l.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${i==null?void 0:i.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${f?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,Qf=(i,l,f,g,_,w,y,S)=>{let L=rn(y?1:w),F=64,K=w/L;K<F&&(F=32);let W=Math.ceil(w/L/F),C=[{type:12,data:l},{type:12,data:f},{type:12,data:g},{type:12,data:_},{type:12,data:K},{type:12,data:W}],X=On(i.dataType,L),J=nr(1,L),ne=["type"];y&&ne.push("type"),S&&ne.push("type");let ce=fe=>{let le=jt("x",i.dataType,i.dims,L),Te=[le],Me=y?et("seq_lens",y.dataType,y.dims):void 0;Me&&Te.push(Me);let $e=S?et("total_sequence_length_input",S.dataType,S.dims):void 0;$e&&Te.push($e);let ze=nr(i.dataType),Ve=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${F}>;
  var<workgroup> thread_sum: array<f32, ${F}>;
  ${fe.registerUniforms(Ve).declareVariables(...Te)}
  ${fe.mainStart([F,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${Vl(Me,$e,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${F}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${y?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${J}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${J}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(L){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${L}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${F}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${J}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${J}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(L){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${L}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${F}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${le.type.value}(${ze}(1.0) / ${ze}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${J}(x[offset + i]);
        x[offset + i] = ${le.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${y?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${le.type.value}(${ze}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${F};${X};${L}`,inputDependencies:ne},getShaderSource:ce,getRunData:()=>({outputs:[],dispatchGroup:{x:Math.ceil(w/F),y:_,z:l*f},programUniforms:C})}},_u=(i,l,f,g,_,w,y,S,L)=>{let F=y+w.kvSequenceLength,K=[w.batchSize,w.numHeads,w.sequenceLength,F],W=i>1&&g,C=w.kvNumHeads?w.kvNumHeads:w.numHeads,X=W?[w.batchSize,C,F,w.headSize]:void 0,J=w.nReps?w.nReps:1,ne=w.scale===0?1/Math.sqrt(w.headSize):w.scale,ce=rn(w.headSize),fe=w.headSize/ce,le=12,Te={x:Math.ceil(F/le),y:Math.ceil(w.sequenceLength/le),z:w.batchSize*w.numHeads},Me=[{type:12,data:w.sequenceLength},{type:12,data:fe},{type:12,data:F},{type:12,data:w.numHeads},{type:12,data:w.headSize},{type:1,data:ne},{type:12,data:y},{type:12,data:w.kvSequenceLength},{type:12,data:J}],$e=W&&g&&We.size(g.dims)>0,ze=["type","type"];$e&&ze.push("type"),_&&ze.push("type"),S&&ze.push("type"),L&&ze.push("type");let Ve=[{dims:K,dataType:l.dataType,gpuDataType:0}];W&&Ve.push({dims:X,dataType:l.dataType,gpuDataType:0});let st=pt=>{let $t=et("q",l.dataType,l.dims,ce),on=et("key",f.dataType,f.dims,ce),dn=[$t,on];if($e){let qt=et("past_key",g.dataType,g.dims,ce);dn.push(qt)}_&&dn.push(et("attention_bias",_.dataType,_.dims));let Pt=S?et("seq_lens",S.dataType,S.dims):void 0;Pt&&dn.push(Pt);let pn=L?et("total_sequence_length_input",L.dataType,L.dims):void 0;pn&&dn.push(pn);let Lt=jt("output",l.dataType,K),Bt=[Lt];W&&Bt.push(jt("present_key",l.dataType,X,ce));let Vn=nr(1,ce),nn=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${le}u;

  var<workgroup> tileQ: array<${$t.type.storage}, ${le*le}>;
  var<workgroup> tileK: array<${$t.type.storage}, ${le*le}>;
  ${pt.registerUniforms(nn).declareVariables(...dn,...Bt)}
  ${pt.mainStart([le,le,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${J===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${J===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${Vl(Pt,pn,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${$e&&W?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${W?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${Vn}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${$e&&W?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${W?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${Vn}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(ce){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${ce}`)}})()};
        output[outputIdx] = ${Lt.type.value} (sum * uniforms.alpha) + ${_?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${ce};${_!==void 0};${g!==void 0};${i}`,inputDependencies:ze},getRunData:()=>({outputs:Ve,dispatchGroup:Te,programUniforms:Me}),getShaderSource:st}},Yf=(i,l,f,g,_,w,y=void 0,S=void 0)=>{let L=w+_.kvSequenceLength,F=_.nReps?_.nReps:1,K=_.vHiddenSize*F,W=i>1&&g,C=_.kvNumHeads?_.kvNumHeads:_.numHeads,X=W?[_.batchSize,C,L,_.headSize]:void 0,J=[_.batchSize,_.sequenceLength,K],ne=12,ce={x:Math.ceil(_.vHeadSize/ne),y:Math.ceil(_.sequenceLength/ne),z:_.batchSize*_.numHeads},fe=[{type:12,data:_.sequenceLength},{type:12,data:L},{type:12,data:_.vHeadSize},{type:12,data:_.numHeads},{type:12,data:_.headSize},{type:12,data:K},{type:12,data:w},{type:12,data:_.kvSequenceLength},{type:12,data:F}],le=W&&g&&We.size(g.dims)>0,Te=["type","type"];le&&Te.push("type"),y&&Te.push("type"),S&&Te.push("type");let Me=[{dims:J,dataType:l.dataType,gpuDataType:0}];W&&Me.push({dims:X,dataType:l.dataType,gpuDataType:0});let $e=ze=>{let Ve=et("probs",l.dataType,l.dims),st=et("v",f.dataType,f.dims),pt=[Ve,st];le&&pt.push(et("past_value",g.dataType,g.dims));let $t=y?et("seq_lens",y.dataType,y.dims):void 0;y&&pt.push($t);let on=S?et("total_sequence_length_input",S.dataType,S.dims):void 0;S&&pt.push(on);let dn=[jt("output",l.dataType,J)];W&&dn.push(jt("present_value",l.dataType,X));let Pt=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${ne}u;
  var<workgroup> tileQ: array<${Ve.type.value}, ${ne*ne}>;
  var<workgroup> tileV: array<${Ve.type.value}, ${ne*ne}>;
  ${ze.registerUniforms(Pt).declareVariables(...pt,...dn)}
  ${ze.mainStart([ne,ne,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${F===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${F===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${Vl($t,on,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${le&&W?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${W?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${Ve.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${le&&W?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${W?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${g!==void 0};${i}`,inputDependencies:Te},getRunData:()=>({outputs:Me,dispatchGroup:ce,programUniforms:fe}),getShaderSource:$e}},ka=(i,l,f,g,_,w,y,S,L,F,K=void 0,W=void 0)=>{let C=Math.min(i.outputCount,1+(y?1:0)+(S?1:0)),X=C>1?F.pastSequenceLength:0,J=X+F.kvSequenceLength,ne=L&&We.size(L.dims)>0?L:void 0,ce=[l,f];C>1&&y&&We.size(y.dims)>0&&ce.push(y),ne&&ce.push(ne),K&&ce.push(K),W&&ce.push(W);let fe=i.compute(_u(C,l,f,y,ne,F,X,K,W),{inputs:ce,outputs:C>1?[-1,1]:[-1]})[0];i.compute(Qf(fe,F.batchSize,F.numHeads,X,F.sequenceLength,J,K,W),{inputs:K&&W?[fe,K,W]:[fe],outputs:[]});let le=[fe,g];C>1&&S&&We.size(S.dims)>0&&le.push(S),K&&le.push(K),W&&le.push(W),i.compute(Yf(C,fe,g,S,F,X,K,W),{inputs:le,outputs:C>1?[0,2]:[0]})},yu=(i,l)=>{let f=[l.batchSize,l.numHeads,l.sequenceLength,l.headSize],g=l.sequenceLength,_=l.inputHiddenSize,w=l.headSize,y=12,S={x:Math.ceil(l.headSize/y),y:Math.ceil(l.sequenceLength/y),z:l.batchSize*l.numHeads},L=[i.inputs[0],i.inputs[1],i.inputs[2]],F=[{type:12,data:g},{type:12,data:_},{type:12,data:w},{type:12,data:l.numHeads},{type:12,data:l.headSize},{type:12,data:l.hiddenSize},{type:12,data:l.hiddenSize+l.hiddenSize+l.vHiddenSize}],K=W=>{let C=jt("output_q",L[0].dataType,f),X=jt("output_k",L[0].dataType,f),J=jt("output_v",L[0].dataType,f),ne=et("input",L[0].dataType,L[0].dims),ce=et("weight",L[1].dataType,L[1].dims),fe=et("bias",L[2].dataType,L[2].dims),le=ne.type.storage,Te=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${y}u;
  var<workgroup> tileInput: array<${le}, ${y*y}>;
  var<workgroup> tileWeightQ: array<${le}, ${y*y}>;
  var<workgroup> tileWeightK: array<${le}, ${y*y}>;
  var<workgroup> tileWeightV: array<${le}, ${y*y}>;
  ${W.registerUniforms(Te).declareVariables(ne,ce,fe,C,X,J)}
  ${W.mainStart([y,y,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${le}(0);
    var valueK = ${le}(0);
    var valueV = ${le}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return i.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:f,dataType:i.inputs[0].dataType,gpuDataType:0},{dims:f,dataType:i.inputs[0].dataType,gpuDataType:0},{dims:f,dataType:i.inputs[0].dataType,gpuDataType:0}],dispatchGroup:S,programUniforms:F}),getShaderSource:K},{inputs:L,outputs:[-1,-1,-1]})},Xf=(i,l)=>{let f=gu(i.inputs,l),[g,_,w]=yu(i,f);return ka(i,g,_,w,i.inputs[4],void 0,void 0,void 0,i.inputs[5],f)}}),wu,Jf,Zf,bu,oy=u(()=>{Xe(),Kt(),zt(),gn(),cn(),wu=(i,l)=>{if(!i||i.length!==5)throw new Error("BatchNormalization requires 5 inputs");let f=(g,_,w)=>{let y=_.length;if(y!==g.length)throw new Error(`${w}: num dimensions != ${y}`);_.forEach((S,L)=>{if(S!==g[L])throw new Error(`${w}: dim[${L}] do not match`)})};if(i[0].dims.length>1){let g=l.format==="NHWC"?l.spatial?i[0].dims.slice(-1):i[0].dims.slice(-1).concat(i[0].dims.slice(1,i[0].dims.length-1)):i[0].dims.slice(1,l.spatial?2:void 0);f(i[1].dims,g,"Invalid input scale"),f(i[2].dims,g,"Invalid input B"),f(i[3].dims,g,"Invalid input mean"),f(i[4].dims,g,"Invalid input var")}else f(i[1].dims,[1],"Invalid input scale"),f(i[2].dims,[1],"Invalid input B"),f(i[3].dims,[1],"Invalid input mean"),f(i[4].dims,[1],"Invalid input var")},Jf=(i,l)=>{let{epsilon:f,spatial:g,format:_}=l,w=i[0].dims,y=g?rn(w[w.length-1]):1,S=_==="NHWC"&&w.length>1?y:1,L=We.size(w)/y,F=g,K=F?w.length:w,W=et("x",i[0].dataType,i[0].dims,y),C=et("scale",i[1].dataType,i[1].dims,S),X=et("bias",i[2].dataType,i[2].dims,S),J=et("inputMean",i[3].dataType,i[3].dims,S),ne=et("inputVar",i[4].dataType,i[4].dims,S),ce=jt("y",i[0].dataType,K,y),fe=()=>{let Te="";if(g)Te=`let cOffset = ${w.length===1?"0u":_==="NHWC"?`outputIndices[${w.length-1}] / ${y}`:"outputIndices[1]"};`;else if(_==="NCHW")Te=`
            ${ce.indicesSet("outputIndices","0","0")}
            let cOffset = ${ce.indicesToOffset("outputIndices")};`;else{Te=`var cIndices = ${C.type.indices}(0);
                       cIndices[0] = outputIndices[${w.length-1}];`;for(let Me=1;Me<C.rank;Me++)Te+=`cIndices[${Me}] = outputIndices[${Me}];`;Te+=`let cOffset = ${C.indicesToOffset("cIndices")};`}return Te},le=Te=>`
  const epsilon = ${f};
  ${Te.registerUniform("outputSize","u32").declareVariables(W,C,X,J,ne,ce)}
  ${Te.mainStart()}
  ${Te.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${ce.offsetToIndices(`global_idx * ${y}`)};
    ${fe()}
    let scale = ${C.getByOffset("cOffset")};
    let bias = ${X.getByOffset("cOffset")};
    let inputMean = ${J.getByOffset("cOffset")};
    let inputVar = ${ne.getByOffset("cOffset")};
    let x = ${W.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${ce.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${l.epsilon}_${l.format}_${g}_${y}`,inputDependencies:F?["rank","type","type","type","type"]:void 0},getShaderSource:le,getRunData:()=>({outputs:[{dims:i[0].dims,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(L/64)},programUniforms:F?[{type:12,data:L},...Tt(w)]:[{type:12,data:L}]})}},Zf=i=>Ht(i),bu=(i,l)=>{let{inputs:f,outputCount:g}=i,_=Zf({...l,outputCount:g});if(j.webgpu.validateInputContent&&wu(f,_),l.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");i.compute(Jf(f,_))}}),ep,xu,tp,ay=u(()=>{zt(),cn(),ep=i=>{if(i[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(i[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(i[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(i[0].dims[2]!==i[1].dims[0])throw new Error("last dimension of input and bias are not the same")},xu=i=>{let l=i[0].dims,f=i[0].dims[2],g=We.size(l)/4,_=i[0].dataType,w=et("input",_,l,4),y=et("bias",_,[f],4),S=et("residual",_,l,4),L=jt("output",_,l,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:l,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)}}),getShaderSource:F=>`
  const channels = ${f}u / 4;
  ${F.declareVariables(w,y,S,L)}

  ${F.mainStart()}
    ${F.guardAgainstOutOfBoundsWorkgroupSizes(g)}
    let value = ${w.getByOffset("global_idx")}
      + ${y.getByOffset("global_idx % channels")} + ${S.getByOffset("global_idx")};
    ${L.setByOffset("global_idx","value")}
  }`}},tp=i=>{ep(i.inputs),i.compute(xu(i.inputs))}}),Mu,Pn,np,Tu,rp,sp,Eu,ip,op,Pu,ap,lp,cp,up,Su,dp,Aa,Cu,Ul,hp,ku,fp,pp,Au,mp,gp,$u,_p,yp,Iu,vp,wp,Ou,bp,xp,Du,Mp,Wl,Lu,Tp,Ep,Pp,Fu,Sp,Cp,Ru=u(()=>{Kt(),zt(),gn(),cn(),Mu=(i,l,f,g,_,w,y)=>{let S=Math.ceil(l/4),L="";typeof _=="string"?L=`${_}(a)`:L=_("a");let F=et("inputData",f,[S],4),K=jt("outputData",g,[S],4),W=[{name:"vec_size",type:"u32"}];return y&&W.push(...y),`
      ${i.registerUniforms(W).declareVariables(F,K)}

  ${w??""}

  ${i.mainStart()}
    ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${F.getByOffset("global_idx")};
    ${K.setByOffset("global_idx",L)}
  }`},Pn=(i,l,f,g,_,w=i.dataType,y,S)=>{let L=[{type:12,data:Math.ceil(We.size(i.dims)/4)}];return y&&L.push(...y),{name:l,shaderCache:{hint:_,inputDependencies:["type"]},getShaderSource:F=>Mu(F,We.size(i.dims),i.dataType,w,f,g,S),getRunData:F=>({outputs:[{dims:i.dims,dataType:w}],dispatchGroup:{x:Math.ceil(We.size(F[0].dims)/64/4)},programUniforms:L})}},np=i=>{i.compute(Pn(i.inputs[0],"Abs","abs"))},Tu=i=>{i.compute(Pn(i.inputs[0],"Acos","acos"))},rp=i=>{i.compute(Pn(i.inputs[0],"Acosh","acosh"))},sp=i=>{i.compute(Pn(i.inputs[0],"Asin","asin"))},Eu=i=>{i.compute(Pn(i.inputs[0],"Asinh","asinh"))},ip=i=>{i.compute(Pn(i.inputs[0],"Atan","atan"))},op=i=>{i.compute(Pn(i.inputs[0],"Atanh","atanh"))},Pu=i=>Ht(i),ap=(i,l)=>{let f;switch(l.to){case 10:f="vec4<f16>";break;case 1:f="vec4<f32>";break;case 12:f="vec4<u32>";break;case 6:f="vec4<i32>";break;case 9:f="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${l.to}`)}i.compute(Pn(i.inputs[0],"Cast",f,void 0,l.cacheKey,l.to))},lp=i=>{let l,f,g=i.length>=2&&i[1].data!==0,_=i.length>=3&&i[2].data!==0;switch(i[0].dataType){case 1:l=g?i[1].getFloat32Array()[0]:-34028234663852886e22,f=_?i[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:l=g?i[1].getUint16Array()[0]:64511,f=_?i[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return Ht({min:l,max:f})},cp=(i,l)=>{let f=l||lp(i.inputs),g=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"Clip",_=>`clamp(${_}, vec4<${g}>(uniforms.min), vec4<${g}>(uniforms.max))`,void 0,f.cacheKey,void 0,[{type:i.inputs[0].dataType,data:f.min},{type:i.inputs[0].dataType,data:f.max}],[{name:"min",type:g},{name:"max",type:g}]),{inputs:[0]})},up=i=>{i.compute(Pn(i.inputs[0],"Ceil","ceil"))},Su=i=>{i.compute(Pn(i.inputs[0],"Cos","cos"))},dp=i=>{i.compute(Pn(i.inputs[0],"Cosh","cosh"))},Aa=i=>Ht(i),Cu=(i,l)=>{let f=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"Elu",g=>`elu_vf32(${g})`,`
  const elu_alpha_ = ${f}(${l.alpha});

  fn elu_f32(a: ${f}) -> ${f} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${f}>) -> vec4<${f}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,l.cacheKey))},Ul=(i="f32")=>`
const r0: ${i} = 0.3275911;
const r1: ${i} = 0.254829592;
const r2: ${i} = -0.284496736;
const r3: ${i} = 1.421413741;
const r4: ${i} = -1.453152027;
const r5: ${i} = 1.061405429;

fn erf_vf32(v: vec4<${i}>) -> vec4<${i}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,hp=i=>{let l=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"Erf",f=>`erf_vf32(${f})`,Ul(l)))},ku=i=>{i.compute(Pn(i.inputs[0],"Exp","exp"))},fp=i=>{i.compute(Pn(i.inputs[0],"Floor","floor"))},pp=i=>{let l=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"Gelu",f=>`0.5 * ${f} * (1.0 + erf_vf32(${f} * 0.7071067811865475))`,Ul(l)))},Au=(i,l)=>{let f=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"LeakyRelu",g=>`select(leaky_relu_alpha_ * ${g}, ${g}, ${g} >= vec4<${f}>(0.0))`,`const leaky_relu_alpha_ = ${f}(${l.alpha});`,l.cacheKey))},mp=i=>{i.compute(Pn(i.inputs[0],"Not",l=>`!${l}`))},gp=i=>{i.compute(Pn(i.inputs[0],"Neg",l=>`-${l}`))},$u=i=>{i.compute(Pn(i.inputs[0],"Reciprocal",l=>`1.0/${l}`))},_p=i=>{let l=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"Relu",f=>`select(vec4<${l}>(0.0), ${f}, ${f} > vec4<${l}>(0.0))`))},yp=i=>{i.compute(Pn(i.inputs[0],"Sigmoid",l=>`(1.0 / (1.0 + exp(-${l})))`))},Iu=i=>Ht(i),vp=(i,l)=>{let f=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"HardSigmoid",g=>`max(vec4<${f}>(0.0), min(vec4<${f}>(1.0), ${l.alpha} * ${g} + vec4<${f}>(${l.beta})))`,void 0,l.cacheKey))},wp=i=>{i.compute(Pn(i.inputs[0],"Sin","sin"))},Ou=i=>{i.compute(Pn(i.inputs[0],"Sinh","sinh"))},bp=i=>{i.compute(Pn(i.inputs[0],"Sqrt","sqrt"))},xp=i=>{i.compute(Pn(i.inputs[0],"Tan","tan"))},Du=i=>`sign(${i}) * (1 - exp(-2 * abs(${i}))) / (1 + exp(-2 * abs(${i})))`,Mp=i=>{i.compute(Pn(i.inputs[0],"Tanh",Du))},Wl=(i="f32")=>`
const fast_gelu_a: ${i} = 0.5;
const fast_gelu_b: ${i} = 0.7978845608028654;
const fast_gelu_c: ${i} = 0.035677408136300125;

fn tanh_v(v: vec4<${i}>) -> vec4<${i}> {
  return ${Du("v")};
}
`,Lu=i=>`(fast_gelu_a + fast_gelu_a * tanh_v(${i} * (fast_gelu_c * ${i} * ${i} + fast_gelu_b))) * ${i}`,Tp=i=>{let l=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"FastGelu",Lu,Wl(l),void 0,i.inputs[0].dataType))},Ep=(i,l)=>{let f=nr(i.inputs[0].dataType);return i.compute(Pn(i.inputs[0],"ThresholdedRelu",g=>`select(vec4<${f}>(0.0), ${g}, ${g} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${f}>(${l.alpha});`,l.cacheKey)),0},Pp=i=>{i.compute(Pn(i.inputs[0],"Log","log"))},Fu=(i,l)=>`
const alpha = vec4<${i}>(${l});
const one = ${i}(1.0);
const zero = ${i}(0.0);

fn quick_gelu_impl(x: vec4<${i}>) -> vec4<${i}> {
  let v = x *alpha;
  var x1 : vec4<${i}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,Sp=i=>`quick_gelu_impl(${i})`,Cp=(i,l)=>{let f=nr(i.inputs[0].dataType);i.compute(Pn(i.inputs[0],"QuickGelu",Sp,Fu(f,l.alpha),l.cacheKey,i.inputs[0].dataType))}}),kp,ju,Ap,ly=u(()=>{zt(),cn(),Ru(),kp=i=>{if(i[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(i[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(i[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(i[0].dims[2]!==i[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ju=i=>{let l=i[0].dims.slice();l[2]=l[2]/2;let f=et("input",i[0].dataType,i[0].dims,4),g=et("bias",i[0].dataType,[i[0].dims[2]],4),_=jt("output",i[0].dataType,l,4),w=We.size(l)/4,y=On(i[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:l,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(w/64)}}),getShaderSource:S=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${i[0].dims[2]/4/2}u;

  ${S.declareVariables(f,g,_)}

  ${Ul(y)}

  ${S.mainStart()}
    ${S.guardAgainstOutOfBoundsWorkgroupSizes(w)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${_.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},Ap=i=>{kp(i.inputs),i.compute(ju(i.inputs))}}),$p,Ip,Es,Op,Dp,Nu,Lp,Fp,zu,Rp,jp,Bu,Np,cy=u(()=>{Kt(),zt(),cn(),$p=(i,l,f,g,_,w,y,S,L,F,K,W)=>{let C,X;typeof S=="string"?C=X=(le,Te)=>`${S}((${le}),(${Te}))`:typeof S=="function"?C=X=S:(C=S.scalar,X=S.vector);let J=jt("outputData",K,g.length,4),ne=et("aData",L,l.length,4),ce=et("bData",F,f.length,4),fe;if(_)if(w){let le=We.size(l)===1,Te=We.size(f)===1,Me=l.length>0&&l[l.length-1]%4===0,$e=f.length>0&&f[f.length-1]%4===0;le||Te?fe=J.setByOffset("global_idx",X(le?`${ne.type.value}(${ne.getByOffset("0")}.x)`:ne.getByOffset("global_idx"),Te?`${ce.type.value}(${ce.getByOffset("0")}.x)`:ce.getByOffset("global_idx"))):fe=`
            let outputIndices = ${J.offsetToIndices("global_idx * 4u")};
            let offsetA = ${ne.broadcastedIndicesToOffset("outputIndices",J)};
            let offsetB = ${ce.broadcastedIndicesToOffset("outputIndices",J)};
            ${J.setByOffset("global_idx",X(y||Me?ne.getByOffset("offsetA / 4u"):`${ne.type.value}(${ne.getByOffset("offsetA / 4u")}[offsetA % 4u])`,y||$e?ce.getByOffset("offsetB / 4u"):`${ce.type.value}(${ce.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else fe=J.setByOffset("global_idx",X(ne.getByOffset("global_idx"),ce.getByOffset("global_idx")));else{if(!w)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let le=(Te,Me,$e="")=>{let ze=`aData[indexA${Me}][componentA${Me}]`,Ve=`bData[indexB${Me}][componentB${Me}]`;return`
            let outputIndices${Me} = ${J.offsetToIndices(`global_idx * 4u + ${Me}u`)};
            let offsetA${Me} = ${ne.broadcastedIndicesToOffset(`outputIndices${Me}`,J)};
            let offsetB${Me} = ${ce.broadcastedIndicesToOffset(`outputIndices${Me}`,J)};
            let indexA${Me} = offsetA${Me} / 4u;
            let indexB${Me} = offsetB${Me} / 4u;
            let componentA${Me} = offsetA${Me} % 4u;
            let componentB${Me} = offsetB${Me} % 4u;
            ${Te}[${Me}] = ${$e}(${C(ze,Ve)});
          `};K===9?fe=`
            var data = vec4<u32>(0);
            ${le("data",0,"u32")}
            ${le("data",1,"u32")}
            ${le("data",2,"u32")}
            ${le("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:fe=`
            ${le("outputData[global_idx]",0)}
            ${le("outputData[global_idx]",1)}
            ${le("outputData[global_idx]",2)}
            ${le("outputData[global_idx]",3)}
          `}return`
        ${i.registerUniform("vec_size","u32").declareVariables(ne,ce,J)}

        ${W??""}

        ${i.mainStart()}
        ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${fe}
      }`},Ip=(i,l,f,g,_,w,y=f.dataType)=>{let S=f.dims.map(ne=>Number(ne)??1),L=g.dims.map(ne=>Number(ne)??1),F=!We.areEqual(S,L),K=S,W=We.size(S),C=!1,X=!1,J=[F];if(F){let ne=Sr.calcShape(S,L,!1);if(!ne)throw new Error("Can't perform binary op on the given tensors");K=ne.slice(),W=We.size(K);let ce=We.size(S)===1,fe=We.size(L)===1,le=S.length>0&&S[S.length-1]%4===0,Te=L.length>0&&L[L.length-1]%4===0;J.push(ce),J.push(fe),J.push(le),J.push(Te);let Me=1;for(let $e=1;$e<K.length;$e++){let ze=S[S.length-$e],Ve=L[L.length-$e];if(ze===Ve)Me*=ze;else break}Me%4===0?(X=!0,C=!0):(ce||fe||le||Te)&&(C=!0)}else C=!0;return J.push(C),{name:i,shaderCache:{hint:l+J.map(ne=>ne.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:ne=>$p(ne,S,L,K,C,F,X,_,f.dataType,g.dataType,y,w),getRunData:()=>({outputs:[{dims:K,dataType:y}],dispatchGroup:{x:Math.ceil(W/64/4)},programUniforms:[{type:12,data:Math.ceil(We.size(K)/4)},...Tt(S,L,K)]})}},Es=(i,l,f,g,_,w)=>{i.compute(Ip(l,_??"",i.inputs[0],i.inputs[1],f,g,w))},Op=i=>{Es(i,"Add",(l,f)=>`${l}+${f}`)},Dp=i=>{Es(i,"Div",(l,f)=>`${l}/${f}`)},Nu=i=>{Es(i,"Equal",{scalar:(l,f)=>`u32(${l}==${f})`,vector:(l,f)=>`vec4<u32>(${l}==${f})`},void 0,void 0,9)},Lp=i=>{Es(i,"Mul",(l,f)=>`${l}*${f}`)},Fp=i=>{let l=et("input",i.inputs[0].dataType,i.inputs[0].dims).type.value;Es(i,"Pow",{scalar:(f,g)=>`pow_custom(${f},${g})`,vector:(f,g)=>`pow_vector_custom(${f},${g})`},`
    fn pow_custom(a : ${l}, b : ${l}) -> ${l} {
      if (b == ${l}(0.0)) {
        return ${l}(1.0);
      } else if (a < ${l}(0.0) && f32(b) != floor(f32(b))) {
        return ${l}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${l}(1.0), round(f32(abs(b) % ${l}(2.0))) != 1.0) * ${l}(${l==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${l}>, b : vec4<${l}>) -> vec4<${l}> {
      // TODO: implement vectorized pow
      return vec4<${l}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},zu=i=>{Es(i,"Sub",(l,f)=>`${l}-${f}`)},Rp=i=>{Es(i,"Greater",{scalar:(l,f)=>`u32(${l}>${f})`,vector:(l,f)=>`vec4<u32>(${l}>${f})`},void 0,void 0,9)},jp=i=>{Es(i,"Less",{scalar:(l,f)=>`u32(${l}<${f})`,vector:(l,f)=>`vec4<u32>(${l}<${f})`},void 0,void 0,9)},Bu=i=>{Es(i,"GreaterOrEqual",{scalar:(l,f)=>`u32(${l}>=${f})`,vector:(l,f)=>`vec4<u32>(${l}>=${f})`},void 0,void 0,9)},Np=i=>{Es(i,"LessOrEqual",{scalar:(l,f)=>`u32(${l}<=${f})`,vector:(l,f)=>`vec4<u32>(${l}<=${f})`},void 0,void 0,9)}}),Vu,zp,Bp,Gl,Vp,Up,Wp=u(()=>{Kt(),zt(),gn(),cn(),Vu=(i,l)=>{if(!i||i.length<1)throw new Error("too few inputs");let f=0,g=i[f],_=g.dataType,w=g.dims.length;i.forEach((y,S)=>{if(S!==f){if(y.dataType!==_)throw new Error("input tensors should be one type");if(y.dims.length!==w)throw new Error("input tensors should have the same shape");y.dims.forEach((L,F)=>{if(F!==l&&L!==g.dims[F])throw new Error("non concat dimensions must match")})}})},zp=(i,l)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${i}u>(${l});
    for (var i: u32 = 0u; i < ${i}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${i}u;
  }`,Bp=(i,l)=>{let f=i.length,g=[];for(let _=0;_<f;++_){let w=l.setByOffset("global_idx",i[_].getByIndices("indices"));f===1?g.push(w):_===0?g.push(`if (inputIndex == ${_}u) { ${w} }`):_===f-1?g.push(`else { ${w} }`):g.push(`else if (inputIndex == ${_}) { ${w} }`)}return g.join(`
`)},Gl=(i,l,f,g)=>{let _=We.size(f),w=new Array(i.length),y=new Array(i.length),S=0,L=[],F=[],K=[{type:12,data:_}];for(let ne=0;ne<i.length;++ne)S+=i[ne].dims[l],w[ne]=S,F.push(i[ne].dims.length),y[ne]=et(`input${ne}`,g,F[ne]),L.push("rank"),K.push({type:12,data:w[ne]});for(let ne=0;ne<i.length;++ne)K.push(...Tt(i[ne].dims));K.push(...Tt(f));let W=jt("output",g,f.length),C=W.indicesGet("indices",l),X=Array.from(Array(w.length).keys()).map(ne=>`uniforms.sizeInConcatAxis${ne}`).join(","),J=ne=>`

  ${(()=>{ne.registerUniform("outputSize","u32");for(let ce=0;ce<i.length;ce++)ne.registerUniform(`sizeInConcatAxis${ce}`,"u32");return ne.declareVariables(...y,W)})()}

  ${zp(w.length,X)}

  ${ne.mainStart()}
    ${ne.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${W.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${C});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${w.length}u>(${X});
      ${C} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${Bp(y,W)}
  }`;return{name:"Concat",shaderCache:{hint:`${l}`,inputDependencies:L},getRunData:()=>({outputs:[{dims:f,dataType:g}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:K}),getShaderSource:J}},Vp=(i,l)=>{let f=i.inputs,g=f[0].dims,_=We.normalizeAxis(l.axis,g.length);Vu(f,_);let w=g.slice();w[_]=f.reduce((S,L)=>S+(L.dims.length>_?L.dims[_]:0),0);let y=f.filter(S=>We.size(S.dims)>0);i.compute(Gl(y,_,w,f[0].dataType),{inputs:y})},Up=i=>Ht({axis:i.axis})}),Bi,co,Vi,Uu,uo=u(()=>{Kt(),zt(),Bi=(i,l,f="f32")=>{switch(i.activation){case"Relu":return`value = max(value, ${l}(0.0));`;case"Sigmoid":return`value = (${l}(1.0) / (${l}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${l}(${f}(uniforms.clip_min)), ${l}(${f}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${l}(0.0), min(${l}(1.0), ${f}(uniforms.alpha) * value + ${f}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${f}(uniforms.alpha) * value, value, value >= ${l}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${i.activation}`)}},co=(i,l)=>{i.activation==="Clip"?l.push({type:1,data:i.clipMax},{type:1,data:i.clipMin}):i.activation==="HardSigmoid"?l.push({type:1,data:i.alpha},{type:1,data:i.beta}):i.activation==="LeakyRelu"&&l.push({type:1,data:i.alpha})},Vi=(i,l)=>{i.activation==="Clip"?l.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):i.activation==="HardSigmoid"?l.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):i.activation==="LeakyRelu"&&l.push({name:"alpha",type:"f32"})},Uu=i=>{let l=(i==null?void 0:i.activation)||"";if(l==="HardSigmoid"){let[f,g]=(i==null?void 0:i.activation_params)||[.2,.5];return{activation:l,alpha:f,beta:g}}else if(l==="Clip"){let[f,g]=(i==null?void 0:i.activation_params)||[tr,Dr];return{activation:l,clipMax:g,clipMin:f}}else if(l==="LeakyRelu"){let[f]=(i==null?void 0:i.activation_params)||[.01];return{activation:l,alpha:f}}return{activation:l}}}),Lr,Wu,Gu=u(()=>{Lr=(i,l)=>{switch(i){case 1:return l;case 2:return`vec2<${l}>`;case 3:return`vec3<${l}>`;case 4:return`vec4<${l}>`;default:throw new Error(`${i}-component is not supported.`)}},Wu=i=>`
      ${i?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Gp,uy=u(()=>{Gp=i=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${i}.x), i32(${i}.y), i32(${i}.z), 1));
}
`}),Go,Ku,Hu=u(()=>{Kt(),zt(),cn(),uo(),Go=(i,l,f,g,_)=>{let w=g-f;return`
      ${Array.from({length:f}).map((y,S)=>`
      if (${Ft(l.shape,S,l.rank)} != 1) {
        ${l.indicesSet(i,S,Ft(_,S+w,g))}
      } else {
        ${l.indicesSet(i,S,0)}
      }`).join("")}
`},Ku=(i,l,f,g,_=!1,w)=>{let y=i[0].dims,S=i[1].dims,L=y[y.length-2],F=S[S.length-1],K=y[y.length-1],W=rn(F),C=rn(K),X=rn(L),J=We.size(f)/W/X,ne=i.length>2,ce=g?g.slice(0,-2):f.slice(0,-2),fe=[We.size(ce),L,F],le=[{type:12,data:J},{type:12,data:L},{type:12,data:F},{type:12,data:K}];co(l,le),le.push(...Tt(ce,y,S)),ne&&le.push(...Tt(i[2].dims)),le.push(...Tt(fe));let Te=Me=>{let $e=Jc("batch_dims",i[0].dataType,ce.length),ze=et("a",i[0].dataType,y.length,C),Ve=et("b",i[1].dataType,S.length,W),st=jt("output",i[0].dataType,fe.length,W),pt=On(st.type.tensor),$t=Bi(l,st.type.value,pt),on=[ze,Ve],dn="";if(ne){let Lt=_?W:1;on.push(et("bias",i[2].dataType,i[2].dims.length,Lt)),dn=`${_?`value += bias[col / ${Lt}];`:`value += ${st.type.value}(bias[row + i]);`}`}let Pt=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Vi(l,Pt);let pn=()=>{let Lt=`var a_data: ${ze.type.value};`;for(let Bt=0;Bt<C;Bt++)Lt+=`
              let b_data${Bt} = b[(b_offset + (k + ${Bt}) * uniforms.N + col) / ${W}];`;for(let Bt=0;Bt<X;Bt++){Lt+=`a_data = a[(a_offset + (row + ${Bt}) * uniforms.K + k) / ${C}];`;for(let Vn=0;Vn<C;Vn++)Lt+=`
            values[${Bt}] = fma(${Ve.type.value}(a_data${C===1?"":`[${Vn}]`}), b_data${Vn}, values[${Bt}]);
`}return Lt};return`
  ${Me.registerUniforms(Pt).registerInternalVariables($e).declareVariables(...on,st)}
  ${Me.mainStart()}
    ${Me.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${W})) * ${W};
    var index1 = global_idx / (uniforms.N / ${W});
    let stride1 = uniforms.M / ${X};
    let row = (index1 % stride1) * ${X};
    let batch = index1 / stride1;

    ${f.length===2?"":`let batch_indices = ${$e.offsetToIndices("batch")};`}

    var a_indices: ${ze.type.indices};
    ${Go("a_indices",ze,ze.rank-2,$e.rank,"batch_indices")}
    ${ze.indicesSet("a_indices",ze.rank-2,0)}
    ${ze.indicesSet("a_indices",ze.rank-1,0)}
    let a_offset = ${ze.indicesToOffset("a_indices")};

    var b_indices: ${Ve.type.indices};
    ${Go("b_indices",Ve,Ve.rank-2,$e.rank,"batch_indices")}
    ${Ve.indicesSet("b_indices",Ve.rank-2,0)}
    ${Ve.indicesSet("b_indices",Ve.rank-1,0)}
    let b_offset = ${Ve.indicesToOffset("b_indices")};
    var values: array<${st.type.value}, ${X}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${C}) {
      ${pn()}
    }
    for (var i = 0u; i < ${X}u; i++) {
      var value = values[i];
      ${dn}
      ${$t}
      let cur_indices = ${st.type.indices}(batch, row + i, col);
      let offset = ${st.indicesToOffset("cur_indices")};
      ${st.setByOffset(`offset / ${W}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${l.activation};${W};${C};${X};${_}`,inputDependencies:ne?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:w?w(f):f,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(J/64)},programUniforms:le}),getShaderSource:Te}}}),qu,Kp,Qu,Kl,Hp,Yu,Xu,Hl,Ju=u(()=>{Kt(),zt(),cn(),uo(),Hu(),Gu(),qu=(i,l)=>i?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${l?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${l?", batchIndices":""});
        `,Kp=(i,l)=>i?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${l===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${l===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${l===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,Qu=(i,l,f="f32",g,_=!1,w=32,y=!1,S=32)=>{let L=l[1]*i[1],F=l[0]*i[0],K=_?L:w,W=_?w:L,C=K/l[0],X=w/l[1];if(!((_&&C===4&&i[1]===4||!_&&(C===3||C===4))&&K%l[0]===0&&w%l[1]===0&&i[0]===4))throw new Error(`If transposeA ${_} is true, innerElementSize ${C} and workPerThread[1] ${i[1]} must be 4.
      Otherwise, innerElementSize ${C} must be 3 or 4.
  tileAWidth ${K} must be divisible by workgroupSize[0]${l[0]}. tileInner ${w} must be divisible by workgroupSize[1] ${l[1]}. colPerThread ${i[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${C}<${f}>, ${K/C}>, ${W}>;
var<workgroup> mm_Bsub: array<array<vec4<${f}>, ${F/i[0]}>, ${w}>;

const rowPerThread = ${i[1]};
const colPerThread = ${i[0]};
const innerElementSize = ${C};
const tileInner = ${w};

@compute @workgroup_size(${l[0]}, ${l[1]}, ${l[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${y?"0":"i32(globalId.z)"};
  ${g?`let batchIndices = ${g.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${L};

  let num_tiles = ${y?`${Math.ceil(S/w)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${y?`i32(globalId.z) * ${S}`:"0"};

  var acc: array<vec4<${f}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${X};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${qu(_,g)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${X}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${g?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${C===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${Kp(_,C)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Kl=(i,l)=>i?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${l?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${l?", batchIndices":""});
            `,Hp=i=>i?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Yu=(i,l,f="f32",g,_=!1,w=32,y=!1,S=32,L=!1)=>{let F=i[1]*l[1],K=i[0]*l[0],W=_?F:w,C=_?w:F;if(!(C%l[1]===0&&W%l[0]===0&&w%l[1]===0))throw new Error(`tileAHight ${C} must be divisible by workgroupSize[1]${l[1]}, tileAWidth ${W} must be divisible by workgroupSize[0]${l[0]}, tileInner ${w} must be divisible by workgroupSize[1]${l[1]}`);let X=C/l[1],J=W/l[0],ne=w/l[1],ce=L?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${F};
    let globalColStart = i32(workgroupId.x) * ${K};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${C}; inputRow = inputRow + ${l[1]}) {
        for (var inputCol = localCol; inputCol < ${W}; inputCol = inputCol + ${l[0]}) {
          ${Kl(_,g)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${l[1]}) {
            for (var inputCol = localCol; inputCol < ${K}; inputCol = inputCol + ${l[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${g?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${f}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${l[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${_?`mm_Asub[k][localRow + innerRow * ${l[1]}];`:`mm_Asub[localRow + innerRow * ${l[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${l[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${l[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${F};

let tileRowA = i32(localId.y) * ${X};
let tileColA = i32(localId.x) * ${J};
let tileRowB = i32(localId.y) * ${ne};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${X}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${J}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Kl(_,g)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${ne}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${g?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${f}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${Hp(_)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${f}, ${W}>, ${C}>;
  var<workgroup> mm_Bsub : array<array<${f}, ${K}>, ${w}>;
  const rowPerThread = ${i[1]};
  const colPerThread = ${i[0]};
  const tileInner = ${w};

@compute @workgroup_size(${l[0]}, ${l[1]}, ${l[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${y?"0":"i32(globalId.z)"};
    ${g?`let batchIndices = ${g.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${y?`${Math.ceil(S/w)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${y?`i32(globalId.z) * ${S}`:"0"};

    var acc : array<array<${f}, colPerThread>, rowPerThread>;
    ${ce}
  }
`},Xu=(i,l,f,g,_=!1)=>{let[w,y,S,L]=g,F=On(g[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${w.type.indices}) -> ${Lr(i,F)} {
      var value = ${Lr(i,F)}(0.0);
      let col = colIn * ${i};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${y.type.indices};
        ${Go("aIndices",y,y.rank-2,w.rank,"batchIndices")}
        ${y.indicesSet("aIndices",y.rank-2,"u32(row)")}
        ${y.indicesSet("aIndices",y.rank-1,"u32(colIn)")}
        value = ${y.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${w.type.indices}) -> ${Lr(i,F)} {
      var value = ${Lr(i,F)}(0.0);
      let col = colIn * ${i};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${S.type.indices};
        ${Go("bIndices",S,S.rank-2,w.rank,"batchIndices")}
        ${S.indicesSet("bIndices",S.rank-2,"u32(row)")}
        ${S.indicesSet("bIndices",S.rank-1,"u32(colIn)")}
        value = ${S.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Lr(i,F)}) {
      let col = colIn * ${i};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${l?`value = value + ${_?"bias[colIn]":`${Lr(i,F)}(bias[row])`};`:""}
        ${f}
        ${L.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},Hl=(i,l,f,g,_=!1,w)=>{let y=i[0].dims,S=i[1].dims,L=y.slice(0,-2),F=S.slice(0,-2),K=g?g.slice(0,-2):f.slice(0,-2),W=We.size(K),C=y[y.length-2],X=y[y.length-1],J=S[S.length-1],ne=X%4===0&&J%4===0,ce=C<=8?[4,1,1]:[4,4,1],fe=[8,8,1],le=[Math.ceil(J/fe[0]/ce[0]),Math.ceil(C/fe[1]/ce[1]),Math.ceil(W/fe[2]/ce[2])],Te=ne?4:1,Me=[...L,C,X/Te],$e=Me.length,ze=[...F,X,J/Te],Ve=ze.length,st=[W,C,J/Te],pt=[{type:6,data:C},{type:6,data:J},{type:6,data:X}];co(l,pt),pt.push(...Tt(K,Me,ze));let $t=["rank","rank"],on=i.length>2;on&&(pt.push(...Tt(i[2].dims)),$t.push("rank")),pt.push(...Tt(st));let dn=Pt=>{let pn=K.length,Lt=Jc("batchDims",i[0].dataType,pn,1),Bt=On(i[0].dataType),Vn=et("a",i[0].dataType,$e,Te),nn=et("b",i[1].dataType,Ve,Te),qt=jt("result",i[0].dataType,st.length,Te),Ln=[Vn,nn];if(on){let Bs=_?Te:1;Ln.push(et("bias",i[2].dataType,i[2].dims.length,Bs))}let dt=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Vi(l,dt);let It=On(qt.type.tensor),Sn=Bi(l,qt.type.value,It),vr=Xu(Te,on,Sn,[Lt,Vn,nn,qt],_);return`
  ${Pt.registerUniforms(dt).registerInternalVariables(Lt).declareVariables(...Ln,qt)}
  ${vr}
  ${ne?Qu(ce,fe,Bt,Lt):Yu(ce,fe,Bt,Lt)}
                   `};return{name:"MatMul",shaderCache:{hint:`${ce};${l.activation};${ne};${_}`,inputDependencies:$t},getRunData:()=>({outputs:[{dims:w?w(f):f,dataType:i[0].dataType}],dispatchGroup:{x:le[0],y:le[1],z:le[2]},programUniforms:pt}),getShaderSource:dn}}}),Zu,qp,dy=u(()=>{Kt(),Le(),cn(),uo(),Gu(),uy(),Ju(),Zu=(i,l,f,g,_=!1,w,y=4,S=4,L=4,F="f32")=>{let K=pt=>{switch(pt){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${F}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${pt} is not supported.`)}},W=pt=>{switch(pt){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${pt} is not supported.`)}},C=i?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,X=i?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,J=i?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",ne=i?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",ce=i?"row":"col",fe=i?"col":"row",le=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${i?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${ce} / outWidth;
    let outCol = ${ce} % outWidth;

    let WRow = ${fe} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${fe} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${fe} % inChannels;
    var resData = ${Lr(y,F)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${J} && xCol >= 0 && xCol < ${ne}) {
      ${C}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${K(y)}
    }
    return resData;`,Te=i?l&&g?`
    let col = colIn * ${y};
    ${le}`:`
    let col = colIn * ${y};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${le}
    }
    return ${Lr(y,F)}(0.0);`:g&&f?`
    let col = colIn * ${y};
    ${le}`:`
    let col = colIn * ${y};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${le}
    }
    return ${Lr(y,F)}(0.0);`,Me=i?g&&f?W(S):`
    let col = colIn * ${S};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${W(S)}
    }
    return ${Lr(S,F)}(0.0);`:`
    let col = colIn * ${S};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${W(S)}
    }
    return ${Lr(S,F)}(0.0);`,$e=Lr(L,F),ze=Lr(i?y:S,F),Ve=Lr(i?S:y,F),st=Bi(w,$e,F);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${ze} {
      ${i?Te:Me}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${Ve} {
      ${i?Me:Te}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${$e}) {
      let col = colIn * ${L};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${i?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${X}
      ${Wu(_)}
      ${st}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},qp=(i,l,f,g,_,w,y,S,L)=>{let F=l.format==="NHWC",K=F?i[0].dims[3]:i[0].dims[1],W=f[0],C=F?f[2]:f[3],X=F?f[1]:f[2],J=F?f[3]:f[1],ne=F&&(K%4===0||K%3===0)&&J%4===0,ce=F?J:C*X,fe=F?C*X:J,le=[8,8,1],Te=g<=8?[4,1,1]:[4,4,1],Me=[Math.ceil(ce/le[0]/Te[0]),Math.ceil(fe/le[1]/Te[1]),Math.ceil(W/le[2]/Te[2])];Mn("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${Me}`);let $e=ne?F&&K%4!==0?3:4:1,ze=le[1]*Te[1],Ve=le[0]*Te[0],st=Math.max(le[0]*$e,le[1]),pt=g%ze===0,$t=_%Ve===0,on=w%st===0,dn=ne?[$e,4,4]:[1,1,1],Pt=[{type:6,data:g},{type:6,data:_},{type:6,data:w},{type:6,data:[l.pads[0],l.pads[1]]},{type:6,data:l.strides},{type:6,data:l.dilations}];co(l,Pt),Pt.push(...Tt(i[0].dims,i[1].dims));let pn=["rank","rank"];y&&(Pt.push(...Tt(i[2].dims)),pn.push("rank")),Pt.push(...Tt(f));let Lt=Bt=>{let Vn=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Vi(l,Vn);let nn=ne?4:1,qt=On(i[0].dataType),Ln=`
      fn setOutputAtIndex(flatIndex : i32, value : ${ne?`vec4<${qt}>`:qt}) {
        result[flatIndex] = ${ne?`vec4<${qt}>`:qt}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${ne?`vec4<${qt}>`:qt}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${ne?"/ 4":""}, value);
      }`,dt=et("x",i[0].dataType,i[0].dims.length,$e===3?1:$e),It=et("w",i[1].dataType,i[1].dims.length,nn),Sn=[dt,It],vr=jt("result",i[0].dataType,f.length,nn);if(y){let Bs=et("bias",i[2].dataType,i[2].dims.length,nn);Sn.push(Bs),Ln+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${ne?`vec4<${qt}>`:qt} {
          return bias[coords.${F?"w":"y"}${ne?"/ 4":""}];
        }`}return`
        ${Gp("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${Bt.registerUniforms(Vn).declareVariables(...Sn,vr)}
        ${Ln}
        ${Zu(F,pt,$t,on,y,l,dn[0],dn[1],dn[2],qt)}
        ${ne?Qu(Te,le,qt,void 0,!F,st):Yu(Te,le,qt,void 0,!F,st,!1,void 0,S)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${l.cacheKey};${$e};${ne};${pt};${$t};${on};${ze};${Ve};${st}`,inputDependencies:pn},getRunData:()=>({outputs:[{dims:L?L(f):f,dataType:i[0].dataType}],dispatchGroup:{x:Me[0],y:Me[1],z:Me[2]},programUniforms:Pt}),getShaderSource:Lt}}}),ed,td,$a,Qp,nd,ql,Yp,Xp,hy=u(()=>{Kt(),Le(),zt(),cn(),uo(),Gu(),ed=i=>{let l=1;for(let f=0;f<i.length;f++)l*=i[f];return l},td=i=>typeof i=="number"?[i,i,i]:i,$a=(i,l)=>l<=1?i:i+(i-1)*(l-1),Qp=(i,l,f,g=1)=>{let _=$a(l,g);return Math.floor((i[0]*(f-1)-f+_)/2)},nd=(i,l,f,g,_)=>{_==null&&(_=Qp(i,l[0],g[0]));let w=[0,0,0,f];for(let y=0;y<3;y++)i[y]+2*_>=l[y]&&(w[y]=Math.trunc((i[y]-l[y]+2*_)/g[y]+1));return w},ql=(i,l,f,g,_,w,y,S,L,F)=>{let K,W,C,X;if(i==="VALID"&&(i=0),typeof i=="number"){K={top:i,bottom:i,left:i,right:i,front:i,back:i};let J=nd([l,f,g,1],[S,L,F],1,[_,w,y],i);W=J[0],C=J[1],X=J[2]}else if(Array.isArray(i)){if(!i.every((ne,ce,fe)=>ne===fe[0]))throw Error(`Unsupported padding parameter: ${i}`);K={top:i[0],bottom:i[1],left:i[2],right:i[3],front:i[4],back:i[5]};let J=nd([l,f,g,1],[S,L,F],1,[_,w,y],i[0]);W=J[0],C=J[1],X=J[2]}else if(i==="SAME_UPPER"){W=Math.ceil(l/_),C=Math.ceil(f/w),X=Math.ceil(g/y);let J=(W-1)*_+S-l,ne=(C-1)*w+L-f,ce=(X-1)*y+F-g,fe=Math.floor(J/2),le=J-fe,Te=Math.floor(ne/2),Me=ne-Te,$e=Math.floor(ce/2),ze=ce-$e;K={top:Te,bottom:Me,left:$e,right:ze,front:fe,back:le}}else throw Error(`Unknown padding parameter: ${i}`);return{padInfo:K,outDepth:W,outHeight:C,outWidth:X}},Yp=(i,l,f,g,_,w=!1,y="channelsLast")=>{let S,L,F,K,W;if(y==="channelsLast")[S,L,F,K,W]=i;else if(y==="channelsFirst")[S,W,L,F,K]=i;else throw new Error(`Unknown dataFormat ${y}`);let[C,,X,J,ne]=l,[ce,fe,le]=td(f),[Te,Me,$e]=td(g),ze=$a(X,Te),Ve=$a(J,Me),st=$a(ne,$e),{padInfo:pt,outDepth:$t,outHeight:on,outWidth:dn}=ql(_,L,F,K,ce,fe,le,ze,Ve,st),Pt=w?C*W:C,pn=[0,0,0,0,0];return y==="channelsFirst"?pn=[S,Pt,$t,on,dn]:y==="channelsLast"&&(pn=[S,$t,on,dn,Pt]),{batchSize:S,dataFormat:y,inDepth:L,inHeight:F,inWidth:K,inChannels:W,outDepth:$t,outHeight:on,outWidth:dn,outChannels:Pt,padInfo:pt,strideDepth:ce,strideHeight:fe,strideWidth:le,filterDepth:X,filterHeight:J,filterWidth:ne,effectiveFilterDepth:ze,effectiveFilterHeight:Ve,effectiveFilterWidth:st,dilationDepth:Te,dilationHeight:Me,dilationWidth:$e,inShape:i,outShape:pn,filterShape:l}},Xp=(i,l,f,g,_,w)=>{let y=w==="channelsLast";y?i[0].dims[3]:i[0].dims[1];let S=[64,1,1],L={x:f.map((ce,fe)=>fe)},F=[Math.ceil(ed(L.x.map(ce=>f[ce]))/S[0]),1,1];Mn("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${F}`);let K=1,W=We.size(f),C=[{type:12,data:W},{type:12,data:g},{type:12,data:_},{type:12,data:l.strides},{type:12,data:l.dilations}];co(l,C),C.push(...Tt(i[0].dims,i[1].dims));let X=["rank","rank"],J=i.length===3;J&&(C.push(...Tt(i[2].dims)),X.push("rank")),C.push(...Tt(f));let ne=ce=>{let fe=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:g.length},{name:"pads",type:"u32",length:_.length},{name:"strides",type:"u32",length:l.strides.length},{name:"dilations",type:"u32",length:l.dilations.length}];Vi(l,fe);let le=1,Te=On(i[0].dataType),Me=et("x",i[0].dataType,i[0].dims.length,K),$e=et("W",i[1].dataType,i[1].dims.length,le),ze=[Me,$e],Ve=jt("result",i[0].dataType,f.length,le),st="";if(J){let on=et("bias",i[2].dataType,i[2].dims.length,le);ze.push(on),st+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${Te} {
          return bias[${y?Ft("coords",4,5):Ft("coords",1,5)}];
        }`}let pt=Lr(K,Te),$t=Bi(l,pt,Te);return`
            ${st}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${Me.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${$e.getByIndices("aIndices")};
            }
          ${ce.registerUniforms(fe).declareVariables(...ze,Ve)}
          ${ce.mainStart()}
          ${ce.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${Ve.offsetToIndices("global_idx")};
              let batch = ${Ft("coords",0,Me.rank)};
              let d2 = ${y?Ft("coords",Me.rank-1,Me.rank):Ft("coords",1,Me.rank)};
              let xFRCCorner = vec3<u32>(${y?Ft("coords",1,Me.rank):Ft("coords",2,Me.rank)},
              ${y?Ft("coords",2,Me.rank):Ft("coords",3,Me.rank)},
              ${y?Ft("coords",3,Me.rank):Ft("coords",4,Me.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${y?Ft("uniforms.x_shape",1,Me.rank):Ft("uniforms.x_shape",2,Me.rank)};
              let xShapeZ = ${y?Ft("uniforms.x_shape",2,Me.rank):Ft("uniforms.x_shape",3,Me.rank)};
              let xShapeW = ${y?Ft("uniforms.x_shape",3,Me.rank):Ft("uniforms.x_shape",4,Me.rank)};
              let xShapeU = ${y?Ft("uniforms.x_shape",4,Me.rank):Ft("uniforms.x_shape",1,Me.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${y?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${y?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${y?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${y?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${J?"value = value + getBiasByOutputCoords(coords)":""};
              ${$t}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${l.cacheKey};${y};${K};${J}`,inputDependencies:X},getRunData:()=>({outputs:[{dims:f,dataType:i[0].dataType}],dispatchGroup:{x:F[0],y:F[1],z:F[2]},programUniforms:C}),getShaderSource:ne}}}),Jp,Zp,em=u(()=>{Kt(),zt(),cn(),uo(),Jp=(i,l,f,g)=>{let _=i.length>2,w=_?"value += b[output_channel];":"",y=i[0].dims,S=i[1].dims,L=l.format==="NHWC",F=L?f[3]:f[1],K=F/l.group,W=L&&K>=4?rn(F):1,C=We.size(f)/W,X=[{type:12,data:C},{type:12,data:l.dilations},{type:12,data:[l.strides[0],l.strides[1]]},{type:12,data:[l.pads[0],l.pads[1]]},{type:12,data:K}];co(l,X),X.push(...Tt(y,[S[0],S[1],S[2],S[3]/W]));let J=_?["rank","rank","rank"]:["rank","rank"];X.push(...Tt([f[0],f[1],f[2],f[3]/W]));let ne=ce=>{let fe=jt("output",i[0].dataType,f.length,W),le=On(fe.type.tensor),Te=Bi(l,fe.type.value,le),Me=et("x",i[0].dataType,y.length),$e=et("w",i[1].dataType,S.length,W),ze=[Me,$e];_&&ze.push(et("b",i[2].dataType,i[2].dims,W));let Ve=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:l.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];Vi(l,Ve);let st=L?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${Me.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${$e.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${Me.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${$e.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${ce.registerUniforms(Ve).declareVariables(...ze,fe)}

  ${ce.mainStart()}
    ${ce.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${fe.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${L?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${L?1:2}], outputIndices[${L?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${W} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${L?2:1}];

    var value: ${fe.type.value} = ${fe.type.value}(0);
    ${st}
    ${w}
    ${Te}
    ${fe.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${l.cacheKey}_${W}`,inputDependencies:J},getRunData:()=>({outputs:[{dims:g?g(f):f,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:X}),getShaderSource:ne}},Zp=(i,l,f,g)=>{let _=i.length>2,w=rn(f[3]),y=rn(f[2]),S=We.size(f)/w/y,L=[i[0].dims[0],i[0].dims[1],i[0].dims[2],i[0].dims[3]/w],F=[i[1].dims[0],i[1].dims[1],i[1].dims[2],i[1].dims[3]/w],K=[f[0],f[1],f[2],f[3]/w],W=[{type:12,data:S},{type:6,data:[l.strides[0],l.strides[1]]},{type:6,data:[l.pads[0],l.pads[1]]}];co(l,W),W.push(...Tt(L,F,K));let C=(y-1)*l.strides[1]+F[1],X=J=>{let ne=jt("output",i[0].dataType,K.length,w),ce=On(ne.type.tensor),fe=Bi(l,ne.type.value,ce),le=et("x",i[0].dataType,L.length,w),Te=et("w",i[1].dataType,F.length,w),Me=[le,Te];_&&Me.push(et("b",i[2].dataType,i[2].dims,w));let $e=_?"value += b[output_channel];":"",ze=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Vi(l,ze),`
  ${J.registerUniforms(ze).declareVariables(...Me,ne)}
  ${J.mainStart()}
    ${J.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${y}u;
    let col = (index1 % width1) * ${y}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${le.type.value}, ${C}>;
    var values: array<${ne.type.value}, ${y}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${F[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${C}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${le.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${le.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${F[1]}; w_width++) {
          let w_val = ${Te.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${y}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${y}u; i++) {
      var value = values[i];
      ${$e}
      ${fe}
      ${ne.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${l.cacheKey};${w};${y};${C};${F[0]};${F[1]}`,inputDependencies:_?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:g?g(f):f,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:W}),getShaderSource:X}}}),tm,Ql,rd,Yl,sd,id,nm,od,ad,fy=u(()=>{zt(),dy(),hy(),Ju(),em(),uo(),Hu(),zi(),tm=(i,l,f,g,_,w)=>{let y=i[0],S=i.slice(w?1:2,w?3:4),L=S.length,F=l[0],K=l.slice(2).map((C,X)=>C+(C-1)*(f[X]-1)),W=S.map((C,X)=>C+g[X]+g[X+L]).map((C,X)=>Math.floor((C-K[X]+_[X])/_[X]));return W.splice(0,0,y),W.splice(w?3:1,0,F),W},Ql=[2,3,1,0],rd=(i,l)=>{if(!i||i.length!==2&&i.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(i[0].dims.length>5)throw new Error("greater than 5D is not supported");if(i[0].dims.length!==i[1].dims.length)throw new Error("filter does not have same dimension as input");let f=i[0].dims[l.format==="NHWC"?i[0].dims.length-1:1],g=i[1].dims[1]*l.group;if(f!==g)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(i.length===3&&(i[2].dims.length!==1||i[1].dims[0]!==i[2].dims[0]))throw new Error("invalid bias");let _=i[0].dims.length-2;if(l.dilations.length!==_)throw new Error(`dilations should be ${_}D`);if(l.strides.length!==_)throw new Error(`strides should be ${_}D`);if(l.pads.length!==_*2)throw new Error(`pads should be ${_*2}D`);if(l.kernelShape.length!==0&&l.kernelShape.length!==i[1].dims.length-2)throw new Error("invalid kernel shape")},Yl=(i,l)=>{let f=i.kernelShape.slice();f.length<l[1].dims.length-2&&f.push(...Array(l[1].dims.length-2-f.length).fill(0));for(let w=2;w<l[1].dims.length;++w)f[w-2]===0&&(f[w-2]=l[1].dims[w]);let g=i.pads.slice();Vr.adjustPadsBasedOnAutoPad(l[0].dims,i.strides,i.dilations,f,g,i.format==="NHWC",i.autoPad);let _=Object.assign({},i);return Object.assign(_,{kernelShape:f,pads:g}),_},sd=i=>{let l=Uu(i),f=i.format,g=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][i.auto_pad],_=i.dilations,w=i.group,y=i.kernel_shape,S=i.pads,L=i.strides,F=i.w_is_const();return{autoPad:g,format:f,dilations:_,group:w,kernelShape:y,pads:S,strides:L,wIsConst:F,...l,cacheKey:`${i.format};${l.activation};`}},id=(i,l,f,g)=>{let _=f.format==="NHWC",w=tm(l[0].dims,l[1].dims,f.dilations,f.pads,f.strides,_);if(f.group!==1){let ze=[l[0]];if(_){let Ve=i.kernelCustomData.wT??i.compute(Ms(l[1],Ql),{inputs:[1],outputs:[f.wIsConst?-2:-1]})[0];f.wIsConst&&!i.kernelCustomData.wT&&(i.kernelCustomData.wT=Ve),ze.push(Ve)}else ze.push(l[1]);l.length===3&&ze.push(l[2]),!i.adapterInfo.isArchitecture("ampere")&&_&&l[1].dims[0]===f.group&&l[1].dims[1]===1&&f.dilations[0]===1&&f.dilations[1]===1?i.compute(Zp(ze,f,w,g),{inputs:ze}):i.compute(Jp(ze,f,w,g),{inputs:ze});return}let y=l.length===3,S=l[0].dims[_?1:2],L=l[0].dims[_?2:3],F=l[0].dims[_?3:1],K=l[1].dims[2],W=l[1].dims[3],C=w[_?1:2],X=w[_?2:3],J=w[_?3:1],ne=_&&K===S&&W===L&&f.pads[0]===0&&f.pads[1]===0;if(ne||K===1&&W===1&&f.dilations[0]===1&&f.dilations[1]===1&&f.strides[0]===1&&f.strides[1]===1&&f.pads[0]===0&&f.pads[1]===0){let ze=w[0],Ve,st,pt,$t=[];if(_){let Pt=i.kernelCustomData.wT??i.compute(Ms(l[1],Ql),{inputs:[1],outputs:[f.wIsConst?-2:-1]})[0];if(f.wIsConst&&!i.kernelCustomData.wT&&(i.kernelCustomData.wT=Pt),ne){let pn=S*L*F;Ve=l[0].reshape([1,ze,pn]),st=Pt.reshape([1,pn,J]),pt=[1,ze,J]}else Ve=l[0].reshape([ze,S*L,F]),st=Pt.reshape([1,F,J]),pt=[ze,C*X,J];$t.push(Ve),$t.push(st)}else Ve=l[0].reshape([ze,F,S*L]),st=l[1].reshape([1,J,F]),pt=[ze,J,C*X],$t.push(st),$t.push(Ve);y&&$t.push(l[2]);let on=pt[2],dn=$t[0].dims[$t[0].dims.length-1];on<8&&dn<8?i.compute(Ku($t,f,w,pt,_,g),{inputs:$t}):i.compute(Hl($t,f,w,pt,_,g),{inputs:$t});return}let ce=!0,fe=i.kernelCustomData.wT??i.compute(Ms(l[1],Ql),{inputs:[1],outputs:[f.wIsConst?-2:-1]})[0];f.wIsConst&&!i.kernelCustomData.wT&&(i.kernelCustomData.wT=fe);let le=[l[0],fe];y&&le.push(l[2]);let Te=_?C*X:J,Me=_?J:C*X,$e=K*W*F;i.compute(qp(le,f,w,Te,Me,$e,y,ce,g),{inputs:le})},nm=(i,l)=>{let f=l.format==="NHWC",g=[i.inputs[0].reshape(f?[i.inputs[0].dims[0],1,i.inputs[0].dims[1],i.inputs[0].dims[2]]:[i.inputs[0].dims[0],i.inputs[0].dims[1],1,i.inputs[0].dims[2]]),i.inputs[1].reshape([i.inputs[1].dims[0],i.inputs[1].dims[1],1,i.inputs[1].dims[2]])];i.inputs.length===3&&g.push(i.inputs[2]);let _=[0,l.pads[0],0,l.pads[1]],w=[1].concat(l.strides),y=[1].concat(l.dilations),S=[1].concat(l.kernelShape),L=Yl({...l,pads:_,strides:w,dilations:y,kernelShape:S},g);id(i,g,L,F=>f?[F[0],F[2],F[3]]:[F[0],F[1],F[3]])},od=(i,l,f)=>{let g=f.format==="NHWC"?"channelsLast":"channelsFirst",_=Yl(f,l),w=f.autoPad==="NOTSET"?f.pads:f.autoPad,y=Yp(l[0].dims,l[1].dims,f.strides,f.dilations,w,!1,g);i.compute(Xp(l,_,y.outShape,[y.filterDepth,y.filterHeight,y.filterWidth],[y.padInfo.front,y.padInfo.top,y.padInfo.left],g))},ad=(i,l)=>{if(rd(i.inputs,l),i.inputs[0].dims.length===3)nm(i,l);else if(i.inputs[0].dims.length===5)od(i,i.inputs,l);else{let f=Yl(l,i.inputs);id(i,i.inputs,f)}}}),ld,py=u(()=>{Kt(),Le(),zt(),cn(),ld=(i,l,f)=>{let g=i.length>2,_=l.outputShape,w=l.format==="NHWC",y=l.group,S=i[1].dims,L=S[2]/y,F=S[3],K=w?rn(L):1,W=w?rn(F):1,C=w?F===1?K:W:1,X=We.size(_)/W,J=[Math.ceil(X/64),1,1];Mn("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${J}`);let ne=["rank","rank"],ce=[l.strides[0],l.strides[1]],fe=[l.kernelShape[w?1:2],l.kernelShape[w?2:3]],le=[l.dilations[0],l.dilations[1]],Te=[fe[0]+(l.dilations[0]<=1?0:(l.kernelShape[w?1:2]-1)*(l.dilations[0]-1)),fe[1]+(l.dilations[1]<=1?0:(l.kernelShape[w?2:3]-1)*(l.dilations[1]-1))],Me=[Te[0]-1-Math.floor((l.pads[0]+l.pads[2])/2),Te[1]-1-Math.floor((l.pads[1]+l.pads[3])/2)],$e=[{type:12,data:X},{type:12,data:ce},{type:12,data:fe},{type:12,data:le},{type:12,data:Te},{type:6,data:Me},{type:12,data:L},{type:12,data:F},...Tt(i[0].dims,i[1].dims)];g&&($e.push(...Tt(i[2].dims)),ne.push("rank")),$e.push(...Tt(_));let ze=Ve=>{let st=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:ce.length},{name:"filter_dims",type:"u32",length:fe.length},{name:"dilations",type:"u32",length:fe.length},{name:"effective_filter_dims",type:"u32",length:Te.length},{name:"pads",type:"i32",length:Me.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],pt=On(i[0].dataType),$t=w?1:2,on=w?2:3,dn=w?3:1,Pt=et("W",i[1].dataType,i[1].dims.length,C),pn=et("Dy",i[0].dataType,i[0].dims.length,K),Lt=[pn,Pt];g&&Lt.push(et("bias",i[2].dataType,[_[dn]].length,W));let Bt=jt("result",i[0].dataType,_.length,W),Vn=()=>{let qt="";if(K===1)qt+=`
        let w_offset = ${Pt.indicesToOffset(`${Pt.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
        let wValue = ${Pt.getByOffset(`w_offset / ${C}`)};
        dotProd = dotProd + xValue * wValue;`;else if(F===1)qt+=`
          let wValue = ${Pt.getByOffset(`${Pt.indicesToOffset(`${Pt.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)} / ${C}`)};
          dotProd = dotProd + dot(xValue, wValue);`;else for(let Ln=0;Ln<K;Ln++)qt+=`
            let wValue${Ln} = ${Pt.getByOffset(`${Pt.indicesToOffset(`${Pt.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${Ln}, wOutChannel)`)} / ${C}`)};
            dotProd = dotProd + xValue[${Ln}] * wValue${Ln};`;return qt},nn=`
            let outputIndices = ${Bt.offsetToIndices(`global_idx * ${W}`)};
            let batch = ${Bt.indicesGet("outputIndices",0)};
            let d1 = ${Bt.indicesGet("outputIndices",dn)};
            let r = ${Bt.indicesGet("outputIndices",$t)};
            let c = ${Bt.indicesGet("outputIndices",on)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${Bt.type.value}(0.0);
            for (var wR: u32 = 0; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${pt}(dyRCorner) + ${pt}(wR)) / ${pt}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${pt}(uniforms.Dy_shape[${$t}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              wR = wR + uniforms.strides[0] - 1;
              let idyR: u32 = u32(dyR);

              for (var wC: u32 = 0; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${pt}(dyCCorner) + ${pt}(wC)) / ${pt}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${pt}(uniforms.Dy_shape[${on}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                wC = wC + uniforms.strides.y - 1;
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + ${K}) {
                  let xValue = ${w?pn.getByOffset(`${pn.indicesToOffset(`${pn.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${K}`):pn.get("batch","inputChannel","idyR","idyC")};
                  ${Vn()}
                  inputChannel = inputChannel + ${K};
                }
              }
            }
            let value = dotProd${g?` + bias[d1 / ${W}]`:""};
            ${Bt.setByOffset("global_idx","value")};
          `;return`
    ${Ve.registerUniforms(st).declareVariables(...Lt,Bt)}
      ${Ve.mainStart()}
      ${Ve.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${nn}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${l.cacheKey};${K}${C}${W}${F===1}`,inputDependencies:ne},getRunData:()=>({dispatchGroup:{x:J[0],y:J[1],z:J[2]},outputs:[{dims:f?f(_):_,dataType:i[0].dataType}],programUniforms:$e}),getShaderSource:ze}}}),rm,cd,sm,ud,dd,im,hd,om,am,lm=u(()=>{py(),uo(),zi(),rm=(i,l,f,g,_,w)=>(i-1)*l+f+(g-1)*_+1-w,cd=(i,l,f,g,_)=>{let w=Math.floor(i/2);l==="SAME_UPPER"?(f[g]=w,f[_]=i-w):l==="SAME_LOWER"&&(f[g]=i-w,f[_]=w)},sm=(i,l,f,g,_,w,y,S,L,F)=>{let K=i.length-2,W=F.length===0;L.length<K&&L.push(...Array(K-L.length).fill(0));let C=i[0],X=l[S?3:1]*_;for(let J=0,ne=i.length-K-(S?1:0);J<K;++J,++ne){let ce=i[ne],fe=W?ce*y[J]:F[J],le=rm(ce,y[J],w[J],l[ne],f[J],fe);cd(le,g,w,J,J+K),W&&F.push(y[J]*(ce-1)+L[J]+(l[ne]-1)*f[J]+1-w[J]-w[J+K])}F.splice(0,0,C),F.splice(S?3:1,0,X)},ud=(i,l)=>{let f=i.kernelShape.slice();if(i.kernelShape.length===0||i.kernelShape.reduce((W,C)=>W*C,1)===0){f.length=0;for(let W=2;W<l[1].dims.length;++W)f.push(l[1].dims[W])}let g=i.format==="NHWC";f.splice(0,0,l[1].dims[0]),f.splice(g?3:1,0,l[1].dims[1]);let _=i.pads.slice(),w=i.outputShape.slice(),y=i.outputPadding.slice(),S=l[0].dims,L=i.dilations.slice();if(L.reduce((W,C)=>W+C,0)===0){let W=l[0].dims.length-2;L=new Array(W).fill(1)}let F=i.strides.slice();if(F.reduce((W,C)=>W+C,0)===0){let W=l[0].dims.length-2;F=new Array(W).fill(1)}sm(S,f,L,i.autoPad,i.group,_,F,g,y,w);let K=Object.assign({},i);return Object.assign(K,{kernelShape:f,pads:_,outputPadding:y,outputShape:w,dilations:L,strides:F}),K},dd=i=>{let l=Uu(i),f=i.format,g=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof i.autoPad>"u"?0:i.autoPad],_=i.dilations,w=i.group,y=i.kernelShape,S=i.pads,L=i.strides,F=i.wIsConst(),K=i.outputPadding,W=i.outputShape;return{autoPad:g,format:f,dilations:_,group:w,kernelShape:y,outputPadding:K,outputShape:W,pads:S,strides:L,wIsConst:F,...l,cacheKey:`${i.format};${l.activation};`}},im=(i,l)=>{if(!i||i.length!==2&&i.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(i[0].dims.length!==4&&i[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(i[0].dims.length!==i[1].dims.length)throw new Error("filter does not have same dimension as input");let f=i[0].dims[l.format==="NHWC"?i[0].dims.length-1:1],g=i[1].dims[0];if(f!==g)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let _=i[1].dims[1]*l.group;if(i.length===3&&(i[2].dims.length!==1||i[2].dims[0]!==_))throw new Error("invalid bias");let w=i[0].dims.length-2;if(l.dilations.reduce((y,S)=>y+S,0)>0&&l.dilations.length!==w)throw new Error(`dilations should be ${w}D`);if(l.strides.reduce((y,S)=>y+S,0)>0&&l.strides.length!==w)throw new Error(`strides should be ${w}D`);if(l.pads.reduce((y,S)=>y+S,0)>0&&l.pads.length!==w*2)throw new Error(`pads should be ${w*2}D`);if(l.outputPadding.length!==w&&l.outputPadding.length!==0)throw new Error(`output_padding should be ${w}D`);if(l.kernelShape.reduce((y,S)=>y+S,0)>0&&l.kernelShape.length!==0&&l.kernelShape.length!==i[1].dims.length-2)throw new Error("invalid kernel shape");if(l.outputShape.length!==0&&l.outputShape.length!==i[0].dims.length-2)throw new Error("invalid output shape")},hd=(i,l,f,g)=>{let _=i.kernelCustomData.wT??i.compute(Ms(l[1],[2,3,0,1]),{inputs:[1],outputs:[f.wIsConst?-2:-1]})[0];f.wIsConst&&!i.kernelCustomData.wT&&(i.kernelCustomData.wT=_);let w=[l[0],_];l.length===3&&w.push(l[2]),i.compute(ld(w,f,g),{inputs:w})},om=(i,l)=>{let f=l.format==="NHWC",g=[i.inputs[0].reshape(f?[i.inputs[0].dims[0],1,i.inputs[0].dims[1],i.inputs[0].dims[2]]:[i.inputs[0].dims[0],i.inputs[0].dims[1],1,i.inputs[0].dims[2]]),i.inputs[1].reshape([i.inputs[1].dims[0],i.inputs[1].dims[1],1,i.inputs[1].dims[2]])];i.inputs.length===3&&g.push(i.inputs[2]);let _=l.kernelShape;(_.length===0||_[0]===0)&&(_=[i.inputs[1].dims[2]]);let w=l.dilations;(w.length===0||w[0]===0)&&(w=[1]);let y=l.strides;(y.length===0||y[0]===0)&&(y=[1]);let S=l.pads;S.length===0&&(S=[0,0]),S=[0,S[0],0,S[1]],y=[1].concat(y),w=[1].concat(w),_=[1].concat(_);let L=ud({...l,pads:S,strides:y,dilations:w,kernelShape:_},g);hd(i,g,L,F=>f?[F[0],F[2],F[3]]:[F[0],F[1],F[3]])},am=(i,l)=>{if(im(i.inputs,l),i.inputs[0].dims.length===3)om(i,l);else{let f=ud(l,i.inputs);hd(i,i.inputs,f)}}}),cm,um,dm,my=u(()=>{Kt(),zt(),gn(),cn(),cm=(i,l,f,g)=>{let _=We.size(l),w=l.length,y=et("input",i,w),S=jt("output",i,w),L=f.dataType===6?f.getInt32Array()[0]:Number(f.getBigInt64Array()[0]),F=We.normalizeAxis(L,w),K=W=>{let C=` i32(${y.indicesGet("inputIndices","uniforms.axis")}) `,X=Ft("uniforms.input_shape","uniforms.axis",w),J=g.reverse?C+(g.exclusive?" + 1":""):"0",ne=g.reverse?X:C+(g.exclusive?"":" + 1");return`
                ${W.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(y,S)}
                ${W.mainStart()}
                  ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${S.offsetToIndices("global_idx")};
                  var sum = ${S.type.value}(0);
                  let first : i32 = ${J};
                  let last : i32 = ${ne};
                  for (var i : i32 = first; i < last; i++) {
                    ${y.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${y.getByIndices("inputIndices")};
                  }
                  ${S.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:g.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:l,dataType:i}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:[{type:12,data:_},{type:12,data:F},...Tt(l,l)]}),getShaderSource:K}},um=(i,l)=>{let f=i.inputs[0].dims,g=i.inputs[0].dataType,_=i.inputs[1];i.compute(cm(g,f,_,l),{inputs:[0]})},dm=i=>{let l=i.exclusive===1,f=i.reverse===1;return Ht({exclusive:l,reverse:f})}}),hm,fm,fd,pm,mm,gm=u(()=>{Kt(),zt(),gn(),cn(),hm=i=>{if(!i||i.length!==1)throw new Error("DepthToSpace requires 1 input.");if(i[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},fm=(i,l,f,g)=>{let _=[];_.push(`fn perm(i: ${g.type.indices}) -> ${f.type.indices} {
    var a: ${f.type.indices};`);for(let w=0;w<l;++w)_.push(f.indicesSet("a",i[w],`i[${w}]`));return _.push("return a;}"),_.join(`
`)},fd=(i,l)=>{let f,g,_,w,y,S,L=l.format==="NHWC",F=l.blocksize,K=l.mode==="DCR";L?([f,g,_,w]=i.dims,y=K?[f,g,_,F,F,w/F**2]:[f,g,_,w/F**2,F,F],S=K?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([f,g,_,w]=[i.dims[0],i.dims[2],i.dims[3],i.dims[1]],y=K?[f,F,F,w/F**2,g,_]:[f,w/F**2,F,F,g,_],S=K?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let W=i.reshape(y),C=W.dims.length,X=i.dataType,J=et("a",X,C),ne=jt("output",X,C),ce=fe=>`
  ${fe.registerUniform("output_size","u32").declareVariables(J,ne)}

  ${fm(S,C,J,ne)}

  ${fe.mainStart()}
    ${fe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${ne.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${ne.setByOffset("global_idx",J.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${i.dims};${l.blocksize};${l.mode}`,inputDependencies:["rank"]},getRunData:fe=>{let le=L?[f,g*F,_*F,w/F**2]:[f,w/F**2,g*F,_*F],Te=We.size(le),Me=W.dims,$e=We.sortBasedOnPerm(Me,S);return{outputs:[{dims:le,dataType:fe[0].dataType}],dispatchGroup:{x:Math.ceil(Te/64)},programUniforms:[{type:12,data:Te},...Tt(Me,$e)]}},getShaderSource:ce}},pm=(i,l)=>{hm(i.inputs),i.compute(fd(i.inputs[0],l))},mm=i=>Ht({blocksize:i.blocksize,mode:i.mode,format:i.format})}),Xl,Ia,_i,_m,ym,vm,wm,Jl,bm,xm,Mm,gy=u(()=>{Kt(),zt(),gn(),cn(),Xl="[a-zA-Z]|\\.\\.\\.",Ia="("+Xl+")+",_i="^"+Ia+"$",_m="("+Ia+",)*"+Ia,ym="^"+_m+"$",vm=class{constructor(i=-1){this.symbolToIndices=new Map,this.inputIndex=i}addSymbol(i,l){let f=this.symbolToIndices.get(i);f===void 0?f=[l]:f.push(l),this.symbolToIndices.set(i,f)}},wm=class{constructor(i,l){var _;this.equation=l,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[f,g]=l.includes("->")?l.split("->",2):[l,""];if(!f.match(RegExp(ym)))throw new Error("Invalid LHS term");if(f.split(",").forEach((w,y)=>{let S=i[y].dims.slice();if(!w.match(RegExp(_i)))throw new Error("Invalid LHS term");let L=this.processTerm(w,!0,S,y);this.lhs.push(L)}),g==="")g+=[...this.symbolToInfo.entries()].filter(([w,y])=>y.count===1||w==="...").map(([w])=>w).join("");else if(!g.match(RegExp(Ia)))throw new Error("Invalid RHS");(_=g.match(RegExp(Xl,"g")))==null||_.forEach(w=>{if(w==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let y=this.symbolToInfo.get(w);if(y===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(y.dimValue)}}),this.rhs=this.processTerm(g,!1,this.outputDims)}addSymbol(i,l,f){let g=this.symbolToInfo.get(i);if(g!==void 0){if(g.dimValue!==l&&g.count!==1)throw new Error("Dimension mismatch");g.count++,g.inputIndices.push(f)}else g={count:1,dimValue:l,inputIndices:[f]};this.symbolToInfo.set(i,g)}processTerm(i,l,f,g=-1){let _=f.length,w=!1,y=[],S=0;if(!i.match(RegExp(_i))&&!l&&i!=="")throw new Error("Invalid LHS term");let L=i.match(RegExp(Xl,"g")),F=new vm(g);return L==null||L.forEach((K,W)=>{if(K==="..."){if(w)throw new Error("Only one ellipsis is allowed per input term");w=!0;let C=_-L.length+1;if(C<0)throw new Error("Ellipsis out of bounds");if(y=f.slice(S,S+C),this.hasEllipsis){if(this.ellipsisDims.length!==y.length||this.ellipsisDims.toString()!==y.toString())throw new Error("Ellipsis dimensions mismatch")}else if(l)this.hasEllipsis=!0,this.ellipsisDims=y;else throw new Error("Ellipsis must be specified in the LHS");for(let X=0;X<y.length;X++){let J=String.fromCharCode(48+X);F.addSymbol(J,W+X),this.addSymbol(J,f[S++],g)}}else F.addSymbol(K,W+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(K,f[S++],g)}),F}},Jl=i=>i+"_max",bm=(i,l,f,g)=>{let _=i.map(F=>F.length).map((F,K)=>et(`input${K}`,l,F)),w=We.size(g),y=jt("output",l,g.length),S=[...f.symbolToInfo.keys()].filter(F=>!f.rhs.symbolToIndices.has(F)),L=F=>{let K=[],W="var prod = 1.0;",C="var sum = 0.0;",X="sum += prod;",J=[],ne=[],ce=[],fe=[],le=f.symbolToInfo.size===f.rhs.symbolToIndices.size;f.symbolToInfo.forEach((Me,$e)=>{var ze;if(f.rhs.symbolToIndices.has($e)){let Ve=(ze=f.rhs.symbolToIndices.get($e))==null?void 0:ze[0];Ve!==void 0&&f.lhs.forEach((st,pt)=>{if(Me.inputIndices.includes(pt)){let $t=st.symbolToIndices.get($e);if($t===void 0)throw new Error("Invalid symbol error");$t.forEach(on=>{K.push(`${_[pt].indicesSet(`input${pt}Indices`,on,y.indicesGet("outputIndices",Ve))}`)})}})}else f.lhs.forEach((Ve,st)=>{if(Me.inputIndices.includes(st)){let pt=Ve.symbolToIndices.get($e);if(pt===void 0)throw new Error("Invalid symbol error");pt.forEach($t=>{J.push(`${_[st].indicesSet(`input${st}Indices`,$t,`${$e}`)}`)}),fe.push(`prod *= ${_[st].getByIndices(`input${st}Indices`)};`)}}),ne.push(`for(var ${$e}: u32 = 0; ${$e} < uniforms.${Jl($e)}; ${$e}++) {`),ce.push("}")});let Te=le?[...K,`let sum = ${_.map((Me,$e)=>Me.getByIndices(`input${$e}Indices`)).join(" * ")};`]:[...K,C,...ne,...J,W,...fe,X,...ce];return`
            ${F.registerUniforms(S.map(Me=>({name:`${Jl(Me)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(..._,y)}

            ${F.mainStart()}
            ${F.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${y.offsetToIndices("global_idx")};
            ${_.map((Me,$e)=>`var input${$e}Indices: ${_[$e].type.indices};`).join(`
`)}
            ${Te.join(`
`)};
            ${y.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:f.equation,inputDependencies:i.map(()=>"rank")},getRunData:()=>{let F=S.filter(W=>f.symbolToInfo.has(W)).map(W=>{var C;return{type:12,data:((C=f.symbolToInfo.get(W))==null?void 0:C.dimValue)||0}});F.push({type:12,data:w});let K=i.map((W,C)=>[...Tt(W)]).reduce((W,C)=>W.concat(C),F);return K.push(...Tt(g)),{outputs:[{dims:g,dataType:l}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:K}},getShaderSource:L}},xm=(i,l)=>{let f=new wm(i.inputs,l.equation),g=f.outputDims,_=i.inputs.map((w,y)=>w.dims);i.compute(bm(_,i.inputs[0].dataType,f,g))},Mm=i=>{let l=i.equation.replace(/\s+/g,"");return Ht({equation:l})}}),Zl,pd,Tm,Em,Oa,_y=u(()=>{Kt(),zt(),cn(),Zl=i=>{if(!i||i.length!==2)throw new Error("Expand requires 2 input.");let l=i[0].dims,f=Array.from(i[1].getBigInt64Array(),Number),g=f.length<l.length?0:f.length-l.length,_=l.length<f.length?0:l.length-f.length;for(;g<f.length&&_<l.length;++g,++_)if(f[g]!==l[_]&&f[g]!==1&&l[_]!==1)throw new Error("Expand requires shape to be broadcastable to input")},pd=(i,l)=>{let f=i.length-l.length,g=[];for(let _=0;_<f;++_)g.push(i[_]);for(let _=0;_<l.length;++_)g.push(l[_]===1?i[_+f]:l[_]);return g},Tm=(i,l)=>i.length>l.length?pd(i,l):pd(l,i),Em=i=>{let l=i[0].dims,f=Array.from(i[1].getBigInt64Array(),Number),g=Tm(l,f),_=i[0].dataType,w=_===9||We.size(l)===1,y=_===9||l.length>0&&l[l.length-1]%4===0?4:1,S=w||g.length>0&&g[g.length-1]%4===0?4:1,L=Math.ceil(We.size(g)/S),F=W=>{let C=et("input",_,l.length,y),X=jt("output",_,g.length,S),J;if(_===9){let ne=(ce,fe,le="")=>`
          let outputIndices${fe} = ${X.offsetToIndices(`outputOffset + ${fe}u`)};
          let offset${fe} = ${C.broadcastedIndicesToOffset(`outputIndices${fe}`,X)};
          let index${fe} = offset${fe} / 4u;
          let component${fe} = offset${fe} % 4u;
          ${ce}[${fe}] = ${le}(${C.getByOffset(`index${fe}`)}[component${fe}]);
        `;J=`
        let outputOffset = global_idx * ${S};
        var data = vec4<u32>(0);
        ${ne("data",0,"u32")}
        ${ne("data",1,"u32")}
        ${ne("data",2,"u32")}
        ${ne("data",3,"u32")}
        ${X.setByOffset("global_idx","data")}
      }`}else J=`
        let outputIndices = ${X.offsetToIndices(`global_idx * ${S}`)};
        let inputOffset = ${C.broadcastedIndicesToOffset("outputIndices",X)};
        let data = ${X.type.value}(${C.getByOffset(`inputOffset / ${y}`)});
        ${X.setByOffset("global_idx","data")}
      }`;return`
    ${W.registerUniform("vec_size","u32").declareVariables(C,X)}
    ${W.mainStart()}
    ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${J}`},K=[{type:12,data:L},...Tt(l,g)];return{name:"Expand",shaderCache:{hint:`${g.length};${y}${S}`,inputDependencies:["rank"]},getShaderSource:F,getRunData:()=>({outputs:[{dims:g,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(L/64)},programUniforms:K})}},Oa=i=>{Zl(i.inputs),i.compute(Em(i.inputs),{inputs:[0]})}}),Pm,Sm,yy=u(()=>{Kt(),zt(),cn(),Ru(),Pm=i=>{let l=i[0].dataType,f=We.size(i[0].dims),g=We.size(i[1].dims),_=g%4===0,w=y=>{let S=et("x",l,[1],4),L=et("bias",l,[1],4),F=jt("y",l,[1],4),K=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],W=X=>`
      let bias${X}_offset: u32 = (global_idx * 4 + ${X}) % uniforms.bias_size;
      let bias${X} = ${L.getByOffset(`bias${X}_offset / 4`)}[bias${X}_offset % 4];`,C=_?`
      let bias = ${L.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${W(0)}${W(1)}${W(2)}${W(3)}
      let bias = ${S.type.value}(bias0, bias1, bias2, bias3);`;return`${y.registerUniforms(K).declareVariables(S,L,F)}

    ${Wl(nr(l))}

    ${y.mainStart(ts)}
      ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${S.getByOffset("global_idx")};
      ${C}
      let x_in = x + bias;
      ${F.setByOffset("global_idx",Lu("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${_}`,inputDependencies:["type","type"]},getShaderSource:w,getRunData:y=>({outputs:[{dims:y[0].dims,dataType:y[0].dataType}],programUniforms:[{type:12,data:Math.ceil(f/4)},{type:12,data:g}],dispatchGroup:{x:Math.ceil(f/ts/4)}})}},Sm=i=>{i.inputs.length<2||We.size(i.inputs[1].dims)===0?Tp(i):i.compute(Pm(i.inputs))}}),ec,Cm,km,Am,D1=u(()=>{Kt(),zt(),gn(),cn(),ec=i=>{if(!i||i.length!==2)throw new Error("Gather requires 2 inputs.")},Cm=(i,l)=>{let f=i[0].dims,g=i[1].dims,_=f.length,w=We.normalizeAxis(l.axis,_),y=f.slice(0);y.splice(w,1,...g);let S=f[w],L=i[0].dataType===9?4:1,F=Math.ceil(We.size(y)/L),K=[{type:12,data:F},{type:6,data:S},{type:12,data:w},...Tt(i[0].dims,i[1].dims,y)],W=C=>{let X=et("data",i[0].dataType,i[0].dims.length,L),J=et("inputIndices",i[1].dataType,i[1].dims.length),ne=jt("output",i[0].dataType,y.length,L),ce=le=>{let Te=g.length,Me=`var indicesIndices${le}  = ${J.type.indices}(0);`;for(let $e=0;$e<Te;$e++)Me+=`${Te>1?`indicesIndices${le}[${$e}]`:`indicesIndices${le}`} = ${y.length>1?`outputIndices${le}[uniforms.axis + ${$e}]`:`outputIndices${le}`};`;Me+=`
          var idx${le} = ${J.getByIndices(`indicesIndices${le}`)};
          if (idx${le} < 0) {
            idx${le} = idx${le} + uniforms.axisDimLimit;
          }
          var dataIndices${le} : ${X.type.indices};
        `;for(let $e=0,ze=0;$e<_;$e++)$e===w?(Me+=`${_>1?`dataIndices${le}[${$e}]`:`dataIndices${le}`} = u32(idx${le});`,ze+=Te):(Me+=`${_>1?`dataIndices${le}[${$e}]`:`dataIndices${le}`} = ${y.length>1?`outputIndices${le}[${ze}]`:`outputIndices${le}`};`,ze++);return Me},fe;if(i[0].dataType===9){let le=(Te,Me,$e="")=>`
          let outputIndices${Me} = ${ne.offsetToIndices(`outputOffset + ${Me}u`)};
          ${ce(Me)};
          let offset${Me} = ${X.indicesToOffset(`dataIndices${Me}`)};
          let index${Me} = offset${Me} / 4u;
          let component${Me} = offset${Me} % 4u;
          ${Te}[${Me}] = ${$e}(${X.getByOffset(`index${Me}`)}[component${Me}]);
        `;fe=`
        let outputOffset = global_idx * ${L};
        var value = vec4<u32>(0);
        ${le("value",0,"u32")}
        ${le("value",1,"u32")}
        ${le("value",2,"u32")}
        ${le("value",3,"u32")}
        ${ne.setByOffset("global_idx","value")}
      `}else fe=`
      let outputIndices = ${ne.offsetToIndices("global_idx")};
      ${ce("")};
      let value = ${X.getByIndices("dataIndices")};
      ${ne.setByOffset("global_idx","value")};
      `;return`
      ${C.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(X,J,ne)}
      ${C.mainStart()}
        ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${fe}
      }`};return{name:"Gather",shaderCache:{hint:l.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:y,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(F/64)},programUniforms:K}),getShaderSource:W}},km=i=>Ht({axis:i.axis}),Am=(i,l)=>{let f=i.inputs;ec(f),i.compute(Cm(i.inputs,l))}}),$m,Im,Om,Da=u(()=>{Kt(),zt(),cn(),$m=(i,l,f,g,_,w,y,S,L)=>{let F=[{type:12,data:w},{type:12,data:g},{type:12,data:_},{type:12,data:f},{type:12,data:y},{type:12,data:S},{type:12,data:L}],K=[w];F.push(...Tt(l.dims,K));let W=C=>{let X=et("indices_data",l.dataType,l.dims.length),J=jt("input_slice_offsets_data",12,1,1),ne=[X,J],ce=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:_.length},{name:"sizes_from_slice_dims_data",type:"u32",length:f.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${C.registerUniforms(ce).declareVariables(...ne)}
  ${C.mainStart()}
    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${_.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${f.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return i.compute({name:"computeSliceOffsets",shaderCache:{hint:`${_.length}_${f.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:K,dataType:i.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:F}),getShaderSource:W},{inputs:[l],outputs:[-1]})[0]},Im=(i,l)=>{let f=i.inputs,g=f[0].dims,_=f[0].dataType,w=f[1].dims,y=w[w.length-1],S=We.sizeToDimension(w,w.length-1),L=We.sizeFromDimension(g,l.batchDims+y),F=We.sizeToDimension(g,l.batchDims),K=We.sizeFromDimension(g,l.batchDims),W=S/F,C=new Array(y),X=L;for(let Me=0;Me<y;++Me)C[y-1-Me]=X,X*=g[l.batchDims+y-1-Me];let J=$m(i,f[1],C,l.batchDims,g,S,W,K,y),ne=l.batchDims+y;if(ne>g.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let ce=w.slice(0,-1).concat(g.slice(ne)),fe=We.size(ce),le=[{type:12,data:fe},{type:12,data:L},...Tt(f[0].dims,J.dims,ce)],Te=Me=>{let $e=et("data",f[0].dataType,f[0].dims.length),ze=et("slice_offsets",12,J.dims.length),Ve=jt("output",f[0].dataType,ce.length);return`
          ${Me.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables($e,ze,Ve)}
            ${Me.mainStart()}
            ${Me.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};i.compute({name:"GatherND",shaderCache:{hint:l.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:ce,dataType:_}],dispatchGroup:{x:Math.ceil(fe/64)},programUniforms:le}),getShaderSource:Te},{inputs:[f[0],J]})},Om=i=>({batchDims:i.batch_dims,cacheKey:""})}),Dm,Lm,Fm,Rm,vy=u(()=>{Kt(),zt(),gn(),cn(),Dm=(i,l)=>{if(i.length<3||i.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let f=We.normalizeAxis(l.quantizeAxis,i[0].dims.length),g=l.blockSize,_=i[0],w=i[2],y=i.length===4?i[3]:void 0;if(w.dims.length!==_.dims.length||!_.dims.map((S,L)=>L===f?Math.ceil(S/g)===w.dims[L]:S===w.dims[L]).reduce((S,L)=>S&&L,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(y){if(y.dataType!==_.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(y.dims.length!==w.dims.length||!y.dims.map((S,L)=>S===w.dims[L]).reduce((S,L)=>S&&L,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},Lm=(i,l)=>{let f=i[0].dims,g=i[1].dims,_=f.length,w=We.normalizeAxis(l.gatherAxis,_),y=We.normalizeAxis(l.quantizeAxis,_),S=f.slice(0);S.splice(w,1,...g);let L=We.size(S),F=i[2].dataType,K=i[0].dataType===22,W=[{type:12,data:L},{type:12,data:y},{type:12,data:w},{type:12,data:l.blockSize},...Tt(...i.map((X,J)=>X.dims),S)],C=X=>{let J=et("data",i[0].dataType,i[0].dims.length),ne=et("inputIndices",i[1].dataType,i[1].dims.length),ce=et("scales",i[2].dataType,i[2].dims.length),fe=i.length>3?et("zeroPoint",i[3].dataType,i[3].dims.length):void 0,le=jt("output",F,S.length),Te=[J,ne,ce];fe&&Te.push(fe);let Me=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${X.registerUniforms(Me).declareVariables(...Te,le)}
        ${X.mainStart()}
        let output_indices = ${le.offsetToIndices("global_idx")};
        var indices_indices = ${ne.type.indices}(0);
        ${g.length>1?`
          for (var i: u32 = 0; i < ${g.length}; i++) {
            let index = ${le.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${ne.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${le.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${J.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${le.indicesGet("output_indices","i")};
          ${J.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${ne.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${f[w]};
        }
        ${J.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${S.length}; i++) {
          let index = ${le.indicesGet("output_indices",`i + ${g.length} - 1`)};
          ${J.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${J.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${J.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${K?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${ce.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${ce.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${ce.getByIndices("scale_indices")};
        ${fe?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${fe.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${fe.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${K?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${nr(F)}(quantized_data - zero_point) * scale;
        ${le.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${l.cacheKey};${i.filter((X,J)=>J!==1).map(X=>X.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:i.length},(X,J)=>"rank")},getRunData:()=>({outputs:[{dims:S,dataType:F}],dispatchGroup:{x:Math.ceil(L/64)},programUniforms:W}),getShaderSource:C}},Fm=(i,l)=>{let f=i.inputs;Dm(f,l),i.compute(Lm(i.inputs,l))},Rm=i=>Ht({blockSize:i.blockSize,gatherAxis:i.gatherAxis,quantizeAxis:i.quantizeAxis})}),jm,Nm,tc,wy,by=u(()=>{Kt(),zt(),gn(),cn(),jm=i=>{if(!i||i.length!==2)throw new Error("GatherElements requires 2 inputs.");if(i[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(i[0].dims.length!==i[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Nm=(i,l)=>{let f=i[0].dims,g=i[0].dataType,_=f.length,w=i[1].dims,y=i[1].dataType,S=We.normalizeAxis(l.axis,_),L=f[S],F=w.slice(0),K=We.size(F),W=et("input",g,_),C=et("indicesInput",y,w.length),X=jt("output",g,F.length),J=[{type:12,data:K},{type:6,data:L},{type:12,data:S}];return J.push(...Tt(f,w,F)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:F,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(K/64)},programUniforms:J}),getShaderSource:ne=>`
      ${ne.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(W,C,X)}
      ${ne.mainStart()}
      ${ne.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${X.offsetToIndices("global_idx")};

      var idx = ${C.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${W.type.indices}(outputIndices);
      ${W.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${W.getByIndices("inputIndices")};

      ${X.setByOffset("global_idx","value")};
  }`}},tc=i=>Ht({axis:i.axis}),wy=(i,l)=>{let f=i.inputs;jm(f),i.compute(Nm(i.inputs,l))}}),zm,Bm,Vm,Um,Wm=u(()=>{Kt(),zt(),cn(),zm=i=>{if(!i)throw new Error("Input is missing");if(i.length<2||i.length>3)throw new Error("Invaid input number.");if(i.length===3&&i[2].dims.length>2)throw new Error("Invalid input shape of C");if(i[0].dataType!==i[1].dataType||i.length===3&&i[0].dataType!==i[2].dataType)throw new Error("Input types are mismatched")},Bm=(i,l)=>{let f=i[0].dims.slice(),g=i[1].dims.slice(),[_,w,y]=gi.getShapeOfGemmResult(f,l.transA,g,l.transB,i.length===3?i[2].dims:void 0),S=[_,w];if(!S)throw new Error("Can't use gemm on the given tensors");let L=16,F=Math.ceil(w/L),K=Math.ceil(_/L),W=!0,C=We.size(S),X=[{type:12,data:W?F:C},{type:12,data:_},{type:12,data:w},{type:12,data:y},{type:1,data:l.alpha},{type:1,data:l.beta}],J=["type","type"];i.length===3&&(X.push(...Tt(i[2].dims)),J.push("rank")),X.push(...Tt(S));let ne=fe=>{let le="";l.transA&&l.transB?le="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":l.transA&&!l.transB?le="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!l.transA&&l.transB?le="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!l.transA&&!l.transB&&(le="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let Te=l.alpha===1?"":"value *= uniforms.alpha;",Me=et("a",i[0].dataType,i[0].dims),$e=et("b",i[1].dataType,i[1].dims),ze=Me.type.value,Ve=null,st=[Me,$e];i.length===3&&(Ve=et("c",i[2].dataType,i[2].dims.length),st.push(Ve));let pt=jt("output",i[0].dataType,S.length);st.push(pt);let $t=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${fe.registerUniforms($t).declareVariables(...st)}

  ${fe.mainStart()}
    ${fe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${ze}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${le}
    }

    ${Te}
    ${Ve!=null?`let cOffset = ${Ve.broadcastedIndicesToOffset("vec2(m, n)",pt)}; value += ${ze}(uniforms.beta) * ${Ve.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},ce=fe=>{let le=et("a",i[0].dataType,i[0].dims),Te=et("b",i[1].dataType,i[1].dims),Me=null,$e=[le,Te];i.length===3&&(Me=et("c",i[2].dataType,i[2].dims.length),$e.push(Me));let ze=jt("output",i[0].dataType,S.length);$e.push(ze);let Ve=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],st="",pt="";l.transA&&l.transB?(pt=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${le.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${Te.type.value}(0);
      }
      `,st="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):l.transA&&!l.transB?(pt=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${le.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${Te.type.value}(0);
      }
      `,st="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!l.transA&&l.transB?(pt=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${le.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${Te.type.value}(0);
      }
      `,st="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!l.transA&&!l.transB&&(pt=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${le.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${Te.type.value}(0);
      }
      `,st="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let $t=l.alpha===1?"":"value *= uniforms.alpha;";return`
  ${fe.registerUniforms(Ve).declareVariables(...$e)}
  var<workgroup> tile_a: array<array<${le.type.storage}, ${L}>, ${L}>;
  var<workgroup> tile_b: array<array<${Te.type.storage}, ${L}>, ${L}>;
  ${fe.mainStart([L,L,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${L};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${L};
    let num_tiles = (uniforms.K - 1) / ${L} + 1;
    var k_start = 0u;
    var value = ${ze.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${pt}
      k_start = k_start + ${L};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${L}; k++) {
        ${st}
      }
      workgroupBarrier();
    }

    ${$t}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${Me!=null?`let cOffset = ${Me.broadcastedIndicesToOffset("vec2(m, n)",ze)}; value += ${ze.type.value}(uniforms.beta) * ${Me.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return W?{name:"GemmShared",shaderCache:{hint:`${l.cacheKey}`,inputDependencies:J},getRunData:()=>({outputs:[{dims:S,dataType:i[0].dataType}],dispatchGroup:{x:F*K},programUniforms:X}),getShaderSource:ce}:{name:"Gemm",shaderCache:{hint:`${l.cacheKey}`,inputDependencies:J},getRunData:()=>({outputs:[{dims:S,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:X}),getShaderSource:ne}},Vm=i=>{let l=i.transA,f=i.transB,g=i.alpha,_=i.beta;return{transA:l,transB:f,alpha:g,beta:_,cacheKey:`${i.transA};${i.transB};${i.alpha===1}`}},Um=(i,l)=>{zm(i.inputs),i.compute(Bm(i.inputs,l))}}),Xs,yi,Ui,ho,Gm,md,Km,Hm,nc,qm,Qm,Ym,Xm,gd,_d=u(()=>{Kt(),zt(),gn(),cn(),[Xs,yi,Ui,ho]=[0,1,2,3],Gm=i=>{if(i[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(i[0].dims.length!==i[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(i[0].dims.length-2!==i[1].dims[i[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${i[0].dims.length-2}`);if(i[0].dims[0]!==i[1].dims[0])throw new Error("grid batch size must match input batch size")},md=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,Km=i=>`
  fn gs_bicubic_interpolate(p: mat4x4<${i}>, x: f32, y: f32) -> ${i} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${i}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,Hm=i=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${i.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,nc=i=>`
  ${i.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,qm=(i,l,f)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${l} {
     var pixel = ${l}(0);
     var indices = vec4<u32>(0);
     indices[${Xs}] = batch;
     indices[${yi}] = channel;`+(()=>{switch(f.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Ui}] = u32(r);
            indices[${ho}] = u32(c);
          }
        `;case"border":return`
          indices[${Ui}] = u32(clamp(r, 0, H - 1));
          indices[${ho}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Ui}] = gs_reflect(r, border[1], border[3]);
          indices[${ho}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${f.paddingMode} is not supported`)}})()+`
    return ${i.getByIndices("indices")};
  }
`,Qm=(i,l,f)=>(()=>{switch(f.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${Xs}], indices[${yi}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${Xs}], indices[${yi}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${Xs}], indices[${yi}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${Xs}], indices[${yi}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${Xs}], indices[${yi}], border);

          let dx2 = ${l}(f32(x2) - x);
          let dx1 = ${l}(x - f32(x1));
          let dy2 = ${l}(f32(y2) - y);
          let dy1 = ${l}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${l}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${Xs}], indices[${yi}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${f.mode} is not supported`)}})()+`${i.setByOffset("global_idx","result")}`,Ym=(i,l)=>{let f=et("x",i[0].dataType,i[0].dims.length),g=[i[1].dims[0],i[1].dims[1],i[1].dims[2]],_=et("grid",i[1].dataType,g.length,2),w=[i[0].dims[0],i[0].dims[1],i[1].dims[1],i[1].dims[2]];l.format==="NHWC"&&(w=[i[0].dims[0],i[1].dims[1],i[1].dims[2],i[0].dims[3]],[Xs,yi,Ui,ho]=[0,3,1,2]);let y=jt("output",i[0].dataType,w.length),S=f.type.value,L=We.size(w),F=[{type:12,data:L},...Tt(i[0].dims,g,w)],K=W=>`
  ${W.registerUniform("output_size","u32").declareVariables(f,_,y)}
  ${md}
  ${Km(S)}
  ${Hm(l)}
  ${nc(l)}
  ${qm(f,S,l)}

  ${W.mainStart()}
    ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Ui}]);
      let W_in = i32(uniforms.x_shape[${ho}]);

      ${l.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${y.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${Xs}], indices[${Ui}], indices[${ho}]);
      let nxy = ${_.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${Qm(y,S,l)}
  }`;return{name:"GridSample",shaderCache:{hint:`${l.cacheKey}`,inputDependencies:["type","type"]},getRunData:W=>{let C=We.size(w);return{outputs:[{dims:w,dataType:W[0].dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:F}},getShaderSource:K}},Xm=(i,l)=>{Gm(i.inputs),i.compute(Ym(i.inputs,l))},gd=i=>Ht({alignCorners:i.align_corners,mode:i.mode,paddingMode:i.padding_mode,format:i.format})}),ns,Jm,Zm,rc,eg,La,yd,tg=u(()=>{Kt(),zt(),gn(),be(),vu(),cn(),zi(),ns=(i,l)=>i.length>l&&i[l].dims.length>0?i[l]:void 0,Jm=(i,l)=>{let f=i[0],g=ns(i,1),_=ns(i,2),w=ns(i,3),y=ns(i,4),S=ns(i,5),L=ns(i,6),F=ns(i,7);if(f.dims.length!==3&&f.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let K=f.dims[0],W=f.dims[1],C=f.dims.length===3?f.dims[2]:l.numHeads*f.dims[4],X=W,J=0,ne=0,ce=Math.floor(C/l.numHeads);if(L&&F&&We.size(L.dims)&&We.size(F.dims)){if(L.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(L.dims[0]!==K||L.dims[1]!==l.numHeads||L.dims[3]!==ce)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(F.dims[0]!==K||F.dims[1]!==l.numHeads||F.dims[3]!==ce)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(L.dims[2]!==F.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(F.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');J=L.dims[2],ne=L.dims[2]}else if(L&&We.size(L.dims)||F&&We.size(F.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let fe;if(g&&We.size(g.dims)>0){if(f.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(g.dims.length<3||g.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(f.dims[0]!==g.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(g.dims.length===3){if(g.dims[2]!==f.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');fe=2,X=g.dims[1]}else if(g.dims.length===5){if(g.dims[2]!==l.numHeads||g.dims[3]!==2||g.dims[4]!==ce)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(_)throw new Error('Expect "value" be none when "key" has packed kv format.');fe=5,X=g.dims[1]}else{if(g.dims[1]!==l.numHeads||g.dims[3]!==ce)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');fe=0,X=g.dims[2]}}else{if(f.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(f.dims[2]!==l.numHeads||f.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');fe=3}if(w&&We.size(w.dims)>0){if(w.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(g&&g.dims.length===5&&g.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let le=J+X,Te=0;if(y&&We.size(y.dims)>0){Te=8;let Ve=y.dims;throw Ve.length===1?Ve[0]===K?Te=1:Ve[0]===3*K+2&&(Te=3):Ve.length===2&&Ve[0]===K&&Ve[1]===le&&(Te=5),Te===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let Me=!1,$e=C;if(_&&We.size(_.dims)>0){if(_.dims.length!==3&&_.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(f.dims[0]!==_.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(_.dims.length===3){if(X!==_.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');$e=_.dims[2]}else{if(X!==_.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');$e=_.dims[1]*_.dims[3],Me=!0}}let ze=!1;if(y&&We.size(y.dims)>0)throw new Error("Key padding mask is not supported");if(S&&We.size(S.dims)>0){if(S.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(S.dims[0]!==K||S.dims[1]!==l.numHeads||S.dims[2]!==W||S.dims[3]!==le)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:K,sequenceLength:W,pastSequenceLength:J,kvSequenceLength:X,totalSequenceLength:le,maxSequenceLength:ne,inputHiddenSize:0,hiddenSize:C,vHiddenSize:$e,headSize:ce,vHeadSize:Math.floor($e/l.numHeads),numHeads:l.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:l.maskFilterValue,maskType:Te,scale:l.scale,broadcastResPosBias:ze,passPastInKv:Me,qkvFormat:fe}},Zm=i=>Ht({...i}),rc=Ht({perm:[0,2,1,3]}),eg=(i,l,f,g,_,w,y)=>{let S=[g,_,w],L=We.size(S),F=[{type:12,data:L},{type:12,data:y},{type:12,data:w}],K=W=>{let C=jt("qkv_with_bias",l.dataType,S),X=et("qkv",l.dataType,S),J=et("bias",f.dataType,S),ne=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${W.registerUniforms(ne).declareVariables(X,J,C)}
  ${W.mainStart()}
    ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return i.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:S,dataType:l.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(L/64)},programUniforms:F}),getShaderSource:K},{inputs:[l,f],outputs:[-1]})[0]},La=(i,l,f,g,_,w,y,S)=>{let L=w;if(y&&We.size(y.dims)>0){if(g===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return L=eg(i,w,y,l,g,f*_,S),L=L.reshape([l,g,f,_]),f===1||g===1?L:i.compute(Ms(L,rc.perm),{inputs:[L],outputs:[-1]})[0]}else return w.dims.length===3&&(L=w.reshape([l,g,f,_])),f===1||g===1?L:i.compute(Ms(L,rc.perm),{inputs:[L],outputs:[-1]})[0]},yd=(i,l)=>{let f=Jm(i.inputs,l),g=i.inputs[0],_=ns(i.inputs,1),w=ns(i.inputs,2),y=ns(i.inputs,3),S=ns(i.inputs,4),L=ns(i.inputs,5),F=ns(i.inputs,6),K=ns(i.inputs,7);if(g.dims.length===5)throw new Error("Packed QKV is not implemented");if((_==null?void 0:_.dims.length)===5)throw new Error("Packed KV is not implemented");let W=_&&w&&_.dims.length===4&&w.dims.length===4,C=La(i,f.batchSize,f.numHeads,f.sequenceLength,f.headSize,g,y,0);if(W)return ka(i,C,_,w,S,void 0,F,K,L,f);if(!_||!w)throw new Error("key and value must be provided");let X=La(i,f.batchSize,f.numHeads,f.kvSequenceLength,f.headSize,_,y,f.hiddenSize),J=La(i,f.batchSize,f.numHeads,f.kvSequenceLength,f.vHeadSize,w,y,2*f.hiddenSize);ka(i,C,X,J,S,void 0,F,K,L,f)}}),ng,vd,xy,My,sc,wd,rg,sg=u(()=>{Kt(),zt(),gn(),cn(),ng=i=>{if(!i||i.length<1)throw new Error("too few inputs")},vd=(i,l)=>{let f=[],g=l.numOutputs;return i[1].dims[0]>0&&(i[1].getBigInt64Array().forEach(_=>f.push(Number(_))),g=f.length),Ht({numOutputs:g,axis:l.axis,splitSizes:f})},xy=i=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${i}u; i += 1u ) {
    if (index < ${Ft("uniforms.size_in_split_axis","i",i)}) {
        return i;
    }
    }
    return ${i}u;
}`,My=i=>{let l=i.length,f=[];for(let g=0;g<l;++g){let _=i[g].setByIndices("indices","input[global_idx]");l===1?f.push(_):g===0?f.push(`if (output_number == ${g}u) { ${_} }`):g===l-1?f.push(`else { ${_} }`):f.push(`else if (output_number == ${g}) { ${_} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${i[0].type.indices}, global_idx: u32) {
        ${f.join(`
`)}
      }`},sc=(i,l)=>{let f=i[0].dims,g=We.size(f),_=i[0].dataType,w=We.normalizeAxis(l.axis,f.length),y=new Array(l.numOutputs),S=et("input",_,f.length),L=new Array(l.numOutputs),F=[],K=[],W=0,C=[{type:12,data:g}];for(let J=0;J<l.numOutputs;J++){W+=l.splitSizes[J],L[J]=W;let ne=f.slice();ne[w]=l.splitSizes[J],K.push(ne),y[J]=jt(`output${J}`,_,ne.length),F.push({dims:K[J],dataType:i[0].dataType})}C.push({type:12,data:L},...Tt(f,...K));let X=J=>`
  ${J.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",L.length).declareVariables(S,...y)}
  ${xy(L.length)}
  ${My(y)}

  ${J.mainStart()}
    ${J.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${S.offsetToIndices("global_idx")};
    var index = ${S.indicesGet("indices",w)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Ft("uniforms.size_in_split_axis","output_number - 1u",L.length)};
      ${S.indicesSet("indices",w,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:l.cacheKey,inputDependencies:["rank"]},getShaderSource:X,getRunData:()=>({outputs:F,dispatchGroup:{x:Math.ceil(g/64)},programUniforms:C})}},wd=(i,l)=>{ng(i.inputs);let f=i.inputs.length===1?l:vd(i.inputs,l);i.compute(sc(i.inputs,f),{inputs:[0]})},rg=i=>{let l=i.axis,f=i.splitSizes,g=i.numOutputs<0?f.length:i.numOutputs;if(g!==f.length)throw new Error("numOutputs and splitSizes lengh must be equal");return Ht({axis:l,numOutputs:g,splitSizes:f})}}),bd,ig,xd,Md,Ty=u(()=>{gn(),vu(),tg(),sg(),zi(),bd=(i,l)=>{if(l.doRotary)throw new Error("GroupQuerryAttention do_rotary attribute is not supported");if(l.doRotary&&i.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let f=i[0],g=i[1],_=i[2],w=i[3],y=i[4];if(l.localWindowSize!==-1)throw new Error("Local attention is not supported");if(l.softcap!==0)throw new Error("Softcap is not supported");if(l.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(l.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(f.dims.length!==3&&f.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let S=!1,L=f.dims[0],F=f.dims[1],K=f.dims.length===3?S?f.dims[2]/3:f.dims[2]:l.numHeads*f.dims[4],W=F,C=0,X=!g||g.dims.length===0,J=Math.floor(X?K/(l.numHeads+2*l.kvNumHeads):K/l.numHeads);X&&(K=J*l.numHeads);let ne=w&&w.dims.length!==0,ce=y&&y.dims.length!==0;if(ne&&w.dims.length===4&&w.dims[0]===L&&w.dims[1]!==l.kvNumHeads&&w.dims[2]===l.kvNumHeads&&w.dims[3]===J)throw new Error("BSNH pastKey/pastValue is not supported");if(ne&&ce){if(w.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(y.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');C=w.dims[2]}else if(ne||ce)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let fe=1;if(g&&g.dims.length>0){if(f.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(g.dims.length<3||g.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(f.dims[0]!==g.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(g.dims.length===3){if(f.dims[2]%g.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');W=g.dims[1]}else if(g.dims.length===5){if(g.dims[2]!==l.numHeads||g.dims[3]!==2||g.dims[4]!==J)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(_)throw new Error('Expect "value" be none when "key" has packed kv format.');W=g.dims[1]}else{if(g.dims[1]!==l.numHeads||g.dims[3]!==J)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');W=g.dims[2]}}else{if(f.dims.length!==3&&f.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(f.dims.length===5&&(f.dims[2]!==l.numHeads||f.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');fe=3}let le=0,Te=!1,Me=l.kvNumHeads?J*l.kvNumHeads:K;if(_&&_.dims.length>0){if(_.dims.length!==3&&_.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(f.dims[0]!==_.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(_.dims.length===3){if(W!==_.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');Me=_.dims[2]}else{if(W!==_.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');Me=_.dims[1]*_.dims[3],Te=!0}}let $e=i.length>4?i[5]:void 0;if($e&&$e.dims.length!==1&&$e.dims[0]!==L)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:L,sequenceLength:F,pastSequenceLength:C,kvSequenceLength:W,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:K,vHiddenSize:Me,headSize:J,vHeadSize:Math.floor(Me/l.kvNumHeads),numHeads:l.numHeads,kvNumHeads:l.kvNumHeads,nReps:l.numHeads/l.kvNumHeads,pastPresentShareBuffer:!1,maskType:le,scale:l.scale,broadcastResPosBias:!1,passPastInKv:Te,qkvFormat:fe}},ig=Ht({perm:[0,2,1,3]}),xd=(i,l,f)=>{let g=l,_=f.kvNumHeads;return l.dims.length===3&&f.kvSequenceLength!==0&&(g=l.reshape([f.batchSize,f.kvSequenceLength,_,f.headSize]),g=i.compute(Ms(g,ig.perm),{inputs:[g],outputs:[-1]})[0]),g},Md=(i,l)=>{var ce;let f=bd(i.inputs,l);if(i.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((ce=i.inputs[1])==null?void 0:ce.dims.length)===5)throw new Error("Packed KV is not implemented");let g=i.inputs[0],_=i.inputs[1]&&i.inputs[1].dims.length>0?i.inputs[1]:void 0,w=i.inputs[2]&&i.inputs[2].dims.length>0?i.inputs[2]:void 0,y=i.inputs[3]&&i.inputs[3].dims.length!==0?i.inputs[3]:void 0,S=i.inputs[4]&&i.inputs[4].dims.length!==0?i.inputs[4]:void 0,L=i.inputs.length>4?i.inputs[5]:void 0,F=i.inputs.length>5?i.inputs[6]:void 0,K=f.kvNumHeads?f.kvNumHeads:f.numHeads,W=Ht({axis:2,numOutputs:3,splitSizes:[f.numHeads*f.headSize,K*f.headSize,K*f.headSize]}),[C,X,J]=!_&&!w?i.compute(sc([g],W),{inputs:[g],outputs:[-1,-1,-1]}):[g,_,w],ne=La(i,f.batchSize,f.numHeads,f.sequenceLength,f.headSize,C,void 0,0);ka(i,ne,xd(i,X,f),xd(i,J,f),void 0,void 0,y,S,void 0,f,L,F)}}),Td,Ed,og,ag,Ey=u(()=>{Kt(),zt(),zi(),cn(),Td=(i,l,f,g,_,w,y,S)=>{let L=rn(w),F=L===1?"f32":`vec${L}f`,K=L===1?"vec2f":`mat2x${L}f`,W=_*y,C=64;W===1&&(C=256);let X=[_,y,w/L],J=[_,y,2],ne=["rank","type","type"],ce=[];ce.push(...Tt(X,J));let fe=le=>{let Te=et("x",l.dataType,3,L),Me=et("scale",f.dataType,f.dims),$e=et("bias",g.dataType,g.dims),ze=jt("output",1,3,2),Ve=[Te,Me,$e,ze];return`
  var<workgroup> workgroup_shared : array<${K}, ${C}>;
  const workgroup_size = ${C}u;
  ${le.declareVariables(...Ve)}
  ${le.mainStart(C)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${F}(0);
    var squared_sum = ${F}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${F}(${Te.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${K}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${Cr("workgroup_shared[0][0]",L)} / f32(hight * ${L});
      let squared_sum_final = ${Cr("workgroup_shared[0][1]",L)} / f32(hight * ${L});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${S}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return i.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${L};${S};${C}`,inputDependencies:ne},getRunData:()=>({outputs:[{dims:J,dataType:1}],dispatchGroup:{x:W},programUniforms:ce}),getShaderSource:fe},{inputs:[l,f,g],outputs:[-1]})[0]},Ed=(i,l,f)=>{let g=l[0].dims,_=g,w=2,y=g[0],S=g[1],L=We.sizeFromDimension(g,w),F=rn(L),K=We.size(_)/F,W=Td(i,l[0],l[1],l[2],y,L,S,f.epsilon),C=[y,S,L/F],X=[y,S],J=["type","none"],ne=ce=>{let fe=et("x",l[0].dataType,C.length,F),le=et("scale_shift",1,X.length,2),Te=jt("output",l[0].dataType,C.length,F),Me=[fe,le,Te];return`
  ${ce.registerUniform("output_size","u32").declareVariables(...Me)}
  ${ce.mainStart()}
  ${ce.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${Te.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${le.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${fe.getByOffset("global_idx")} * ${Te.type.value}(scale_shift.x) + ${Te.type.value}(scale_shift.y);
      ${Te.setByOffset("global_idx","value")};
  }`};i.compute({name:"InstanceNormalization",shaderCache:{hint:`${F}`,inputDependencies:J},getRunData:()=>({outputs:[{dims:_,dataType:l[0].dataType}],dispatchGroup:{x:Math.ceil(K/64)},programUniforms:[{type:12,data:K},...Tt(C,X,C)]}),getShaderSource:ne},{inputs:[l[0],W]})},og=(i,l,f)=>{let g=l[0].dims,_=g,w=g[0],y=g[g.length-1],S=We.sizeFromDimension(g,1)/y,L=rn(y),F=We.size(_)/L,K=[{type:12,data:S},{type:12,data:Math.floor(y/L)}],W=["type","type"],C=!1,X=[0,g.length-1];for(let fe=0;fe<g.length-2;fe++)C=C||g[fe+1]!==1,X.push(fe+1);C=C&&g[g.length-1]!==1;let J=C?i.compute(Ms(i.inputs[0],X),{inputs:[i.inputs[0]],outputs:[-1]})[0]:i.inputs[0].reshape(Array.from({length:g.length},(fe,le)=>g[X[le]])),ne=Td(i,J,l[1],l[2],w,S,y,f.epsilon),ce=fe=>{let le=On(l[0].dataType),Te=L===1?"vec2f":`mat${L}x2f`,Me=Ve=>{let st=Ve===0?"x":"y",pt=L===1?"f32":`vec${L}f`;switch(L){case 1:return`${le}(${pt}(scale.${st}))`;case 2:return`vec2<${le}>(${pt}(scale[0].${st}, scale[1].${st}))`;case 4:return`vec4<${le}>(${pt}(scale[0].${st}, scale[1].${st}, scale[2].${st}, scale[3].${st}))`;default:throw new Error(`Not supported compoents ${L}`)}},$e=et("input",l[0].dataType,l[0].dims,L),ze=jt("output",l[0].dataType,_,L);return`
  @group(0) @binding(0) var<storage, read> input : array<${$e.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${Te}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${ze.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${fe.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${Me(0)}, ${Me(1)});
  }`};i.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${L}`,inputDependencies:W},getRunData:()=>({outputs:[{dims:_,dataType:l[0].dataType}],dispatchGroup:{x:Math.ceil(F/64)},programUniforms:K}),getShaderSource:ce},{inputs:[l[0],ne]})},ag=(i,l)=>{l.format==="NHWC"?og(i,i.inputs,l):Ed(i,i.inputs,l)}}),lg,cg,ug,Py=u(()=>{Kt(),zt(),cn(),lg=i=>{if(!i||i.length<2)throw new Error("layerNorm requires at least 2 inputs.")},cg=(i,l,f)=>{let g=l.simplified,_=i[0].dims,w=i[1],y=!g&&i[2],S=_,L=We.normalizeAxis(l.axis,_.length),F=We.sizeToDimension(_,L),K=We.sizeFromDimension(_,L),W=We.size(w.dims),C=y?We.size(y.dims):0;if(W!==K||y&&C!==K)throw new Error(`Size of X.shape()[axis:] == ${K}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${W} and bias size of ${C}`);let X=[];for(let $e=0;$e<_.length;++$e)$e<L?X.push(_[$e]):X.push(1);let J=rn(K),ne=["type","type"],ce=[{type:12,data:F},{type:1,data:K},{type:12,data:Math.floor(K/J)},{type:1,data:l.epsilon}];y&&ne.push("type");let fe=f>1,le=f>2,Te=$e=>{let ze=On(i[0].dataType),Ve=[et("x",i[0].dataType,i[0].dims,J),et("scale",w.dataType,w.dims,J)];y&&Ve.push(et("bias",y.dataType,y.dims,J)),Ve.push(jt("output",i[0].dataType,S,J)),fe&&Ve.push(jt("mean_data_output",1,X)),le&&Ve.push(jt("inv_std_output",1,X));let st=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${$e.registerUniforms(st).declareVariables(...Ve)}
  ${$e.mainStart()}
    ${$e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${pr("f32",J)};
    var mean_square_vector = ${pr("f32",J)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${rr(ze,J,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Cr("mean_vector",J)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Cr("mean_square_vector",J)} / uniforms.norm_size ${g?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${rr(ze,J,"x[j + offset]")};
      let f32scale = ${rr(ze,J,"scale[j]")};
      output[j + offset] = ${Ve[0].type.value}((f32input ${g?"":"- mean"}) * inv_std_dev * f32scale
        ${y?`+ ${rr(ze,J,"bias[j]")}`:""}
      );
    }

    ${fe?"mean_data_output[global_idx] = mean":""};
    ${le?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},Me=[{dims:S,dataType:i[0].dataType}];return fe&&Me.push({dims:X,dataType:1}),le&&Me.push({dims:X,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${J};${f};${g}`,inputDependencies:ne},getRunData:()=>({outputs:Me,dispatchGroup:{x:Math.ceil(F/64)},programUniforms:ce}),getShaderSource:Te}},ug=(i,l)=>{lg(i.inputs),i.compute(cg(i.inputs,l,i.outputCount))}}),dg,hg,fg=u(()=>{zt(),Hu(),Ju(),dg=i=>{if(!i||i.length!==2)throw new Error("MatMul requires 2 inputs.");if(i[0].dims[i[0].dims.length-1]!==i[1].dims[i[1].dims.length-2])throw new Error("shared dimension does not match.")},hg=i=>{dg(i.inputs);let l=Sr.calcShape(i.inputs[0].dims,i.inputs[1].dims,!0);if(!l)throw new Error("Can't use matmul on the given tensors");let f=l[l.length-1],g=i.inputs[0].dims[i.inputs[0].dims.length-1];if(f<8&&g<8)i.compute(Ku(i.inputs,{activation:""},l));else{let _=l[l.length-2],w=We.size(i.inputs[0].dims.slice(0,-2)),y=We.size(i.inputs[1].dims.slice(0,-2));if(w!==1&&_===1&&y===1){let S=i.inputs[0].reshape([1,w,g]),L=i.inputs[1].reshape([1,g,f]),F=[1,w,f],K=[S,L];i.compute(Hl(K,{activation:""},l,F),{inputs:K})}else i.compute(Hl(i.inputs,{activation:""},l))}}}),pg,mg,Pd,gg,_g,jn=u(()=>{Kt(),zt(),gn(),cn(),pg=(i,l)=>{if(i.length<3||i.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let f=i[0],g=f.dims.length;if(f.dims[g-1]!==l.k)throw new Error("The last dim of input shape does not match the k value");let _=Math.floor((l.k+l.blockSize-1)/l.blockSize),w=l.blockSize/8*l.bits,y=i[1];if(!We.areEqual(y.dims,[l.n,_,w]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let S=i[2].dims;if(We.size(S)!==l.n*_)throw new Error("scales input size error.");if(i.length===4){let L=i[3].dims,F=l.bits>4?l.n*_:l.n*Math.floor((_+1)/2);if(We.size(L)!==F)throw new Error("zeroPoints input size error.")}},mg=(i,l)=>{let f=i[0].dims,g=f.length,_=f[g-2],w=l.k,y=l.n,S=f.slice(0,g-2),L=We.size(S),F=i[1].dims[2]/4,K=i[0].dataType,W=rn(l.k),C=rn(F),X=rn(y),J=S.concat([_,y]),ne=_>1&&y/X%2===0?2:1,ce=We.size(J)/X/ne,fe=64,le=[],Te=[L,_,w/W],Me=We.convertShape(i[1].dims).slice();Me.splice(-1,1,F/C),le.push(...Tt(Te)),le.push(...Tt(Me)),le.push(...Tt(i[2].dims)),i.length===4&&le.push(...Tt(We.convertShape(i[3].dims)));let $e=[L,_,y/X];le.push(...Tt($e));let ze=Ve=>{let st=Te.length,pt=et("a",i[0].dataType,st,W),$t=et("b",12,Me.length,C),on=et("scales",i[2].dataType,i[2].dims.length),dn=[pt,$t,on],Pt=i.length===4?et("zero_points",12,i[3].dims.length):void 0;Pt&&dn.push(Pt);let pn=$e.length,Lt=jt("output",i[0].dataType,pn,X),Bt=On(i[0].dataType),Vn=(()=>{switch(W){case 1:return`array<${Bt}, 8>`;case 2:return`mat4x2<${Bt}>`;case 4:return`mat2x4<${Bt}>`;default:throw new Error(`${W}-component is not supported.`)}})(),nn=()=>{let dt=`
          // reuse a data
            var input_offset = ${pt.indicesToOffset(`${pt.type.indices}(batch, row, word_offset)`)};
            var a_data: ${Vn};
            for (var j: u32 = 0; j < ${8/W}; j++) {
              a_data[j] = ${pt.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let It=0;It<X*ne;It++)dt+=`
            b_value = ${C===1?`b${It}_data`:`b${It}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${Vn}(${Array.from({length:4},(Sn,vr)=>`${Bt}(b_value_lower[${vr}]), ${Bt}(b_value_upper[${vr}])`).join(", ")});
            b_dequantized_values = ${W===1?`${Vn}(${Array.from({length:8},(Sn,vr)=>`(b_quantized_values[${vr}] - ${Pt?`zero_point${It}`:"zero_point"}) * scale${It}`).join(", ")});`:`(b_quantized_values - ${Vn}(${Array(8).fill(`${Pt?`zero_point${It}`:"zero_point"}`).join(",")})) * scale${It};`};
            workgroup_shared[local_id.x * ${ne} + ${Math.floor(It/X)}]${X>1?`[${It%X}]`:""} += ${Array.from({length:8/W},(Sn,vr)=>`${W===1?`a_data[${vr}] * b_dequantized_values[${vr}]`:`dot(a_data[${vr}], b_dequantized_values[${vr}])`}`).join(" + ")};
          `;return dt},qt=()=>{let dt=`
            var col_index = col * ${X};
            ${Pt?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${Bt}(8);`}
            `;for(let It=0;It<X*ne;It++)dt+=`
            let scale${It} = ${on.getByOffset("col_index * nBlocksPerCol + block")};
            ${Pt?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${Pt.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${It} = ${Bt}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return dt},Ln=()=>{let dt=`col_index = col * ${X};`;for(let It=0;It<X*ne;It++)dt+=`
            let b${It}_data = ${$t.getByIndices(`${$t.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return dt+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${Vn};
            var b_dequantized_values: ${Vn};`,dt};return`
        var<workgroup> workgroup_shared: array<${Lt.type.value}, ${ne*fe}>;
        ${Ve.declareVariables(...dn,Lt)}
        ${Ve.mainStart([fe,1,1])}
          let output_indices = ${Lt.offsetToIndices(`(global_idx / ${fe}) * ${ne}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${fe}) {
            //process one block
            var word_offset: u32 = block * ${l.blockSize/W};
            ${qt()}
            for (var word: u32 = 0; word < ${F}; word += ${C}) {
              ${Ln()}
              for (var i: u32 = 0; i < ${C}; i++) {
                ${nn()}
                word_offset += ${8/W};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${ne}) {
            var output_value: ${Lt.type.value} = ${Lt.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${fe}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${ne};
            }
            ${Lt.setByIndices(`${Lt.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${l.blockSize};${l.bits};${W};${C};${X};${ne};${fe}`,inputDependencies:Array(i.length).fill("rank")},getRunData:()=>({outputs:[{dims:J,dataType:K}],dispatchGroup:{x:ce},programUniforms:le}),getShaderSource:ze}},Pd=(i,l)=>{let f=i[0].dims,g=f.length,_=f[g-2],w=l.k,y=l.n,S=f.slice(0,g-2),L=We.size(S),F=i[1].dims[2]/4,K=i[0].dataType,W=rn(l.k),C=rn(F),X=S.concat([_,y]),J=128,ne=y%8===0?8:y%4===0?4:1,ce=J/ne,fe=ce*C*8,le=fe/W,Te=fe/l.blockSize,Me=We.size(X)/ne,$e=[],ze=[L,_,w/W],Ve=We.convertShape(i[1].dims).slice();Ve.splice(-1,1,F/C),$e.push(...Tt(ze)),$e.push(...Tt(Ve)),$e.push(...Tt(i[2].dims)),i.length===4&&$e.push(...Tt(We.convertShape(i[3].dims)));let st=[L,_,y];$e.push(...Tt(st));let pt=$t=>{let on=ze.length,dn=et("a",i[0].dataType,on,W),Pt=et("b",12,Ve.length,C),pn=et("scales",i[2].dataType,i[2].dims.length),Lt=[dn,Pt,pn],Bt=i.length===4?et("zero_points",12,i[3].dims.length):void 0;Bt&&Lt.push(Bt);let Vn=st.length,nn=jt("output",i[0].dataType,Vn),qt=On(i[0].dataType),Ln=()=>{switch(W){case 1:return`
          let a_data0 = vec4<${qt}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${qt}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${qt}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${qt}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${W}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${dn.type.value}, ${le}>;
        var<workgroup> inter_results: array<array<${nn.type.value}, ${ce}>, ${ne}>;
        ${$t.declareVariables(...Lt,nn)}
        ${$t.mainStart([ce,ne,1])}
          let output_indices = ${nn.offsetToIndices(`workgroup_index * ${ne}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${Te} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${le};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${le}; a_offset += ${J})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${dn.getByIndices(`${dn.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${dn.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${Te} + local_id.x;
            ${Bt?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${Bt.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${qt}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${qt}(8);`}
            let scale = ${pn.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${Pt.getByIndices(`${Pt.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${l.blockSize/W};
            for (var i: u32 = 0; i < ${C}; i++) {
              ${Ln()}
              let b_value = ${C===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${qt}>(${Array.from({length:4},(dt,It)=>`${qt}(b_value_lower[${It}]), ${qt}(b_value_upper[${It}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${qt}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(dt,It)=>`${`dot(a_data${It}, b_dequantized_values[${It}])`}`).join(" + ")};
              word_offset += ${8/W};
            }
            workgroupBarrier();
          }

          if (local_idx < ${ne}) {
            var output_value: ${nn.type.value} = ${nn.type.value}(0);
            for (var b = 0u; b < ${ce}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${nn.setByIndices(`${nn.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${l.blockSize};${W};${C};${ce};${ne}`,inputDependencies:Array(i.length).fill("rank")},getRunData:()=>({outputs:[{dims:X,dataType:K}],dispatchGroup:{x:Me},programUniforms:$e}),getShaderSource:pt}},gg=(i,l)=>{pg(i.inputs,l),l.blockSize===32&&i.adapterInfo.isVendor("intel")&&i.adapterInfo.isArchitecture("gen-12lp")?i.compute(Pd(i.inputs,l)):i.compute(mg(i.inputs,l))},_g=i=>Ht(i)}),Sy,Cy,ky,Sd,yg,vg,wg,bg,Cd,xg=u(()=>{Kt(),zt(),cn(),Sy=i=>{if(!i||i.length<1)throw new Error("Too few inputs");if(i[0].dataType!==1&&i[0].dataType!==10)throw new Error("Input type must be float or float16.");if(i.length>=2){let l=i[0].dims.length*2===i[1].dims[0];if(i.length===4&&(l=i[3].dims[0]*2===i[1].dims[0]),!l)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},Cy=(i,l,f)=>{let g="";for(let _=l-1;_>=0;--_)g+=`
            k = i32(${i.indicesGet("indices",_)}) - ${Ft("uniforms.pads",_,f)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Ft("uniforms.x_shape",_,l)})) {
              break;
            }
            offset += k * i32(${Ft("uniforms.x_strides",_,l)});
        `;return`
          value = ${i.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${g}
            value = x[offset];
          }
      `},ky=(i,l,f)=>{let g="";for(let _=l-1;_>=0;--_)g+=`
                k = i32(${i.indicesGet("indices",_)}) - ${Ft("uniforms.pads",_,f)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Ft("uniforms.x_shape",_,l)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Ft("uniforms.x_shape",_,l)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Ft("uniforms.x_strides",_,l)});
            `;return`
              var offset = 0;
              var k = 0;
              ${g}
              value = x[offset];
          `},Sd=(i,l,f)=>{let g="";for(let _=l-1;_>=0;--_)g+=`
                k = i32(${i.indicesGet("indices",_)}) - ${Ft("uniforms.pads",_,f)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Ft("uniforms.x_shape",_,l)})) {
                  k = i32(${Ft("uniforms.x_shape",_,l)}) - 1;
                }
                offset += k * i32(${Ft("uniforms.x_strides",_,l)});
            `;return`
              var offset = 0;
              var k = 0;
              ${g}
              value = x[offset];
          `},yg=(i,l,f)=>{let g="";for(let _=l-1;_>=0;--_)g+=`
                k = i32(${i.indicesGet("indices",_)}) - ${Ft("uniforms.pads",_,f)};
                if (k < 0)  {
                  k += i32(${Ft("uniforms.x_shape",_,l)}]);
                }
                if (k >= i32(${Ft("uniforms.x_shape",_,l)})) {
                  k -= i32(${Ft("uniforms.x_shape",_,l)});
                }
                offset += k * i32(${Ft("uniforms.x_strides",_,l)});
            `;return`
              var offset = 0;
              var k = 0;
              ${g}
              value = x[offset];
          `},vg=(i,l,f)=>{switch(f.mode){case 0:return Cy(i,l,f.pads.length);case 1:return ky(i,l,f.pads.length);case 2:return Sd(i,l,f.pads.length);case 3:return yg(i,l,f.pads.length);default:throw new Error("Invalid mode")}},wg=(i,l)=>{let f=We.padShape(i[0].dims.slice(),l.pads),g=i[0].dims,_=We.size(f),w=[{type:12,data:_},{type:6,data:l.pads}],y=i.length>=3&&i[2].data;l.mode===0&&w.push({type:y?i[2].dataType:1,data:l.value}),w.push(...Tt(i[0].dims,f));let S=["rank"],L=F=>{let K=jt("output",i[0].dataType,f.length),W=et("x",i[0].dataType,g.length),C=W.type.value,X=vg(K,g.length,l),J=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:l.pads.length}];return l.mode===0&&J.push({name:"constant_value",type:y?C:"f32"}),`
            ${F.registerUniforms(J).declareVariables(W,K)}
            ${F.mainStart()}
            ${F.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${K.offsetToIndices("global_idx")};

            var value = ${C}(0);
            ${X}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${l.mode}${y}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:f,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(We.size(f)/64)},programUniforms:w}),getShaderSource:L}},bg=(i,l)=>{if(i.length>1){let f=i[1].getBigInt64Array(),g=i.length>=3&&i[2].data?i[2].dataType===10?i[2].getUint16Array()[0]:i[2].getFloat32Array()[0]:0,_=i[0].dims.length,w=new Int32Array(2*_).fill(0);if(i.length>=4){let S=i[3].getBigInt64Array();for(let L=0;L<S.length;L++)w[Number(S[L])]=Number(f[L]),w[Number(S[L])+_]=Number(f[L+S.length])}else f.forEach((S,L)=>w[Number(L)]=Number(S));let y=[];return w.forEach(S=>y.push(S)),{mode:l.mode,value:g,pads:y}}else return l},Cd=(i,l)=>{Sy(i.inputs);let f=bg(i.inputs,l);i.compute(wg(i.inputs,f),{inputs:[0]})}}),ic,kd,Ad,oc,Mg,Ay,Tg,$d,Id,Eg,Pg,Od,Sg,Cg,Dd,kg,Ag,$g,$y,Iy=u(()=>{Xe(),Kt(),zt(),cn(),ic=i=>{if(j.webgpu.validateInputContent&&(!i||i.length!==1))throw new Error("Pool ops requires 1 input.")},kd=(i,l,f)=>{let g=l.format==="NHWC",_=i.dims.slice();g&&_.splice(1,0,_.pop());let w=Object.hasOwnProperty.call(l,"dilations"),y=l.kernelShape.slice(),S=l.strides.slice(),L=w?l.dilations.slice():[],F=l.pads.slice();Vr.adjustPoolAttributes(f,_,y,S,L,F);let K=Vr.computePoolOutputShape(f,_,S,L,y,F,l.autoPad),W=Object.assign({},l);w?Object.assign(W,{kernelShape:y,strides:S,pads:F,dilations:L,cacheKey:l.cacheKey}):Object.assign(W,{kernelShape:y,strides:S,pads:F,cacheKey:l.cacheKey});let C=K.slice();return C.push(C.splice(1,1)[0]),[W,g?C:K]},Ad=(i,l)=>{let f=l.format==="NHWC",g=We.size(i),_=We.size(l.kernelShape),w=[{type:12,data:g},{type:12,data:_}],y=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(l.kernelShape.length<=2){let S=l.kernelShape[l.kernelShape.length-1],L=l.strides[l.strides.length-1],F=l.pads[l.pads.length/2-1],K=l.pads[l.pads.length-1],W=!!(F+K);w.push({type:12,data:S},{type:12,data:L},{type:12,data:F},{type:12,data:K}),y.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let C=!1;if(l.kernelShape.length===2){let X=l.kernelShape[l.kernelShape.length-2],J=l.strides[l.strides.length-2],ne=l.pads[l.pads.length/2-2],ce=l.pads[l.pads.length-2];C=!!(ne+ce),w.push({type:12,data:X},{type:12,data:J},{type:12,data:ne},{type:12,data:ce}),y.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[w,y,!0,W,C]}else{if(f)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let S=We.computeStrides(l.kernelShape);w.push({type:12,data:S},{type:12,data:l.pads},{type:12,data:l.strides}),y.push({name:"kernelStrides",type:"u32",length:S.length},{name:"pads",type:"u32",length:l.pads.length},{name:"strides",type:"u32",length:l.strides.length});let L=l.pads.reduce((F,K)=>F+K);return[w,y,!!L,!1,!1]}},oc=(i,l,f,g,_,w,y,S,L,F,K,W)=>{let C=_.format==="NHWC",X=l.type.value,J=jt("output",l.type.tensor,g);if(_.kernelShape.length<=2){let ne="",ce="",fe="",le=f-(C?2:1);if(K?ne=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${le}] = indices[${le}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${le}] < 0 || xIndices[${le}]
                      >= uniforms.x_shape[${le}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${l.indicesToOffset("xIndices")}];
                  ${w}
                }`:ne=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${le}] = indices[${le}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${l.indicesToOffset("xIndices")}];
                  ${w}
                }`,_.kernelShape.length===2){let Te=f-(C?3:2);W?ce=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${Te}] = indices[${Te}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${Te}] < 0 || xIndices[${Te}] >= uniforms.x_shape[${Te}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:ce=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${Te}] = indices[${Te}] * uniforms.sh - uniforms.phStart + j;
                `,fe=`
              }
            `}return`
            ${i.registerUniforms(L).declareVariables(l,J)}

            ${i.mainStart()}
              ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${J.offsetToIndices("global_idx")};
              var xIndices = ${J.offsetToIndices("global_idx")};

              var value = ${X}(${S});
              var pad = 0;
              ${ce}
              ${ne}
              ${fe}
              ${y}

              output[global_idx] = value;
            }`}else{if(C)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let ne=_.kernelShape.length,ce=_.pads.length,fe="";return F?fe=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${l.indicesToOffset("xIndices")}];
                ${w}
              }`:fe=`
              }
              let x_val = x[${l.indicesToOffset("xIndices")}];
              ${w}
            `,`
            ${i.registerUniforms(L).declareVariables(l,J)}

            ${i.mainStart()}
              ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${J.offsetToIndices("global_idx")};
              var xIndices = ${J.offsetToIndices("global_idx")};

              var offsets: array<u32, ${ne}>;

              var value = ${X}(${S});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${ne-1}u; j++) {
                  offsets[j] = offset / ${Ft("uniforms.kernelStrides","j",ne)};
                  offset -= offsets[j] * ${Ft("uniforms.kernelStrides","j",ne)};
                }
                offsets[${ne-1}] = offset;

                isPad = false;
                for (var j = ${f-ne}u; j < ${f}u; j++) {
                  xIndices[j] = indices[j] * ${Ft("uniforms.strides",`j - ${f-ne}u`,ne)}
                    + offsets[j - ${f-ne}u] - ${Ft("uniforms.pads","j - 2u",ce)};
                  ${fe}
              }
              ${y}

              output[global_idx] = value;
            }`}},Mg=i=>`${i.format};${i.ceilMode};${i.autoPad};${i.kernelShape.length}`,Ay=i=>`${Mg(i)};${i.countIncludePad}`,Tg=i=>`${Mg(i)};${i.storageOrder};${i.dilations}`,$d=i=>({format:i.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][i.auto_pad],ceilMode:i.ceil_mode,kernelShape:i.kernel_shape,strides:i.strides,pads:i.pads}),Id=(i,l,f,g)=>{let[_,w]=kd(l,g,f),y=et("x",l.dataType,l.dims.length),S=y.type.value,L="value += x_val;",F="";_.countIncludePad?F+=`value /= ${S}(uniforms.kernelSize);`:F+=`value /= ${S}(i32(uniforms.kernelSize) - pad);`;let[K,W,C,X,J]=Ad(w,_);K.push(...Tt(l.dims,w));let ne=["rank"];return{name:i,shaderCache:{hint:`${g.cacheKey};${C};${X};${J}`,inputDependencies:ne},getRunData:()=>({outputs:[{dims:w,dataType:l.dataType}],dispatchGroup:{x:Math.ceil(We.size(w)/64)},programUniforms:K}),getShaderSource:ce=>oc(ce,y,l.dims.length,w.length,_,L,F,0,W,C,X,J)}},Eg=i=>{let l=i.count_include_pad!==0,f=$d(i);if(f.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let g={countIncludePad:l,...f,cacheKey:""};return{...g,cacheKey:Ay(g)}},Pg=(i,l)=>{ic(i.inputs),i.compute(Id("AveragePool",i.inputs[0],!1,l))},Od={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Sg=i=>{let l=i.format;return{format:l,...Od,cacheKey:l}},Cg=(i,l)=>{ic(i.inputs),i.compute(Id("GlobalAveragePool",i.inputs[0],!0,l))},Dd=(i,l,f,g)=>{let[_,w]=kd(l,g,f),y=`
      value = max(x_val, value);
    `,S="",L=et("x",l.dataType,l.dims.length),F=["rank"],[K,W,C,X,J]=Ad(w,_);return K.push(...Tt(l.dims,w)),{name:i,shaderCache:{hint:`${g.cacheKey};${C};${X};${J}`,inputDependencies:F},getRunData:()=>({outputs:[{dims:w,dataType:l.dataType}],dispatchGroup:{x:Math.ceil(We.size(w)/64)},programUniforms:K}),getShaderSource:ne=>oc(ne,L,l.dims.length,w.length,_,y,S,l.dataType===10?-65504:-1e5,W,C,X,J)}},kg=(i,l)=>{ic(i.inputs),i.compute(Dd("MaxPool",i.inputs[0],!1,l))},Ag=i=>{let l=i.storage_order,f=i.dilations,g=$d(i);if(l!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(g.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let _={storageOrder:l,dilations:f,...g,cacheKey:""};return{..._,cacheKey:Tg(_)}},$g=i=>{let l=i.format;return{format:l,...Od,cacheKey:l}},$y=(i,l)=>{ic(i.inputs),i.compute(Dd("GlobalMaxPool",i.inputs[0],!0,l))}}),Ig,Og,Dg,Lg,Oy=u(()=>{Kt(),zt(),gn(),cn(),Ig=(i,l)=>{if(i.length<2||i.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(i.length===3&&i[1].dims===i[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(i.length===3&&i[0].dataType!==i[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(i[0].dataType===6&&i.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(i[1].dims.length!==0&&i[1].dims.length!==1&&i[1].dims.length!==i[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(i.length>2){if(i[0].dataType!==i[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(i[1].dims.length!==i[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!i[1].dims.map((f,g)=>f===i[2].dims[g]).reduce((f,g)=>f&&g,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(l.blockSize>0){if(i[1].dims.length===0||i[1].dims.length===1&&i[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!i[1].dims.map((_,w)=>w===l.axis||_===i[0].dims[w]).reduce((_,w)=>_&&w,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(i[1].dims.length!==i[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let f=i[0].dims[l.axis],g=i[1].dims[l.axis];if(l.blockSize<Math.ceil(f/g)||l.blockSize>Math.ceil(f/(g-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},Og=(i,l)=>{let f=We.normalizeAxis(l.axis,i[0].dims.length),g=i[0].dataType,_=g===3,w=i[0].dims,y=i[1].dataType,S=We.size(w),L=g===3||g===2,F=L?[Math.ceil(We.size(i[0].dims)/4)]:i[0].dims,K=i[1].dims,W=i.length>2?i[2]:void 0,C=W?L?[Math.ceil(We.size(W.dims)/4)]:W.dims:void 0,X=K.length===0||K.length===1&&K[0]===1,J=X===!1&&K.length===1,ne=rn(S),ce=X&&(!L||ne===4),fe=ce?ne:1,le=ce&&!L?ne:1,Te=et("input",L?12:g,F.length,le),Me=et("scale",y,K.length),$e=W?et("zero_point",L?12:g,C.length):void 0,ze=jt("output",y,w.length,fe),Ve=[Te,Me];$e&&Ve.push($e);let st=[F,K];W&&st.push(C);let pt=[{type:12,data:S/fe},{type:12,data:f},{type:12,data:l.blockSize},...Tt(...st,w)],$t=on=>{let dn=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${on.registerUniforms(dn).declareVariables(...Ve,ze)}
      ${on.mainStart()}
          ${on.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${ze.offsetToIndices("global_idx")};

          // Set input x
          ${L?`
            let input = ${Te.getByOffset("global_idx / 4")};
            let x_vec = ${_?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${fe===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${Te.getByOffset("global_idx")};`};

          // Set scale input
          ${X?`let scale_value= ${Me.getByOffset("0")}`:J?`
            let scale_index = ${ze.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${Me.getByOffset("scale_index")};`:`
            var scale_indices: ${Me.type.indices} = output_indices;
            let index = ${Me.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${Me.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${Me.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${$e?X?L?`
                let zero_point_input = ${$e.getByOffset("0")};
                let zero_point_vec =  ${_?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${$e.getByOffset("0")}`:J?L?`
                let zero_point_index = ${ze.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${$e.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${_?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${ze.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${$e.getByOffset("zero_point_index")};`:L?`
                let zero_point_offset = ${Me.indicesToOffset("scale_indices")};
                let zero_point_input = ${$e.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${_?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${$e.getByIndices("scale_indices")};`:`let zero_point_value = ${L?_?"i32":"u32":Te.type.value}(0);`};
      // Compute and write output
      ${ze.setByOffset("global_idx",`${ze.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:l.cacheKey,inputDependencies:$e?["rank","rank","rank"]:["rank","rank"]},getShaderSource:$t,getRunData:()=>({outputs:[{dims:w,dataType:y}],dispatchGroup:{x:Math.ceil(S/fe/64),y:1,z:1},programUniforms:pt})}},Dg=(i,l)=>{Ig(i.inputs,l),i.compute(Og(i.inputs,l))},Lg=i=>Ht({axis:i.axis,blockSize:i.blockSize})}),Dy,Ld,Fg,Ly=u(()=>{Xe(),Kt(),cn(),Dy=(i,l,f)=>{let g=i===l,_=i<l&&f<0,w=i>l&&f>0;if(g||_||w)throw new Error("Range these inputs' contents are invalid.")},Ld=(i,l,f,g)=>{let _=Math.abs(Math.ceil((l-i)/f)),w=[_],y=_,S=[{type:12,data:y},{type:g,data:i},{type:g,data:f},...Tt(w)],L=F=>{let K=jt("output",g,w.length),W=K.type.value,C=[{name:"outputSize",type:"u32"},{name:"start",type:W},{name:"delta",type:W}];return`
        ${F.registerUniforms(C).declareVariables(K)}
        ${F.mainStart()}
        ${F.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${W}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${g}`},getShaderSource:L,getRunData:()=>({outputs:[{dims:w,dataType:g}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:S})}},Fg=i=>{let l=0,f=0,g=0;i.inputs[0].dataType===6?(l=i.inputs[0].getInt32Array()[0],f=i.inputs[1].getInt32Array()[0],g=i.inputs[2].getInt32Array()[0]):i.inputs[0].dataType===1&&(l=i.inputs[0].getFloat32Array()[0],f=i.inputs[1].getFloat32Array()[0],g=i.inputs[2].getFloat32Array()[0]),j.webgpu.validateInputContent&&Dy(l,f,g),i.compute(Ld(l,f,g,i.inputs[0].dataType),{inputs:[]})}}),Rg,jg,Ng,zg,Fy=u(()=>{Kt(),zt(),gn(),cn(),Rg=(i,l,f,g)=>{if(i!=="none"&&g!=="i32"&&g!=="u32"&&g!=="f32")throw new Error(`Input ${g} is not supported with reduction ${i}.`);let _=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,w=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${l}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(i){case"none":return`${l}=${f};`;case"add":return g==="i32"||g==="u32"?`atomicAdd(&${l}, bitcast<${g}>(${f}));`:`
              ${_}bitcast<${g}>(oldValue) + (${f})${w}`;case"max":return g==="i32"||g==="u32"?`atomicMax(&${l}, bitcast<${g}>(${f}));`:`
                ${_}max(bitcast<f32>(oldValue), (${f}))${w}`;case"min":return g==="i32"||g==="u32"?`atomicMin(&${l}, bitcast<${g}>(${f}));`:`${_}min(bitcast<${g}>(oldValue), (${f}))${w}`;case"mul":return`${_}(bitcast<${g}>(oldValue) * (${f}))${w}`;default:throw new Error(`Reduction ${i} is not supported.`)}},jg=(i,l)=>{let f=i[0].dims,g=i[1].dims,_=f,w=1,y=Math.ceil(We.size(g)/w),S=g[g.length-1],L=We.sizeFromDimension(f,S),F=[{type:12,data:y},{type:12,data:S},{type:12,data:L},...Tt(i[1].dims,i[2].dims,_)],K=W=>{let C=et("indices",i[1].dataType,i[1].dims.length),X=et("updates",i[2].dataType,i[2].dims.length,w),J=l.reduction!=="none"&&l.reduction!==""?pf("output",i[0].dataType,_.length):jt("output",i[0].dataType,_.length,w);return`
      ${W.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(C,X,J)}
      ${W.mainStart()}
        ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var data_offset = 0u;
  let indices_start = uniforms.last_index_dimension * global_idx;
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${i[0].dims.length===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start + uniforms.last_index_dimension];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${Rg(l.reduction,"output[data_offset + i]","value",J.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${l.cacheKey}_${l.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:_,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:F}),getShaderSource:K}},Ng=i=>Ht({reduction:i.reduction}),zg=(i,l)=>{i.compute(jg(i.inputs,l),{inputs:[i.inputs[1],i.inputs[2]],outputs:[]})}}),Bg,Vg,Ug,Wg,Gg,Kg,Hg,qg,Qg,Yg,Xg,Fd,Jg,Zg,e_,t_,n_,r_,s_,Ry=u(()=>{Kt(),zt(),gn(),cn(),Bg=(i,l)=>{if(i.every(f=>f>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),i.length>0){if(l.mode==="linear"){if(!(i.length===2||i.length===3||i.length===4&&i[0]===1&&i[1]===1||i.length===4&&i[0]===1&&i[3]===1||i.length===5&&i[0]===1&&i[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(l.mode==="cubic"&&!(i.length===2||i.length===4&&i[0]===1&&i[1]===1||i.length===4&&i[0]===1&&i[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},Vg=(i,l,f)=>{l.every(_=>_>=0&&_<f||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let g=new Array(f).fill(1);return l.forEach((_,w)=>g[_]=i[w]),g},Ug=(i,l,f,g,_,w)=>{let[y,S,L]=f>10?[1,2,3]:[-1,i.length>1?1:-1,-1],F=i[0].dims.length;if(y>0&&i.length>y&&i[y].dims.length>0)i[y].getFloat32Array().forEach(K=>w.push(K));else if(l.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(S>0&&i.length>S&&i[S].dims.length===1&&i[S].dims[0]>0){if(i[S].getFloat32Array().forEach(K=>g.push(K)),g.length!==0&&g.length!==F&&f>=18&&g.length!==l.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");Bg(g,l),l.axes.length>0&&Vg(g,l.axes,F).forEach((K,W)=>g[W]=K)}if(L>0&&i.length>L&&i[L].dims.length===1&&i[L].dims[0]>0&&(i[L].getBigInt64Array().forEach(K=>_.push(Number(K))),_.length!==0&&_.length!==F&&f>=18&&_.length!==l.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(l.axes.length>0){if(g.length!==0&&g.length!==l.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(_.length!==0&&_.length!==l.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof g<"u"&&typeof _<"u"&&g.length>0&&_.length>F)throw new Error("Resize requires only of scales or sizes to be specified")},Wg=(i,l)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${l} { `+(()=>{switch(i){case"asymmetric":return`return ${l}(xResized) / ${l}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${l}(xResized) + 0.5) / ${l}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${l}(xResized) + 0.5) / ${l}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating
                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
                    // offset-by-one error later in floor().
                    let whole = ${l}(xResized * (lengthOriginal - 1) / (lengthResized - 1));
                    let fract =
                        ${l}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${l}(lengthResized - 1);
                    return whole + fract;
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${l}(roiStart) * ${l}(lengthOriginal - 1) +
                        (${l}(xResized) * ${l}(roiEnd - roiStart) * ${l}(lengthOriginal - 1)) /
                        ${l}(lengthResized - 1);
                  } else {
                    return 0.5 * ${l}(roiStart + roiEnd) * ${l}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${l}xScale * ${l}(lengthResized);
                  const adjustment = ${l}(lengthResized) / outputWidth;
                  const center = ${l}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${l}(xResized) + 0.5) / ${l}(xScale)) - 0.5;`;case"half_pixel":return`return ((${l}(xResized) + 0.5) / ${l}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${i} is not supported`)}})()+"}",Gg=(i,l,f)=>`fn getNearestPixelFromOriginal(xOriginal: ${f}, isDownSample: bool) -> ${f} {`+(()=>{switch(i){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(l<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${i} is not supported`)}})()+"}",Kg=(i,l,f)=>{let g=new Array(f).fill(0).concat(new Array(f).fill(1)),_=i.length===0?g:i.slice();return l.length>0?(l.forEach((w,y)=>{g[w]=_[y],g[y+f]=_[l.length+y]}),g):_},Hg=(i,l,f,g)=>{let _=[];if(f.length>0)if(g.length>0){if(i.forEach(w=>_.push(w)),Math.max(...g)>i.length)throw new Error("axes is out of bound");g.forEach((w,y)=>_[w]=f[y])}else f.forEach(w=>_.push(w));else{if(l.length===0)throw new Error("Resize requires either scales or sizes.");_=i.map((w,y)=>Math.round(w*l[y]))}return _},qg=(i,l,f)=>{let g=(()=>{switch(f.keepAspectRatioPolicy){case"not_larger":return f.axes.length>0?Math.min(...f.axes.map(w=>l[w]),Number.MAX_VALUE):Math.min(...l,Number.MAX_VALUE);case"not_smaller":return f.axes.length>0?Math.max(...f.axes.map(w=>l[w]),Number.MIN_VALUE):Math.max(...l,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${f.keepAspectRatioPolicy} is not supported`)}})();l.fill(1,0,l.length);let _=i.slice();return f.axes.length>0?(f.axes.forEach(w=>l[w]=g),f.axes.forEach(w=>_[w]=Math.round(i[w]*l[w]))):(l.fill(g,0,l.length),_.forEach((w,y)=>_[y]=Math.round(w*l[y]))),_},Qg=(i,l,f,g,_)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${i.type.indices}) -> array<${i.type.value}, ${f.length}> {
      var original_indices: array<${i.type.value}, ${f.length}>;
      for (var i:u32 = 0; i < ${f.length}; i++) {
        var output_index = ${i.indicesGet("output_indices","i")};
        var scale = ${Ft("uniforms.scales","i",g)};
        var roi_low = ${Ft("uniforms.roi","i",_)};
        var roi_hi = ${Ft("uniforms.roi",`i + ${l.length}`,_)};
        if (scale == 1.0) {
          original_indices[i] = ${i.type.value}(output_index);
        } else {
          var input_shape_i = ${Ft("uniforms.input_shape","i",l.length)};
          var output_shape_i = ${Ft("uniforms.output_shape","i",f.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Yg=(i,l,f,g,_,w,y)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${l.type.indices}) -> ${i.type.indices} {
      var input_indices: ${i.type.indices};
      for (var i:u32 = 0; i < ${g.length}; i++) {
        var output_index = ${l.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Ft("uniforms.scales","i",_)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Ft("uniforms.roi","i",w)};
          var roi_hi = ${Ft("uniforms.roi",`i + ${f.length}`,w)};
          var input_shape_i = ${Ft("uniforms.input_shape","i",f.length)};
          var output_shape_i = ${Ft("uniforms.output_shape","i",g.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${y} || (original_idx >= 0 && original_idx < ${l.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${l.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${i.indicesSet("input_indices","i"," input_index")}
      }
      return input_indices;
    }`,Xg=(i,l)=>`
    fn checkInputIndices(input_indices: ${i.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${l.length}; i++) {
        var input_index = ${i.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Ft("uniforms.input_shape","i",l.length)}) {
          return false;
        }
      }
      return true;
    }`,Fd=(i,l,f,g)=>i.rank>g?`
    ${i.indicesSet("input_indices",l,"channel")};
    ${i.indicesSet("input_indices",f,"batch")};
`:"",Jg=(i,l,f,g,_)=>{let[w,y,S,L]=f.length===2?[-1,0,1,-1]:[0,2,3,1],F=i.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${F} {
      var input_indices: ${i.type.indices};
      ${i.indicesSet("input_indices",y,`max(0, min(row, ${f[y]} - 1))`)};
      ${i.indicesSet("input_indices",S,`max(0, min(col, ${f[S]} - 1))`)};
      ${Fd(i,L,w,2)}
      return ${i.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${l.type.indices}) -> ${F} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${F} = originalIndices[${y}];
      var col:${F} = originalIndices[${S}];
      ${g?`if (row < 0 || row > (${f[y]} - 1) || col < 0 || col > (${f[S]} - 1)) {
        return ${_};
      }`:""};
      row = max(0, min(row, ${f[y]} - 1));
      col = max(0, min(col, ${f[S]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${f.length>2?`u32(originalIndices[${L}])`:"0"};
      var batch: u32 =  ${f.length>2?`u32(originalIndices[${w}])`:"0"};
      var x11: ${F} = getInputValue(batch, channel, row1, col1);
      var x12: ${F} = getInputValue(batch, channel, row1, col2);
      var x21: ${F} = getInputValue(batch, channel, row2, col1);
      var x22: ${F} = getInputValue(batch, channel, row2, col2);
      var dx1: ${F} = abs(row - ${F}(row1));
      var dx2: ${F} = abs(${F}(row2) - row);
      var dy1: ${F} = abs(col - ${F}(col1));
      var dy2: ${F} = abs(${F}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},Zg=(i,l,f,g,_,w,y,S,L,F)=>{let K=f.length===2,[W,C]=K?[0,1]:[2,3],X=i.type.value,J=ne=>{let ce=ne===W?"row":"col";return`
      fn ${ce}CubicInterpolation(input_indices: ${i.type.indices}, output_indices: ${l.type.indices}) -> ${X} {
        var output_index = ${l.indicesGet("output_indices",ne)};
        var originalIdx: ${X} = getOriginalCoordinateFromResizedCoordinate(output_index, ${_[ne]},
        ${g[ne]}, ${f[ne]}, ${w[ne]}, ${w[ne]} + ${f.length});
        var fractOriginalIdx: ${X} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${S} && (originalIdx < 0 || originalIdx > (${f[ne]} - 1))) {
          return ${L};
        }
        var data: array<${X}, 4> = array<${X}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${ce}: ${X} = originalIdx + ${X}(i);
          if (${ce} < 0 || ${ce} >= ${f[ne]}) {
            ${F?`coefs[i + 1] = 0.0;
                        continue;`:S?`return ${L};`:`${ce} = max(0, min(${ce}, ${f[ne]} - 1));`};
          }
        var input_indices_copy: ${i.type.indices} = input_indices;
          ${i.indicesSet("input_indices_copy",ne,`u32(${ce})`)};
          data[i + 1] = ${ne===W?i.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${J(W)};
    ${J(C)};
  fn getCubicInterpolationCoefs(s: ${X}) -> array<${X}, 4> {
    var absS = abs(s);
    var coeffs: array<${X}, 4> = array<${X}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${X} = 1.0 - absS;
    var twoMinusAbsS: ${X} = 2.0 - absS;
    var onePlusAbsS: ${X} = 1.0 + absS;
    coeffs[0] = ((${y} * onePlusAbsS - 5 * ${y}) * onePlusAbsS + 8 * ${y}) * onePlusAbsS - 4 * ${y};
    coeffs[1] = ((${y} + 2) * absS - (${y} + 3)) * absS * absS + 1;
    coeffs[2] = ((${y} + 2) * oneMinusAbsS - (${y} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${y} * twoMinusAbsS - 5 * ${y}) * twoMinusAbsS + 8 * ${y}) * twoMinusAbsS - 4 * ${y};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${X}, 4>, coefs: array<${X}, 4>) -> ${X} {
    var coefsSum: ${X} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${l.type.indices}) -> ${X} {
    var input_indices: ${i.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},e_=(i,l,f,g,_)=>{let[w,y,S,L,F]=f.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],K=i.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${K} {
      var input_indices: ${i.type.indices};
      ${i.indicesSet("input_indices",y,`max(0, min(depth, ${f[y]} - 1))`)};
      ${i.indicesSet("input_indices",S,`max(0, min(height, ${f[S]} - 1))`)};
      ${i.indicesSet("input_indices",L,`max(0, min(width, ${f[L]} - 1))`)};
      ${Fd(i,F,w,3)}
      return ${i.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${l.type.indices}) -> ${K} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${K} = originalIndices[${y}];
      var height:${K} = originalIndices[${S}];
      var width:${K} = originalIndices[${L}];
      ${g?`if (depth < 0 || depth > (${f[y]} - 1) || height < 0 || height > (${f[S]} - 1) || width < 0 || (width > ${f[L]} - 1)) {
      return ${_};
        }`:""};

    depth = max(0, min(depth, ${f[y]} - 1));
      height = max(0, min(height, ${f[S]} - 1));
      width = max(0, min(width, ${f[L]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${f.length>3?`u32(originalIndices[${F}])`:"0"};
      var batch: u32 =  ${f.length>3?`u32(originalIndices[${w}])`:"0"};

      var x111: ${K} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${K} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${K} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${K} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${K} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${K} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${K} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${K} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${K} = abs(depth - ${K}(depth1));
      var dx2: ${K} = abs(${K}(depth2) - depth);
      var dy1: ${K} = abs(height - ${K}(height1));
      var dy2: ${K} = abs(${K}(height2) - height);
      var dz1: ${K} = abs(width - ${K}(width1));
      var dz2: ${K} = abs(${K}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},t_=(i,l,f,g,_,w)=>{let y=i.dims,S=Kg(w,l.axes,y.length),L=Hg(y,g,_,l.axes),F=g.slice();g.length===0&&(F=y.map((le,Te)=>le===0?1:L[Te]/le),l.keepAspectRatioPolicy!=="stretch"&&(L=qg(y,F,l)));let K=jt("output",i.dataType,L.length),W=et("input",i.dataType,y.length),C=We.size(L),X=y.length===L.length&&y.every((le,Te)=>le===L[Te]),J=l.coordinateTransformMode==="tf_crop_and_resize",ne=l.extrapolationValue,ce=W.type.value,fe=le=>`
      ${X?"":`
      ${Wg(l.coordinateTransformMode,ce)};
      ${(()=>{switch(l.mode){case"nearest":return`
              ${Xg(W,y)};
              ${Gg(l.nearestMode,f,ce)};
              ${Yg(W,K,y,L,F.length,S.length,J)};
              `;case"linear":return`
              ${Qg(K,y,L,F.length,S.length)};
              ${(()=>{if(y.length===2||y.length===4)return`${Jg(W,K,y,J,ne)}`;if(y.length===3||y.length===5)return`${e_(W,K,y,J,ne)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(y.length===2||y.length===4)return`${Zg(W,K,y,L,F,S,l.cubicCoeffA,J,l.extrapolationValue,l.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${le.registerUniform("output_size","u32").registerUniform("scales","f32",F.length).registerUniform("roi","f32",S.length).declareVariables(W,K)}
      ${le.mainStart()}
        ${le.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${X?"output[global_idx] = input[global_idx];":`
        let output_indices = ${K.offsetToIndices("global_idx")};
        var input_indices: ${W.type.indices};
        ${(()=>{switch(l.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${W.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${l.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${y.length===2||y.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${l.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${l.cacheKey}|${f}|${F.length>0?F:""}|${_.length>0?_:""}|${S.length>0?S:""}|${X}|${y}`,inputDependencies:["rank"]},getShaderSource:fe,getRunData:()=>({outputs:[{dims:L,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:[{type:12,data:C},{type:1,data:F},{type:1,data:S},...Tt(y,L)]})}},n_=i=>{let l=i.customDataBuffer;return new Uint32Array(l,l.byteOffset,1)[0]},r_=(i,l)=>{let f=[],g=[],_=[],w=n_(i);if(l.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");Ug(i.inputs,l,w,f,g,_),i.compute(t_(i.inputs[0],l,w,f,g,_),{inputs:[0]})},s_=i=>{let l=i.antialias,f=i.axes,g=i.coordinateTransformMode,_=i.cubicCoeffA,w=i.excludeOutside!==0,y=i.extrapolationValue,S=i.keepAspectRatioPolicy,L=i.mode,F=i.nearestMode===""?"simple":i.nearestMode;return Ht({antialias:l,axes:f,coordinateTransformMode:g,cubicCoeffA:_,excludeOutside:w,extrapolationValue:y,keepAspectRatioPolicy:S,mode:L,nearestMode:F})}}),i_,jy,sn,Ny=u(()=>{Kt(),zt(),gn(),cn(),i_=(i,l)=>{let[f,g,_,w]=i,{numHeads:y,rotaryEmbeddingDim:S}=l;if(f.dims.length!==3&&f.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${f.dims.length}`);if(!We.areEqual(g.dims,[])&&!We.areEqual(g.dims,[1])&&g.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${g.dims.length}`);if(_.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${_.dims.length}`);if(w.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${w.dims.length}`);if(!We.areEqual(_.dims,w.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(S>0&&y===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let L=f.dims[0],F=f.dims[f.dims.length-2],K=_.dims[0],W=We.sizeFromDimension(f.dims,1)/F,C=S===0?_.dims[1]*2:W/y;if(S>C)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(g.dims.length===2){if(L!==g.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${g.dims[0]}`);if(F!==g.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${g.dims[1]}`)}if(C/2!==_.dims[1]&&S/2!==_.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${_.dims[1]}`);if(F>K)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},jy=(i,l)=>{let{interleaved:f,numHeads:g,rotaryEmbeddingDim:_,scale:w}=l,y=i[0].dims[0],S=We.sizeFromDimension(i[0].dims,1),L=i[0].dims[i[0].dims.length-2],F=S/L,K=i[2].dims[1],W=_===0?K*2:F/g,C=new Array(y,L,F/W,W-K),X=We.computeStrides(C),J=[{type:1,data:w},{type:12,data:C},{type:12,data:X},...i[0].dims.length===3?new Array({type:12,data:[S,F,W,1]}):[],...i[0].dims.length===4?new Array({type:12,data:[S,W,L*W,1]}):[],...Tt(i[0].dims,i[1].dims,i[2].dims,i[3].dims,i[0].dims)],ne=ce=>{let fe=et("input",i[0].dataType,i[0].dims.length),le=et("position_ids",i[1].dataType,i[1].dims.length),Te=et("cos_cache",i[2].dataType,i[2].dims.length),Me=et("sin_cache",i[3].dataType,i[3].dims.length),$e=jt("output",i[0].dataType,i[0].dims.length);return ce.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:C.length},{name:"global_strides",type:"u32",length:X.length},{name:"input_output_strides",type:"u32",length:X.length}]),`
        ${ce.declareVariables(fe,le,Te,Me,$e)}

        ${ce.mainStart(ts)}
          let half_rotary_emb_dim = uniforms.${Te.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${ce.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${le.broadcastedIndicesToOffset("bsnh.xy",jt("",le.type.tensor,2))};
            let position_id =
                u32(${le.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${f});
            let j = i + select(half_rotary_emb_dim, 1, ${f});
            let re = ${fe.getByOffset("i")} * ${Te.get("position_id","bsnh[3]")} -
                ${fe.getByOffset("j")} * ${Me.get("position_id","bsnh[3]")};
            ${$e.setByOffset("i","re")}
            let im = ${fe.getByOffset("i")} * ${Me.get("position_id","bsnh[3]")} +
                ${fe.getByOffset("j")} * ${Te.get("position_id","bsnh[3]")};
            ${$e.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${$e.setByOffset("k",fe.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:Ht({interleaved:f}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:ne,getRunData:()=>({outputs:[{dims:i[0].dims,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(We.size(C)/ts)},programUniforms:J})}},sn=(i,l)=>{i_(i.inputs,l),i.compute(jy(i.inputs,l))}}),kr,Fr,Hr,Ko=u(()=>{Kt(),zt(),cn(),kr=i=>{if(!i||i.length<3)throw new Error("layerNorm requires at least 3 inputs.");let l=i[0],f=i[1],g=i[2];if(l.dataType!==f.dataType||l.dataType!==g.dataType)throw new Error("All inputs must have the same data type");if(l.dims.length!==3&&l.dims.length!==2)throw new Error("Input must be 2D or 3D");if(f.dims.length!==3&&f.dims.length!==2)throw new Error("Skip must be 2D or 3D");let _=l.dims[l.dims.length-1],w=l.dims[l.dims.length-2];if(f.dims[f.dims.length-1]!==_)throw new Error("Skip must have the same hidden size as input");if(f.dims[f.dims.length-2]!==w)throw new Error("Skip must have the same sequence length as input");if(g.dims.length!==1)throw new Error("Gamma must be 1D");if(g.dims[g.dims.length-1]!==_)throw new Error("Gamma must have the same hidden size as input");if(i.length>3){let y=i[3];if(y.dims.length!==1)throw new Error("Beta must be 1D");if(y.dims[y.dims.length-1]!==_)throw new Error("Beta must have the same hidden size as input")}if(i.length>4){let y=i[4];if(y.dims.length!==1)throw new Error("Bias must be 1D");if(y.dims[y.dims.length-1]!==_)throw new Error("Bias must have the same hidden size as input")}},Fr=(i,l,f,g)=>{let _=l.simplified,w=i[0].dims,y=We.size(w),S=w,L=y,F=w.slice(-1)[0],K=g?w.slice(0,-1).concat(1):[],W=!_&&i.length>3,C=i.length>4,X=g&&f>1,J=g&&f>2,ne=f>3,ce=64,fe=rn(F),le=[{type:12,data:L},{type:12,data:fe},{type:12,data:F},{type:1,data:l.epsilon}],Te=$e=>{let ze=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],Ve=[et("x",i[0].dataType,i[0].dims,fe),et("skip",i[1].dataType,i[1].dims,fe),et("gamma",i[2].dataType,i[2].dims,fe)];W&&Ve.push(et("beta",i[3].dataType,i[3].dims,fe)),C&&Ve.push(et("bias",i[4].dataType,i[4].dims,fe)),Ve.push(jt("output",i[0].dataType,S,fe)),X&&Ve.push(jt("mean_output",1,K)),J&&Ve.push(jt("inv_std_output",1,K)),ne&&Ve.push(jt("input_skip_bias_sum",i[0].dataType,S,fe));let st=On(i[0].dataType),pt=On(1,fe);return`

      ${$e.registerUniforms(ze).declareVariables(...Ve)}
      var<workgroup> sum_shared : array<${pt}, ${ce}>;
      var<workgroup> sum_squared_shared : array<${pt}, ${ce}>;

      ${$e.mainStart([ce,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${ce};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${ce};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${ce-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${C?"bias[offset1d + i]":st+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${ne?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${rr(st,fe,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${ce};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${Cr("sum",fe)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Cr("square_sum",fe)} / f32(uniforms.hidden_size) ${_?"":"- mean * mean"} + uniforms.epsilon);
        ${X?"mean_output[global_idx] = mean;":""}
        ${J?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${_?"":`- ${st}(mean)`}) *
            ${st}(inv_std_dev) * gamma[offset1d + i]
            ${W?"+ beta[offset1d + i]":""};
        }
      }`},Me=[{dims:S,dataType:i[0].dataType}];return f>1&&Me.push({dims:K,dataType:1}),f>2&&Me.push({dims:K,dataType:1}),f>3&&Me.push({dims:w,dataType:i[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${fe};${X};${J};${ne}`,inputDependencies:i.map(($e,ze)=>"type")},getShaderSource:Te,getRunData:()=>({outputs:Me,dispatchGroup:{x:Math.ceil(L/F)},programUniforms:le})}},Hr=(i,l)=>{kr(i.inputs);let f=[0];i.outputCount>1&&f.push(-3),i.outputCount>2&&f.push(-3),i.outputCount>3&&f.push(3),i.compute(Fr(i.inputs,l,i.outputCount,!1),{outputs:f})}}),zy,Fa,o_,z,V,Z,Se,je,Ne=u(()=>{Kt(),zt(),gn(),cn(),zy=(i,l)=>{if(!i||i.length<1)throw new Error("too few inputs");if(l.axes.length!==0){if(l.axes.length!==l.starts.length||l.axes.length!==l.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(l.starts.length!==l.ends.length)throw new Error("starts and ends must have the same length");i.slice(1).forEach((f,g)=>{if(i[g+1].dataType!==6&&i[g+1].dataType!==7)throw new Error(`Input ${g} must be an array of int32 or int64`)})},Fa=(i,l)=>{let f=[];if(i.length>l)if(i[l].dataType===7)i[l].getBigInt64Array().forEach(g=>f.push(Number(g)));else if(i[l].dataType===6)i[l].getInt32Array().forEach(g=>f.push(Number(g)));else throw new Error(`Input ${l} must be an array of int32 or int64`);return f},o_=(i,l)=>{if(i.length>1){let f=Fa(i,1),g=Fa(i,2),_=Fa(i,3);return _.length===0&&(_=[...Array(i[0].dims.length).keys()]),Ht({starts:f,ends:g,axes:_})}else return l},z=(i,l,f,g,_)=>{let w=i;return i<0&&(w+=f[g[l]]),_[l]<0?Math.max(0,Math.min(w,f[g[l]]-1)):Math.max(0,Math.min(w,f[g[l]]))},V=(i,l,f)=>`fn calculateInputIndices(output_indices: ${l.type.indices}) -> ${i.type.indices} {
          var input_indices: ${i.type.indices};
          var carry = 0u;
          for (var i = ${f.length}; i >= 0; i--) {
            let input_shape_i = ${Ft("uniforms.input_shape","i",f.length)};
            let steps_i = ${Ft("uniforms.steps","i",f.length)};
            let signs_i = ${Ft("uniforms.signs","i",f.length)};
            let starts_i = ${Ft("uniforms.starts","i",f.length)};
            var output_index = ${l.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${i.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Z=(i,l)=>{let f=i[0].dims,g=We.size(f),_=l.axes.length>0?We.normalizeAxes(l.axes,f.length):[...Array(f.length).keys()],w=Fa(i,4);w.forEach(fe=>fe!==0||(()=>{throw new Error("step cannot be 0")})),w.length===0&&(w=Array(_.length).fill(1));let y=l.starts.map((fe,le)=>z(fe,le,f,_,w)),S=l.ends.map((fe,le)=>z(fe,le,f,_,w));if(_.length!==y.length||_.length!==S.length)throw new Error("start, ends and axes should have the same number of elements");if(_.length!==f.length)for(let fe=0;fe<f.length;++fe)_.includes(fe)||(y.splice(fe,0,0),S.splice(fe,0,f[fe]),w.splice(fe,0,1));let L=w.map(fe=>Math.sign(fe));w.forEach((fe,le,Te)=>{if(fe<0){let Me=(S[le]-y[le])/fe,$e=y[le],ze=$e+Me*w[le];y[le]=ze,S[le]=$e,Te[le]=-fe}});let F=f.slice(0);_.forEach((fe,le)=>{F[fe]=Math.ceil((S[fe]-y[fe])/w[fe])});let K={dims:F,dataType:i[0].dataType},W=jt("output",i[0].dataType,F.length),C=et("input",i[0].dataType,i[0].dims.length),X=We.size(F),J=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:y.length},{name:"signs",type:"i32",length:L.length},{name:"steps",type:"u32",length:w.length}],ne=[{type:12,data:X},{type:12,data:y},{type:6,data:L},{type:12,data:w},...Tt(i[0].dims,F)],ce=fe=>`
      ${fe.registerUniforms(J).declareVariables(C,W)}
        ${V(C,W,f)}
        ${fe.mainStart()}
          ${fe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${W.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${W.setByOffset("global_idx",C.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${L.length}_${y.length}_${w.length}`,inputDependencies:["rank"]},getShaderSource:ce,getRunData:()=>({outputs:[K],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:ne})}},Se=(i,l)=>{zy(i.inputs,l);let f=o_(i.inputs,l);i.compute(Z(i.inputs,f),{inputs:[0]})},je=i=>{let l=i.starts,f=i.ends,g=i.axes;return Ht({starts:l,ends:f,axes:g})}}),it,at,bt,Et,Qt=u(()=>{Kt(),zt(),gn(),zi(),cn(),it=i=>{if(!i||i.length!==1)throw new Error("Softmax op requires 1 input.")},at=(i,l)=>{let f=i.inputs[0],g=f.dims,_=We.size(g),w=g.length,y=We.normalizeAxis(l.axis,w),S=y<g.length-1,L,F=[];S?(F=Array.from({length:w},(Ve,st)=>st),F[y]=w-1,F[w-1]=y,L=i.compute(Ms(f,F),{inputs:[f],outputs:[-1]})[0]):L=f;let K=L.dims,W=K[w-1],C=_/W,X=rn(W),J=W/X,ne=64;C===1&&(ne=256);let ce=(Ve,st)=>st===4?`max(max(${Ve}.x, ${Ve}.y), max(${Ve}.z, ${Ve}.w))`:st===2?`max(${Ve}.x, ${Ve}.y)`:st===3?`max(max(${Ve}.x, ${Ve}.y), ${Ve}.z)`:Ve,fe=et("x",L.dataType,L.dims,X),le=jt("result",L.dataType,L.dims,X),Te=fe.type.value,Me=On(L.dataType)==="f32"?`var threadMax = ${Te}(-3.402823e+38f);`:`var threadMax = ${Te}(-65504.0h);`,$e=Ve=>`
      var<workgroup> rowMaxShared : ${Te};
      var<workgroup> rowSumShared : ${Te};
      var<workgroup> threadShared : array<${Te}, ${ne}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${Te} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${Te}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${Ve.registerUniform("packedCols","i32").declareVariables(fe,le)}
      ${Ve.mainStart(ne)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${ne};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${Me}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${Te}(${ce("threadShared[0]",X)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${Te}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${Te}(${Cr("threadShared[0]",X)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,ze=i.compute({name:"Softmax",shaderCache:{hint:`${X};${ne}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:K,dataType:L.dataType}],dispatchGroup:{x:C},programUniforms:[{type:6,data:J}]}),getShaderSource:$e},{inputs:[L],outputs:[S?-1:0]})[0];S&&i.compute(Ms(ze,F),{inputs:[ze]})},bt=(i,l)=>{it(i.inputs),at(i,l)},Et=i=>Ht({axis:i.axis})}),Xt,Gt,Zt,hn,_n,un=u(()=>{Kt(),zt(),cn(),Xt=i=>Array.from(i.getBigInt64Array(),Number),Gt=i=>{if(!i||i.length!==2)throw new Error("Tile requires 2 inputs.");if(i[0].dataType!==1&&i[0].dataType!==10&&i[0].dataType!==6&&i[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(i[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(i[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Xt(i[1]).length!==i[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Zt=(i,l)=>{let f=[];for(let g=0;g<i.length;++g)f.push(i[g]*l[g]);return f},hn=(i,l)=>{let f=i[0].dims,g=l??Xt(i[1]),_=Zt(f,g),w=We.size(_),y=i[0].dataType,S=et("input",y,f.length),L=jt("output",y,_.length),F=K=>`
      const inputShape = ${S.indices(...f)};
      ${K.registerUniform("output_size","u32").declareVariables(S,L)}
      ${K.mainStart()}
      ${K.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${L.offsetToIndices("global_idx")};
      var input_indices: ${S.type.indices};
      for (var i = 0; i < ${f.length}; i++) {
        let input_dim_i = ${S.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${L.indicesGet("output_indices","i")}  % input_dim_i;

        ${S.indicesSet("input_indices","i","input_dim_value")}
      }
      ${L.setByOffset("global_idx",S.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${g}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:_,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:12,data:w},...Tt(i[0].dims,_)]}),getShaderSource:F}},_n=i=>{Gt(i.inputs),i.compute(hn(i.inputs),{inputs:[0]})}}),xn,Zn,Hn,Dn=u(()=>{Kt(),zt(),cn(),xn=(i,l,f,g,_)=>{let w=jt("output_data",_,f.length,4),y=et("a_data",l[1].dataType,l[1].dims.length,4),S=et("b_data",l[2].dataType,l[2].dims.length,4),L=et("c_data",l[0].dataType,l[0].dims.length,4),F,K=(W,C,X)=>`select(${C}, ${W}, ${X})`;if(!g)F=w.setByOffset("global_idx",K(y.getByOffset("global_idx"),S.getByOffset("global_idx"),L.getByOffset("global_idx")));else{let W=(C,X,J="")=>{let ne=`a_data[index_a${X}][component_a${X}]`,ce=`b_data[index_b${X}][component_b${X}]`,fe=`bool(c_data[index_c${X}] & (0xffu << (component_c${X} * 8)))`;return`
            let output_indices${X} = ${w.offsetToIndices(`global_idx * 4u + ${X}u`)};
            let offset_a${X} = ${y.broadcastedIndicesToOffset(`output_indices${X}`,w)};
            let offset_b${X} = ${S.broadcastedIndicesToOffset(`output_indices${X}`,w)};
            let offset_c${X} = ${L.broadcastedIndicesToOffset(`output_indices${X}`,w)};
            let index_a${X} = offset_a${X} / 4u;
            let index_b${X} = offset_b${X} / 4u;
            let index_c${X} = offset_c${X} / 4u;
            let component_a${X} = offset_a${X} % 4u;
            let component_b${X} = offset_b${X} % 4u;
            let component_c${X} = offset_c${X} % 4u;
            ${C}[${X}] = ${J}(${K(ne,ce,fe)});
          `};_===9?F=`
            var data = vec4<u32>(0);
            ${W("data",0,"u32")}
            ${W("data",1,"u32")}
            ${W("data",2,"u32")}
            ${W("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:F=`
            ${W("output_data[global_idx]",0)}
            ${W("output_data[global_idx]",1)}
            ${W("output_data[global_idx]",2)}
            ${W("output_data[global_idx]",3)}
          `}return`
        ${i.registerUniform("vec_size","u32").declareVariables(L,y,S,w)}
        ${i.mainStart()}
        ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${F}
      }`},Zn=i=>{let l=i[1].dims,f=i[2].dims,g=i[0].dims,_=i[1].dataType,w=!(We.areEqual(l,f)&&We.areEqual(f,g)),y=l,S=We.size(l);if(w){let F=Sr.calcShape(Sr.calcShape(l,f,!1),g,!1);if(!F)throw new Error("Can't perform where op on the given tensors");y=F,S=We.size(y)}let L=Math.ceil(S/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:F=>xn(F,i,y,w,_),getRunData:()=>({outputs:[{dims:y,dataType:_}],dispatchGroup:{x:Math.ceil(S/64/4)},programUniforms:[{type:12,data:L},...Tt(g,l,f,y)]})}},Hn=i=>{i.compute(Zn(i.inputs))}}),Xn,ir=u(()=>{iy(),vu(),oy(),ay(),ly(),cy(),Wp(),fy(),lm(),my(),gm(),gy(),_y(),yy(),D1(),Da(),vy(),by(),Wm(),_d(),Ty(),Ey(),Py(),fg(),jn(),tg(),xg(),Iy(),Oy(),Ly(),Fy(),Bl(),Ry(),Ny(),Ko(),Ne(),Qt(),sg(),un(),zi(),Ru(),Dn(),Xn=new Map([["Abs",[np]],["Acos",[Tu]],["Acosh",[rp]],["Add",[Op]],["ArgMax",[pu,mu]],["ArgMin",[qf,mu]],["Asin",[sp]],["Asinh",[Eu]],["Atan",[ip]],["Atanh",[op]],["Attention",[Xf]],["AveragePool",[Pg,Eg]],["BatchNormalization",[bu]],["BiasAdd",[tp]],["BiasSplitGelu",[Ap]],["Cast",[ap,Pu]],["Ceil",[up]],["Clip",[cp]],["Concat",[Vp,Up]],["Conv",[ad,sd]],["ConvTranspose",[am,dd]],["Cos",[Su]],["Cosh",[dp]],["CumSum",[um,dm]],["DepthToSpace",[pm,mm]],["DequantizeLinear",[Dg,Lg]],["Div",[Dp]],["Einsum",[xm,Mm]],["Elu",[Cu,Aa]],["Equal",[Nu]],["Erf",[hp]],["Exp",[ku]],["Expand",[Oa]],["FastGelu",[Sm]],["Floor",[fp]],["FusedConv",[ad,sd]],["Gather",[Am,km]],["GatherElements",[wy,tc]],["GatherBlockQuantized",[Fm,Rm]],["GatherND",[Im,Om]],["Gelu",[pp]],["Gemm",[Um,Vm]],["GlobalAveragePool",[Cg,Sg]],["GlobalMaxPool",[$y,$g]],["Greater",[Rp]],["GreaterOrEqual",[Bu]],["GridSample",[Xm,gd]],["GroupQueryAttention",[Md]],["HardSigmoid",[vp,Iu]],["InstanceNormalization",[ag]],["LayerNormalization",[ug]],["LeakyRelu",[Au,Aa]],["Less",[jp]],["LessOrEqual",[Np]],["Log",[Pp]],["MatMul",[hg]],["MatMulNBits",[gg,_g]],["MaxPool",[kg,Ag]],["Mul",[Lp]],["MultiHeadAttention",[yd,Zm]],["Neg",[gp]],["Not",[mp]],["Pad",[Cd]],["Pow",[Fp]],["QuickGelu",[Cp,Aa]],["Range",[Fg]],["Reciprocal",[$u]],["ReduceMin",[Wf]],["ReduceMean",[Bf]],["ReduceMax",[du]],["ReduceSum",[hu]],["ReduceProd",[Gf]],["ReduceL1",[uu]],["ReduceL2",[Vf]],["ReduceLogSum",[Hf]],["ReduceLogSumExp",[Uf]],["ReduceSumSquare",[Kf]],["Relu",[_p]],["Resize",[r_,s_]],["RotaryEmbedding",[sn]],["ScatterND",[zg,Ng]],["Sigmoid",[yp]],["Sin",[wp]],["Sinh",[Ou]],["Slice",[Se,je]],["SkipLayerNormalization",[Hr]],["Split",[wd,rg]],["Sqrt",[bp]],["Softmax",[bt,Et]],["Sub",[zu]],["Tan",[xp]],["Tanh",[Mp]],["ThresholdedRelu",[Ep,Aa]],["Tile",[_n]],["Transpose",[wf,nu]],["Where",[Hn]]])}),Ur,Rr=u(()=>{Xe(),Le(),cn(),Ur=class{constructor(i){this.backend=i,this.repo=new Map,this.attributesBound=!1}getArtifact(i){return this.repo.get(i)}setArtifact(i,l){this.repo.set(i,l)}run(i,l,f,g,_){Qe(i.programInfo.name);let w=this.backend.device,y=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let S=[];for(let F of l)S.push({binding:S.length,resource:{buffer:F.buffer}});for(let F of f)S.push({binding:S.length,resource:{buffer:F.buffer}});_&&S.push({binding:S.length,resource:_});let L=w.createBindGroup({layout:i.computePipeline.getBindGroupLayout(0),entries:S,label:i.programInfo.name});if(this.backend.sessionStatus==="capturing"){let F={kernelId:this.backend.currentKernelId,computePipeline:i.computePipeline,bindGroup:L,dispatchGroup:g};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(F)}y.setPipeline(i.computePipeline),y.setBindGroup(0,L),y.dispatchWorkgroups(...g),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ke(i.programInfo.name)}dispose(){}build(i,l){Qe(i.name);let f=this.backend.device,g=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"},{feature:"subgroups-f16",extension:"subgroups_f16"}].forEach(F=>{f.features.has(F.feature)&&g.push(`enable ${F.extension};`)});let _=gf(l,this.backend.device.limits),w=i.getShaderSource(_),y=`${g.join(`
`)}
${_.additionalImplementations}
${w}`,S=f.createShaderModule({code:y,label:i.name});Mn("verbose",()=>`[WebGPU] ${i.name} shader code: ${y}`);let L=f.createComputePipeline({compute:{module:S,entryPoint:"main"},layout:"auto",label:i.name});return Ke(i.name),{programInfo:i,computePipeline:L,uniformVariablesInfo:_.variablesInfo}}normalizeDispatchGroupSize(i){let l=typeof i=="number"?i:i.x,f=typeof i=="number"?1:i.y||1,g=typeof i=="number"?1:i.z||1,_=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(l<=_&&f<=_&&g<=_)return[l,f,g];let w=l*f*g,y=Math.ceil(Math.sqrt(w));if(y>_){if(y=Math.ceil(Math.cbrt(w)),y>_)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[y,y,y]}else return[y,y,1]}}}),Ns,Ho,Rd,ds,Js,a_=u(()=>{Xe(),Kt(),Le(),ae(),En(),ir(),Rr(),Ns=(i,l)=>{if(l.length!==i.length)throw new Error(`inputDependencies length ${l.length} is not equal to inputTensors length ${i.length}.`);let f=[];for(let g=0;g<i.length;++g){let _=i[g].dataType;switch(l[g]){case"none":{f.push("");break}case"type":{f.push(`${_}`);break}case"rank":{let w=i[g].dims.length;f.push(`${_};${w}`);break}case"dims":{let w=i[g].dims.join(",");f.push(`${_};${w}`);break}default:throw new Error(`unsupported input dependency: ${l[g]}`)}}return f.join("|")},Ho=(i,l,f)=>{var _,w;let g=i.name;return(_=i.shaderCache)!=null&&_.hint&&(g+="["+i.shaderCache.hint+"]"),g+=":"+f+`:${Ns(l,((w=i.shaderCache)==null?void 0:w.inputDependencies)??new Array(l.length).fill("dims"))}`,g},Rd=class{constructor(i){i&&(this.architecture=i.architecture,this.vendor=i.vendor)}isArchitecture(i){return this.architecture===i}isVendor(i){return this.vendor===i}},ds=class{constructor(i){this.subgroupsSupported=i.features.has("subgroups"),this.subgroupsF16Supported=i.features.has("subgroups");let l=i.limits;!this.subgroupsSupported||!l.minSubgroupSize||!l.maxSubgroupSize?this.subgroupSizeRange=void 0:this.subgroupSizeRange=[l.minSubgroupSize,l.maxSubgroupSize]}},Js=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let i=this.kernelCustomData.get(this.currentKernelId);return i||(i={},this.kernelCustomData.set(this.currentKernelId,i)),i}async initialize(i,l){this.env=i;let f=[],g={requiredLimits:{maxComputeWorkgroupStorageSize:l.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:l.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:l.limits.maxStorageBufferBindingSize,maxBufferSize:l.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:l.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:l.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:l.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:l.limits.maxComputeWorkgroupSizeZ},requiredFeatures:f},_=w=>l.features.has(w)&&f.push(w)&&!0;_("chromium-experimental-timestamp-query-inside-passes")||_("timestamp-query"),_("shader-f16"),_("subgroups")&&_("subgroups-f16"),this.device=await l.requestDevice(g),this.deviceInfo=new ds(this.device),this.adapterInfo=new Rd(l.info||await l.requestAdapterInfo()),this.gpuDataManager=In(this),this.programManager=new Ur(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Wo(i.logLevel,!!i.debug),this.device.onuncapturederror=w=>{w.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${w.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:l,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let i=this.getCommandEncoder(),l={};this.queryType==="at-passes"&&(l.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=i.beginComputePass(l)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Qe(),this.endComputePass();let i;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),i=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(i,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,i,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&i.mapAsync(GPUMapMode.READ).then(()=>{var g;let l=new BigUint64Array(i.getMappedRange()),f=this.pendingQueries.get(i);for(let _=0;_<l.length/2;_++){let w=f[_],y=w.kernelId,S=this.kernels.get(y),L=S.kernelType,F=S.kernelName,K=w.programName,W=w.inputTensorViews,C=w.outputTensorViews,X=l[_*2],J=l[_*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=X);let ne=Number(X-this.queryTimeBase),ce=Number(J-this.queryTimeBase);if(!Number.isSafeInteger(ne)||!Number.isSafeInteger(ce))throw new RangeError("incorrect timestamp range");if((g=this.env.webgpu.profiling)!=null&&g.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:W.map(fe=>({dims:fe.dims,dataType:Ds(fe.dataType)})),outputsMetadata:C.map(fe=>({dims:fe.dims,dataType:Ds(fe.dataType)})),kernelId:y,kernelType:L,kernelName:F,programName:K,startTime:ne,endTime:ce});else{let fe="";W.forEach((Te,Me)=>{fe+=`input[${Me}]: [${Te.dims}] | ${Ds(Te.dataType)}, `});let le="";C.forEach((Te,Me)=>{le+=`output[${Me}]: [${Te.dims}] | ${Ds(Te.dataType)}, `}),console.log(`[profiling] kernel "${y}|${L}|${F}|${K}" ${fe}${le}execution time: ${ce-ne} ns`)}He("GPU",`${K}::${X}::${J}`)}i.unmap(),this.pendingQueries.delete(i)}),Ke()}run(i,l,f,g,_,w){Qe(i.name);let y=[];for(let le=0;le<l.length;++le){let Te=l[le].data;if(Te===0)continue;let Me=this.gpuDataManager.get(Te);if(!Me)throw new Error(`no GPU data for input: ${Te}`);y.push(Me)}let{outputs:S,dispatchGroup:L,programUniforms:F}=i.getRunData(l),K=f.length===0?S.map((le,Te)=>Te):f;if(K.length!==S.length)throw new Error(`Output size ${K.length} must be equal to ${S.length}.`);let W=[],C=[];for(let le=0;le<S.length;++le){if(!Number.isInteger(K[le])||K[le]<-3||K[le]>=w)throw new Error(`Invalid output index: ${K[le]}`);if(K[le]===-3)continue;let Te=K[le]===-1,Me=K[le]===-2,$e=Te||Me?_(S[le].dataType,S[le].dims):g(K[le],S[le].dataType,S[le].dims);if(W.push($e),$e.data===0)continue;let ze=this.gpuDataManager.get($e.data);if(!ze)throw new Error(`no GPU data for output: ${$e.data}`);if(Te&&this.temporaryData.push(ze),Me){let Ve=this.kernelPersistentData.get(this.currentKernelId);Ve||(Ve=[],this.kernelPersistentData.set(this.currentKernelId,Ve)),Ve.push(ze)}C.push(ze)}if(y.length!==l.length||C.length!==W.length){if(C.length===0)return Ke(i.name),W;throw new Error(`Program ${i.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let X;if(F){let le=0,Te=[];F.forEach(Ve=>{let st=typeof Ve.data=="number"?[Ve.data]:Ve.data;if(st.length===0)return;let pt=Ve.type===10?2:4,$t,on;Ve.type===10?(on=st.length>4?16:st.length>2?8:st.length*pt,$t=st.length>4?16:pt*st.length):(on=st.length<=2?st.length*pt:16,$t=16),le=Math.ceil(le/on)*on,Te.push(le);let dn=Ve.type===10?8:4;le+=st.length>4?Math.ceil(st.length/dn)*$t:st.length*pt});let Me=16;le=Math.ceil(le/Me)*Me;let $e=new ArrayBuffer(le);F.forEach((Ve,st)=>{let pt=Te[st],$t=typeof Ve.data=="number"?[Ve.data]:Ve.data;if(Ve.type===6)new Int32Array($e,pt,$t.length).set($t);else if(Ve.type===12)new Uint32Array($e,pt,$t.length).set($t);else if(Ve.type===10)new Uint16Array($e,pt,$t.length).set($t);else if(Ve.type===1)new Float32Array($e,pt,$t.length).set($t);else throw new Error(`Unsupported uniform type: ${Ds(Ve.type)}`)});let ze=this.gpuDataManager.create(le,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(ze.buffer,0,$e,0,le),this.gpuDataManager.release(ze.id),X={offset:0,size:le,buffer:ze.buffer}}let J=this.programManager.normalizeDispatchGroupSize(L),ne=J[1]===1&&J[2]===1,ce=Ho(i,l,ne),fe=this.programManager.getArtifact(ce);if(fe||(fe=this.programManager.build(i,J),this.programManager.setArtifact(ce,fe),Mn("info",()=>`[artifact] key: ${ce}, programName: ${i.name}`)),F&&fe.uniformVariablesInfo){if(F.length!==fe.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${fe.uniformVariablesInfo.length}, got ${F.length} in program "${fe.programInfo.name}".`);for(let le=0;le<F.length;le++){let Te=F[le],Me=Te.type,$e=typeof Te.data=="number"?1:Te.data.length,[ze,Ve]=fe.uniformVariablesInfo[le];if(Me!==ze||$e!==Ve)throw new Error(`Uniform variable ${le} mismatch: expect type ${ze} with size ${Ve}, got type ${Me} with size ${$e} in program "${fe.programInfo.name}".`)}}if(Mn("info",()=>`[ProgramManager] run "${i.name}" (key=${ce}) with ${J[0]}x${J[1]}x${J[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let le={kernelId:this.currentKernelId,programName:fe.programInfo.name,inputTensorViews:l,outputTensorViews:W};this.pendingKernels.push(le),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(le)}return this.programManager.run(fe,y,C,J,X),Ke(i.name),W}upload(i,l){this.gpuDataManager.upload(i,l)}memcpy(i,l){this.gpuDataManager.memcpy(i,l)}async download(i,l){await this.gpuDataManager.download(i,l)}alloc(i){return this.gpuDataManager.create(i).id}free(i){return this.gpuDataManager.release(i)}createKernel(i,l,f,g){let _=Xn.get(i);if(!_)throw new Error(`kernel not implemented: ${i}`);let w={kernelType:i,kernelName:g,kernelEntry:_[0],attributes:[_[1],f]};this.kernels.set(l,w)}releaseKernel(i){let l=this.kernelPersistentData.get(i);if(l){for(let f of l)this.gpuDataManager.release(f.id);this.kernelPersistentData.delete(i)}this.kernelCustomData.delete(i),this.kernels.delete(i)}computeKernel(i,l,f){let g=this.kernels.get(i);if(!g)throw new Error(`kernel not created: ${i}`);let _=g.kernelType,w=g.kernelName,y=g.kernelEntry,S=g.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${_}] ${w}" is not allowed to be called recursively`);this.currentKernelId=i,S[0]&&(S[1]=S[0](S[1]),S[0]=void 0),Mn("info",()=>`[WebGPU] Start to run kernel "[${_}] ${w}"...`);let L=this.env.debug;this.temporaryData=[];try{return L&&this.device.pushErrorScope("validation"),y(l,S[1]),0}catch(F){return f.push(Promise.resolve(`[WebGPU] Kernel "[${_}] ${w}" failed. ${F}`)),1}finally{L&&f.push(this.device.popErrorScope().then(F=>F?`GPU validation error for kernel "[${_}] ${w}": ${F.message}`:null));for(let F of this.temporaryData)this.gpuDataManager.release(F.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(i,l,f,g){let _=this.sessionExternalDataMapping.get(i);_||(_=new Map,this.sessionExternalDataMapping.set(i,_));let w=_.get(l),y=this.gpuDataManager.registerExternalBuffer(f,g,w);return _.set(l,[y,f]),y}unregisterBuffers(i){let l=this.sessionExternalDataMapping.get(i);l&&(l.forEach(f=>this.gpuDataManager.unregisterExternalBuffer(f[0])),this.sessionExternalDataMapping.delete(i))}getBuffer(i){let l=this.gpuDataManager.get(i);if(!l)throw new Error(`no GPU data for buffer: ${i}`);return l.buffer}createDownloader(i,l,f){return async()=>{let g=await Ct(this,i,l);return G(g.buffer,f)}}writeTimestamp(i){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,i)}setQueryType(){var i;this.queryType="none",(((i=this.env.webgpu.profiling)==null?void 0:i.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Mn("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Mn("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Mn("info","replay"),this.sessionStatus="replaying";let i=this.capturedCommandList.get(this.currentSessionId),l=this.capturedPendingKernels.get(this.currentSessionId),f=i.length;this.pendingKernels=[];for(let g=0;g<f;g++){let _=this.getComputePassEncoder(),w=i[g];this.writeTimestamp(this.pendingDispatchNumber*2),_.setPipeline(w.computePipeline),_.setBindGroup(0,w.bindGroup),_.dispatchWorkgroups(...w.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(l[g]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(i){this.unregisterBuffers(i),this.capturedCommandList.has(i)&&this.capturedCommandList.delete(i),this.capturedPendingKernels.has(i)&&this.capturedPendingKernels.delete(i),this.gpuDataManager.onReleaseSession(i)}onRunStart(i){this.currentSessionId=i,this.setQueryType()}}}),ac,Ra,lc,qn,mr,vi,fo,qo,jd=u(()=>{Le(),ac=1,Ra=()=>ac++,lc=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),qn=(i,l)=>{let f=lc.get(i);if(!f)throw new Error("Unsupported data type.");return l.length>0?Math.ceil(l.reduce((g,_)=>g*_)*f/8):0},mr=class{constructor(i){this.sessionId=i.sessionId,this.mlContext=i.context,this.mlTensor=i.tensor,this.dataType=i.dataType,this.tensorShape=i.shape}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return qn(this.dataType,this.tensorShape)}destroy(){Mn("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(i){this.mlContext.writeTensor(this.mlTensor,i)}async read(i){return i?this.mlContext.readTensor(this.mlTensor,i):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(i,l,f){return this.mlContext===i&&this.dataType===l&&this.tensorShape.length===f.length&&this.tensorShape.every((g,_)=>g===f[_])}},vi=class{constructor(i,l){this.tensorManager=i,this.wrapper=l}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(i,l,f,g){if(this.wrapper){if(this.wrapper.canReuseTensor(i,l,f))return this.wrapper.tensor;if(g){if(this.wrapper.byteLength!==qn(l,f))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let _=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(l,f,_,!0,!0),g&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(i){if(this.wrapper)if(i.byteLength===this.wrapper.byteLength){this.wrapper.write(i);return}else Mn("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(i):this.activeUpload=new Uint8Array(i)}async download(i){if(this.activeUpload)if(i){i instanceof ArrayBuffer?new Uint8Array(i).set(this.activeUpload):new Uint8Array(i.buffer,i.byteOffset,i.byteLength).set(this.activeUpload);return}else return this.activeUpload.buffer;if(!this.wrapper)throw new Error("Tensor has not been created.");return i?this.wrapper.read(i):this.wrapper.read()}},fo=class{constructor(i){this.backend=i,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}reserveTensorId(){let i=Ra();return this.tensorTrackersById.set(i,new vi(this)),i}releaseTensorId(i){let l=this.tensorTrackersById.get(i);l&&(this.tensorTrackersById.delete(i),l.tensorWrapper&&this.releaseTensor(l.tensorWrapper))}async ensureTensor(i,l,f,g){Mn("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${i}, dataType: ${l}, shape: ${f}, copyOld: ${g}}`);let _=this.tensorTrackersById.get(i);if(!_)throw new Error("Tensor not found.");return _.ensureTensor(this.backend.currentContext,l,f,g)}upload(i,l){let f=this.tensorTrackersById.get(i);if(!f)throw new Error("Tensor not found.");f.upload(l)}async download(i,l){Mn("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${i}, dstBuffer: ${l==null?void 0:l.byteLength}}`);let f=this.tensorTrackersById.get(i);if(!f)throw new Error("Tensor not found.");return f.download(l)}releaseTensorsForSession(i){for(let l of this.freeTensors)l.sessionId===i&&l.destroy();this.freeTensors=this.freeTensors.filter(l=>l.sessionId!==i)}registerTensor(i,l,f,g){let _=Ra(),w=new mr({sessionId:this.backend.currentSessionId,context:i,tensor:l,dataType:f,shape:g});return this.tensorTrackersById.set(_,new vi(this,w)),this.externalTensors.add(w),_}async getCachedTensor(i,l,f,g,_){let w=this.backend.currentSessionId,y=this.backend.currentContext;for(let[L,F]of this.freeTensors.entries())if(F.canReuseTensor(y,i,l)){Mn("verbose",()=>`[WebNN] Reusing tensor {dataType: ${i}, shape: ${l}}`);let K=this.freeTensors.splice(L,1)[0];return K.sessionId=w,K}Mn("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${i}, shape: ${l}}`);let S=await y.createTensor({dataType:i,shape:l,dimensions:l,usage:f,writable:g,readable:_});return new mr({sessionId:w,context:y,tensor:S,dataType:i,shape:l})}releaseTensor(i){this.externalTensors.has(i)&&this.externalTensors.delete(i),this.freeTensors.push(i)}},qo=(...i)=>new fo(...i)}),cc,Nd,zd,L1=u(()=>{Kt(),cs(),ae(),jd(),Le(),cc=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),Nd=(i,l)=>{if(i===l)return!0;if(i===void 0||l===void 0)return!1;let f=Object.keys(i).sort(),g=Object.keys(l).sort();return f.length===g.length&&f.every((_,w)=>_===g[w]&&i[_]===l[_])},zd=class{constructor(i){this.tensorManager=qo(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],Wo(i.logLevel,!!i.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(i){this.activeSessionId=i}async createMLContext(i){if(i instanceof GPUDevice){let f=this.mlContextCache.findIndex(g=>g.gpuDevice===i);if(f!==-1)return this.mlContextCache[f].mlContext;{let g=await navigator.ml.createContext(i);return this.mlContextCache.push({gpuDevice:i,mlContext:g}),g}}else if(i===void 0){let f=this.mlContextCache.findIndex(g=>g.options===void 0&&g.gpuDevice===void 0);if(f!==-1)return this.mlContextCache[f].mlContext;{let g=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:g}),g}}let l=this.mlContextCache.findIndex(f=>Nd(f.options,i));if(l!==-1)return this.mlContextCache[l].mlContext;{let f=await navigator.ml.createContext(i);return this.mlContextCache.push({options:i,mlContext:f}),f}}get currentContext(){let i=this.getMLContext(this.currentSessionId);if(!i)throw new Error(`No MLContext found for session ${this.currentSessionId}`);return i}registerMLContext(i,l){this.mlContextBySessionId.set(i,l);let f=this.sessionIdsByMLContext.get(l);f||(f=new Set,this.sessionIdsByMLContext.set(l,f)),f.add(i)}onReleaseSession(i){let l=this.mlContextBySessionId.get(i);if(!l)return;this.tensorManager.releaseTensorsForSession(i),this.mlContextBySessionId.delete(i);let f=this.sessionIdsByMLContext.get(l);if(f.delete(i),f.size===0){this.sessionIdsByMLContext.delete(l);let g=this.mlContextCache.findIndex(_=>_.mlContext===l);g!==-1&&this.mlContextCache.splice(g,1)}}getMLContext(i){return this.mlContextBySessionId.get(i)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(i){Mn("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${i}}`),this.tensorManager.releaseTensorId(i)}async ensureTensor(i,l,f,g){let _=cc.get(l);if(!_)throw new Error(`Unsupported ONNX data type: ${l}`);return this.tensorManager.ensureTensor(i,_,f,g)}uploadTensor(i,l){if(!Bn().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Mn("verbose",()=>`[WebNN] uploadTensor {tensorId: ${i}, data: ${l.byteLength}}`),this.tensorManager.upload(i,l)}async downloadTensor(i,l){return this.tensorManager.download(i,l)}createMLTensorDownloader(i,l){return async()=>{let f=await this.tensorManager.download(i);return G(f,l)}}registerMLTensor(i,l,f){let g=cc.get(l);if(!g)throw new Error(`Unsupported ONNX data type: ${l}`);let _=this.tensorManager.registerTensor(this.currentContext,i,g,f);return Mn("verbose",()=>`[WebNN] registerMLTensor {tensor: ${i}, dataType: ${g}, dimensions: ${f}} -> {tensorId: ${_}}`),_}registerMLConstant(i,l,f,g,_,w){if(!w)throw new Error("External mounted files are not available.");let y=i;i.startsWith("./")&&(y=i.substring(2));let S=w.get(y);if(!S)throw new Error(`File with name ${y} not found in preloaded files.`);if(l+f>S.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let L=S.slice(l,l+f).buffer,F;switch(_.dataType){case"float32":F=new Float32Array(L);break;case"float16":F=new Uint16Array(L);break;case"int32":F=new Int32Array(L);break;case"uint32":F=new Uint32Array(L);break;case"int64":F=new BigInt64Array(L);break;case"uint64":F=new BigUint64Array(L);break;case"int8":F=new Int8Array(L);break;case"int4":case"uint4":case"uint8":F=new Uint8Array(L);break;default:throw new Error(`Unsupported data type: ${_.dataType} in creating WebNN Constant from external data.`)}return Mn("verbose",()=>`[WebNN] registerMLConstant {dataType: ${_.dataType}, shape: ${_.shape}}}`),g.constant(_,F)}flush(){}}}),Bd={};d(Bd,{init:()=>l_});var Qo,Vd,l_,c_=u(()=>{Kt(),a_(),Le(),zt(),L1(),Qo=class rF{constructor(l,f,g,_){this.module=l,this.dataType=f,this.data=g,this.dims=_}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let l=We.size(this.dims);return l===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,l)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let l=We.size(this.dims);return l===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,l)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let l=We.size(this.dims);return l===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,l)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let l=We.size(this.dims);return l===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,l)}reshape(l){if(We.size(l)!==We.size(this.dims))throw new Error("Invalid new shape");return new rF(this.module,this.dataType,this.data,l)}},Vd=class{constructor(i,l,f){this.module=i,this.backend=l,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=l.adapterInfo,this.deviceInfo=l.deviceInfo;let g=i.PTR_SIZE,_=f/i.PTR_SIZE,w=g===4?"i32":"i64";this.opKernelContext=Number(i.getValue(g*_++,w));let y=Number(i.getValue(g*_++,w));this.outputCount=Number(i.getValue(g*_++,w)),this.customDataOffset=Number(i.getValue(g*_++,"*")),this.customDataSize=Number(i.getValue(g*_++,w));let S=[];for(let L=0;L<y;L++){let F=Number(i.getValue(g*_++,w)),K=Number(i.getValue(g*_++,"*")),W=Number(i.getValue(g*_++,w)),C=[];for(let X=0;X<W;X++)C.push(Number(i.getValue(g*_++,w)));S.push(new Qo(i,F,K,C))}this.inputs=S}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(i,l){var y;let f=((y=l==null?void 0:l.inputs)==null?void 0:y.map(S=>typeof S=="number"?this.inputs[S]:S))??this.inputs,g=(l==null?void 0:l.outputs)??[],_=(S,L,F)=>new Qo(this.module,L,this.output(S,F),F),w=(S,L)=>{let F=us(S,L);if(!F)throw new Error(`Unsupported data type: ${S}`);let K=F>0?this.backend.gpuDataManager.create(F).id:0;return new Qo(this.module,S,K,L)};return this.backend.run(i,f,g,_,w,this.outputCount)}output(i,l){let f=this.module.stackSave();try{let g=this.module.PTR_SIZE,_=g===4?"i32":"i64",w=this.module.stackAlloc((1+l.length)*g);this.module.setValue(w,l.length,_);for(let y=0;y<l.length;y++)this.module.setValue(w+g*(y+1),l[y],_);return this.module._JsepOutput(this.opKernelContext,i,w)}catch(g){throw new Error(`Failed to generate kernel's output[${i}] with dims [${l}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${g}`)}finally{this.module.stackRestore(f)}}},l_=async(i,l,f,g)=>{let _=l.jsepInit;if(!_)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(i==="webgpu"){let w=new Js;await w.initialize(f,g),_("webgpu",[w,y=>w.alloc(Number(y)),y=>w.free(y),(y,S,L,F=!1)=>{if(F)Mn("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(y)}, dst=${Number(S)}, size=${Number(L)}`),w.memcpy(Number(y),Number(S));else{Mn("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(y)}, gpuDataId=${Number(S)}, size=${Number(L)}`);let K=l.HEAPU8.subarray(Number(y>>>0),Number(y>>>0)+Number(L));w.upload(Number(S),K)}},async(y,S,L)=>{Mn("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${y}, dataOffset=${S}, size=${L}`),await w.download(Number(y),()=>l.HEAPU8.subarray(Number(S)>>>0,Number(S+L)>>>0))},(y,S,L)=>w.createKernel(y,Number(S),L,l.UTF8ToString(l._JsepGetNodeName(Number(S)))),y=>w.releaseKernel(y),(y,S,L,F)=>{Mn("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${L}, kernel=${y}, contextDataOffset=${S}`);let K=new Vd(l,w,Number(S));return w.computeKernel(Number(y),K,F)},()=>w.captureBegin(),()=>w.captureEnd(),()=>w.replay()])}else{let w=new zd(f);_("webnn",[w,()=>w.reserveTensorId(),y=>w.releaseTensorId(y),async(y,S,L,F)=>w.ensureTensor(y,S,L,F),(y,S)=>{w.uploadTensor(y,S)},async(y,S)=>w.downloadTensor(y,S)])}}}),uc,u_,d_,po,mo,hs,F1,R1,j1,N1,z1,B1,g2=u(()=>{Fl(),Rl(),Kt(),cs(),jo(),Ta(),uc=(i,l)=>{Bn()._OrtInit(i,l)!==0&&fn("Can't initialize onnxruntime.")},u_=async i=>{uc(i.wasm.numThreads,oo(i.logLevel))},d_=async(i,l)=>{{let f=(c_(),m(Bd)).init;if(l==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let g=i.webgpu.adapter;if(g){if(typeof g.limits!="object"||typeof g.features!="object"||typeof g.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let _=i.webgpu.powerPreference;if(_!==void 0&&_!=="low-power"&&_!=="high-performance")throw new Error(`Invalid powerPreference setting: "${_}"`);let w=i.webgpu.forceFallbackAdapter;if(w!==void 0&&typeof w!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${w}"`);if(g=await navigator.gpu.requestAdapter({powerPreference:_,forceFallbackAdapter:w}),!g)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await f("webgpu",Bn(),i,g)}if(l==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await f("webnn",Bn(),i)}}},po=new Map,mo=i=>{let l=Bn(),f=l.stackSave();try{let g=l.PTR_SIZE,_=l.stackAlloc(2*g);l._OrtGetInputOutputCount(i,_,_+g)!==0&&fn("Can't get session input/output count.");let w=g===4?"i32":"i64";return[Number(l.getValue(_,w)),Number(l.getValue(_+g,w))]}finally{l.stackRestore(f)}},hs=i=>{let l=Bn(),f=l._malloc(i.byteLength);if(f===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${i.byteLength}.`);return l.HEAPU8.set(i,f),[f,i.byteLength]},F1=async(i,l)=>{var W,C,X;let f,g,_=Bn();Array.isArray(i)?[f,g]=i:i.buffer===_.HEAPU8.buffer?[f,g]=[i.byteOffset,i.byteLength]:[f,g]=hs(i);let w=0,y=0,S=0,L=[],F=[],K=[];try{if([y,L]=Ma(l),(l==null?void 0:l.externalData)&&_.mountExternalData){let $e=[];for(let ze of l.externalData){let Ve=typeof ze=="string"?ze:ze.path;$e.push(Uo(typeof ze=="string"?ze:ze.data).then(st=>{_.mountExternalData(Ve,st)}))}await Promise.all($e)}for(let $e of(l==null?void 0:l.executionProviders)??[])if((typeof $e=="string"?$e:$e.name)==="webnn"){if(_.shouldTransferToMLTensor=!1,typeof $e!="string"){let ze=$e,Ve=ze==null?void 0:ze.context,st=ze==null?void 0:ze.gpuDevice,pt=ze==null?void 0:ze.deviceType,$t=ze==null?void 0:ze.powerPreference;Ve?_.currentContext=Ve:st?_.currentContext=await _.jsepCreateMLContext(st):_.currentContext=await _.jsepCreateMLContext({deviceType:pt,powerPreference:$t})}else _.currentContext=await _.jsepCreateMLContext();break}w=await _._OrtCreateSession(f,g,y),w===0&&fn("Can't create a session."),(W=_.jsepOnCreateSession)==null||W.call(_),_.currentContext&&(_.jsepRegisterMLContext(w,_.currentContext),_.currentContext=void 0,_.shouldTransferToMLTensor=!0);let[J,ne]=mo(w),ce=!!(l!=null&&l.enableGraphCapture),fe=[],le=[],Te=[];for(let $e=0;$e<J;$e++){let ze=_._OrtGetInputName(w,$e);ze===0&&fn("Can't get an input name."),F.push(ze),fe.push(_.UTF8ToString(ze))}for(let $e=0;$e<ne;$e++){let ze=_._OrtGetOutputName(w,$e);ze===0&&fn("Can't get an output name."),K.push(ze);let Ve=_.UTF8ToString(ze);le.push(Ve);{if(ce&&(l==null?void 0:l.preferredOutputLocation)===void 0){Te.push("gpu-buffer");continue}let st=typeof(l==null?void 0:l.preferredOutputLocation)=="string"?l.preferredOutputLocation:((C=l==null?void 0:l.preferredOutputLocation)==null?void 0:C[Ve])??"cpu";if(st!=="cpu"&&st!=="cpu-pinned"&&st!=="gpu-buffer"&&st!=="ml-tensor")throw new Error(`Not supported preferred output location: ${st}.`);if(ce&&st!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${st}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);Te.push(st)}}let Me=null;return Te.some($e=>$e==="gpu-buffer"||$e==="ml-tensor")&&(S=_._OrtCreateBinding(w),S===0&&fn("Can't create IO binding."),Me={handle:S,outputPreferredLocations:Te,outputPreferredLocationsEncoded:Te.map($e=>Vo($e))}),po.set(w,[w,F,K,Me,ce,!1]),[w,fe,le]}catch(J){throw F.forEach(ne=>_._OrtFree(ne)),K.forEach(ne=>_._OrtFree(ne)),S!==0&&_._OrtReleaseBinding(S)!==0&&fn("Can't release IO binding."),w!==0&&_._OrtReleaseSession(w)!==0&&fn("Can't release session."),J}finally{_._free(f),y!==0&&_._OrtReleaseSessionOptions(y)!==0&&fn("Can't release session options."),L.forEach(J=>_._free(J)),(X=_.unmountExternalData)==null||X.call(_)}},R1=i=>{var L;let l=Bn(),f=po.get(i);if(!f)throw new Error(`cannot release session. invalid session id: ${i}`);let[g,_,w,y,S]=f;y&&(S&&l._OrtClearBoundOutputs(y.handle)!==0&&fn("Can't clear bound outputs."),l._OrtReleaseBinding(y.handle)!==0&&fn("Can't release IO binding.")),(L=l.jsepOnReleaseSession)==null||L.call(l,i),_.forEach(F=>l._OrtFree(F)),w.forEach(F=>l._OrtFree(F)),l._OrtReleaseSession(g)!==0&&fn("Can't release session."),po.delete(i)},j1=(i,l,f,g,_,w=!1)=>{if(!i){l.push(0);return}let y=Bn(),S=y.PTR_SIZE,L=i[0],F=i[1],K=i[3],W,C;if(L==="string"&&(K==="gpu-buffer"||K==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(w&&K!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${_} when enableGraphCapture is true.`);if(K==="gpu-buffer"){let ne=i[2].gpuBuffer;C=us(ji(L),F);let ce=y.jsepRegisterBuffer;if(!ce)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');W=ce(g,_,ne,C)}else if(K==="ml-tensor"){let ne=i[2].mlTensor;C=us(ji(L),F);let ce=y.jsepRegisterMLTensor;if(!ce)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');W=ce(ne,ji(L),F)}else{let ne=i[2];if(Array.isArray(ne)){C=S*ne.length,W=y._malloc(C),f.push(W);for(let ce=0;ce<ne.length;ce++){if(typeof ne[ce]!="string")throw new TypeError(`tensor data at index ${ce} is not a string`);y.setValue(W+ce*S,sr(ne[ce],f),"*")}}else C=ne.byteLength,W=y._malloc(C),f.push(W),y.HEAPU8.set(new Uint8Array(ne.buffer,ne.byteOffset,C),W)}let X=y.stackSave(),J=y.stackAlloc(4*F.length);try{F.forEach((ce,fe)=>y.setValue(J+fe*S,ce,S===4?"i32":"i64"));let ne=y._OrtCreateTensor(ji(L),W,C,J,F.length,Vo(K));ne===0&&fn(`Can't create tensor for input/output. session=${g}, index=${_}.`),l.push(ne)}finally{y.stackRestore(X)}},N1=async(i,l,f,g,_,w)=>{var on,dn;let y=Bn(),S=y.PTR_SIZE,L=po.get(i);if(!L)throw new Error(`cannot run inference. invalid session id: ${i}`);let F=L[0],K=L[1],W=L[2],C=L[3],X=L[4],J=L[5],ne=l.length,ce=g.length,fe=0,le=[],Te=[],Me=[],$e=[],ze=y.stackSave(),Ve=y.stackAlloc(ne*S),st=y.stackAlloc(ne*S),pt=y.stackAlloc(ce*S),$t=y.stackAlloc(ce*S);try{(on=y.jsepOnRunStart)==null||on.call(y,F),[fe,le]=Fi(w);for(let Lt=0;Lt<ne;Lt++)j1(f[Lt],Te,$e,i,l[Lt],X);for(let Lt=0;Lt<ce;Lt++)j1(_[Lt],Me,$e,i,ne+g[Lt],X);for(let Lt=0;Lt<ne;Lt++)y.setValue(Ve+Lt*S,Te[Lt],"*"),y.setValue(st+Lt*S,K[l[Lt]],"*");for(let Lt=0;Lt<ce;Lt++)y.setValue(pt+Lt*S,Me[Lt],"*"),y.setValue($t+Lt*S,W[g[Lt]],"*");if(C&&!J){let{handle:Lt,outputPreferredLocations:Bt,outputPreferredLocationsEncoded:Vn}=C;if(K.length!==ne)throw new Error(`input count from feeds (${ne}) is expected to be always equal to model's input count (${K.length}).`);for(let nn=0;nn<ne;nn++){let qt=l[nn];await y._OrtBindInput(Lt,K[qt],Te[nn])!==0&&fn(`Can't bind input[${nn}] for session=${i}.`)}for(let nn=0;nn<ce;nn++){let qt=g[nn];(dn=_[nn])!=null&&dn[3]?y._OrtBindOutput(Lt,W[qt],Me[nn],0)!==0&&fn(`Can't bind pre-allocated output[${nn}] for session=${i}.`):y._OrtBindOutput(Lt,W[qt],0,Vn[qt])!==0&&fn(`Can't bind output[${nn}] to ${Bt[nn]} for session=${i}.`)}po.set(i,[F,K,W,C,X,!0])}let Pt;C?Pt=await y._OrtRunWithBinding(F,C.handle,ce,pt,fe):Pt=await y._OrtRun(F,st,Ve,ne,$t,ce,pt,fe),Pt!==0&&fn("failed to call OrtRun().");let pn=[];for(let Lt=0;Lt<ce;Lt++){let Bt=Number(y.getValue(pt+Lt*S,"*"));if(Bt===Me[Lt]){pn.push(_[Lt]);continue}let Vn=y.stackSave(),nn=y.stackAlloc(4*S),qt=!1,Ln,dt=0;try{y._OrtGetTensorData(Bt,nn,nn+S,nn+2*S,nn+3*S)!==0&&fn(`Can't access output tensor data on index ${Lt}.`);let It=S===4?"i32":"i64",Sn=Number(y.getValue(nn,It));dt=y.getValue(nn+S,"*");let vr=y.getValue(nn+S*2,"*"),Bs=Number(y.getValue(nn+S*3,It)),Wr=[];for(let gr=0;gr<Bs;gr++)Wr.push(Number(y.getValue(vr+gr*S,It)));y._OrtFree(vr)!==0&&fn("Can't free memory for tensor dims.");let go=Wr.reduce((gr,Qn)=>gr*Qn,1);Ln=Ds(Sn);let fc=C==null?void 0:C.outputPreferredLocations[g[Lt]];if(Ln==="string"){if(fc==="gpu-buffer"||fc==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let gr=[];for(let Qn=0;Qn<go;Qn++){let Na=y.getValue(dt+Qn*S,"*"),p_=y.getValue(dt+(Qn+1)*S,"*"),K1=Qn===go-1?void 0:p_-Na;gr.push(y.UTF8ToString(Na,K1))}pn.push([Ln,Wr,gr,"cpu"])}else if(fc==="gpu-buffer"&&go>0){let gr=y.jsepGetBuffer;if(!gr)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Qn=gr(dt),Na=us(Sn,go);if(Na===void 0||!zo(Ln))throw new Error(`Unsupported data type: ${Ln}`);qt=!0,pn.push([Ln,Wr,{gpuBuffer:Qn,download:y.jsepCreateDownloader(Qn,Na,Ln),dispose:()=>{y._OrtReleaseTensor(Bt)!==0&&fn("Can't release tensor.")}},"gpu-buffer"])}else if(fc==="ml-tensor"&&go>0){let gr=y.jsepEnsureTensor;if(!gr)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(us(Sn,go)===void 0||!Bo(Ln))throw new Error(`Unsupported data type: ${Ln}`);let Qn=await gr(dt,Sn,Wr,!1);qt=!0,pn.push([Ln,Wr,{mlTensor:Qn,download:y.jsepCreateMLTensorDownloader(dt,Ln),dispose:()=>{y.jsepReleaseTensorId(dt),y._OrtReleaseTensor(Bt)}},"ml-tensor"])}else{let gr=No(Ln),Qn=new gr(go);new Uint8Array(Qn.buffer,Qn.byteOffset,Qn.byteLength).set(y.HEAPU8.subarray(dt,dt+Qn.byteLength)),pn.push([Ln,Wr,Qn,"cpu"])}}finally{y.stackRestore(Vn),Ln==="string"&&dt&&y._free(dt),qt||y._OrtReleaseTensor(Bt)}}return C&&!X&&(y._OrtClearBoundOutputs(C.handle)!==0&&fn("Can't clear bound outputs."),po.set(i,[F,K,W,C,X,!1])),pn}finally{y.stackRestore(ze),Te.forEach(Pt=>y._OrtReleaseTensor(Pt)),Me.forEach(Pt=>y._OrtReleaseTensor(Pt)),$e.forEach(Pt=>y._free(Pt)),fe!==0&&y._OrtReleaseRunOptions(fe),le.forEach(Pt=>y._free(Pt))}},z1=i=>{let l=Bn(),f=po.get(i);if(!f)throw new Error("invalid session id");let g=f[0],_=l._OrtEndProfiling(g);_===0&&fn("Can't get an profile file name."),l._OrtFree(_)},B1=i=>{let l=[];for(let f of i){let g=f[2];!Array.isArray(g)&&"buffer"in g&&l.push(g.buffer)}return l}}),ja,zs,Ud,h_,f_,By,V1,Vy,dc,hc,_2,y2,v2,w2,b2,x2,M2,T2,E2=u(()=>{Xe(),g2(),cs(),Di(),ja=()=>!!j.wasm.proxy&&typeof document<"u",Ud=!1,h_=!1,f_=!1,Vy=new Map,dc=(i,l)=>{let f=Vy.get(i);f?f.push(l):Vy.set(i,[l])},hc=()=>{if(Ud||!h_||f_||!zs)throw new Error("worker not ready")},_2=i=>{switch(i.data.type){case"init-wasm":Ud=!1,i.data.err?(f_=!0,V1[1](i.data.err)):(h_=!0,V1[0]()),By&&(URL.revokeObjectURL(By),By=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let l=Vy.get(i.data.type);i.data.err?l.shift()[1](i.data.err):l.shift()[0](i.data.out);break}}},y2=async()=>{if(!h_){if(Ud)throw new Error("multiple calls to 'initWasm()' detected.");if(f_)throw new Error("previous call to 'initWasm()' failed.");if(Ud=!0,ja())return new Promise((i,l)=>{zs==null||zs.terminate(),io().then(([f,g])=>{var _;try{zs=g,zs.onerror=y=>l(y),zs.onmessage=_2,V1=[i,l];let w={type:"init-wasm",in:j};!w.in.wasm.wasmPaths&&(f||(_=import.meta.url)!=null&&_.startsWith("file:"))&&(w.in.wasm.wasmPaths={wasm:new URL(n("./node_modules/onnxruntime-web/dist/ort-wasm-simd-threaded.jsep.wasm"),n.b).href}),zs.postMessage(w),By=f}catch(w){l(w)}},l)});try{await mi(j.wasm),await u_(j),h_=!0}catch(i){throw f_=!0,i}finally{Ud=!1}}},v2=async i=>{if(ja())return hc(),new Promise((l,f)=>{dc("init-ep",[l,f]);let g={type:"init-ep",in:{epName:i,env:j}};zs.postMessage(g)});await d_(j,i)},w2=async i=>ja()?(hc(),new Promise((l,f)=>{dc("copy-from",[l,f]);let g={type:"copy-from",in:{buffer:i}};zs.postMessage(g,[i.buffer])})):hs(i),b2=async(i,l)=>{if(ja()){if(l!=null&&l.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return hc(),new Promise((f,g)=>{dc("create",[f,g]);let _={type:"create",in:{model:i,options:{...l}}},w=[];i instanceof Uint8Array&&w.push(i.buffer),zs.postMessage(_,w)})}else return F1(i,l)},x2=async i=>{if(ja())return hc(),new Promise((l,f)=>{dc("release",[l,f]);let g={type:"release",in:i};zs.postMessage(g)});R1(i)},M2=async(i,l,f,g,_,w)=>{if(ja()){if(f.some(y=>y[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(_.some(y=>y))throw new Error("pre-allocated output tensor is not supported for proxy.");return hc(),new Promise((y,S)=>{dc("run",[y,S]);let L=f,F={type:"run",in:{sessionId:i,inputIndices:l,inputs:L,outputIndices:g,options:w}};zs.postMessage(F,B1(L))})}else return N1(i,l,f,g,_,w)},T2=async i=>{if(ja())return hc(),new Promise((l,f)=>{dc("end-profiling",[l,f]);let g={type:"end-profiling",in:i};zs.postMessage(g)});z1(i)}}),U1,P2,S2,fR=u(()=>{Xe(),E2(),Kt(),Ze(),Ta(),U1=(i,l)=>{switch(i.location){case"cpu":return[i.type,i.dims,i.data,"cpu"];case"gpu-buffer":return[i.type,i.dims,{gpuBuffer:i.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[i.type,i.dims,{mlTensor:i.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${i.location} for ${l()}`)}},P2=i=>{switch(i[3]){case"cpu":return new _e(i[0],i[2],i[1]);case"gpu-buffer":{let l=i[0];if(!zo(l))throw new Error(`not supported data type: ${l} for deserializing GPU tensor`);let{gpuBuffer:f,download:g,dispose:_}=i[2];return _e.fromGpuBuffer(f,{dataType:l,dims:i[1],download:g,dispose:_})}case"ml-tensor":{let l=i[0];if(!Bo(l))throw new Error(`not supported data type: ${l} for deserializing MLTensor tensor`);let{mlTensor:f,download:g,dispose:_}=i[2];return _e.fromMLTensor(f,{dataType:l,dims:i[1],download:g,dispose:_})}default:throw new Error(`invalid data location: ${i[3]}`)}},S2=class{async fetchModelAndCopyToWasmMemory(i){return w2(await Uo(i))}async loadModel(i,l){Qe();let f;typeof i=="string"?f=await this.fetchModelAndCopyToWasmMemory(i):f=i,[this.sessionId,this.inputNames,this.outputNames]=await b2(f,l),Ke()}async dispose(){return x2(this.sessionId)}async run(i,l,f){Qe();let g=[],_=[];Object.entries(i).forEach(W=>{let C=W[0],X=W[1],J=this.inputNames.indexOf(C);if(J===-1)throw new Error(`invalid input '${C}'`);g.push(X),_.push(J)});let w=[],y=[];Object.entries(l).forEach(W=>{let C=W[0],X=W[1],J=this.outputNames.indexOf(C);if(J===-1)throw new Error(`invalid output '${C}'`);w.push(X),y.push(J)});let S=g.map((W,C)=>U1(W,()=>`input "${this.inputNames[_[C]]}"`)),L=w.map((W,C)=>W?U1(W,()=>`output "${this.outputNames[y[C]]}"`):null),F=await M2(this.sessionId,_,S,y,L,f),K={};for(let W=0;W<F.length;W++)K[this.outputNames[y[W]]]=w[W]??P2(F[W]);return Ke(),K}startProfiling(){}endProfiling(){T2(this.sessionId)}}}),C2={};d(C2,{OnnxruntimeWebAssemblyBackend:()=>G1,initializeFlags:()=>W1,wasmBackend:()=>k2});var W1,G1,k2,pR=u(()=>{Xe(),E2(),fR(),W1=()=>{if((typeof j.wasm.initTimeout!="number"||j.wasm.initTimeout<0)&&(j.wasm.initTimeout=0),j.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof j.wasm.proxy!="boolean"&&(j.wasm.proxy=!1),typeof j.wasm.trace!="boolean"&&(j.wasm.trace=!1),typeof j.wasm.numThreads!="number"||!Number.isInteger(j.wasm.numThreads)||j.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)j.wasm.numThreads=1;else{let i=typeof navigator>"u"?c("node:os").cpus().length:navigator.hardwareConcurrency;j.wasm.numThreads=Math.min(4,Math.ceil((i||1)/2))}},G1=class{async init(i){W1(),await y2(),await v2(i)}async createInferenceSessionHandler(i,l){let f=new S2;return await f.loadModel(i,l),Promise.resolve(f)}},k2=new G1});Xe(),Xe(),Xe();var mR="1.21.0-dev.20250111-73f5b0c597",gR=Re;{let i=(pR(),m(C2)).wasmBackend;T("webgpu",i,5),T("webnn",i,5),T("cpu",i,10),T("wasm",i,10)}Object.defineProperty(j.versions,"web",{value:mR,enumerable:!0});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},"./src/backends/onnx.js":(e,t,n)=>{var r;n.r(t),n.d(t,{Tensor:()=>c.Tensor,createInferenceSession:()=>O,deviceToExecutionProviders:()=>T,isONNXProxy:()=>I,isONNXTensor:()=>b});var s=n("./src/env.js"),o=n("?2ce3"),a=n("./node_modules/onnxruntime-web/dist/ort.bundle.min.mjs?3a96"),c=n("./node_modules/onnxruntime-common/dist/esm/index.js");const u=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),d=[];let h,m;const p=Symbol.for("onnxruntime");if(p in globalThis)m=globalThis[p];else if(s.apis.IS_NODE_ENV){switch(m=o??(r||(r=n.t(o,2))),process.platform){case"win32":d.push("dml");break;case"linux":process.arch==="x64"&&d.push("cuda");break}d.push("cpu"),h=["cpu"]}else m=a,s.apis.IS_WEBNN_AVAILABLE&&d.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),s.apis.IS_WEBGPU_AVAILABLE&&d.push("webgpu"),d.push("wasm"),h=["wasm"];const v=m.InferenceSession;function T(k=null){if(!k)return h;switch(k){case"auto":return d;case"gpu":return d.filter($=>["webgpu","cuda","dml","webnn-gpu"].includes($))}if(d.includes(k))return[u[k]??k];throw new Error(`Unsupported device: "${k}". Should be one of: ${d.join(", ")}.`)}let E=null;async function O(k,$,P){E&&await E;const D=v.create(k,$);E??(E=D);const j=await D;return j.config=P,j}function b(k){return k instanceof m.Tensor}const M=m==null?void 0:m.env;M!=null&&M.wasm&&(M.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${s.env.version}/dist/`,M.wasm.proxy=!1,(typeof crossOriginIsolated>"u"||!crossOriginIsolated)&&(M.wasm.numThreads=1)),M!=null&&M.webgpu&&(M.webgpu.powerPreference="high-performance");function I(){var k;return(k=M==null?void 0:M.wasm)==null?void 0:k.proxy}s.env.backends.onnx=M},"./src/base/feature_extraction_utils.js":(e,t,n)=>{n.r(t),n.d(t,{FeatureExtractor:()=>a,validate_audio_inputs:()=>c});var r=n("./src/utils/constants.js"),s=n("./src/utils/generic.js"),o=n("./src/utils/hub.js");class a extends s.Callable{constructor(d){super(),this.config=d}static async from_pretrained(d,h){const m=await(0,o.getModelJSON)(d,r.FEATURE_EXTRACTOR_NAME,!0,h);return new this(m)}}function c(u,d){var h;if(!(u instanceof Float32Array||u instanceof Float64Array))throw new Error(`${d} expects input to be a Float32Array or a Float64Array, but got ${((h=u==null?void 0:u.constructor)==null?void 0:h.name)??typeof u} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(e,t,n)=>{n.r(t),n.d(t,{ImageProcessor:()=>k,center_to_corners_format:()=>m,post_process_instance_segmentation:()=>I,post_process_object_detection:()=>p,post_process_panoptic_segmentation:()=>M,post_process_semantic_segmentation:()=>v});var r=n("./src/utils/generic.js"),s=n("./src/utils/tensor.js"),o=n("./src/utils/maths.js");n("./src/utils/image.js");var a=n("./src/utils/core.js"),c=n("./src/utils/hub.js"),u=n("./src/utils/constants.js");function d($,P,D=0,j=null){const Y=$/P;let q=(0,o.bankers_round)(Y)*P;return j!==null&&q>j&&(q=Math.floor(Y)*P),q<D&&(q=Math.ceil(Y)*P),q}function h([$,P],D){return[Math.max(Math.floor($/D),1)*D,Math.max(Math.floor(P/D),1)*D]}function m([$,P,D,j]){return[$-D/2,P-j/2,$+D/2,P+j/2]}function p($,P=.5,D=null,j=!1){const Y=$.logits,q=$.pred_boxes,[oe,de,re]=Y.dims;if(D!==null&&D.length!==oe)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let he=[];for(let ue=0;ue<oe;++ue){let ye=D!==null?D[ue]:null,xe={boxes:[],classes:[],scores:[]},te=Y[ue],ke=q[ue];for(let De=0;De<de;++De){let me=te[De],ee=[],ge;if(j){ge=me.sigmoid().data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]>P&&ee.push(Ie)}else{let Ie=(0,o.max)(me.data)[1];if(Ie===re-1||(ge=(0,o.softmax)(me.data),ge[Ie]<P))continue;ee.push(Ie)}for(const Ie of ee){let Be=ke[De].data;Be=m(Be),ye!==null&&(Be=Be.map((Ue,pe)=>Ue*ye[(pe+1)%2])),xe.boxes.push(Be),xe.classes.push(Ie),xe.scores.push(ge[Ie])}}he.push(xe)}return he}function v($,P=null){const D=$.logits,j=D.dims[0];if(P!==null&&P.length!==j)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const Y=[];for(let q=0;q<j;++q){const oe=P!==null?P[q]:null;let de=D[q];oe!==null&&(de=(0,s.interpolate)(de,oe,"bilinear",!1));const[re,he]=oe??de.dims.slice(-2),ue=new s.Tensor("int32",new Int32Array(re*he),[re,he]),ye=de[0].data,xe=ue.data;for(let De=1;De<de.dims[0];++De){const me=de[De].data;for(let ee=0;ee<me.length;++ee)me[ee]>ye[ee]&&(ye[ee]=me[ee],xe[ee]=De)}const te=new Array(de.dims[0]);for(let De=0;De<xe.length;++De){const me=xe[De];te[me]=me}const ke=te.filter(De=>De!==void 0);Y.push({segmentation:ue,labels:ke})}return Y}function T($,P,D,j){const Y=[],q=[],oe=[];for(let de=0;de<$.dims[0];++de){const re=$[de],he=P[de],ue=(0,o.max)(re.data)[1];if(ue===j)continue;const xe=(0,o.softmax)(re.data)[ue];xe>D&&(Y.push(he),q.push(xe),oe.push(ue))}return[Y,q,oe]}function E($,P,D,j=.5,Y=.8){const q=[];let oe=0,de=0;const re=P[D].data;for(let ue=0;ue<$.length;++ue)$[ue]===D&&(q.push(ue),++oe),re[ue]>=j&&++de;let he=oe>0&&de>0;return he&&(he=oe/de>Y),[he,q]}function O($,P,D,j,Y,q=null,oe=null){const[de,re]=oe??$[0].dims,he=new s.Tensor("int32",new Int32Array(de*re),[de,re]),ue=[];if(oe!==null)for(let De=0;De<$.length;++De)$[De]=(0,s.interpolate)($[De],oe,"bilinear",!1);const ye=new Int32Array($[0].data.length),xe=new Float32Array($[0].data.length);for(let De=0;De<$.length;++De){let me=P[De];const ee=$[De].data;for(let ge=0;ge<ee.length;++ge)ee[ge]*=me,ee[ge]>xe[ge]&&(ye[ge]=De,xe[ge]=ee[ge])}let te=0;const ke=he.data;for(let De=0;De<D.length;++De){const me=D[De],[ee,ge]=E(ye,$,De,j,Y);if(ee){++te;for(const Ie of ge)ke[Ie]=te;ue.push({id:te,label_id:me,score:P[De]})}}return[he,ue]}function b($,P,D=28,j=56*56,Y=14*14*4*1280){if($<D||P<D)throw new Error(`height:${$} or width:${P} must be larger than factor:${D}`);if(Math.max($,P)/Math.min($,P)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max($,P)/Math.min($,P)}`);let q=Math.round($/D)*D,oe=Math.round(P/D)*D;if(q*oe>Y){const de=Math.sqrt($*P/Y);q=Math.floor($/de/D)*D,oe=Math.floor(P/de/D)*D}else if(q*oe<j){const de=Math.sqrt(j/($*P));q=Math.ceil($*de/D)*D,oe=Math.ceil(P*de/D)*D}return[q,oe]}function M($,P=.5,D=.5,j=.8,Y=null,q=null){Y===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),Y=new Set);const oe=$.class_queries_logits??$.logits,re=($.masks_queries_logits??$.pred_masks).sigmoid();let[he,ue,ye]=oe.dims;if(ye-=1,q!==null&&q.length!==he)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let xe=[];for(let te=0;te<he;++te){let ke=q!==null?q[te]:null,De=oe[te],me=re[te],[ee,ge,Ie]=T(De,me,P,ye);if(Ie.length===0){let[pe,Ye]=ke??me.dims.slice(-2),Ge=new s.Tensor("int32",new Int32Array(pe*Ye).fill(-1),[pe,Ye]);xe.push({segmentation:Ge,segments_info:[]});continue}let[Be,Ue]=O(ee,ge,Ie,D,j,Y,ke);xe.push({segmentation:Be,segments_info:Ue})}return xe}function I($,P=.5,D=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class k extends r.Callable{constructor(P){super(),this.image_mean=P.image_mean??P.mean,this.image_std=P.image_std??P.std,this.resample=P.resample??2,this.do_rescale=P.do_rescale??!0,this.rescale_factor=P.rescale_factor??1/255,this.do_normalize=P.do_normalize,this.do_thumbnail=P.do_thumbnail,this.size=P.size??P.image_size,this.do_resize=P.do_resize??this.size!==void 0,this.size_divisibility=P.size_divisibility??P.size_divisor,this.do_center_crop=P.do_center_crop,this.crop_size=P.crop_size,this.do_convert_rgb=P.do_convert_rgb??!0,this.do_crop_margin=P.do_crop_margin,this.pad_size=P.pad_size,this.do_pad=P.do_pad,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=P.do_flip_channel_order??!1,this.config=P}async thumbnail(P,D,j=2){const Y=P.height,q=P.width,oe=D.height,de=D.width;let re=Math.min(Y,oe),he=Math.min(q,de);return re===Y&&he===q?P:(Y>q?he=Math.floor(q*re/Y):q>Y&&(re=Math.floor(Y*he/q)),await P.resize(he,re,{resample:j}))}async crop_margin(P,D=200){const j=P.clone().grayscale(),Y=(0,o.min)(j.data)[0],oe=(0,o.max)(j.data)[0]-Y;if(oe===0)return P;const de=D/255;let re=j.width,he=j.height,ue=0,ye=0;const xe=j.data;for(let te=0;te<j.height;++te){const ke=te*j.width;for(let De=0;De<j.width;++De)(xe[ke+De]-Y)/oe<de&&(re=Math.min(re,De),he=Math.min(he,te),ue=Math.max(ue,De),ye=Math.max(ye,te))}return P=await P.crop([re,he,ue,ye]),P}pad_image(P,D,j,{mode:Y="constant",center:q=!1,constant_values:oe=0}={}){const[de,re,he]=D;let ue,ye;if(typeof j=="number"?(ue=j,ye=j):j==="square"?ue=ye=Math.max(de,re):(ue=j.width,ye=j.height),ue!==re||ye!==de){const xe=new Float32Array(ue*ye*he);if(Array.isArray(oe))for(let De=0;De<xe.length;++De)xe[De]=oe[De%he];else oe!==0&&xe.fill(oe);const[te,ke]=q?[Math.floor((ue-re)/2),Math.floor((ye-de)/2)]:[0,0];for(let De=0;De<de;++De){const me=(De+ke)*ue,ee=De*re;for(let ge=0;ge<re;++ge){const Ie=(me+ge+te)*he,Be=(ee+ge)*he;for(let Ue=0;Ue<he;++Ue)xe[Ie+Ue]=P[Be+Ue]}}if(Y==="symmetric"){if(q)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const De=de-1,me=re-1;for(let ee=0;ee<ye;++ee){const ge=ee*ue,Ie=(0,a.calculateReflectOffset)(ee,De)*re;for(let Be=0;Be<ue;++Be){if(ee<de&&Be<re)continue;const Ue=(ge+Be)*he,pe=(Ie+(0,a.calculateReflectOffset)(Be,me))*he;for(let Ye=0;Ye<he;++Ye)xe[Ue+Ye]=P[pe+Ye]}}}P=xe,D=[ye,ue,he]}return[P,D]}rescale(P){for(let D=0;D<P.length;++D)P[D]=this.rescale_factor*P[D]}get_resize_output_image_size(P,D){const[j,Y]=P.size;let q,oe;if(this.do_thumbnail){const{height:de,width:re}=D;q=Math.min(de,re)}else Number.isInteger(D)?(q=D,oe=this.config.max_size??q):D!==void 0&&(q=D.shortest_edge,oe=D.longest_edge);if(q!==void 0||oe!==void 0){const de=q===void 0?1:Math.max(q/j,q/Y),re=j*de,he=Y*de,ue=oe===void 0?1:Math.min(oe/re,oe/he);let ye=Math.floor(Number((re*ue).toFixed(2))),xe=Math.floor(Number((he*ue).toFixed(2)));return this.size_divisibility!==void 0&&([ye,xe]=h([ye,xe],this.size_divisibility)),[ye,xe]}else if(D!==void 0&&D.width!==void 0&&D.height!==void 0){let de=D.width,re=D.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let he=re/Y,ue=de/j;Math.abs(1-ue)<Math.abs(1-he)?he=ue:ue=he,re=d(he*Y,this.config.ensure_multiple_of),de=d(ue*j,this.config.ensure_multiple_of)}return[de,re]}else{if(this.size_divisibility!==void 0)return h([j,Y],this.size_divisibility);if(D.min_pixels!==void 0&&D.max_pixels!==void 0){const{min_pixels:de,max_pixels:re}=D,he=this.config.patch_size*this.config.merge_size;return b(Y,j,he,de,re)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(D)}`)}}async resize(P){const[D,j]=this.get_resize_output_image_size(P,this.size);return await P.resize(D,j,{resample:this.resample})}async preprocess(P,{do_normalize:D=null,do_pad:j=null,do_convert_rgb:Y=null,do_convert_grayscale:q=null,do_flip_channel_order:oe=null}={}){this.do_crop_margin&&(P=await this.crop_margin(P));const[de,re]=P.size;if(Y??this.do_convert_rgb?P=P.rgb():q&&(P=P.grayscale()),this.do_resize&&(P=await this.resize(P)),this.do_thumbnail&&(P=await this.thumbnail(P,this.size,this.resample)),this.do_center_crop){let te,ke;Number.isInteger(this.crop_size)?(te=this.crop_size,ke=this.crop_size):(te=this.crop_size.width,ke=this.crop_size.height),P=await P.center_crop(te,ke)}const he=[P.height,P.width];let ue=Float32Array.from(P.data),ye=[P.height,P.width,P.channels];if(this.do_rescale&&this.rescale(ue),D??this.do_normalize){let te=this.image_mean;Array.isArray(this.image_mean)||(te=new Array(P.channels).fill(te));let ke=this.image_std;if(Array.isArray(this.image_std)||(ke=new Array(P.channels).fill(te)),te.length!==P.channels||ke.length!==P.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${te.length}) and \`image_std\` (${ke.length}) must match the number of channels in the image (${P.channels}).`);for(let De=0;De<ue.length;De+=P.channels)for(let me=0;me<P.channels;++me)ue[De+me]=(ue[De+me]-te[me])/ke[me]}if(j??this.do_pad){if(this.pad_size)[ue,ye]=this.pad_image(ue,[P.height,P.width,P.channels],this.pad_size);else if(this.size_divisibility){const[te,ke]=h([ye[1],ye[0]],this.size_divisibility);[ue,ye]=this.pad_image(ue,ye,{width:te,height:ke})}}if(oe??this.do_flip_channel_order){if(ye[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let te=0;te<ue.length;te+=3){const ke=ue[te];ue[te]=ue[te+2],ue[te+2]=ke}}const xe=new s.Tensor("float32",ue,ye).permute(2,0,1);return{original_size:[re,de],reshaped_input_size:he,pixel_values:xe}}async _call(P,...D){Array.isArray(P)||(P=[P]);const j=await Promise.all(P.map(q=>this.preprocess(q)));return{pixel_values:(0,s.stack)(j.map(q=>q.pixel_values),0),original_sizes:j.map(q=>q.original_size),reshaped_input_sizes:j.map(q=>q.reshaped_input_size)}}static async from_pretrained(P,D){const j=await(0,c.getModelJSON)(P,u.IMAGE_PROCESSOR_NAME,!0,D);return new this(j)}}},"./src/base/processing_utils.js":(e,t,n)=>{n.r(t),n.d(t,{Processor:()=>a});var r=n("./src/utils/constants.js"),s=n("./src/utils/generic.js"),o=n("./src/utils/hub.js");class a extends s.Callable{constructor(u,d){super(),this.config=u,this.components=d}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(u,d={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(u,{tokenize:!1,...d})}batch_decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...u)}decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...u)}async _call(u,...d){for(const h of[this.image_processor,this.feature_extractor,this.tokenizer])if(h)return h(u,...d);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(u,d){const[h,m]=await Promise.all([this.uses_processor_config?(0,o.getModelJSON)(u,r.PROCESSOR_NAME,!0,d):{},Promise.all(this.classes.filter(p=>p in this).map(async p=>{const v=await this[p].from_pretrained(u,d);return[p.replace(/_class$/,""),v]})).then(Object.fromEntries)]);return new this(h,m)}}Pe(a,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),Pe(a,"uses_processor_config",!1)},"./src/configs.js":(e,t,n)=>{n.r(t),n.d(t,{AutoConfig:()=>d,PretrainedConfig:()=>u,getKeyValueShapes:()=>c});var r=n("./src/utils/core.js"),s=n("./src/utils/hub.js");async function o(h,m){return await(0,s.getModelJSON)(h,"config.json",!0,m)}function a(h){const m={};let p={};switch(h.model_type){case"llava":case"paligemma":case"florence2":case"llava_onevision":case"idefics3":p=a(h.text_config);break;case"moondream1":p=a(h.phi_config);break;case"musicgen":p=a(h.decoder);break;case"multi_modality":p=a(h.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":m.num_heads="n_head",m.num_layers="n_layer",m.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":m.num_heads="num_attention_heads",m.num_layers="num_hidden_layers",m.hidden_size="hidden_size";break;case"llama":case"olmo":case"olmo2":case"mobilellm":case"granite":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":m.num_heads="num_key_value_heads",m.num_layers="num_hidden_layers",m.hidden_size="hidden_size",m.num_attention_heads="num_attention_heads";break;case"gemma":case"gemma2":m.num_heads="num_key_value_heads",m.num_layers="num_hidden_layers",m.dim_kv="head_dim";break;case"openelm":m.num_heads="num_kv_heads",m.num_layers="num_transformer_layers",m.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":m.num_heads="num_heads",m.num_layers="num_layers",m.hidden_size="hidden_size";break;case"bloom":m.num_heads="n_head",m.num_layers="n_layer",m.hidden_size="hidden_size";break;case"mpt":m.num_heads="n_heads",m.num_layers="n_layers",m.hidden_size="d_model";break;case"exaone":m.num_heads="num_key_value_heads",m.num_layers="num_layers",m.dim_kv="head_dim",m.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":m.num_decoder_layers="num_decoder_layers",m.num_decoder_heads="num_heads",m.decoder_dim_kv="d_kv",m.num_encoder_layers="num_layers",m.num_encoder_heads="num_heads",m.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":m.num_decoder_layers="decoder_layers",m.num_decoder_heads="decoder_attention_heads",m.decoder_hidden_size="d_model",m.num_encoder_layers="encoder_layers",m.num_encoder_heads="encoder_attention_heads",m.encoder_hidden_size="d_model";break;case"speecht5":m.num_decoder_layers="decoder_layers",m.num_decoder_heads="decoder_attention_heads",m.decoder_hidden_size="hidden_size",m.num_encoder_layers="encoder_layers",m.num_encoder_heads="encoder_attention_heads",m.encoder_hidden_size="hidden_size";break;case"trocr":m.num_encoder_layers=m.num_decoder_layers="decoder_layers",m.num_encoder_heads=m.num_decoder_heads="decoder_attention_heads",m.encoder_hidden_size=m.decoder_hidden_size="d_model";break;case"musicgen_decoder":case"moonshine":m.num_encoder_layers=m.num_decoder_layers="num_hidden_layers",m.num_encoder_heads=m.num_decoder_heads="num_attention_heads",m.encoder_hidden_size=m.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const T=a(h.decoder),E="num_decoder_layers"in T,O=(0,r.pick)(h,["model_type","is_encoder_decoder"]);return E?(O.num_decoder_layers=T.num_decoder_layers,O.num_decoder_heads=T.num_decoder_heads,O.decoder_hidden_size=T.decoder_hidden_size,O.num_encoder_layers=T.num_encoder_layers,O.num_encoder_heads=T.num_encoder_heads,O.encoder_hidden_size=T.encoder_hidden_size):(O.num_layers=T.num_layers,O.num_heads=T.num_heads,O.hidden_size=T.hidden_size),O}const v={...p,...(0,r.pick)(h,["model_type","multi_query","is_encoder_decoder"])};for(const T in m)v[T]=h[m[T]];return v}function c(h,{prefix:m="past_key_values",batch_size:p=1}={}){const v={},T=h.normalized_config;if(T.is_encoder_decoder&&"num_encoder_heads"in T&&"num_decoder_heads"in T){const E=T.encoder_dim_kv??T.encoder_hidden_size/T.num_encoder_heads,O=T.decoder_dim_kv??T.decoder_hidden_size/T.num_decoder_heads,b=[p,T.num_encoder_heads,0,E],M=[p,T.num_decoder_heads,0,O];for(let I=0;I<T.num_decoder_layers;++I)v[`${m}.${I}.encoder.key`]=b,v[`${m}.${I}.encoder.value`]=b,v[`${m}.${I}.decoder.key`]=M,v[`${m}.${I}.decoder.value`]=M}else{const E=T.num_heads,O=T.num_layers,b=T.dim_kv??T.hidden_size/(T.num_attention_heads??E);if(T.model_type==="falcon"){const M=[p*E,0,b];for(let I=0;I<O;++I)v[`${m}.${I}.key`]=M,v[`${m}.${I}.value`]=M}else if(T.multi_query){const M=[p*E,0,2*b];for(let I=0;I<O;++I)v[`${m}.${I}.key_value`]=M}else if(T.model_type==="bloom"){const M=[p*E,b,0],I=[p*E,0,b];for(let k=0;k<O;++k)v[`${m}.${k}.key`]=M,v[`${m}.${k}.value`]=I}else if(T.model_type==="openelm")for(let M=0;M<O;++M){const I=[p,E[M],0,b];v[`${m}.${M}.key`]=I,v[`${m}.${M}.value`]=I}else{const M=[p,E,0,b];for(let I=0;I<O;++I)v[`${m}.${I}.key`]=M,v[`${m}.${I}.value`]=M}}return v}class u{constructor(m){Pe(this,"model_type",null);Pe(this,"is_encoder_decoder",!1);Pe(this,"max_position_embeddings");Pe(this,"transformers.js_config");Object.assign(this,m),this.normalized_config=a(this)}static async from_pretrained(m,{progress_callback:p=null,config:v=null,cache_dir:T=null,local_files_only:E=!1,revision:O="main"}={}){v&&!(v instanceof u)&&(v=new u(v));const b=v??await o(m,{progress_callback:p,config:v,cache_dir:T,local_files_only:E,revision:O});return new this(b)}}class d{static async from_pretrained(...m){return u.from_pretrained(...m)}}},"./src/env.js":(e,t,n)=>{var j,Y;n.r(t),n.d(t,{apis:()=>O,env:()=>P});var r=n("?569f"),s=n("?3f59"),o=n("?154a");const a="3.3.0",c=typeof window<"u"&&typeof window.document<"u",u=typeof self<"u"&&((j=self.constructor)==null?void 0:j.name)==="DedicatedWorkerGlobalScope",d=typeof self<"u"&&"caches"in self,h=typeof navigator<"u"&&"gpu"in navigator,m=typeof navigator<"u"&&"ml"in navigator,p=typeof process<"u",v=p&&((Y=process==null?void 0:process.release)==null?void 0:Y.name)==="node",T=!D(r),E=!D(s),O=Object.freeze({IS_BROWSER_ENV:c,IS_WEBWORKER_ENV:u,IS_WEB_CACHE_AVAILABLE:d,IS_WEBGPU_AVAILABLE:h,IS_WEBNN_AVAILABLE:m,IS_PROCESS_AVAILABLE:p,IS_NODE_ENV:v,IS_FS_AVAILABLE:T,IS_PATH_AVAILABLE:E}),b=T&&E;let M="./";if(b){const q=Object(import.meta).url;q?M=s.dirname(s.dirname(o.fileURLToPath(q))):typeof __dirname<"u"&&(M=s.dirname(__dirname))}const I=b?s.join(M,"/.cache/"):null,k="/models/",$=b?s.join(M,k):k,P={version:a,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(c||u),localModelPath:$,useFS:T,useBrowserCache:d,useFSCache:T,cacheDir:I,useCustomCache:!1,customCache:null};function D(q){return Object.keys(q).length===0}},"./src/generation/configuration_utils.js":(e,t,n)=>{n.r(t),n.d(t,{GenerationConfig:()=>s});var r=n("./src/utils/core.js");class s{constructor(a){Pe(this,"max_length",20);Pe(this,"max_new_tokens",null);Pe(this,"min_length",0);Pe(this,"min_new_tokens",null);Pe(this,"early_stopping",!1);Pe(this,"max_time",null);Pe(this,"do_sample",!1);Pe(this,"num_beams",1);Pe(this,"num_beam_groups",1);Pe(this,"penalty_alpha",null);Pe(this,"use_cache",!0);Pe(this,"temperature",1);Pe(this,"top_k",50);Pe(this,"top_p",1);Pe(this,"typical_p",1);Pe(this,"epsilon_cutoff",0);Pe(this,"eta_cutoff",0);Pe(this,"diversity_penalty",0);Pe(this,"repetition_penalty",1);Pe(this,"encoder_repetition_penalty",1);Pe(this,"length_penalty",1);Pe(this,"no_repeat_ngram_size",0);Pe(this,"bad_words_ids",null);Pe(this,"force_words_ids",null);Pe(this,"renormalize_logits",!1);Pe(this,"constraints",null);Pe(this,"forced_bos_token_id",null);Pe(this,"forced_eos_token_id",null);Pe(this,"remove_invalid_values",!1);Pe(this,"exponential_decay_length_penalty",null);Pe(this,"suppress_tokens",null);Pe(this,"streamer",null);Pe(this,"begin_suppress_tokens",null);Pe(this,"forced_decoder_ids",null);Pe(this,"guidance_scale",null);Pe(this,"num_return_sequences",1);Pe(this,"output_attentions",!1);Pe(this,"output_hidden_states",!1);Pe(this,"output_scores",!1);Pe(this,"return_dict_in_generate",!1);Pe(this,"pad_token_id",null);Pe(this,"bos_token_id",null);Pe(this,"eos_token_id",null);Pe(this,"encoder_no_repeat_ngram_size",0);Pe(this,"decoder_start_token_id",null);Pe(this,"generation_kwargs",{});Object.assign(this,(0,r.pick)(a,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,t,n)=>{n.r(t),n.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>b,ForcedBOSTokenLogitsProcessor:()=>u,ForcedEOSTokenLogitsProcessor:()=>d,LogitsProcessor:()=>o,LogitsProcessorList:()=>c,LogitsWarper:()=>a,MinLengthLogitsProcessor:()=>T,MinNewTokensLengthLogitsProcessor:()=>E,NoBadWordsLogitsProcessor:()=>O,NoRepeatNGramLogitsProcessor:()=>p,RepetitionPenaltyLogitsProcessor:()=>v,SuppressTokensAtBeginLogitsProcessor:()=>h,TemperatureLogitsWarper:()=>M,TopKLogitsWarper:()=>k,TopPLogitsWarper:()=>I,WhisperTimeStampLogitsProcessor:()=>m});var r=n("./src/utils/generic.js");n("./src/utils/tensor.js");var s=n("./src/utils/maths.js");class o extends r.Callable{_call(P,D){throw Error("`_call` should be implemented in a subclass")}}class a extends r.Callable{_call(P,D){throw Error("`_call` should be implemented in a subclass")}}class c extends r.Callable{constructor(){super(),this.processors=[]}push(P){this.processors.push(P)}extend(P){this.processors.push(...P)}_call(P,D){let j=D;for(const Y of this.processors)j=Y(P,j);return j}[Symbol.iterator](){return this.processors.values()}}class u extends o{constructor(P){super(),this.bos_token_id=P}_call(P,D){for(let j=0;j<P.length;++j)if(P[j].length===1){const Y=D[j].data;Y.fill(-1/0),Y[this.bos_token_id]=0}return D}}class d extends o{constructor(P,D){super(),this.max_length=P,this.eos_token_id=Array.isArray(D)?D:[D]}_call(P,D){for(let j=0;j<P.length;++j)if(P[j].length===this.max_length-1){const Y=D[j].data;Y.fill(-1/0);for(const q of this.eos_token_id)Y[q]=0}return D}}class h extends o{constructor(P,D){super(),this.begin_suppress_tokens=P,this.begin_index=D}_call(P,D){for(let j=0;j<P.length;++j)if(P[j].length===this.begin_index){const Y=D[j].data;for(const q of this.begin_suppress_tokens)Y[q]=-1/0}return D}}class m extends o{constructor(P,D){super(),this.eos_token_id=Array.isArray(P.eos_token_id)?P.eos_token_id[0]:P.eos_token_id,this.no_timestamps_token_id=P.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=D.length,D.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=P.max_initial_timestamp_index}_call(P,D){for(let j=0;j<P.length;++j){const Y=D[j].data;if(Y[this.no_timestamps_token_id]=-1/0,P[j].length===this.begin_index-1){Y.fill(-1/0),Y[this.timestamp_begin]=0;continue}const q=P[j].slice(this.begin_index),oe=q.length>=1&&q[q.length-1]>=this.timestamp_begin,de=q.length<2||q[q.length-2]>=this.timestamp_begin;if(oe&&(de?Y.subarray(this.timestamp_begin).fill(-1/0):Y.subarray(0,this.eos_token_id).fill(-1/0)),P[j].length===this.begin_index&&this.max_initial_timestamp_index!==null){const ye=this.timestamp_begin+this.max_initial_timestamp_index;Y.subarray(ye+1).fill(-1/0)}const re=(0,s.log_softmax)(Y),he=Math.log(re.subarray(this.timestamp_begin).map(Math.exp).reduce((ye,xe)=>ye+xe)),ue=(0,s.max)(re.subarray(0,this.timestamp_begin))[0];he>ue&&Y.subarray(0,this.timestamp_begin).fill(-1/0)}return D}}class p extends o{constructor(P){super(),this.no_repeat_ngram_size=P}getNgrams(P){const D=P.length,j=[];for(let q=0;q<D+1-this.no_repeat_ngram_size;++q){const oe=[];for(let de=0;de<this.no_repeat_ngram_size;++de)oe.push(P[q+de]);j.push(oe.map(Number))}const Y=new Map;for(const q of j){const oe=q.slice(0,q.length-1),de=JSON.stringify(oe),re=Y.get(de)??[];re.push(q[q.length-1]),Y.set(de,re)}return Y}getGeneratedNgrams(P,D){const j=D.slice(D.length+1-this.no_repeat_ngram_size,D.length);return P.get(JSON.stringify(j.map(Number)))??[]}calcBannedNgramTokens(P){const D=[];if(P.length+1<this.no_repeat_ngram_size)return D;{const j=this.getNgrams(P);return this.getGeneratedNgrams(j,P)}}_call(P,D){for(let j=0;j<P.length;++j){const Y=D[j].data,q=this.calcBannedNgramTokens(P[j]);for(const oe of q)Y[oe]=-1/0}return D}}class v extends o{constructor(P){super(),this.penalty=P}_call(P,D){for(let j=0;j<P.length;++j){const Y=D[j].data;for(const q of new Set(P[j])){const oe=Number(q);Y[oe]<0?Y[oe]*=this.penalty:Y[oe]/=this.penalty}}return D}}class T extends o{constructor(P,D){super(),this.min_length=P,this.eos_token_id=Array.isArray(D)?D:[D]}_call(P,D){for(let j=0;j<P.length;++j)if(P[j].length<this.min_length){const Y=D[j].data;for(const q of this.eos_token_id)Y[q]=-1/0}return D}}class E extends o{constructor(P,D,j){super(),this.prompt_length_to_skip=P,this.min_new_tokens=D,this.eos_token_id=Array.isArray(j)?j:[j]}_call(P,D){for(let j=0;j<P.length;++j)if(P[j].length-this.prompt_length_to_skip<this.min_new_tokens){const q=D[j].data;for(const oe of this.eos_token_id)q[oe]=-1/0}return D}}class O extends o{constructor(P,D){super(),this.bad_words_ids=P,this.eos_token_id=Array.isArray(D)?D:[D]}_call(P,D){for(let j=0;j<P.length;++j){const Y=D[j].data,q=P[j];for(const oe of this.bad_words_ids){let de=!0;for(let re=1;re<=oe.length-1&&oe.length<q.length;++re)if(oe.at(-re-1)!=q.at(-re)){de=!1;break}de&&(Y[oe.at(-1)]=-1/0)}}return D}}class b extends o{constructor(P){if(super(),P<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${P}.`);this.guidance_scale=P}_call(P,D){if(D.dims[0]!==2*P.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${D.dims[0]} for the logits and ${P.length} for the input ids.`);const j=P.length,Y=D.slice([0,j],null),q=D.slice([j,D.dims[0]],null);for(let oe=0;oe<q.data.length;++oe)q.data[oe]+=(Y.data[oe]-q.data[oe])*this.guidance_scale;return q}}class M extends a{constructor(P){super(),this.temperature=P}_call(P,D){const j=D.data;for(let Y=0;Y<j.length;++Y)j[Y]/=this.temperature;return D}}class I extends a{constructor(P,{filter_value:D=-1/0,min_tokens_to_keep:j=1}={}){if(super(),P<0||P>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${P}`);if(!Number.isInteger(j)||j<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${j}`);this.top_p=P,this.filter_value=D,this.min_tokens_to_keep=j}}class k extends a{constructor(P,{filter_value:D=-1/0,min_tokens_to_keep:j=1}={}){if(super(),!Number.isInteger(P)||P<0)throw new Error(`\`top_k\` must be a positive integer, but is ${P}`);this.top_k=Math.max(P,j),this.filter_value=D}}},"./src/generation/logits_sampler.js":(e,t,n)=>{n.r(t),n.d(t,{LogitsSampler:()=>a});var r=n("./src/utils/generic.js"),s=n("./src/utils/tensor.js"),o=n("./src/utils/maths.js");n("./src/generation/configuration_utils.js");class a extends r.Callable{constructor(m){super(),this.generation_config=m}async _call(m){return this.sample(m)}async sample(m){throw Error("sample should be implemented in subclasses.")}getLogits(m,p){let v=m.dims.at(-1),T=m.data;if(p===-1)T=T.slice(-v);else{let E=p*v;T=T.slice(E,E+v)}return T}randomSelect(m){let p=0;for(let T=0;T<m.length;++T)p+=m[T];let v=Math.random()*p;for(let T=0;T<m.length;++T)if(v-=m[T],v<=0)return T;return 0}static getSampler(m){if(m.do_sample)return new u(m);if(m.num_beams>1)return new d(m);if(m.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${m.num_return_sequences}.`);return new c(m)}}class c extends a{async sample(m){const p=(0,o.max)(m.data)[1];return[[BigInt(p),0]]}}class u extends a{async sample(m){let p=m.dims.at(-1);this.generation_config.top_k>0&&(p=Math.min(this.generation_config.top_k,p));const[v,T]=await(0,s.topk)(m,p),E=(0,o.softmax)(v.data);return Array.from({length:this.generation_config.num_beams},()=>{const O=this.randomSelect(E);return[T.data[O],Math.log(E[O])]})}}class d extends a{async sample(m){let p=m.dims.at(-1);this.generation_config.top_k>0&&(p=Math.min(this.generation_config.top_k,p));const[v,T]=await(0,s.topk)(m,p),E=(0,o.softmax)(v.data);return Array.from({length:this.generation_config.num_beams},(O,b)=>[T.data[b],Math.log(E[b])])}}},"./src/generation/stopping_criteria.js":(e,t,n)=>{n.r(t),n.d(t,{EosTokenCriteria:()=>c,InterruptableStoppingCriteria:()=>u,MaxLengthCriteria:()=>a,StoppingCriteria:()=>s,StoppingCriteriaList:()=>o});var r=n("./src/utils/generic.js");class s extends r.Callable{_call(h,m){throw Error("StoppingCriteria needs to be subclassed")}}class o extends r.Callable{constructor(){super(),this.criteria=[]}push(h){this.criteria.push(h)}extend(h){h instanceof o?h=h.criteria:h instanceof s&&(h=[h]),this.criteria.push(...h)}_call(h,m){const p=new Array(h.length).fill(!1);for(const v of this.criteria){const T=v(h,m);for(let E=0;E<p.length;++E)p[E]||(p[E]=T[E])}return p}[Symbol.iterator](){return this.criteria.values()}}class a extends s{constructor(h,m=null){super(),this.max_length=h,this.max_position_embeddings=m}_call(h){return h.map(m=>m.length>=this.max_length)}}class c extends s{constructor(h){super(),Array.isArray(h)||(h=[h]),this.eos_token_id=h}_call(h,m){return h.map(p=>{const v=p.at(-1);return this.eos_token_id.some(T=>v==T)})}}class u extends s{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(h,m){return new Array(h.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,t,n)=>{n.r(t),n.d(t,{BaseStreamer:()=>a,TextStreamer:()=>u,WhisperTextStreamer:()=>d});var r=n("./src/utils/core.js"),s=n("./src/tokenizers.js"),o=n("./src/env.js");class a{put(m){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const c=o.apis.IS_PROCESS_AVAILABLE?h=>process.stdout.write(h):h=>console.log(h);class u extends a{constructor(m,{skip_prompt:p=!1,callback_function:v=null,token_callback_function:T=null,skip_special_tokens:E=!0,decode_kwargs:O={},...b}={}){super(),this.tokenizer=m,this.skip_prompt=p,this.callback_function=v??c,this.token_callback_function=T,this.decode_kwargs={skip_special_tokens:E,...O,...b},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(m){var E;if(m.length>1)throw Error("TextStreamer only supports batch size of 1");if(this.skip_prompt&&this.next_tokens_are_prompt){this.next_tokens_are_prompt=!1;return}const p=m[0];(E=this.token_callback_function)==null||E.call(this,p),this.token_cache=(0,r.mergeArrays)(this.token_cache,p);const v=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let T;v.endsWith(`
`)?(T=v.slice(this.print_len),this.token_cache=[],this.print_len=0):v.length>0&&(0,s.is_chinese_char)(v.charCodeAt(v.length-1))?(T=v.slice(this.print_len),this.print_len+=T.length):(T=v.slice(this.print_len,v.lastIndexOf(" ")+1),this.print_len+=T.length),this.on_finalized_text(T,!1)}end(){let m;this.token_cache.length>0?(m=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):m="",this.next_tokens_are_prompt=!0,this.on_finalized_text(m,!0)}on_finalized_text(m,p){var v,T;m.length>0&&((v=this.callback_function)==null||v.call(this,m)),p&&this.callback_function===c&&o.apis.IS_PROCESS_AVAILABLE&&((T=this.callback_function)==null||T.call(this,`
`))}}class d extends u{constructor(m,{skip_prompt:p=!1,callback_function:v=null,token_callback_function:T=null,on_chunk_start:E=null,on_chunk_end:O=null,on_finalize:b=null,time_precision:M=.02,skip_special_tokens:I=!0,decode_kwargs:k={}}={}){super(m,{skip_prompt:p,skip_special_tokens:I,callback_function:v,token_callback_function:T,decode_kwargs:k}),this.timestamp_begin=m.timestamp_begin,this.on_chunk_start=E,this.on_chunk_end=O,this.on_finalize=b,this.time_precision=M,this.waiting_for_timestamp=!1}put(m){var v,T;if(m.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const p=m[0];if(p.length===1){const E=Number(p[0])-this.timestamp_begin;if(E>=0){const O=E*this.time_precision;this.waiting_for_timestamp?(v=this.on_chunk_end)==null||v.call(this,O):(T=this.on_chunk_start)==null||T.call(this,O),this.waiting_for_timestamp=!this.waiting_for_timestamp,m=[[]]}}return super.put(m)}end(){var m;super.end(),(m=this.on_finalize)==null||m.call(this)}}},"./src/models.js":(e,t,n)=>{n.r(t),n.d(t,{ASTForAudioClassification:()=>Zc,ASTModel:()=>_f,ASTPreTrainedModel:()=>cn,AlbertForMaskedLM:()=>Mn,AlbertForQuestionAnswering:()=>Ca,AlbertForSequenceClassification:()=>Wo,AlbertModel:()=>Sa,AlbertPreTrainedModel:()=>Ni,AutoModel:()=>Ld,AutoModelForAudioClassification:()=>Fd,AutoModelForAudioFrameClassification:()=>Zg,AutoModelForCTC:()=>Xg,AutoModelForCausalLM:()=>Fy,AutoModelForDepthEstimation:()=>r_,AutoModelForDocumentQuestionAnswering:()=>e_,AutoModelForImageClassification:()=>Wg,AutoModelForImageFeatureExtraction:()=>i_,AutoModelForImageMatting:()=>t_,AutoModelForImageSegmentation:()=>Gg,AutoModelForImageToImage:()=>n_,AutoModelForMaskGeneration:()=>Yg,AutoModelForMaskedLM:()=>Bg,AutoModelForNormalEstimation:()=>s_,AutoModelForObjectDetection:()=>qg,AutoModelForPoseEstimation:()=>Ry,AutoModelForQuestionAnswering:()=>Vg,AutoModelForSemanticSegmentation:()=>Kg,AutoModelForSeq2SeqLM:()=>Rg,AutoModelForSequenceClassification:()=>Fg,AutoModelForSpeechSeq2Seq:()=>jg,AutoModelForTextToSpectrogram:()=>Ng,AutoModelForTextToWaveform:()=>zg,AutoModelForTokenClassification:()=>Ly,AutoModelForUniversalSegmentation:()=>Hg,AutoModelForVision2Seq:()=>Ug,AutoModelForXVector:()=>Jg,AutoModelForZeroShotObjectDetection:()=>Qg,BartForConditionalGeneration:()=>tn,BartForSequenceClassification:()=>In,BartModel:()=>Ct,BartPretrainedModel:()=>wt,BaseModelOutput:()=>Ge,BeitForImageClassification:()=>Bp,BeitModel:()=>zp,BeitPreTrainedModel:()=>Vu,BertForMaskedLM:()=>He,BertForQuestionAnswering:()=>Ke,BertForSequenceClassification:()=>qe,BertForTokenClassification:()=>Qe,BertModel:()=>Ae,BertPreTrainedModel:()=>_e,BlenderbotForConditionalGeneration:()=>Vr,BlenderbotModel:()=>We,BlenderbotPreTrainedModel:()=>Sr,BlenderbotSmallForConditionalGeneration:()=>Dr,BlenderbotSmallModel:()=>tr,BlenderbotSmallPreTrainedModel:()=>gi,BloomForCausalLM:()=>pp,BloomModel:()=>fp,BloomPreTrainedModel:()=>ku,CLIPModel:()=>kf,CLIPPreTrainedModel:()=>lo,CLIPSegForImageSegmentation:()=>Ff,CLIPSegModel:()=>Lf,CLIPSegPreTrainedModel:()=>ou,CLIPTextModel:()=>ny,CLIPTextModelWithProjection:()=>Af,CLIPVisionModel:()=>ry,CLIPVisionModelWithProjection:()=>$f,CamembertForMaskedLM:()=>bs,CamembertForQuestionAnswering:()=>so,CamembertForSequenceClassification:()=>Os,CamembertForTokenClassification:()=>fi,CamembertModel:()=>Rt,CamembertPreTrainedModel:()=>fr,CausalLMOutput:()=>Ko,CausalLMOutputWithPast:()=>zy,ChineseCLIPModel:()=>Fs,ChineseCLIPPreTrainedModel:()=>sy,ClapAudioModelWithProjection:()=>Ym,ClapModel:()=>qm,ClapPreTrainedModel:()=>nc,ClapTextModelWithProjection:()=>Qm,CodeGenForCausalLM:()=>qf,CodeGenModel:()=>fu,CodeGenPreTrainedModel:()=>Bl,CohereForCausalLM:()=>ay,CohereModel:()=>tp,CoherePreTrainedModel:()=>xu,ConvBertForMaskedLM:()=>kt,ConvBertForQuestionAnswering:()=>An,ConvBertForSequenceClassification:()=>Dt,ConvBertForTokenClassification:()=>mn,ConvBertModel:()=>St,ConvBertPreTrainedModel:()=>gt,ConvNextForImageClassification:()=>fy,ConvNextModel:()=>ad,ConvNextPreTrainedModel:()=>od,ConvNextV2ForImageClassification:()=>rm,ConvNextV2Model:()=>py,ConvNextV2PreTrainedModel:()=>ld,DPTForDepthEstimation:()=>$a,DPTModel:()=>td,DPTPreTrainedModel:()=>ed,DebertaForMaskedLM:()=>pi,DebertaForQuestionAnswering:()=>ls,DebertaForSequenceClassification:()=>Oi,DebertaForTokenClassification:()=>Di,DebertaModel:()=>io,DebertaPreTrainedModel:()=>xs,DebertaV2ForMaskedLM:()=>Wt,DebertaV2ForQuestionAnswering:()=>mi,DebertaV2ForSequenceClassification:()=>Pr,DebertaV2ForTokenClassification:()=>Li,DebertaV2Model:()=>At,DebertaV2PreTrainedModel:()=>ut,DecisionTransformerModel:()=>lg,DecisionTransformerPreTrainedModel:()=>Ey,DeiTForImageClassification:()=>Hu,DeiTModel:()=>Ku,DeiTPreTrainedModel:()=>Go,DepthAnythingForDepthEstimation:()=>nd,DepthAnythingPreTrainedModel:()=>Qp,DepthProForDepthEstimation:()=>Zp,DepthProPreTrainedModel:()=>Jp,DetrForObjectDetection:()=>Up,DetrForSegmentation:()=>Wp,DetrModel:()=>Vp,DetrObjectDetectionOutput:()=>Bi,DetrPreTrainedModel:()=>Gl,DetrSegmentationOutput:()=>co,Dinov2ForImageClassification:()=>ud,Dinov2Model:()=>sm,Dinov2PreTrainedModel:()=>cd,Dinov2WithRegistersForImageClassification:()=>hd,Dinov2WithRegistersModel:()=>im,Dinov2WithRegistersPreTrainedModel:()=>dd,DistilBertForMaskedLM:()=>jo,DistilBertForQuestionAnswering:()=>fn,DistilBertForSequenceClassification:()=>sr,DistilBertForTokenClassification:()=>Ys,DistilBertModel:()=>cs,DistilBertPreTrainedModel:()=>Bn,DonutSwinModel:()=>nm,DonutSwinPreTrainedModel:()=>id,EfficientNetForImageClassification:()=>ng,EfficientNetModel:()=>tg,EfficientNetPreTrainedModel:()=>yd,ElectraForMaskedLM:()=>Br,ElectraForQuestionAnswering:()=>ln,ElectraForSequenceClassification:()=>en,ElectraForTokenClassification:()=>$n,ElectraModel:()=>zn,ElectraPreTrainedModel:()=>Gn,EsmForMaskedLM:()=>wa,EsmForSequenceClassification:()=>ba,EsmForTokenClassification:()=>xa,EsmModel:()=>Fl,EsmPreTrainedModel:()=>Fi,ExaoneForCausalLM:()=>Qf,ExaoneModel:()=>Vl,ExaonePreTrainedModel:()=>gu,FalconForCausalLM:()=>Hm,FalconModel:()=>Km,FalconPreTrainedModel:()=>md,FastViTForImageClassification:()=>ly,FastViTModel:()=>Ap,FastViTPreTrainedModel:()=>ju,Florence2ForConditionalGeneration:()=>Tf,Florence2PreTrainedModel:()=>Mf,GLPNForDepthEstimation:()=>sd,GLPNModel:()=>Yl,GLPNPreTrainedModel:()=>rd,GPT2LMHeadModel:()=>jf,GPT2Model:()=>Rf,GPT2PreTrainedModel:()=>au,GPTBigCodeForCausalLM:()=>Hf,GPTBigCodeModel:()=>Kf,GPTBigCodePreTrainedModel:()=>hu,GPTJForCausalLM:()=>Gf,GPTJModel:()=>Wf,GPTJPreTrainedModel:()=>du,GPTNeoForCausalLM:()=>Bf,GPTNeoModel:()=>js,GPTNeoPreTrainedModel:()=>cu,GPTNeoXForCausalLM:()=>Uf,GPTNeoXModel:()=>Vf,GPTNeoXPreTrainedModel:()=>uu,Gemma2ForCausalLM:()=>sp,Gemma2Model:()=>rp,Gemma2PreTrainedModel:()=>Tu,GemmaForCausalLM:()=>np,GemmaModel:()=>Pn,GemmaPreTrainedModel:()=>Mu,GraniteForCausalLM:()=>ep,GraniteModel:()=>oy,GranitePreTrainedModel:()=>bu,GroundingDinoForObjectDetection:()=>am,GroundingDinoPreTrainedModel:()=>om,GroupViTModel:()=>kp,GroupViTPreTrainedModel:()=>Ru,HieraForImageClassification:()=>Qu,HieraModel:()=>Kp,HieraPreTrainedModel:()=>qu,HubertForCTC:()=>Im,HubertForSequenceClassification:()=>Om,HubertModel:()=>$m,HubertPreTrainedModel:()=>D1,IJepaForImageClassification:()=>xp,IJepaModel:()=>bp,IJepaPreTrainedModel:()=>Ou,Idefics3ForConditionalGeneration:()=>ru,Idefics3PreTrainedModel:()=>Sf,ImageMattingOutput:()=>Fa,JAISLMHeadModel:()=>zf,JAISModel:()=>Nf,JAISPreTrainedModel:()=>lu,JinaCLIPModel:()=>zl,JinaCLIPPreTrainedModel:()=>Nl,JinaCLIPTextModel:()=>iu,JinaCLIPVisionModel:()=>Rs,LlamaForCausalLM:()=>iy,LlamaModel:()=>mu,LlamaPreTrainedModel:()=>pu,LlavaForConditionalGeneration:()=>jl,LlavaOnevisionForConditionalGeneration:()=>bf,LlavaPreTrainedModel:()=>zi,LongT5ForConditionalGeneration:()=>Fe,LongT5Model:()=>Oe,LongT5PreTrainedModel:()=>be,M2M100ForConditionalGeneration:()=>Ia,M2M100Model:()=>Xl,M2M100PreTrainedModel:()=>gm,MBartForCausalLM:()=>Xr,MBartForConditionalGeneration:()=>Ht,MBartForSequenceClassification:()=>gn,MBartModel:()=>lr,MBartPreTrainedModel:()=>En,MPNetForMaskedLM:()=>oo,MPNetForQuestionAnswering:()=>Vo,MPNetForSequenceClassification:()=>zo,MPNetForTokenClassification:()=>Bo,MPNetModel:()=>No,MPNetPreTrainedModel:()=>us,MT5ForConditionalGeneration:()=>xt,MT5Model:()=>yt,MT5PreTrainedModel:()=>tt,MarianMTModel:()=>mm,MarianModel:()=>pm,MarianPreTrainedModel:()=>fd,MaskFormerForInstanceSegmentation:()=>Ql,MaskFormerModel:()=>tm,MaskFormerPreTrainedModel:()=>em,MaskedLMOutput:()=>Fr,MgpstrForSceneTextRecognition:()=>hg,MgpstrModelOutput:()=>Py,MgpstrPreTrainedModel:()=>dg,MistralForCausalLM:()=>yi,MistralModel:()=>Xs,MistralPreTrainedModel:()=>Wm,MobileBertForMaskedLM:()=>Rl,MobileBertForQuestionAnswering:()=>Ds,MobileBertForSequenceClassification:()=>ji,MobileBertModel:()=>Ma,MobileBertPreTrainedModel:()=>Ri,MobileLLMForCausalLM:()=>ka,MobileLLMModel:()=>Yf,MobileLLMPreTrainedModel:()=>_u,MobileNetV1ForImageClassification:()=>sg,MobileNetV1Model:()=>rg,MobileNetV1PreTrainedModel:()=>wd,MobileNetV2ForImageClassification:()=>xd,MobileNetV2Model:()=>ig,MobileNetV2PreTrainedModel:()=>bd,MobileNetV3ForImageClassification:()=>Td,MobileNetV3Model:()=>Ty,MobileNetV3PreTrainedModel:()=>Md,MobileNetV4ForImageClassification:()=>ag,MobileNetV4Model:()=>og,MobileNetV4PreTrainedModel:()=>Ed,MobileViTForImageClassification:()=>Dp,MobileViTModel:()=>Op,MobileViTPreTrainedModel:()=>Es,MobileViTV2ForImageClassification:()=>Fp,MobileViTV2Model:()=>Lp,MobileViTV2PreTrainedModel:()=>Nu,ModelOutput:()=>Ye,ModernBertForMaskedLM:()=>_t,ModernBertForSequenceClassification:()=>ot,ModernBertForTokenClassification:()=>mt,ModernBertModel:()=>ht,ModernBertPreTrainedModel:()=>rt,Moondream1ForConditionalGeneration:()=>xf,MoonshineForConditionalGeneration:()=>wf,MoonshineModel:()=>Ms,MoonshinePreTrainedModel:()=>tu,MptForCausalLM:()=>gp,MptModel:()=>mp,MptPreTrainedModel:()=>Au,MultiModalityCausalLM:()=>ug,MultiModalityPreTrainedModel:()=>cg,MusicgenForCausalLM:()=>My,MusicgenForConditionalGeneration:()=>sc,MusicgenModel:()=>xy,MusicgenPreTrainedModel:()=>vd,NomicBertModel:()=>ve,NomicBertPreTrainedModel:()=>Q,OPTForCausalLM:()=>yp,OPTModel:()=>_p,OPTPreTrainedModel:()=>$u,Olmo2ForCausalLM:()=>Zf,Olmo2Model:()=>Jf,Olmo2PreTrainedModel:()=>wu,OlmoForCausalLM:()=>vu,OlmoModel:()=>Xf,OlmoPreTrainedModel:()=>yu,OpenELMForCausalLM:()=>op,OpenELMModel:()=>ip,OpenELMPreTrainedModel:()=>Eu,OwlViTForObjectDetection:()=>jp,OwlViTModel:()=>Rp,OwlViTPreTrainedModel:()=>zu,Owlv2ForObjectDetection:()=>cy,Owlv2Model:()=>Np,Owlv2PreTrainedModel:()=>Bu,PaliGemmaForConditionalGeneration:()=>Pf,PaliGemmaPreTrainedModel:()=>Ef,PatchTSMixerForPrediction:()=>_g,PatchTSMixerModel:()=>gg,PatchTSMixerPreTrainedModel:()=>Pd,PatchTSTForPrediction:()=>mg,PatchTSTModel:()=>pg,PatchTSTPreTrainedModel:()=>fg,Phi3ForCausalLM:()=>hp,Phi3Model:()=>Ul,Phi3PreTrainedModel:()=>Cu,Phi3VForCausalLM:()=>Ts,Phi3VPreTrainedModel:()=>Cf,PhiForCausalLM:()=>Aa,PhiModel:()=>dp,PhiPreTrainedModel:()=>Su,PreTrainedModel:()=>pe,PretrainedMixin:()=>jn,PvtForImageClassification:()=>Tp,PvtModel:()=>Lu,PvtPreTrainedModel:()=>Wl,PyAnnoteForAudioFrameClassification:()=>xm,PyAnnoteModel:()=>bm,PyAnnotePreTrainedModel:()=>Jl,QuestionAnsweringModelOutput:()=>Hr,Qwen2ForCausalLM:()=>lp,Qwen2Model:()=>ap,Qwen2PreTrainedModel:()=>Pu,Qwen2VLForConditionalGeneration:()=>up,Qwen2VLPreTrainedModel:()=>cp,RTDetrForObjectDetection:()=>uo,RTDetrModel:()=>Uu,RTDetrObjectDetectionOutput:()=>Lr,RTDetrPreTrainedModel:()=>Vi,ResNetForImageClassification:()=>Yu,ResNetModel:()=>Hp,ResNetPreTrainedModel:()=>Kl,RoFormerForMaskedLM:()=>Re,RoFormerForQuestionAnswering:()=>ft,RoFormerForSequenceClassification:()=>Xe,RoFormerForTokenClassification:()=>Ze,RoFormerModel:()=>Ee,RoFormerPreTrainedModel:()=>ie,RobertaForMaskedLM:()=>Ls,RobertaForQuestionAnswering:()=>Tt,RobertaForSequenceClassification:()=>On,RobertaForTokenClassification:()=>nr,RobertaModel:()=>ts,RobertaPreTrainedModel:()=>zt,SamImageSegmentationOutput:()=>fm,SamModel:()=>hm,SamPreTrainedModel:()=>my,SapiensForDepthEstimation:()=>Xp,SapiensForNormalEstimation:()=>hy,SapiensForSemanticSegmentation:()=>Yp,SapiensPreTrainedModel:()=>ql,SegformerForImageClassification:()=>Jm,SegformerForSemanticSegmentation:()=>Zm,SegformerModel:()=>ns,SegformerPreTrainedModel:()=>_d,Seq2SeqLMOutput:()=>jy,SequenceClassifierOutput:()=>sn,SiglipModel:()=>If,SiglipPreTrainedModel:()=>su,SiglipTextModel:()=>Of,SiglipVisionModel:()=>Df,SpeechT5ForSpeechToText:()=>by,SpeechT5ForTextToSpeech:()=>zm,SpeechT5HifiGan:()=>Bm,SpeechT5Model:()=>wy,SpeechT5PreTrainedModel:()=>tc,SqueezeBertForMaskedLM:()=>Ta,SqueezeBertForQuestionAnswering:()=>Pa,SqueezeBertForSequenceClassification:()=>Ea,SqueezeBertModel:()=>Uo,SqueezeBertPreTrainedModel:()=>Kt,StableLmForCausalLM:()=>La,StableLmModel:()=>eg,StableLmPreTrainedModel:()=>rc,Starcoder2ForCausalLM:()=>Gm,Starcoder2Model:()=>ho,Starcoder2PreTrainedModel:()=>Ui,StyleTextToSpeech2Model:()=>Nm,StyleTextToSpeech2PreTrainedModel:()=>jm,Swin2SRForImageSuperResolution:()=>dy,Swin2SRModel:()=>qp,Swin2SRPreTrainedModel:()=>Zu,SwinForImageClassification:()=>Ju,SwinModel:()=>Hl,SwinPreTrainedModel:()=>Xu,T5ForConditionalGeneration:()=>ae,T5Model:()=>G,T5PreTrainedModel:()=>Le,TableTransformerForObjectDetection:()=>Gp,TableTransformerModel:()=>Gu,TableTransformerObjectDetectionOutput:()=>uy,TableTransformerPreTrainedModel:()=>Wu,TokenClassifierOutput:()=>kr,TrOCRForCausalLM:()=>Um,TrOCRPreTrainedModel:()=>Vm,UniSpeechForCTC:()=>Tm,UniSpeechForSequenceClassification:()=>Em,UniSpeechModel:()=>pd,UniSpeechPreTrainedModel:()=>Zl,UniSpeechSatForAudioFrameClassification:()=>yy,UniSpeechSatForCTC:()=>Pm,UniSpeechSatForSequenceClassification:()=>Sm,UniSpeechSatModel:()=>_y,UniSpeechSatPreTrainedModel:()=>Oa,ViTForImageClassification:()=>wp,ViTMAEModel:()=>Pp,ViTMAEPreTrainedModel:()=>Ep,ViTMSNForImageClassification:()=>Cp,ViTMSNModel:()=>Sp,ViTMSNPreTrainedModel:()=>Fu,ViTModel:()=>vp,ViTPreTrainedModel:()=>Iu,VisionEncoderDecoderModel:()=>nu,VitMatteForImageMatting:()=>Ip,VitMattePreTrainedModel:()=>$p,VitPoseForPoseEstimation:()=>Mp,VitPosePreTrainedModel:()=>Du,VitsModel:()=>gd,VitsModelOutput:()=>o_,VitsPreTrainedModel:()=>Xm,Wav2Vec2BertForCTC:()=>km,Wav2Vec2BertForSequenceClassification:()=>Am,Wav2Vec2BertModel:()=>Cm,Wav2Vec2BertPreTrainedModel:()=>ec,Wav2Vec2ForAudioFrameClassification:()=>wm,Wav2Vec2ForCTC:()=>ym,Wav2Vec2ForSequenceClassification:()=>vm,Wav2Vec2Model:()=>_m,Wav2Vec2PreTrainedModel:()=>_i,WavLMForAudioFrameClassification:()=>vy,WavLMForCTC:()=>Lm,WavLMForSequenceClassification:()=>Fm,WavLMForXVector:()=>Rm,WavLMModel:()=>Dm,WavLMPreTrainedModel:()=>Da,WeSpeakerResNetModel:()=>gy,WeSpeakerResNetPreTrainedModel:()=>Mm,WhisperForConditionalGeneration:()=>vf,WhisperModel:()=>yf,WhisperPreTrainedModel:()=>eu,XLMForQuestionAnswering:()=>ao,XLMForSequenceClassification:()=>Cr,XLMForTokenClassification:()=>Ft,XLMModel:()=>pr,XLMPreTrainedModel:()=>rn,XLMRobertaForMaskedLM:()=>pf,XLMRobertaForQuestionAnswering:()=>gf,XLMRobertaForSequenceClassification:()=>Jc,XLMRobertaForTokenClassification:()=>mf,XLMRobertaModel:()=>jt,XLMRobertaPreTrainedModel:()=>et,XLMWithLMHeadModel:()=>rr,XVectorOutput:()=>Ny,YolosForObjectDetection:()=>um,YolosModel:()=>cm,YolosObjectDetectionOutput:()=>dm,YolosPreTrainedModel:()=>lm});var r=n("./src/configs.js"),s=n("./src/backends/onnx.js"),o=n("./src/utils/dtypes.js"),a=n("./src/utils/generic.js"),c=n("./src/utils/core.js"),u=n("./src/utils/hub.js"),d=n("./src/utils/constants.js"),h=n("./src/generation/logits_process.js"),m=n("./src/generation/configuration_utils.js"),p=n("./src/utils/tensor.js"),v=n("./src/utils/image.js"),T=n("./src/utils/maths.js"),E=n("./src/generation/stopping_criteria.js"),O=n("./src/generation/logits_sampler.js"),b=n("./src/env.js"),M=n("./src/models/whisper/generation_whisper.js"),I=n("./src/models/whisper/common_whisper.js");const k={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9},$=new Map,P=new Map,D=new Map;async function j(z,V,Z){var Hn;const Se=((Hn=Z.config)==null?void 0:Hn["transformers.js_config"])??{};let je=Z.device??Se.device;je&&typeof je!="string"&&(je.hasOwnProperty(V)?je=je[V]:(console.warn(`device not specified for "${V}". Using the default device.`),je=null));const Ne=je??(b.apis.IS_NODE_ENV?"cpu":"wasm"),it=(0,s.deviceToExecutionProviders)(Ne);let at=Z.dtype??Se.dtype;if(typeof at!="string"&&(at&&at.hasOwnProperty(V)?at=at[V]:(at=o.DEFAULT_DEVICE_DTYPE_MAPPING[Ne]??o.DATA_TYPES.fp32,console.warn(`dtype not specified for "${V}". Using the default dtype (${at}) for this device (${Ne}).`))),at===o.DATA_TYPES.auto){let Dn=Se.dtype;typeof Dn!="string"&&(Dn=Dn[V]),Dn&&Dn!==o.DATA_TYPES.auto&&o.DATA_TYPES.hasOwnProperty(Dn)?at=Dn:at=o.DEFAULT_DEVICE_DTYPE_MAPPING[Ne]??o.DATA_TYPES.fp32}const bt=at;if(o.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(bt)){if(bt===o.DATA_TYPES.fp16&&Ne==="webgpu"&&!await(0,o.isWebGpuFp16Supported)())throw new Error(`The device (${Ne}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${bt}. Should be one of: ${Object.keys(o.DATA_TYPES).join(", ")}`);const Et=Se.kv_cache_dtype?typeof Se.kv_cache_dtype=="string"?Se.kv_cache_dtype:Se.kv_cache_dtype[bt]??"float32":void 0;if(Et&&!["float32","float16"].includes(Et))throw new Error(`Invalid kv_cache_dtype: ${Et}. Should be one of: float32, float16`);const Qt={dtype:bt,kv_cache_dtype:Et},Xt=o.DEFAULT_DTYPE_SUFFIX_MAPPING[bt],Gt=`${Z.subfolder??""}/${V}${Xt}.onnx`,Zt={...Z.session_options};Zt.executionProviders??(Zt.executionProviders=it);const hn=Se.free_dimension_overrides;hn?Zt.freeDimensionOverrides??(Zt.freeDimensionOverrides=hn):Ne.startsWith("webnn")&&!Zt.freeDimensionOverrides&&console.warn('WebNN does not currently support dynamic shapes and requires `free_dimension_overrides` to be set in config.json as a field within "transformers.js_config". When `free_dimension_overrides` is not set, you may experience significant performance degradation.');const _n=(0,u.getModelFile)(z,Gt,!0,Z),un=Z.use_external_data_format??Se.use_external_data_format;let xn=[];if(un&&(un===!0||typeof un=="object"&&un.hasOwnProperty(V)&&un[V]===!0)){if(b.apis.IS_NODE_ENV)throw new Error("External data format is not yet supported in Node.js");const Dn=`${V}${Xt}.onnx_data`,Xn=`${Z.subfolder??""}/${Dn}`;xn.push(new Promise(async(ir,Ur)=>{const Rr=await(0,u.getModelFile)(z,Xn,!0,Z);ir({path:Dn,data:Rr})}))}else Zt.externalData!==void 0&&(xn=Zt.externalData.map(async Dn=>{if(typeof Dn.data=="string"){const Xn=await(0,u.getModelFile)(z,Dn.data,!0,Z);return{...Dn,data:Xn}}return Dn}));if(xn.length>0&&(Zt.externalData=await Promise.all(xn)),Ne==="webgpu"){const Dn=(0,r.getKeyValueShapes)(Z.config,{prefix:"present"});if(Object.keys(Dn).length>0&&!(0,s.isONNXProxy)()){const Xn={};for(const ir in Dn)Xn[ir]="gpu-buffer";Zt.preferredOutputLocation=Xn}}return{buffer:await _n,session_options:Zt,session_config:Qt}}async function Y(z,V,Z){return Object.fromEntries(await Promise.all(Object.keys(V).map(async Se=>{const{buffer:je,session_options:Ne,session_config:it}=await j(z,V[Se],Z),at=await(0,s.createInferenceSession)(je,Ne,it);return[Se,at]})))}async function q(z,V,Z){return Object.fromEntries(await Promise.all(Object.keys(V).map(async Se=>{const je=await(0,u.getModelJSON)(z,V[Se],!1,Z);return[Se,je]})))}function oe(z,V){const Z=Object.create(null),Se=[];for(const it of z.inputNames){const at=V[it];if(!(at instanceof p.Tensor)){Se.push(it);continue}Z[it]=(0,s.isONNXProxy)()?at.clone():at}if(Se.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${Se.join(", ")}.`);const je=Object.keys(V).length,Ne=z.inputNames.length;if(je>Ne){let it=Object.keys(V).filter(at=>!z.inputNames.includes(at));console.warn(`WARNING: Too many inputs were provided (${je} > ${Ne}). The following inputs will be ignored: "${it.join(", ")}".`)}return Z}async function de(z,V){const Z=oe(z,V);try{const Se=Object.fromEntries(Object.entries(Z).map(([Ne,it])=>[Ne,it.ort_tensor]));let je=await z.run(Se);return je=re(je),je}catch(Se){const je=Object.fromEntries(Object.entries(Z).map(([Ne,{type:it,dims:at,data:bt}])=>[Ne,{type:it,dims:at,data:bt}]));throw console.error(`An error occurred during model execution: "${Se}".`),console.error("Inputs given to model:",je),Se}}function re(z){for(let V in z)(0,s.isONNXTensor)(z[V])?z[V]=new p.Tensor(z[V]):typeof z[V]=="object"&&re(z[V]);return z}function he(z){if(z instanceof p.Tensor)return z;if(z.length===0)throw Error("items must be non-empty");if(Array.isArray(z[0])){if(z.some(V=>V.length!==z[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new p.Tensor("int64",BigInt64Array.from(z.flat().map(V=>BigInt(V))),[z.length,z[0].length])}else return new p.Tensor("int64",BigInt64Array.from(z.map(V=>BigInt(V))),[1,z.length])}function ue(z){return new p.Tensor("bool",[z],[1])}async function ye(z,V){let{encoder_outputs:Z,input_ids:Se,decoder_input_ids:je,...Ne}=V;if(!Z){const at=(0,c.pick)(V,z.sessions.model.inputNames);Z=(await xe(z,at)).last_hidden_state}return Ne.input_ids=je,Ne.encoder_hidden_states=Z,z.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(Ne.encoder_attention_mask=V.attention_mask),await te(z,Ne,!0)}async function xe(z,V){const Z=z.sessions.model,Se=(0,c.pick)(V,Z.inputNames);if(Z.inputNames.includes("inputs_embeds")&&!Se.inputs_embeds){if(!V.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");Se.inputs_embeds=await z.encode_text({input_ids:V.input_ids})}if(Z.inputNames.includes("token_type_ids")&&!Se.token_type_ids){if(!Se.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");Se.token_type_ids=(0,p.zeros_like)(Se.input_ids)}if(Z.inputNames.includes("pixel_mask")&&!Se.pixel_mask){if(!Se.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const je=Se.pixel_values.dims;Se.pixel_mask=(0,p.ones)([je[0],je[2],je[3]])}return await de(Z,Se)}async function te(z,V,Z=!1){const Se=z.sessions[Z?"decoder_model_merged":"model"],{past_key_values:je,...Ne}=V;if(Se.inputNames.includes("use_cache_branch")&&(Ne.use_cache_branch=ue(!!je)),Se.inputNames.includes("position_ids")&&Ne.attention_mask&&!Ne.position_ids){const at=z.config.model_type==="paligemma"?1:0;Ne.position_ids=ee(Ne,je,at)}z.addPastKeyValues(Ne,je);const it=(0,c.pick)(Ne,Se.inputNames);return await de(Se,it)}function ke({image_token_id:z,inputs_embeds:V,image_features:Z,input_ids:Se,attention_mask:je}){const Ne=Se.tolist().map(Et=>Et.reduce((Qt,Xt,Gt)=>(Xt==z&&Qt.push(Gt),Qt),[])),it=Ne.reduce((Et,Qt)=>Et+Qt.length,0),at=Z.dims[0];if(it!==at)throw new Error(`Image features and image tokens do not match: tokens: ${it}, features ${at}`);let bt=0;for(let Et=0;Et<Ne.length;++Et){const Qt=Ne[Et],Xt=V[Et];for(let Gt=0;Gt<Qt.length;++Gt)Xt[Qt[Gt]].data.set(Z[bt++].data)}return{inputs_embeds:V,attention_mask:je}}async function De(z,{input_ids:V=null,attention_mask:Z=null,pixel_values:Se=null,position_ids:je=null,inputs_embeds:Ne=null,past_key_values:it=null,generation_config:at=null,logits_processor:bt=null,...Et}){if(!Ne){if(Ne=await z.encode_text({input_ids:V,...Et}),Se&&V.dims[1]!==1){const Xt=await z.encode_image({pixel_values:Se,...Et});({inputs_embeds:Ne,attention_mask:Z}=z._merge_input_ids_with_image_features({image_features:Xt,inputs_embeds:Ne,input_ids:V,attention_mask:Z}))}else if(it&&Se&&V.dims[1]===1){const Xt=V.dims[1],Gt=Object.values(it)[0].dims.at(-2);Z=(0,p.cat)([(0,p.ones)([V.dims[0],Gt]),Z.slice(null,[Z.dims[1]-Xt,Z.dims[1]])],1)}}if(!je&&z.config.model_type==="qwen2_vl"){const{image_grid_thw:Xt,video_grid_thw:Gt}=Et;[je]=z.get_rope_index(V,Xt,Gt,Z)}return await te(z,{inputs_embeds:Ne,past_key_values:it,attention_mask:Z,position_ids:je,generation_config:at,logits_processor:bt},!0)}function me(z,V=0){const[Z,Se]=z.dims,je=z.data,Ne=new BigInt64Array(je.length);for(let it=0;it<Z;++it){const at=it*Se;let bt=BigInt(V);for(let Et=0;Et<Se;++Et){const Qt=at+Et;je[Qt]===0n?Ne[Qt]=BigInt(1):(Ne[Qt]=bt,bt+=je[Qt])}}return{data:Ne,dims:z.dims}}function ee(z,V=null,Z=0){const{input_ids:Se,inputs_embeds:je,attention_mask:Ne}=z,{data:it,dims:at}=me(Ne,Z);let bt=new p.Tensor("int64",it,at);if(V){const Et=-(Se??je).dims.at(1);bt=bt.slice(null,[Et,null])}return bt}function ge(z,V,Z,Se){if(Z.past_key_values){const je=Object.values(Z.past_key_values)[0].dims.at(-2),{input_ids:Ne,attention_mask:it}=Z;if(!(it&&it.dims[1]>Ne.dims[1])){if(je<Ne.dims[1])Z.input_ids=Ne.slice(null,[je,null]);else if(z.config.image_token_index!=null&&Ne.data.some(at=>at==z.config.image_token_index)){const at=z.config.num_image_tokens;if(!at)throw new Error("`num_image_tokens` is missing in the model configuration.");const bt=Ne.dims[1]-(je-at);Z.input_ids=Ne.slice(null,[-bt,null]),Z.attention_mask=(0,p.ones)([1,je+bt])}}}return Z}function Ie(z,V,Z,Se){return Z.past_key_values&&(V=V.map(je=>[je.at(-1)])),{...Z,decoder_input_ids:he(V)}}function Be(z,...V){return z.config.is_encoder_decoder?Ie(z,...V):ge(z,...V)}function Ue(z,V,Z,Se){const je=!!Z.past_key_values;return Se.guidance_scale!==null&&Se.guidance_scale>1&&(je?Z.input_ids=(0,p.cat)([Z.input_ids,Z.input_ids],0):(Z.input_ids=(0,p.cat)([Z.input_ids,(0,p.full_like)(Z.input_ids,BigInt(Se.pad_token_id))],0),Z.attention_mask=(0,p.cat)([Z.attention_mask,(0,p.full_like)(Z.attention_mask,0n)],0))),(je||!Z.pixel_values)&&(Z.pixel_values=(0,p.full)([0,0,3,384,384],1)),je&&(Z.images_seq_mask=new p.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),Z.images_emb_mask=new p.Tensor("bool",new Array(0).fill(!1),[1,1,0])),Z}class pe extends a.Callable{constructor(Z,Se,je){super();Pe(this,"main_input_name","input_ids");Pe(this,"forward_params",["input_ids","attention_mask"]);this.config=Z,this.sessions=Se,this.configs=je;const Ne=D.get(this.constructor),it=$.get(Ne);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,it){case k.DecoderOnly:this.can_generate=!0,this._forward=te,this._prepare_inputs_for_generation=ge;break;case k.Seq2Seq:case k.Vision2Seq:case k.Musicgen:this.can_generate=!0,this._forward=ye,this._prepare_inputs_for_generation=Ie;break;case k.EncoderDecoder:this._forward=ye;break;case k.ImageTextToText:this.can_generate=!0,this._forward=De,this._prepare_inputs_for_generation=Be;break;case k.Phi3V:this.can_generate=!0,this._prepare_inputs_for_generation=Be;break;case k.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=Ue;break;default:this._forward=xe;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){var Se;const Z=[];for(const je of Object.values(this.sessions))(Se=je==null?void 0:je.handler)!=null&&Se.dispose&&Z.push(je.handler.dispose());return await Promise.all(Z)}static async from_pretrained(Z,{progress_callback:Se=null,config:je=null,cache_dir:Ne=null,local_files_only:it=!1,revision:at="main",model_file_name:bt=null,subfolder:Et="onnx",device:Qt=null,dtype:Xt=null,use_external_data_format:Gt=null,session_options:Zt={}}={}){let hn={progress_callback:Se,config:je,cache_dir:Ne,local_files_only:it,revision:at,model_file_name:bt,subfolder:Et,device:Qt,dtype:Xt,use_external_data_format:Gt,session_options:Zt};const _n=D.get(this),un=$.get(_n);je=hn.config=await r.AutoConfig.from_pretrained(Z,hn);let xn;if(un===k.DecoderOnly)xn=await Promise.all([Y(Z,{model:hn.model_file_name??"model"},hn),q(Z,{generation_config:"generation_config.json"},hn)]);else if(un===k.Seq2Seq||un===k.Vision2Seq)xn=await Promise.all([Y(Z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},hn),q(Z,{generation_config:"generation_config.json"},hn)]);else if(un===k.MaskGeneration)xn=await Promise.all([Y(Z,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},hn)]);else if(un===k.EncoderDecoder)xn=await Promise.all([Y(Z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},hn)]);else if(un===k.ImageTextToText){const Zn={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};je.is_encoder_decoder&&(Zn.model="encoder_model"),xn=await Promise.all([Y(Z,Zn,hn),q(Z,{generation_config:"generation_config.json"},hn)])}else if(un===k.Musicgen)xn=await Promise.all([Y(Z,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},hn),q(Z,{generation_config:"generation_config.json"},hn)]);else if(un===k.MultiModality)xn=await Promise.all([Y(Z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},hn),q(Z,{generation_config:"generation_config.json"},hn)]);else if(un===k.Phi3V)xn=await Promise.all([Y(Z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},hn),q(Z,{generation_config:"generation_config.json"},hn)]);else{if(un!==k.EncoderOnly){const Zn=_n??(je==null?void 0:je.model_type);Zn!=="custom"&&console.warn(`Model type for '${Zn}' not found, assuming encoder-only architecture. Please report this at ${d.GITHUB_ISSUE_URL}.`)}xn=await Promise.all([Y(Z,{model:hn.model_file_name??"model"},hn)])}return new this(je,...xn)}async _call(Z){return await this.forward(Z)}async forward(Z){return await this._forward(this,Z)}get generation_config(){var Z;return((Z=this.configs)==null?void 0:Z.generation_config)??null}_get_logits_warper(Z){const Se=new h.LogitsProcessorList;return Z.temperature!==null&&Z.temperature!==1&&Se.push(new h.TemperatureLogitsWarper(Z.temperature)),Z.top_k!==null&&Z.top_k!==0&&Se.push(new h.TopKLogitsWarper(Z.top_k)),Z.top_p!==null&&Z.top_p<1&&Se.push(new h.TopPLogitsWarper(Z.top_p)),Se}_get_logits_processor(Z,Se,je=null){const Ne=new h.LogitsProcessorList;if(Z.repetition_penalty!==null&&Z.repetition_penalty!==1&&Ne.push(new h.RepetitionPenaltyLogitsProcessor(Z.repetition_penalty)),Z.no_repeat_ngram_size!==null&&Z.no_repeat_ngram_size>0&&Ne.push(new h.NoRepeatNGramLogitsProcessor(Z.no_repeat_ngram_size)),Z.bad_words_ids!==null&&Ne.push(new h.NoBadWordsLogitsProcessor(Z.bad_words_ids,Z.eos_token_id)),Z.min_length!==null&&Z.eos_token_id!==null&&Z.min_length>0&&Ne.push(new h.MinLengthLogitsProcessor(Z.min_length,Z.eos_token_id)),Z.min_new_tokens!==null&&Z.eos_token_id!==null&&Z.min_new_tokens>0&&Ne.push(new h.MinNewTokensLengthLogitsProcessor(Se,Z.min_new_tokens,Z.eos_token_id)),Z.forced_bos_token_id!==null&&Ne.push(new h.ForcedBOSTokenLogitsProcessor(Z.forced_bos_token_id)),Z.forced_eos_token_id!==null&&Ne.push(new h.ForcedEOSTokenLogitsProcessor(Z.max_length,Z.forced_eos_token_id)),Z.begin_suppress_tokens!==null){const it=Se>1||Z.forced_bos_token_id===null?Se:Se+1;Ne.push(new h.SuppressTokensAtBeginLogitsProcessor(Z.begin_suppress_tokens,it))}return Z.guidance_scale!==null&&Z.guidance_scale>1&&Ne.push(new h.ClassifierFreeGuidanceLogitsProcessor(Z.guidance_scale)),je!==null&&Ne.extend(je),Ne}_prepare_generation_config(Z,Se,je=m.GenerationConfig){const Ne={...this.config};for(const at of["decoder","generator","text_config"])at in Ne&&Object.assign(Ne,Ne[at]);const it=new je(Ne);return Object.assign(it,this.generation_config??{}),Z&&Object.assign(it,Z),Se&&Object.assign(it,(0,c.pick)(Se,Object.getOwnPropertyNames(it))),it}_get_stopping_criteria(Z,Se=null){const je=new E.StoppingCriteriaList;return Z.max_length!==null&&je.push(new E.MaxLengthCriteria(Z.max_length,this.config.max_position_embeddings??null)),Z.eos_token_id!==null&&je.push(new E.EosTokenCriteria(Z.eos_token_id)),Se&&je.extend(Se),je}_validate_model_class(){if(!this.can_generate){const Z=[xg,oc,Cd,Sd],Se=D.get(this.constructor),je=new Set,Ne=this.config.model_type;for(const at of Z){const bt=at.get(Ne);bt&&je.add(bt[0])}let it=`The current model class (${Se}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw je.size>0&&(it+=` Please use the following class instead: ${[...je].join(", ")}`),Error(it)}}prepare_inputs_for_generation(...Z){return this._prepare_inputs_for_generation(this,...Z)}_update_model_kwargs_for_generation({generated_input_ids:Z,outputs:Se,model_inputs:je,is_encoder_decoder:Ne}){return je.past_key_values=this.getPastKeyValues(Se,je.past_key_values),je.input_ids=new p.Tensor("int64",Z.flat(),[Z.length,1]),Ne||(je.attention_mask=(0,p.cat)([je.attention_mask,(0,p.ones)([je.attention_mask.dims[0],1])],1)),je.position_ids=null,je}_prepare_model_inputs({inputs:Z,bos_token_id:Se,model_kwargs:je}){const Ne=(0,c.pick)(je,this.forward_params),it=this.main_input_name;if(it in Ne){if(Z)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else Ne[it]=Z;return{inputs_tensor:Ne[it],model_inputs:Ne,model_input_name:it}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:Z,model_inputs:Se,model_input_name:je,generation_config:Ne}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!Se.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:at,pixel_values:bt,attention_mask:Et,...Qt}=Se,Xt=await this._prepare_inputs_embeds(Se);Se={...Qt,...(0,c.pick)(Xt,["inputs_embeds","attention_mask"])}}let{last_hidden_state:it}=await xe(this,Se);if(Ne.guidance_scale!==null&&Ne.guidance_scale>1)it=(0,p.cat)([it,(0,p.full_like)(it,0)],0),"attention_mask"in Se&&(Se.attention_mask=(0,p.cat)([Se.attention_mask,(0,p.zeros_like)(Se.attention_mask)],0));else if(Se.decoder_input_ids){const at=he(Se.decoder_input_ids).dims[0];if(at!==it.dims[0]){if(it.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${it.dims[0]}) than the decoder inputs (${at}).`);it=(0,p.cat)(Array.from({length:at},()=>it),0)}}return Se.encoder_outputs=it,Se}_prepare_decoder_input_ids_for_generation({batch_size:Z,model_input_name:Se,model_kwargs:je,decoder_start_token_id:Ne,bos_token_id:it,generation_config:at}){let{decoder_input_ids:bt,...Et}=je;if(!(bt instanceof p.Tensor)){if(bt)Array.isArray(bt[0])||(bt=Array.from({length:Z},()=>bt));else if(Ne??(Ne=it),this.config.model_type==="musicgen")bt=Array.from({length:Z*this.config.decoder.num_codebooks},()=>[Ne]);else if(Array.isArray(Ne)){if(Ne.length!==Z)throw new Error(`\`decoder_start_token_id\` expcted to have length ${Z} but got ${Ne.length}`);bt=Ne}else bt=Array.from({length:Z},()=>[Ne]);bt=he(bt)}return je.decoder_attention_mask=(0,p.ones_like)(bt),{input_ids:bt,model_inputs:Et}}async generate({inputs:Z=null,generation_config:Se=null,logits_processor:je=null,stopping_criteria:Ne=null,streamer:it=null,...at}){this._validate_model_class(),Se=this._prepare_generation_config(Se,at);let{inputs_tensor:bt,model_inputs:Et,model_input_name:Qt}=this._prepare_model_inputs({inputs:Z,model_kwargs:at});const Xt=this.config.is_encoder_decoder;Xt&&("encoder_outputs"in Et||(Et=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:bt,model_inputs:Et,model_input_name:Qt,generation_config:Se})));let Gt;Xt?{input_ids:Gt,model_inputs:Et}=this._prepare_decoder_input_ids_for_generation({batch_size:Et[Qt].dims.at(0),model_input_name:Qt,model_kwargs:Et,decoder_start_token_id:Se.decoder_start_token_id,bos_token_id:Se.bos_token_id,generation_config:Se}):Gt=Et[Qt];let Zt=Gt.dims.at(-1);Se.max_new_tokens!==null&&(Se.max_length=Zt+Se.max_new_tokens);const hn=this._get_logits_processor(Se,Zt,je),_n=this._get_stopping_criteria(Se,Ne),un=Et[Qt].dims.at(0),xn=O.LogitsSampler.getSampler(Se),Zn=new Array(un).fill(0),Hn=Gt.tolist();it&&it.put(Hn);let Dn,Xn={};for(;;){if(Et=this.prepare_inputs_for_generation(Hn,Et,Se),Dn=await this.forward(Et),Se.output_attentions&&Se.return_dict_in_generate){const ds=this.getAttentions(Dn);for(const Js in ds)Js in Xn||(Xn[Js]=[]),Xn[Js].push(ds[Js])}const Rr=Dn.logits.slice(null,-1,null),Ns=hn(Hn,Rr),Ho=[];for(let ds=0;ds<Ns.dims.at(0);++ds){const Js=Ns[ds],a_=await xn(Js);for(const[ac,Ra]of a_){const lc=BigInt(ac);Zn[ds]+=Ra,Hn[ds].push(lc),Ho.push([lc]);break}}if(it&&it.put(Ho),_n(Hn).every(ds=>ds))break;Et=this._update_model_kwargs_for_generation({generated_input_ids:Ho,outputs:Dn,model_inputs:Et,is_encoder_decoder:Xt})}it&&it.end();const ir=this.getPastKeyValues(Dn,Et.past_key_values,!0),Ur=new p.Tensor("int64",Hn.flat(),[Hn.length,Hn[0].length]);if(Se.return_dict_in_generate)return{sequences:Ur,past_key_values:ir,...Xn};for(const Rr of Object.values(Dn))Rr.location==="gpu-buffer"&&Rr.dispose();return Ur}getPastKeyValues(Z,Se,je=!1){const Ne=Object.create(null);for(const it in Z)if(it.startsWith("present")){const at=it.replace("present","past_key_values"),bt=it.includes("encoder");if(bt&&Se?Ne[at]=Se[at]:Ne[at]=Z[it],Se&&(!bt||je)){const Et=Se[at];Et.location==="gpu-buffer"&&Et.dispose()}}return Ne}getAttentions(Z){const Se={};for(const je of["cross_attentions","encoder_attentions","decoder_attentions"])for(const Ne in Z)Ne.startsWith(je)&&(je in Se||(Se[je]=[]),Se[je].push(Z[Ne]));return Se}addPastKeyValues(Z,Se){var je,Ne,it;if(Se)Object.assign(Z,Se);else{const at=this.sessions.decoder_model_merged??this.sessions.model,bt=((je=at==null?void 0:at.config)==null?void 0:je.kv_cache_dtype)??"float32",Et=bt==="float16"?new Uint16Array:[],Qt=((it=(Ne=Z[this.main_input_name]??Z.attention_mask)==null?void 0:Ne.dims)==null?void 0:it[0])??1,Xt=(0,r.getKeyValueShapes)(this.config,{batch_size:Qt});for(const Gt in Xt)Z[Gt]=new p.Tensor(bt,Et,Xt[Gt])}}async encode_image({pixel_values:Z}){const Se=(await de(this.sessions.vision_encoder,{pixel_values:Z})).image_features;return this.config.num_image_tokens||(console.warn(`The number of image tokens was not set in the model configuration. Setting it to the number of features detected by the vision encoder (${Se.dims[1]}).`),this.config.num_image_tokens=Se.dims[1]),Se}async encode_text({input_ids:Z}){return(await de(this.sessions.embed_tokens,{input_ids:Z})).inputs_embeds}}class Ye{}class Ge extends Ye{constructor({last_hidden_state:V,hidden_states:Z=null,attentions:Se=null}){super(),this.last_hidden_state=V,this.hidden_states=Z,this.attentions=Se}}class _e extends pe{}class Ae extends _e{}class He extends _e{async _call(V){return new Fr(await super._call(V))}}class qe extends _e{async _call(V){return new sn(await super._call(V))}}class Qe extends _e{async _call(V){return new kr(await super._call(V))}}class Ke extends _e{async _call(V){return new Hr(await super._call(V))}}class rt extends pe{}class ht extends rt{}class _t extends rt{async _call(V){return new Fr(await super._call(V))}}class ot extends rt{async _call(V){return new sn(await super._call(V))}}class mt extends rt{async _call(V){return new kr(await super._call(V))}}class Q extends pe{}class ve extends Q{}class ie extends pe{}class Ee extends ie{}class Re extends ie{async _call(V){return new Fr(await super._call(V))}}class Xe extends ie{async _call(V){return new sn(await super._call(V))}}class Ze extends ie{async _call(V){return new kr(await super._call(V))}}class ft extends ie{async _call(V){return new Hr(await super._call(V))}}class gt extends pe{}class St extends gt{}class kt extends gt{async _call(V){return new Fr(await super._call(V))}}class Dt extends gt{async _call(V){return new sn(await super._call(V))}}class mn extends gt{async _call(V){return new kr(await super._call(V))}}class An extends gt{async _call(V){return new Hr(await super._call(V))}}class Gn extends pe{}class zn extends Gn{}class Br extends Gn{async _call(V){return new Fr(await super._call(V))}}class en extends Gn{async _call(V){return new sn(await super._call(V))}}class $n extends Gn{async _call(V){return new kr(await super._call(V))}}class ln extends Gn{async _call(V){return new Hr(await super._call(V))}}class fr extends pe{}class Rt extends fr{}class bs extends fr{async _call(V){return new Fr(await super._call(V))}}class Os extends fr{async _call(V){return new sn(await super._call(V))}}class fi extends fr{async _call(V){return new kr(await super._call(V))}}class so extends fr{async _call(V){return new Hr(await super._call(V))}}class xs extends pe{}class io extends xs{}class pi extends xs{async _call(V){return new Fr(await super._call(V))}}class Oi extends xs{async _call(V){return new sn(await super._call(V))}}class Di extends xs{async _call(V){return new kr(await super._call(V))}}class ls extends xs{async _call(V){return new Hr(await super._call(V))}}class ut extends pe{}class At extends ut{}class Wt extends ut{async _call(V){return new Fr(await super._call(V))}}class Pr extends ut{async _call(V){return new sn(await super._call(V))}}class Li extends ut{async _call(V){return new kr(await super._call(V))}}class mi extends ut{async _call(V){return new Hr(await super._call(V))}}class Bn extends pe{}class cs extends Bn{}class sr extends Bn{async _call(V){return new sn(await super._call(V))}}class Ys extends Bn{async _call(V){return new kr(await super._call(V))}}class fn extends Bn{async _call(V){return new Hr(await super._call(V))}}class jo extends Bn{async _call(V){return new Fr(await super._call(V))}}class Fi extends pe{}class Fl extends Fi{}class wa extends Fi{async _call(V){return new Fr(await super._call(V))}}class ba extends Fi{async _call(V){return new sn(await super._call(V))}}class xa extends Fi{async _call(V){return new kr(await super._call(V))}}class Ri extends pe{}class Ma extends Ri{}class Rl extends Ri{async _call(V){return new Fr(await super._call(V))}}class ji extends Ri{async _call(V){return new sn(await super._call(V))}}class Ds extends Ri{async _call(V){return new Hr(await super._call(V))}}class us extends pe{}class No extends us{}class oo extends us{async _call(V){return new Fr(await super._call(V))}}class zo extends us{async _call(V){return new sn(await super._call(V))}}class Bo extends us{async _call(V){return new kr(await super._call(V))}}class Vo extends us{async _call(V){return new Hr(await super._call(V))}}class Kt extends pe{}class Uo extends Kt{}class Ta extends Kt{async _call(V){return new Fr(await super._call(V))}}class Ea extends Kt{async _call(V){return new sn(await super._call(V))}}class Pa extends Kt{async _call(V){return new Hr(await super._call(V))}}class Ni extends pe{}class Sa extends Ni{}class Wo extends Ni{async _call(V){return new sn(await super._call(V))}}class Ca extends Ni{async _call(V){return new Hr(await super._call(V))}}class Mn extends Ni{async _call(V){return new Fr(await super._call(V))}}class Le extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class G extends Le{}class ae extends Le{}class be extends pe{}class Oe extends be{}class Fe extends be{}class tt extends pe{}class yt extends tt{}class xt extends tt{}class wt extends pe{}class Ct extends wt{}class tn extends wt{}class In extends wt{async _call(V){return new sn(await super._call(V))}}class En extends pe{}class lr extends En{}class Ht extends En{}class gn extends En{async _call(V){return new sn(await super._call(V))}}class Xr extends En{}class Sr extends pe{}class We extends Sr{}class Vr extends Sr{}class gi extends pe{}class tr extends gi{}class Dr extends gi{}class zt extends pe{}class ts extends zt{}class Ls extends zt{async _call(V){return new Fr(await super._call(V))}}class On extends zt{async _call(V){return new sn(await super._call(V))}}class nr extends zt{async _call(V){return new kr(await super._call(V))}}class Tt extends zt{async _call(V){return new Hr(await super._call(V))}}class rn extends pe{}class pr extends rn{}class rr extends rn{async _call(V){return new Fr(await super._call(V))}}class Cr extends rn{async _call(V){return new sn(await super._call(V))}}class Ft extends rn{async _call(V){return new kr(await super._call(V))}}class ao extends rn{async _call(V){return new Hr(await super._call(V))}}class et extends pe{}class jt extends et{}class pf extends et{async _call(V){return new Fr(await super._call(V))}}class Jc extends et{async _call(V){return new sn(await super._call(V))}}class mf extends et{async _call(V){return new kr(await super._call(V))}}class gf extends et{async _call(V){return new Hr(await super._call(V))}}class cn extends pe{}class _f extends cn{}class Zc extends cn{}class eu extends pe{constructor(){super(...arguments);Pe(this,"requires_attention_mask",!1);Pe(this,"main_input_name","input_features");Pe(this,"forward_params",["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class yf extends eu{}class vf extends eu{_prepare_generation_config(V,Z){return super._prepare_generation_config(V,Z,M.WhisperGenerationConfig)}_retrieve_init_tokens(V){const Z=[V.decoder_start_token_id];let Se=V.language;const je=V.task;if(V.is_multilingual){Se||(console.warn("No language specified - defaulting to English (en)."),Se="en");const it=`<|${(0,I.whisper_language_to_code)(Se)}|>`;Z.push(V.lang_to_id[it]),Z.push(V.task_to_id[je??"transcribe"])}else if(Se||je)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!V.return_timestamps&&V.no_timestamps_token_id&&Z.at(-1)!==V.no_timestamps_token_id?Z.push(V.no_timestamps_token_id):V.return_timestamps&&Z.at(-1)===V.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),Z.pop()),Z.filter(Ne=>Ne!=null)}async generate({inputs:V=null,generation_config:Z=null,logits_processor:Se=null,stopping_criteria:je=null,...Ne}){Z=this._prepare_generation_config(Z,Ne);const it=Ne.decoder_input_ids??this._retrieve_init_tokens(Z);if(Z.return_timestamps&&(Se??(Se=new h.LogitsProcessorList),Se.push(new h.WhisperTimeStampLogitsProcessor(Z,it))),Z.begin_suppress_tokens&&(Se??(Se=new h.LogitsProcessorList),Se.push(new h.SuppressTokensAtBeginLogitsProcessor(Z.begin_suppress_tokens,it.length))),Z.return_token_timestamps){if(!Z.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");Z.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),Z.output_attentions=!0,Z.return_dict_in_generate=!0}const at=await super.generate({inputs:V,generation_config:Z,logits_processor:Se,decoder_input_ids:it,...Ne});return Z.return_token_timestamps&&(at.token_timestamps=this._extract_token_timestamps(at,Z.alignment_heads,Z.num_frames)),at}_extract_token_timestamps(V,Z,Se=null,je=.02){if(!V.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");Se==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let Ne=this.config.median_filter_width;Ne===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),Ne=7);const it=V.cross_attentions,at=Array.from({length:this.config.decoder_layers},(_n,un)=>(0,p.cat)(it.map(xn=>xn[un]),2)),bt=(0,p.stack)(Z.map(([_n,un])=>{if(_n>=at.length)throw new Error(`Layer index ${_n} is out of bounds for cross attentions (length ${at.length}).`);return Se?at[_n].slice(null,un,null,[0,Se]):at[_n].slice(null,un)})).transpose(1,0,2,3),[Et,Qt]=(0,p.std_mean)(bt,-2,0,!0),Xt=bt.clone();for(let _n=0;_n<Xt.dims[0];++_n){const un=Xt[_n];for(let xn=0;xn<un.dims[0];++xn){const Zn=un[xn],Hn=Et[_n][xn][0].data,Dn=Qt[_n][xn][0].data;for(let Xn=0;Xn<Zn.dims[0];++Xn){let ir=Zn[Xn].data;for(let Ur=0;Ur<ir.length;++Ur)ir[Ur]=(ir[Ur]-Dn[Ur])/Hn[Ur];ir.set((0,T.medianFilter)(ir,Ne))}}}const Gt=[(0,p.mean)(Xt,1)],Zt=V.sequences.dims,hn=new p.Tensor("float32",new Float32Array(Zt[0]*Zt[1]),Zt);for(let _n=0;_n<Zt[0];++_n){const un=Gt[_n].neg().squeeze_(0),[xn,Zn]=(0,T.dynamic_time_warping)(un.tolist()),Hn=Array.from({length:xn.length-1},(ir,Ur)=>xn[Ur+1]-xn[Ur]),Dn=(0,c.mergeArrays)([1],Hn).map(ir=>!!ir),Xn=[];for(let ir=0;ir<Dn.length;++ir)Dn[ir]&&Xn.push(Zn[ir]*je);hn[_n].data.set(Xn,1)}return hn}}class tu extends pe{constructor(){super(...arguments);Pe(this,"requires_attention_mask",!1);Pe(this,"main_input_name","input_values");Pe(this,"forward_params",["input_values","decoder_input_ids","past_key_values"])}}class Ms extends tu{}class wf extends tu{}class nu extends pe{constructor(){super(...arguments);Pe(this,"main_input_name","pixel_values");Pe(this,"forward_params",["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"])}}class zi extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class jl extends zi{_merge_input_ids_with_image_features({inputs_embeds:V,image_features:Z,input_ids:Se,attention_mask:je}){const Ne=this.config.image_token_index,at=Se.tolist().map(Gt=>Gt.findIndex(Zt=>Zt==Ne)),bt=at.every(Gt=>Gt===-1),Et=at.every(Gt=>Gt!==-1);if(!bt&&!Et)throw new Error("Every input should contain either 0 or 1 image token.");if(bt)return{inputs_embeds:V,attention_mask:je};const Qt=[],Xt=[];for(let Gt=0;Gt<at.length;++Gt){const Zt=at[Gt],hn=V[Gt],_n=Z[Gt],un=je[Gt];Qt.push((0,p.cat)([hn.slice([0,Zt]),_n,hn.slice([Zt+1,hn.dims[0]])],0)),Xt.push((0,p.cat)([un.slice([0,Zt]),(0,p.ones)([_n.dims[0]]),un.slice([Zt+1,un.dims[0]])],0))}return{inputs_embeds:(0,p.stack)(Qt,0),attention_mask:(0,p.stack)(Xt,0)}}}class bf extends jl{}class xf extends jl{}class Mf extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"]);Pe(this,"main_input_name","inputs_embeds")}}class Tf extends Mf{_merge_input_ids_with_image_features({inputs_embeds:V,image_features:Z,input_ids:Se,attention_mask:je}){return{inputs_embeds:(0,p.cat)([Z,V],1),attention_mask:(0,p.cat)([(0,p.ones)(Z.dims.slice(0,2)),je],1)}}async _prepare_inputs_embeds({input_ids:V,pixel_values:Z,inputs_embeds:Se,attention_mask:je}){if(!V&&!Z)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let Ne,it;return V&&(Ne=await this.encode_text({input_ids:V})),Z&&(it=await this.encode_image({pixel_values:Z})),Ne&&it?{inputs_embeds:Se,attention_mask:je}=this._merge_input_ids_with_image_features({inputs_embeds:Ne,image_features:it,input_ids:V,attention_mask:je}):Se=Ne||it,{inputs_embeds:Se,attention_mask:je}}async forward({input_ids:V,pixel_values:Z,attention_mask:Se,decoder_input_ids:je,decoder_attention_mask:Ne,encoder_outputs:it,past_key_values:at,inputs_embeds:bt,decoder_inputs_embeds:Et}){if(bt||({inputs_embeds:bt,attention_mask:Se}=await this._prepare_inputs_embeds({input_ids:V,pixel_values:Z,inputs_embeds:bt,attention_mask:Se})),!it){let{last_hidden_state:Gt}=await xe(this,{inputs_embeds:bt,attention_mask:Se});it=Gt}if(!Et){if(!je)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");Et=await this.encode_text({input_ids:je})}return await te(this,{inputs_embeds:Et,attention_mask:Ne,encoder_attention_mask:Se,encoder_hidden_states:it,past_key_values:at},!0)}}class Ef extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Pf extends Ef{_merge_input_ids_with_image_features(V){const Z=V.image_features.dims.at(-1),Se=V.image_features.view(-1,Z);return ke({image_token_id:this.config.image_token_index,...V,image_features:Se})}}class Sf extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"])}}class ru extends Sf{async encode_image({pixel_values:V,pixel_attention_mask:Z}){return(await de(this.sessions.vision_encoder,{pixel_values:V,pixel_attention_mask:Z})).image_features}_merge_input_ids_with_image_features(V){const Z=V.image_features.dims.at(-1),Se=V.image_features.view(-1,Z);return ke({image_token_id:this.config.image_token_id,...V,image_features:Se})}}class Cf extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"])}}class Ts extends Cf{async forward({input_ids:V=null,attention_mask:Z=null,pixel_values:Se=null,image_sizes:je=null,position_ids:Ne=null,inputs_embeds:it=null,past_key_values:at=null,generation_config:bt=null,logits_processor:Et=null,...Qt}){if(!it){let Gt;if(Se&&V.dims[1]!==1){if(!je)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:Gt}=await de(this.sessions.vision_encoder,{pixel_values:Se,image_sizes:je}))}else{const Zt=this.config.normalized_config.hidden_size;Gt=new p.Tensor("float32",[],[0,Zt])}({inputs_embeds:it}=await de(this.sessions.prepare_inputs_embeds,{input_ids:V,image_features:Gt}))}return await te(this,{inputs_embeds:it,past_key_values:at,attention_mask:Z,position_ids:Ne,generation_config:bt,logits_processor:Et},!1)}}class lo extends pe{}class kf extends lo{}class ny extends lo{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"text_model"})}}class Af extends lo{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"text_model"})}}class ry extends lo{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"vision_model"})}}class $f extends lo{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"vision_model"})}}class su extends pe{}class If extends su{}class Of extends su{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"text_model"})}}class Df extends lo{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"vision_model"})}}class sy extends pe{}class Fs extends sy{}class Nl extends pe{}class zl extends Nl{async forward(V){const Z=!V.input_ids,Se=!V.pixel_values;if(Z&&Se)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(Z&&(V.input_ids=(0,p.ones)([V.pixel_values.dims[0],1])),Se){const{image_size:Et}=this.config.vision_config;V.pixel_values=(0,p.full)([0,3,Et,Et],0)}const{text_embeddings:je,image_embeddings:Ne,l2norm_text_embeddings:it,l2norm_image_embeddings:at}=await super.forward(V),bt={};return Z||(bt.text_embeddings=je,bt.l2norm_text_embeddings=it),Se||(bt.image_embeddings=Ne,bt.l2norm_image_embeddings=at),bt}}class iu extends Nl{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"text_model"})}}class Rs extends Nl{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"vision_model"})}}class ou extends pe{}class Lf extends ou{}class Ff extends ou{}class au extends pe{}class Rf extends au{}class jf extends au{}class lu extends pe{}class Nf extends lu{}class zf extends lu{}class cu extends pe{}class js extends cu{}class Bf extends cu{}class uu extends pe{}class Vf extends uu{}class Uf extends uu{}class du extends pe{}class Wf extends du{}class Gf extends du{}class hu extends pe{}class Kf extends hu{}class Hf extends hu{}class Bl extends pe{}class fu extends Bl{}class qf extends Bl{}class pu extends pe{}class mu extends pu{}class iy extends pu{}class gu extends pe{}class Vl extends gu{}class Qf extends gu{}class _u extends pe{}class Yf extends _u{}class ka extends _u{}class yu extends pe{}class Xf extends yu{}class vu extends yu{}class wu extends pe{}class Jf extends wu{}class Zf extends wu{}class bu extends pe{}class oy extends bu{}class ep extends bu{}class xu extends pe{}class tp extends xu{}class ay extends xu{}class Mu extends pe{}class Pn extends Mu{}class np extends Mu{}class Tu extends pe{}class rp extends Tu{}class sp extends Tu{}class Eu extends pe{}class ip extends Eu{}class op extends Eu{}class Pu extends pe{}class ap extends Pu{}class lp extends Pu{}class cp extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"])}}class up extends cp{get_rope_index(V,Z,Se,je){const{vision_config:Ne,image_token_id:it,video_token_id:at,vision_start_token_id:bt}=this.config,Et=Ne.spatial_merge_size??2,Qt=[];if(Z||Se){let Xt=V.tolist();je||(je=(0,p.ones_like)(V));const Gt=je.tolist(),Zt=Array.from({length:3},Zn=>Array.from({length:V.dims[0]},Hn=>Array.from({length:V.dims[1]},Dn=>1))),hn=Z?Z.tolist():[],_n=Se?Se.tolist():[];let un=0,xn=0;for(let Zn=0;Zn<Xt.length;++Zn){const Hn=Xt[Zn].filter((qn,mr)=>Gt[Zn][mr]==1),Xn=Hn.reduce((qn,mr,vi)=>(mr==bt&&qn.push(vi),qn),[]).map(qn=>Hn[qn+1]),ir=Xn.filter(qn=>qn==it).length,Ur=Xn.filter(qn=>qn==at).length;let Rr=[],Ns=0,Ho=ir,Rd=Ur;for(let qn=0;qn<Xn.length;++qn){const mr=Hn.findIndex((mo,hs)=>hs>Ns&&mo==it),vi=Hn.findIndex((mo,hs)=>hs>Ns&&mo==at),fo=Ho>0&&mr!==-1?mr:Hn.length+1,qo=Rd>0&&vi!==-1?vi:Hn.length+1;let jd,cc,Nd,zd;fo<qo?([cc,Nd,zd]=hn[un],++un,--Ho,jd=fo):([cc,Nd,zd]=_n[xn],++xn,--Rd,jd=qo);const[L1,Bd,Qo]=[Number(cc),Math.floor(Number(Nd)/Et),Math.floor(Number(zd)/Et)],Vd=jd-Ns,l_=Rr.length>0?(0,T.max)(Rr.at(-1))[0]+1:0;Rr.push(Array.from({length:3*Vd},(mo,hs)=>l_+hs%Vd));const c_=Vd+l_,uc=L1*Bd*Qo,u_=Array.from({length:uc},(mo,hs)=>c_+Math.floor(hs/(Bd*Qo))),d_=Array.from({length:uc},(mo,hs)=>c_+Math.floor(hs/Qo)%Bd),po=Array.from({length:uc},(mo,hs)=>c_+hs%Qo);Rr.push([u_,d_,po].flat()),Ns=jd+uc}if(Ns<Hn.length){const qn=Rr.length>0?(0,T.max)(Rr.at(-1))[0]+1:0,mr=Hn.length-Ns;Rr.push(Array.from({length:3*mr},(vi,fo)=>qn+fo%mr))}const ds=Rr.reduce((qn,mr)=>qn+mr.length,0),Js=new Array(ds);let a_=0;for(let qn=0;qn<3;++qn)for(let mr=0;mr<Rr.length;++mr){const vi=Rr[mr],fo=vi.length/3;for(let qo=qn*fo;qo<(qn+1)*fo;++qo)Js[a_++]=vi[qo]}let ac=0;const Ra=Gt[Zn];for(let qn=0;qn<Ra.length;++qn)if(Ra[qn]==1){for(let mr=0;mr<3;++mr)Zt[mr][Zn][qn]=Js[mr*ds/3+ac];++ac}const lc=(0,T.max)(Js)[0];Qt.push(lc+1-Xt[Zn].length)}return[new p.Tensor("int64",Zt.flat(1/0),[3,V.dims[0],V.dims[1]]),new p.Tensor("int64",Qt,[Qt.length,1])]}else if(je){const{data:Xt,dims:Gt}=me(je),Zt=BigInt64Array.from({length:3*Xt.length},(_n,un)=>Xt[un%Xt.length]),hn=Array.from({length:Gt[0]},(_n,un)=>(0,T.max)(Xt.subarray(Gt[1]*un,Gt[1]*(un+1)))[0]+1n+BigInt(Gt[1]));return[new p.Tensor("int64",Zt,[3,...Gt]),new p.Tensor("int64",hn,[hn.length,1])]}else{const[Xt,Gt]=V.dims,Zt=BigInt64Array.from({length:3*Xt*Gt},(hn,_n)=>BigInt(Math.floor(_n%Gt/Xt)));return[new p.Tensor("int64",Zt,[3,...V.dims]),(0,p.zeros)([Xt,1])]}}async encode_image({pixel_values:V,image_grid_thw:Z}){return(await de(this.sessions.vision_encoder,{pixel_values:V,grid_thw:Z})).image_features}_merge_input_ids_with_image_features(V){return ke({image_token_id:this.config.image_token_id,...V})}prepare_inputs_for_generation(V,Z,Se){if(Z.attention_mask&&!Z.position_ids)if(!Z.past_key_values)[Z.position_ids,Z.rope_deltas]=this.get_rope_index(Z.input_ids,Z.image_grid_thw,Z.video_grid_thw,Z.attention_mask);else{Z.pixel_values=null;const je=BigInt(Object.values(Z.past_key_values)[0].dims.at(-2)),Ne=Z.rope_deltas.map(it=>je+it);Z.position_ids=(0,p.stack)([Ne,Ne,Ne],0)}return Z}}class Su extends pe{}class dp extends Su{}class Aa extends Su{}class Cu extends pe{}class Ul extends Cu{}class hp extends Cu{}class ku extends pe{}class fp extends ku{}class pp extends ku{}class Au extends pe{}class mp extends Au{}class gp extends Au{}class $u extends pe{}class _p extends $u{}class yp extends $u{}class Iu extends pe{}class vp extends Iu{}class wp extends Iu{async _call(V){return new sn(await super._call(V))}}class Ou extends pe{}class bp extends Ou{}class xp extends Ou{async _call(V){return new sn(await super._call(V))}}class Du extends pe{}class Mp extends Du{}class Wl extends pe{}class Lu extends Wl{}class Tp extends Wl{async _call(V){return new sn(await super._call(V))}}class Ep extends pe{}class Pp extends Ep{}class Fu extends pe{}class Sp extends Fu{}class Cp extends Fu{async _call(V){return new sn(await super._call(V))}}class Ru extends pe{}class kp extends Ru{}class ju extends pe{}class Ap extends ju{}class ly extends ju{async _call(V){return new sn(await super._call(V))}}class $p extends pe{}class Ip extends $p{async _call(V){return new Fa(await super._call(V))}}class Es extends pe{}class Op extends Es{}class Dp extends Es{async _call(V){return new sn(await super._call(V))}}class Nu extends pe{}class Lp extends Nu{}class Fp extends Nu{async _call(V){return new sn(await super._call(V))}}class zu extends pe{}class Rp extends zu{}class jp extends zu{}class Bu extends pe{}class Np extends Bu{}class cy extends Bu{}class Vu extends pe{}class zp extends Vu{}class Bp extends Vu{async _call(V){return new sn(await super._call(V))}}class Gl extends pe{}class Vp extends Gl{}class Up extends Gl{async _call(V){return new Bi(await super._call(V))}}class Wp extends Gl{async _call(V){return new co(await super._call(V))}}class Bi extends Ye{constructor({logits:V,pred_boxes:Z}){super(),this.logits=V,this.pred_boxes=Z}}class co extends Ye{constructor({logits:V,pred_boxes:Z,pred_masks:Se}){super(),this.logits=V,this.pred_boxes=Z,this.pred_masks=Se}}class Vi extends pe{}class Uu extends Vi{}class uo extends Vi{async _call(V){return new Lr(await super._call(V))}}class Lr extends Ye{constructor({logits:V,pred_boxes:Z}){super(),this.logits=V,this.pred_boxes=Z}}class Wu extends pe{}class Gu extends Wu{}class Gp extends Wu{async _call(V){return new uy(await super._call(V))}}class uy extends Bi{}class Go extends pe{}class Ku extends Go{}class Hu extends Go{async _call(V){return new sn(await super._call(V))}}class qu extends pe{}class Kp extends qu{}class Qu extends qu{async _call(V){return new sn(await super._call(V))}}class Kl extends pe{}class Hp extends Kl{}class Yu extends Kl{async _call(V){return new sn(await super._call(V))}}class Xu extends pe{}class Hl extends Xu{}class Ju extends Xu{async _call(V){return new sn(await super._call(V))}}class Zu extends pe{}class qp extends Zu{}class dy extends Zu{}class ed extends pe{}class td extends ed{}class $a extends ed{}class Qp extends pe{}class nd extends Qp{}class ql extends pe{}class Yp extends ql{}class Xp extends ql{}class hy extends ql{}class Jp extends pe{}class Zp extends Jp{}class em extends pe{}class tm extends em{}class Ql extends em{}class rd extends pe{}class Yl extends rd{}class sd extends rd{}class id extends pe{}class nm extends id{}class od extends pe{}class ad extends od{}class fy extends od{async _call(V){return new sn(await super._call(V))}}class ld extends pe{}class py extends ld{}class rm extends ld{async _call(V){return new sn(await super._call(V))}}class cd extends pe{}class sm extends cd{}class ud extends cd{async _call(V){return new sn(await super._call(V))}}class dd extends pe{}class im extends dd{}class hd extends dd{async _call(V){return new sn(await super._call(V))}}class om extends pe{}class am extends om{}class lm extends pe{}class cm extends lm{}class um extends lm{async _call(V){return new dm(await super._call(V))}}class dm extends Ye{constructor({logits:V,pred_boxes:Z}){super(),this.logits=V,this.pred_boxes=Z}}class my extends pe{}class hm extends my{async get_image_embeddings({pixel_values:V}){return await xe(this,{pixel_values:V})}async forward(V){if((!V.image_embeddings||!V.image_positional_embeddings)&&(V={...V,...await this.get_image_embeddings(V)}),!V.input_labels&&V.input_points){const Se=V.input_points.dims.slice(0,-1),je=Se.reduce((Ne,it)=>Ne*it,1);V.input_labels=new p.Tensor("int64",new BigInt64Array(je).fill(1n),Se)}const Z={image_embeddings:V.image_embeddings,image_positional_embeddings:V.image_positional_embeddings};return V.input_points&&(Z.input_points=V.input_points),V.input_labels&&(Z.input_labels=V.input_labels),V.input_boxes&&(Z.input_boxes=V.input_boxes),await de(this.sessions.prompt_encoder_mask_decoder,Z)}async _call(V){return new fm(await super._call(V))}}class fm extends Ye{constructor({iou_scores:V,pred_masks:Z}){super(),this.iou_scores=V,this.pred_masks=Z}}class fd extends pe{}class pm extends fd{}class mm extends fd{}class gm extends pe{}class Xl extends gm{}class Ia extends gm{}class _i extends pe{}class _m extends _i{}class ym extends _i{async _call(V){return new Ko(await super._call(V))}}class vm extends _i{async _call(V){return new sn(await super._call(V))}}class wm extends _i{async _call(V){return new kr(await super._call(V))}}class Jl extends pe{}class bm extends Jl{}class xm extends Jl{async _call(V){return new kr(await super._call(V))}}class Mm extends pe{}class gy extends Mm{}class Zl extends pe{}class pd extends Zl{}class Tm extends Zl{async _call(V){return new Ko(await super._call(V))}}class Em extends Zl{async _call(V){return new sn(await super._call(V))}}class Oa extends pe{}class _y extends Oa{}class Pm extends Oa{async _call(V){return new Ko(await super._call(V))}}class Sm extends Oa{async _call(V){return new sn(await super._call(V))}}class yy extends Oa{async _call(V){return new kr(await super._call(V))}}class ec extends pe{}class Cm extends ec{}class km extends ec{async _call(V){return new Ko(await super._call(V))}}class Am extends ec{async _call(V){return new sn(await super._call(V))}}class D1 extends pe{}class $m extends _i{}class Im extends _i{async _call(V){return new Ko(await super._call(V))}}class Om extends _i{async _call(V){return new sn(await super._call(V))}}class Da extends pe{}class Dm extends Da{}class Lm extends Da{async _call(V){return new Ko(await super._call(V))}}class Fm extends Da{async _call(V){return new sn(await super._call(V))}}class Rm extends Da{async _call(V){return new Ny(await super._call(V))}}class vy extends Da{async _call(V){return new kr(await super._call(V))}}class jm extends pe{}class Nm extends jm{}class tc extends pe{}class wy extends tc{}class by extends tc{}class zm extends tc{async generate_speech(V,Z,{threshold:Se=.5,minlenratio:je=0,maxlenratio:Ne=20,vocoder:it=null}={}){const at={input_ids:V},{encoder_outputs:bt,encoder_attention_mask:Et}=await xe(this,at),Qt=bt.dims[1]/this.config.reduction_factor,Xt=Math.floor(Qt*Ne),Gt=Math.floor(Qt*je),Zt=this.config.num_mel_bins;let hn=[],_n=null,un=null,xn=0;for(;;){++xn;const Dn=ue(!!un);let Xn;un?Xn=un.output_sequence_out:Xn=new p.Tensor("float32",new Float32Array(Zt),[1,1,Zt]);let ir={use_cache_branch:Dn,output_sequence:Xn,encoder_attention_mask:Et,speaker_embeddings:Z,encoder_hidden_states:bt};this.addPastKeyValues(ir,_n),un=await de(this.sessions.decoder_model_merged,ir),_n=this.getPastKeyValues(un,_n);const{prob:Ur,spectrum:Rr}=un;if(hn.push(Rr),xn>=Gt&&(Array.from(Ur.data).filter(Ns=>Ns>=Se).length>0||xn>=Xt))break}const Zn=(0,p.cat)(hn),{waveform:Hn}=await de(it.sessions.model,{spectrogram:Zn});return{spectrogram:Zn,waveform:Hn}}}class Bm extends pe{constructor(){super(...arguments);Pe(this,"main_input_name","spectrogram")}}class Vm extends pe{}class Um extends Vm{}class Wm extends pe{}class Xs extends Wm{}class yi extends Wm{}class Ui extends pe{}class ho extends Ui{}class Gm extends Ui{}class md extends pe{}class Km extends md{}class Hm extends md{}class nc extends pe{}class qm extends nc{}class Qm extends nc{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"text_model"})}}class Ym extends nc{static async from_pretrained(V,Z={}){return super.from_pretrained(V,{...Z,model_file_name:Z.model_file_name??"audio_model"})}}class Xm extends pe{}class gd extends Xm{async _call(V){return new o_(await super._call(V))}}class _d extends pe{}class ns extends _d{}class Jm extends _d{}class Zm extends _d{}class rc extends pe{}class eg extends rc{}class La extends rc{}class yd extends pe{}class tg extends yd{}class ng extends yd{async _call(V){return new sn(await super._call(V))}}class vd extends pe{}class xy extends vd{}class My extends vd{}class sc extends pe{constructor(){super(...arguments);Pe(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}_apply_and_filter_by_delay_pattern_mask(Z){const[Se,je]=Z.dims,Ne=this.config.decoder.num_codebooks,it=je-Ne;let at=0;for(let Qt=0;Qt<Z.size;++Qt){if(Z.data[Qt]===this.config.decoder.pad_token_id)continue;const Xt=Qt%je,Gt=Math.floor(Qt/je)%Ne,Zt=Xt-Gt;Zt>0&&Zt<=it&&(Z.data[at++]=Z.data[Qt])}const bt=Math.floor(Se/Ne),Et=at/(bt*Ne);return new p.Tensor(Z.type,Z.data.slice(0,at),[bt,Ne,Et])}prepare_inputs_for_generation(Z,Se,je){let Ne=structuredClone(Z);for(let at=0;at<Ne.length;++at)for(let bt=0;bt<Ne[at].length;++bt)at%this.config.decoder.num_codebooks>=bt&&(Ne[at][bt]=BigInt(this.config.decoder.pad_token_id));return je.guidance_scale!==null&&je.guidance_scale>1&&(Ne=Ne.concat(Ne)),super.prepare_inputs_for_generation(Ne,Se,je)}async generate(Z){const Se=await super.generate(Z),je=this._apply_and_filter_by_delay_pattern_mask(Se).unsqueeze_(0),{audio_values:Ne}=await de(this.sessions.encodec_decode,{audio_codes:je});return Ne}}class wd extends pe{}class rg extends wd{}class sg extends wd{async _call(V){return new sn(await super._call(V))}}class bd extends pe{}class ig extends bd{}class xd extends bd{async _call(V){return new sn(await super._call(V))}}class Md extends pe{}class Ty extends Md{}class Td extends Md{async _call(V){return new sn(await super._call(V))}}class Ed extends pe{}class og extends Ed{}class ag extends Ed{async _call(V){return new sn(await super._call(V))}}class Ey extends pe{}class lg extends Ey{}class cg extends pe{}class ug extends cg{constructor(...Z){super(...Z);Pe(this,"forward_params",["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"]);this._generation_mode="text"}async forward(Z){const Se=this._generation_mode??"text";let je;if(Se==="text"||!Z.past_key_values){const Et=this.sessions.prepare_inputs_embeds,Qt=(0,c.pick)(Z,Et.inputNames);je=await de(Et,Qt)}else{const Et=this.sessions.gen_img_embeds,Qt=(0,c.pick)({image_ids:Z.input_ids},Et.inputNames);je=await de(Et,Qt)}const Ne={...Z,...je},it=await te(this,Ne),at=this.sessions[Se==="text"?"lm_head":"gen_head"];if(!at)throw new Error(`Unable to find "${at}" generation head`);const bt=await de(at,(0,c.pick)(it,at.inputNames));return{...je,...it,...bt}}async generate(Z){return this._generation_mode="text",super.generate(Z)}async generate_images(Z){this._generation_mode="image";const Se=(Z.inputs??Z[this.main_input_name]).dims[1],Ne=(await super.generate(Z)).slice(null,[Se,null]),it=this.sessions.image_decode,{decoded_image:at}=await de(it,{generated_tokens:Ne}),bt=at.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),Et=[];for(const Qt of bt){const Xt=v.RawImage.fromTensor(Qt);Et.push(Xt)}return Et}}class Py extends Ye{constructor({char_logits:V,bpe_logits:Z,wp_logits:Se}){super(),this.char_logits=V,this.bpe_logits=Z,this.wp_logits=Se}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class dg extends pe{}class hg extends dg{async _call(V){return new Py(await super._call(V))}}class fg extends pe{}class pg extends fg{}class mg extends fg{}class Pd extends pe{}class gg extends Pd{}class _g extends Pd{}class jn{static async from_pretrained(V,{progress_callback:Z=null,config:Se=null,cache_dir:je=null,local_files_only:Ne=!1,revision:it="main",model_file_name:at=null,subfolder:bt="onnx",device:Et=null,dtype:Qt=null,use_external_data_format:Xt=null,session_options:Gt={}}={}){const Zt={progress_callback:Z,config:Se,cache_dir:je,local_files_only:Ne,revision:it,model_file_name:at,subfolder:bt,device:Et,dtype:Qt,use_external_data_format:Xt,session_options:Gt};if(Zt.config=await r.AutoConfig.from_pretrained(V,Zt),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);for(const hn of this.MODEL_CLASS_MAPPINGS){const _n=hn.get(Zt.config.model_type);if(_n)return await _n[1].from_pretrained(V,Zt)}if(this.BASE_IF_FAIL)return console.warn(`Unknown model class "${Zt.config.model_type}", attempting to construct from base class.`),await pe.from_pretrained(V,Zt);throw Error(`Unsupported model type: ${Zt.config.model_type}`)}}Pe(jn,"MODEL_CLASS_MAPPINGS",null),Pe(jn,"BASE_IF_FAIL",!1);const Sy=new Map([["bert",["BertModel",Ae]],["modernbert",["ModernBertModel",ht]],["nomic_bert",["NomicBertModel",ve]],["roformer",["RoFormerModel",Ee]],["electra",["ElectraModel",zn]],["esm",["EsmModel",Fl]],["convbert",["ConvBertModel",St]],["camembert",["CamembertModel",Rt]],["deberta",["DebertaModel",io]],["deberta-v2",["DebertaV2Model",At]],["mpnet",["MPNetModel",No]],["albert",["AlbertModel",Sa]],["distilbert",["DistilBertModel",cs]],["roberta",["RobertaModel",ts]],["xlm",["XLMModel",pr]],["xlm-roberta",["XLMRobertaModel",jt]],["clap",["ClapModel",qm]],["clip",["CLIPModel",kf]],["clipseg",["CLIPSegModel",Lf]],["chinese_clip",["ChineseCLIPModel",Fs]],["siglip",["SiglipModel",If]],["jina_clip",["JinaCLIPModel",zl]],["mobilebert",["MobileBertModel",Ma]],["squeezebert",["SqueezeBertModel",Uo]],["wav2vec2",["Wav2Vec2Model",_m]],["wav2vec2-bert",["Wav2Vec2BertModel",Cm]],["unispeech",["UniSpeechModel",pd]],["unispeech-sat",["UniSpeechSatModel",_y]],["hubert",["HubertModel",$m]],["wavlm",["WavLMModel",Dm]],["audio-spectrogram-transformer",["ASTModel",_f]],["vits",["VitsModel",gd]],["pyannote",["PyAnnoteModel",bm]],["wespeaker-resnet",["WeSpeakerResNetModel",gy]],["detr",["DetrModel",Vp]],["rt_detr",["RTDetrModel",Uu]],["table-transformer",["TableTransformerModel",Gu]],["vit",["ViTModel",vp]],["ijepa",["IJepaModel",bp]],["pvt",["PvtModel",Lu]],["vit_msn",["ViTMSNModel",Sp]],["vit_mae",["ViTMAEModel",Pp]],["groupvit",["GroupViTModel",kp]],["fastvit",["FastViTModel",Ap]],["mobilevit",["MobileViTModel",Op]],["mobilevitv2",["MobileViTV2Model",Lp]],["owlvit",["OwlViTModel",Rp]],["owlv2",["Owlv2Model",Np]],["beit",["BeitModel",zp]],["deit",["DeiTModel",Ku]],["hiera",["HieraModel",Kp]],["convnext",["ConvNextModel",ad]],["convnextv2",["ConvNextV2Model",py]],["dinov2",["Dinov2Model",sm]],["dinov2_with_registers",["Dinov2WithRegistersModel",im]],["resnet",["ResNetModel",Hp]],["swin",["SwinModel",Hl]],["swin2sr",["Swin2SRModel",qp]],["donut-swin",["DonutSwinModel",nm]],["yolos",["YolosModel",cm]],["dpt",["DPTModel",td]],["glpn",["GLPNModel",Yl]],["hifigan",["SpeechT5HifiGan",Bm]],["efficientnet",["EfficientNetModel",tg]],["decision_transformer",["DecisionTransformerModel",lg]],["patchtst",["PatchTSTForPrediction",pg]],["patchtsmixer",["PatchTSMixerForPrediction",gg]],["mobilenet_v1",["MobileNetV1Model",rg]],["mobilenet_v2",["MobileNetV2Model",ig]],["mobilenet_v3",["MobileNetV3Model",Ty]],["mobilenet_v4",["MobileNetV4Model",og]],["maskformer",["MaskFormerModel",tm]],["mgp-str",["MgpstrForSceneTextRecognition",hg]],["style_text_to_speech_2",["StyleTextToSpeech2Model",Nm]]]),Cy=new Map([["t5",["T5Model",G]],["longt5",["LongT5Model",Oe]],["mt5",["MT5Model",yt]],["bart",["BartModel",Ct]],["mbart",["MBartModel",lr]],["marian",["MarianModel",pm]],["whisper",["WhisperModel",yf]],["m2m_100",["M2M100Model",Xl]],["blenderbot",["BlenderbotModel",We]],["blenderbot-small",["BlenderbotSmallModel",tr]]]),ky=new Map([["bloom",["BloomModel",fp]],["jais",["JAISModel",Nf]],["gpt2",["GPT2Model",Rf]],["gptj",["GPTJModel",Wf]],["gpt_bigcode",["GPTBigCodeModel",Kf]],["gpt_neo",["GPTNeoModel",js]],["gpt_neox",["GPTNeoXModel",Vf]],["codegen",["CodeGenModel",fu]],["llama",["LlamaModel",mu]],["exaone",["ExaoneModel",Vl]],["olmo",["OlmoModel",Xf]],["olmo2",["Olmo2Model",Jf]],["mobilellm",["MobileLLMModel",Yf]],["granite",["GraniteModel",oy]],["cohere",["CohereModel",tp]],["gemma",["GemmaModel",Pn]],["gemma2",["Gemma2Model",rp]],["openelm",["OpenELMModel",ip]],["qwen2",["Qwen2Model",ap]],["phi",["PhiModel",dp]],["phi3",["Phi3Model",Ul]],["mpt",["MptModel",mp]],["opt",["OPTModel",_p]],["mistral",["MistralModel",Xs]],["starcoder2",["Starcoder2Model",ho]],["falcon",["FalconModel",Km]],["stablelm",["StableLmModel",eg]]]),Sd=new Map([["speecht5",["SpeechT5ForSpeechToText",by]],["whisper",["WhisperForConditionalGeneration",vf]],["moonshine",["MoonshineForConditionalGeneration",wf]]]),yg=new Map([["speecht5",["SpeechT5ForTextToSpeech",zm]]]),vg=new Map([["vits",["VitsModel",gd]],["musicgen",["MusicgenForConditionalGeneration",sc]]]),wg=new Map([["bert",["BertForSequenceClassification",qe]],["modernbert",["ModernBertForSequenceClassification",ot]],["roformer",["RoFormerForSequenceClassification",Xe]],["electra",["ElectraForSequenceClassification",en]],["esm",["EsmForSequenceClassification",ba]],["convbert",["ConvBertForSequenceClassification",Dt]],["camembert",["CamembertForSequenceClassification",Os]],["deberta",["DebertaForSequenceClassification",Oi]],["deberta-v2",["DebertaV2ForSequenceClassification",Pr]],["mpnet",["MPNetForSequenceClassification",zo]],["albert",["AlbertForSequenceClassification",Wo]],["distilbert",["DistilBertForSequenceClassification",sr]],["roberta",["RobertaForSequenceClassification",On]],["xlm",["XLMForSequenceClassification",Cr]],["xlm-roberta",["XLMRobertaForSequenceClassification",Jc]],["bart",["BartForSequenceClassification",In]],["mbart",["MBartForSequenceClassification",gn]],["mobilebert",["MobileBertForSequenceClassification",ji]],["squeezebert",["SqueezeBertForSequenceClassification",Ea]]]),bg=new Map([["bert",["BertForTokenClassification",Qe]],["modernbert",["ModernBertForTokenClassification",mt]],["roformer",["RoFormerForTokenClassification",Ze]],["electra",["ElectraForTokenClassification",$n]],["esm",["EsmForTokenClassification",xa]],["convbert",["ConvBertForTokenClassification",mn]],["camembert",["CamembertForTokenClassification",fi]],["deberta",["DebertaForTokenClassification",Di]],["deberta-v2",["DebertaV2ForTokenClassification",Li]],["mpnet",["MPNetForTokenClassification",Bo]],["distilbert",["DistilBertForTokenClassification",Ys]],["roberta",["RobertaForTokenClassification",nr]],["xlm",["XLMForTokenClassification",Ft]],["xlm-roberta",["XLMRobertaForTokenClassification",mf]]]),Cd=new Map([["t5",["T5ForConditionalGeneration",ae]],["longt5",["LongT5ForConditionalGeneration",Fe]],["mt5",["MT5ForConditionalGeneration",xt]],["bart",["BartForConditionalGeneration",tn]],["mbart",["MBartForConditionalGeneration",Ht]],["marian",["MarianMTModel",mm]],["m2m_100",["M2M100ForConditionalGeneration",Ia]],["blenderbot",["BlenderbotForConditionalGeneration",Vr]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",Dr]]]),xg=new Map([["bloom",["BloomForCausalLM",pp]],["gpt2",["GPT2LMHeadModel",jf]],["jais",["JAISLMHeadModel",zf]],["gptj",["GPTJForCausalLM",Gf]],["gpt_bigcode",["GPTBigCodeForCausalLM",Hf]],["gpt_neo",["GPTNeoForCausalLM",Bf]],["gpt_neox",["GPTNeoXForCausalLM",Uf]],["codegen",["CodeGenForCausalLM",qf]],["llama",["LlamaForCausalLM",iy]],["exaone",["ExaoneForCausalLM",Qf]],["olmo",["OlmoForCausalLM",vu]],["olmo2",["Olmo2ForCausalLM",Zf]],["mobilellm",["MobileLLMForCausalLM",ka]],["granite",["GraniteForCausalLM",ep]],["cohere",["CohereForCausalLM",ay]],["gemma",["GemmaForCausalLM",np]],["gemma2",["Gemma2ForCausalLM",sp]],["openelm",["OpenELMForCausalLM",op]],["qwen2",["Qwen2ForCausalLM",lp]],["phi",["PhiForCausalLM",Aa]],["phi3",["Phi3ForCausalLM",hp]],["mpt",["MptForCausalLM",gp]],["opt",["OPTForCausalLM",yp]],["mbart",["MBartForCausalLM",Xr]],["mistral",["MistralForCausalLM",yi]],["starcoder2",["Starcoder2ForCausalLM",Gm]],["falcon",["FalconForCausalLM",Hm]],["trocr",["TrOCRForCausalLM",Um]],["stablelm",["StableLmForCausalLM",La]],["phi3_v",["Phi3VForCausalLM",Ts]]]),ic=new Map([["multi_modality",["MultiModalityCausalLM",ug]]]),kd=new Map([["bert",["BertForMaskedLM",He]],["modernbert",["ModernBertForMaskedLM",_t]],["roformer",["RoFormerForMaskedLM",Re]],["electra",["ElectraForMaskedLM",Br]],["esm",["EsmForMaskedLM",wa]],["convbert",["ConvBertForMaskedLM",kt]],["camembert",["CamembertForMaskedLM",bs]],["deberta",["DebertaForMaskedLM",pi]],["deberta-v2",["DebertaV2ForMaskedLM",Wt]],["mpnet",["MPNetForMaskedLM",oo]],["albert",["AlbertForMaskedLM",Mn]],["distilbert",["DistilBertForMaskedLM",jo]],["roberta",["RobertaForMaskedLM",Ls]],["xlm",["XLMWithLMHeadModel",rr]],["xlm-roberta",["XLMRobertaForMaskedLM",pf]],["mobilebert",["MobileBertForMaskedLM",Rl]],["squeezebert",["SqueezeBertForMaskedLM",Ta]]]),Ad=new Map([["bert",["BertForQuestionAnswering",Ke]],["roformer",["RoFormerForQuestionAnswering",ft]],["electra",["ElectraForQuestionAnswering",ln]],["convbert",["ConvBertForQuestionAnswering",An]],["camembert",["CamembertForQuestionAnswering",so]],["deberta",["DebertaForQuestionAnswering",ls]],["deberta-v2",["DebertaV2ForQuestionAnswering",mi]],["mpnet",["MPNetForQuestionAnswering",Vo]],["albert",["AlbertForQuestionAnswering",Ca]],["distilbert",["DistilBertForQuestionAnswering",fn]],["roberta",["RobertaForQuestionAnswering",Tt]],["xlm",["XLMForQuestionAnswering",ao]],["xlm-roberta",["XLMRobertaForQuestionAnswering",gf]],["mobilebert",["MobileBertForQuestionAnswering",Ds]],["squeezebert",["SqueezeBertForQuestionAnswering",Pa]]]),oc=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",nu]],["idefics3",["Idefics3ForConditionalGeneration",ru]]]),Mg=new Map([["llava",["LlavaForConditionalGeneration",jl]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",bf]],["moondream1",["Moondream1ForConditionalGeneration",xf]],["florence2",["Florence2ForConditionalGeneration",Tf]],["qwen2-vl",["Qwen2VLForConditionalGeneration",up]],["idefics3",["Idefics3ForConditionalGeneration",ru]],["paligemma",["PaliGemmaForConditionalGeneration",Pf]]]),Ay=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",nu]]]),Tg=new Map([["vit",["ViTForImageClassification",wp]],["ijepa",["IJepaForImageClassification",xp]],["pvt",["PvtForImageClassification",Tp]],["vit_msn",["ViTMSNForImageClassification",Cp]],["fastvit",["FastViTForImageClassification",ly]],["mobilevit",["MobileViTForImageClassification",Dp]],["mobilevitv2",["MobileViTV2ForImageClassification",Fp]],["beit",["BeitForImageClassification",Bp]],["deit",["DeiTForImageClassification",Hu]],["hiera",["HieraForImageClassification",Qu]],["convnext",["ConvNextForImageClassification",fy]],["convnextv2",["ConvNextV2ForImageClassification",rm]],["dinov2",["Dinov2ForImageClassification",ud]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",hd]],["resnet",["ResNetForImageClassification",Yu]],["swin",["SwinForImageClassification",Ju]],["segformer",["SegformerForImageClassification",Jm]],["efficientnet",["EfficientNetForImageClassification",ng]],["mobilenet_v1",["MobileNetV1ForImageClassification",sg]],["mobilenet_v2",["MobileNetV2ForImageClassification",xd]],["mobilenet_v3",["MobileNetV3ForImageClassification",Td]],["mobilenet_v4",["MobileNetV4ForImageClassification",ag]]]),$d=new Map([["detr",["DetrForObjectDetection",Up]],["rt_detr",["RTDetrForObjectDetection",uo]],["table-transformer",["TableTransformerForObjectDetection",Gp]],["yolos",["YolosForObjectDetection",um]]]),Id=new Map([["owlvit",["OwlViTForObjectDetection",jp]],["owlv2",["Owlv2ForObjectDetection",cy]],["grounding-dino",["GroundingDinoForObjectDetection",am]]]),Eg=new Map([["detr",["DetrForSegmentation",Wp]],["clipseg",["CLIPSegForImageSegmentation",Ff]]]),Pg=new Map([["segformer",["SegformerForSemanticSegmentation",Zm]],["sapiens",["SapiensForSemanticSegmentation",Yp]]]),Od=new Map([["detr",["DetrForSegmentation",Wp]],["maskformer",["MaskFormerForInstanceSegmentation",Ql]]]),Sg=new Map([["sam",["SamModel",hm]]]),Cg=new Map([["wav2vec2",["Wav2Vec2ForCTC",ym]],["wav2vec2-bert",["Wav2Vec2BertForCTC",km]],["unispeech",["UniSpeechForCTC",Tm]],["unispeech-sat",["UniSpeechSatForCTC",Pm]],["wavlm",["WavLMForCTC",Lm]],["hubert",["HubertForCTC",Im]]]),Dd=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",vm]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",Am]],["unispeech",["UniSpeechForSequenceClassification",Em]],["unispeech-sat",["UniSpeechSatForSequenceClassification",Sm]],["wavlm",["WavLMForSequenceClassification",Fm]],["hubert",["HubertForSequenceClassification",Om]],["audio-spectrogram-transformer",["ASTForAudioClassification",Zc]]]),kg=new Map([["wavlm",["WavLMForXVector",Rm]]]),Ag=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",yy]],["wavlm",["WavLMForAudioFrameClassification",vy]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",wm]],["pyannote",["PyAnnoteForAudioFrameClassification",xm]]]),$g=new Map([["vitmatte",["VitMatteForImageMatting",Ip]]]),$y=new Map([["patchtst",["PatchTSTForPrediction",mg]],["patchtsmixer",["PatchTSMixerForPrediction",_g]]]),Iy=new Map([["swin2sr",["Swin2SRForImageSuperResolution",dy]]]),Ig=new Map([["dpt",["DPTForDepthEstimation",$a]],["depth_anything",["DepthAnythingForDepthEstimation",nd]],["glpn",["GLPNForDepthEstimation",sd]],["sapiens",["SapiensForDepthEstimation",Xp]],["depth_pro",["DepthProForDepthEstimation",Zp]]]),Og=new Map([["sapiens",["SapiensForNormalEstimation",hy]]]),Dg=new Map([["vitpose",["VitPoseForPoseEstimation",Mp]]]),Lg=new Map([["clip",["CLIPVisionModelWithProjection",$f]],["siglip",["SiglipVisionModel",Df]],["jina_clip",["JinaCLIPVisionModel",Rs]]]),Oy=[[Sy,k.EncoderOnly],[Cy,k.EncoderDecoder],[ky,k.DecoderOnly],[wg,k.EncoderOnly],[bg,k.EncoderOnly],[Cd,k.Seq2Seq],[Sd,k.Seq2Seq],[xg,k.DecoderOnly],[ic,k.MultiModality],[kd,k.EncoderOnly],[Ad,k.EncoderOnly],[oc,k.Vision2Seq],[Mg,k.ImageTextToText],[Tg,k.EncoderOnly],[Eg,k.EncoderOnly],[Od,k.EncoderOnly],[Pg,k.EncoderOnly],[$g,k.EncoderOnly],[$y,k.EncoderOnly],[Iy,k.EncoderOnly],[Ig,k.EncoderOnly],[Og,k.EncoderOnly],[Dg,k.EncoderOnly],[$d,k.EncoderOnly],[Id,k.EncoderOnly],[Sg,k.MaskGeneration],[Cg,k.EncoderOnly],[Dd,k.EncoderOnly],[yg,k.Seq2Seq],[vg,k.EncoderOnly],[kg,k.EncoderOnly],[Ag,k.EncoderOnly],[Lg,k.EncoderOnly]];for(const[z,V]of Oy)for(const[Z,Se]of z.values())$.set(Z,V),D.set(Se,Z),P.set(Z,Se);const Dy=[["MusicgenForConditionalGeneration",sc,k.Musicgen],["Phi3VForCausalLM",Ts,k.Phi3V],["CLIPTextModelWithProjection",Af,k.EncoderOnly],["SiglipTextModel",Of,k.EncoderOnly],["JinaCLIPTextModel",iu,k.EncoderOnly],["ClapTextModelWithProjection",Qm,k.EncoderOnly],["ClapAudioModelWithProjection",Ym,k.EncoderOnly]];for(const[z,V,Z]of Dy)$.set(z,Z),D.set(V,z),P.set(z,V);class Ld extends jn{}Pe(Ld,"MODEL_CLASS_MAPPINGS",Oy.map(V=>V[0])),Pe(Ld,"BASE_IF_FAIL",!0);class Fg extends jn{}Pe(Fg,"MODEL_CLASS_MAPPINGS",[wg]);class Ly extends jn{}Pe(Ly,"MODEL_CLASS_MAPPINGS",[bg]);class Rg extends jn{}Pe(Rg,"MODEL_CLASS_MAPPINGS",[Cd]);class jg extends jn{}Pe(jg,"MODEL_CLASS_MAPPINGS",[Sd]);class Ng extends jn{}Pe(Ng,"MODEL_CLASS_MAPPINGS",[yg]);class zg extends jn{}Pe(zg,"MODEL_CLASS_MAPPINGS",[vg]);class Fy extends jn{}Pe(Fy,"MODEL_CLASS_MAPPINGS",[xg]);class Bg extends jn{}Pe(Bg,"MODEL_CLASS_MAPPINGS",[kd]);class Vg extends jn{}Pe(Vg,"MODEL_CLASS_MAPPINGS",[Ad]);class Ug extends jn{}Pe(Ug,"MODEL_CLASS_MAPPINGS",[oc]);class Wg extends jn{}Pe(Wg,"MODEL_CLASS_MAPPINGS",[Tg]);class Gg extends jn{}Pe(Gg,"MODEL_CLASS_MAPPINGS",[Eg]);class Kg extends jn{}Pe(Kg,"MODEL_CLASS_MAPPINGS",[Pg]);class Hg extends jn{}Pe(Hg,"MODEL_CLASS_MAPPINGS",[Od]);class qg extends jn{}Pe(qg,"MODEL_CLASS_MAPPINGS",[$d]);class Qg extends jn{}Pe(Qg,"MODEL_CLASS_MAPPINGS",[Id]);class Yg extends jn{}Pe(Yg,"MODEL_CLASS_MAPPINGS",[Sg]);class Xg extends jn{}Pe(Xg,"MODEL_CLASS_MAPPINGS",[Cg]);class Fd extends jn{}Pe(Fd,"MODEL_CLASS_MAPPINGS",[Dd]);class Jg extends jn{}Pe(Jg,"MODEL_CLASS_MAPPINGS",[kg]);class Zg extends jn{}Pe(Zg,"MODEL_CLASS_MAPPINGS",[Ag]);class e_ extends jn{}Pe(e_,"MODEL_CLASS_MAPPINGS",[Ay]);class t_ extends jn{}Pe(t_,"MODEL_CLASS_MAPPINGS",[$g]);class n_ extends jn{}Pe(n_,"MODEL_CLASS_MAPPINGS",[Iy]);class r_ extends jn{}Pe(r_,"MODEL_CLASS_MAPPINGS",[Ig]);class s_ extends jn{}Pe(s_,"MODEL_CLASS_MAPPINGS",[Og]);class Ry extends jn{}Pe(Ry,"MODEL_CLASS_MAPPINGS",[Dg]);class i_ extends jn{}Pe(i_,"MODEL_CLASS_MAPPINGS",[Lg]);class jy extends Ye{constructor({logits:V,past_key_values:Z,encoder_outputs:Se,decoder_attentions:je=null,cross_attentions:Ne=null}){super(),this.logits=V,this.past_key_values=Z,this.encoder_outputs=Se,this.decoder_attentions=je,this.cross_attentions=Ne}}class sn extends Ye{constructor({logits:V,...Z}){super(),this.logits=V;const Se=Object.values(Z);Se.length>0&&(this.attentions=Se)}}class Ny extends Ye{constructor({logits:V,embeddings:Z}){super(),this.logits=V,this.embeddings=Z}}class kr extends Ye{constructor({logits:V}){super(),this.logits=V}}class Fr extends Ye{constructor({logits:V}){super(),this.logits=V}}class Hr extends Ye{constructor({start_logits:V,end_logits:Z}){super(),this.start_logits=V,this.end_logits=Z}}class Ko extends Ye{constructor({logits:V}){super(),this.logits=V}}class zy extends Ye{constructor({logits:V,past_key_values:Z}){super(),this.logits=V,this.past_key_values=Z}}class Fa extends Ye{constructor({alphas:V}){super(),this.alphas=V}}class o_ extends Ye{constructor({waveform:V,spectrogram:Z}){super(),this.waveform=V,this.spectrogram=Z}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class o extends r.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,d=(0,s.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);for(let h=0;h<d.length;++h)d[h].push(0);this.mel_filters=d,this.window=(0,s.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(c,u){return(0,s.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:u,transpose:!0})}async _call(c){(0,r.validate_audio_inputs)(c,"ASTFeatureExtractor");const u=await this._extract_fbank_features(c,this.config.max_length);if(this.config.do_normalize){const d=this.std*2,h=u.data;for(let m=0;m<h.length;++m)h[m]=(h[m]-this.mean)/d}return{input_values:u.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoFeatureExtractor:()=>a});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js");n("./src/base/feature_extraction_utils.js");var o=n("./src/models/feature_extractors.js");class a{static async from_pretrained(u,d={}){const h=await(0,s.getModelJSON)(u,r.FEATURE_EXTRACTOR_NAME,!0,d),m=h.feature_extractor_type,p=o[m];if(!p)throw new Error(`Unknown feature_extractor_type: '${m}'. Please report this at ${r.GITHUB_ISSUE_URL}.`);return new p(h)}}},"./src/models/auto/image_processing_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoImageProcessor:()=>c});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js"),o=n("./src/base/image_processors_utils.js"),a=n("./src/models/image_processors.js");class c{static async from_pretrained(d,h={}){const m=await(0,s.getModelJSON)(d,r.IMAGE_PROCESSOR_NAME,!0,h),p=m.image_processor_type??m.feature_extractor_type;let v=a[p];return v||(p!==void 0&&console.warn(`Image processor type '${p}' not found, assuming base ImageProcessor. Please report this at ${r.GITHUB_ISSUE_URL}.`),v=o.ImageProcessor),new v(m)}}},"./src/models/auto/processing_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoProcessor:()=>d});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js"),o=n("./src/base/processing_utils.js"),a=n("./src/models/processors.js"),c=n("./src/models/image_processors.js"),u=n("./src/models/feature_extractors.js");class d{static async from_pretrained(m,p={}){const v=await(0,s.getModelJSON)(m,r.IMAGE_PROCESSOR_NAME,!0,p),{image_processor_type:T,feature_extractor_type:E,processor_class:O}=v;if(O&&a[O])return a[O].from_pretrained(m,p);if(!T&&!E)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const b={};if(T){const I=c[T];if(!I)throw new Error(`Unknown image_processor_type: '${T}'.`);b.image_processor=new I(v)}if(E){const I=c[E];if(I)b.image_processor=new I(v);else{const k=u[E];if(!k)throw new Error(`Unknown feature_extractor_type: '${E}'.`);b.feature_extractor=new k(v)}}const M={};return new o.Processor(M,b)}}},"./src/models/beit/image_processing_beit.js":(e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,t,n)=>{n.r(t),n.d(t,{BitImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,t,n)=>{n.r(t),n.d(t,{ChineseCLIPFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,t,n)=>{n.r(t),n.d(t,{ClapFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class o extends r.FeatureExtractor{constructor(c){super(c),this.mel_filters=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,s.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(c,u,d,h){let m;const p=c.length-u;if(p>0)if(d==="rand_trunc"){const v=Math.floor(Math.random()*(p+1));c=c.subarray(v,v+u),m=await this._extract_fbank_features(c,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${d}" not implemented`);else{if(p<0){let v=new Float64Array(u);if(v.set(c),h==="repeat")for(let T=c.length;T<u;T+=c.length)v.set(c.subarray(0,Math.min(c.length,u-T)),T);else if(h==="repeatpad")for(let T=c.length;T<-p;T+=c.length)v.set(c,T);c=v}if(d==="fusion")throw new Error(`Truncation strategy "${d}" not implemented`);m=await this._extract_fbank_features(c,this.mel_filters_slaney,this.config.nb_max_samples)}return m.unsqueeze_(0)}async _extract_fbank_features(c,u,d=null){return(0,s.spectrogram)(c,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:u,log_mel:"dB",max_num_frames:d,do_pad:!1,transpose:!0})}async _call(c,{max_length:u=null}={}){return(0,r.validate_audio_inputs)(c,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(c,u??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,t,n)=>{n.r(t),n.d(t,{CLIPFeatureExtractor:()=>o,CLIPImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/convnext/image_processing_convnext.js":(e,t,n)=>{n.r(t),n.d(t,{ConvNextFeatureExtractor:()=>o,ConvNextImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(c){super(c),this.crop_pct=this.config.crop_pct??224/256}async resize(c){var d;const u=(d=this.size)==null?void 0:d.shortest_edge;if(u===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(u<384){const h=Math.floor(u/this.crop_pct),[m,p]=this.get_resize_output_image_size(c,{shortest_edge:h});c=await c.resize(m,p,{resample:this.resample}),c=await c.center_crop(u,u)}else c=await c.resize(u,u,{resample:this.resample});return c}}class o extends s{}},"./src/models/deit/image_processing_deit.js":(e,t,n)=>{n.r(t),n.d(t,{DeiTFeatureExtractor:()=>o,DeiTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/detr/image_processing_detr.js":(e,t,n)=>{n.r(t),n.d(t,{DetrFeatureExtractor:()=>a,DetrImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class o extends r.ImageProcessor{async _call(u){const d=await super._call(u),h=[d.pixel_values.dims[0],64,64],m=(0,s.full)(h,1n);return{...d,pixel_mask:m}}post_process_object_detection(...u){return(0,r.post_process_object_detection)(...u)}post_process_panoptic_segmentation(...u){return(0,r.post_process_panoptic_segmentation)(...u)}post_process_instance_segmentation(...u){return(0,r.post_process_instance_segmentation)(...u)}}class a extends o{}},"./src/models/donut/image_processing_donut.js":(e,t,n)=>{n.r(t),n.d(t,{DonutFeatureExtractor:()=>o,DonutImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{pad_image(c,u,d,h={}){const[m,p,v]=u;let T=this.image_mean;Array.isArray(this.image_mean)||(T=new Array(v).fill(T));let E=this.image_std;Array.isArray(E)||(E=new Array(v).fill(T));const O=T.map((b,M)=>-b/E[M]);return super.pad_image(c,u,d,{center:!0,constant_values:O,...h})}}class o extends s{}},"./src/models/dpt/image_processing_dpt.js":(e,t,n)=>{n.r(t),n.d(t,{DPTFeatureExtractor:()=>o,DPTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,t,n)=>{n.r(t),n.d(t,{EfficientNetImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){super(a),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(c=>c*c))}}},"./src/models/feature_extractors.js":(e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>r.ASTFeatureExtractor,ClapFeatureExtractor:()=>s.ClapFeatureExtractor,ImageFeatureExtractor:()=>p.ImageProcessor,MoonshineFeatureExtractor:()=>o.MoonshineFeatureExtractor,PyAnnoteFeatureExtractor:()=>a.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>c.SeamlessM4TFeatureExtractor,SpeechT5FeatureExtractor:()=>u.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>h.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>m.WhisperFeatureExtractor});var r=n("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),s=n("./src/models/clap/feature_extraction_clap.js"),o=n("./src/models/moonshine/feature_extraction_moonshine.js"),a=n("./src/models/pyannote/feature_extraction_pyannote.js"),c=n("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),u=n("./src/models/speecht5/feature_extraction_speecht5.js"),d=n("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),h=n("./src/models/wespeaker/feature_extraction_wespeaker.js"),m=n("./src/models/whisper/feature_extraction_whisper.js"),p=n("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");class a extends r.Processor{constructor(u,d){super(u,d);const{tasks_answer_post_processing_type:h,task_prompts_without_inputs:m,task_prompts_with_input:p}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(h??{})),this.task_prompts_without_inputs=new Map(Object.entries(m??{})),this.task_prompts_with_input=new Map(Object.entries(p??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(u){typeof u=="string"&&(u=[u]);const d=[];for(const h of u)if(this.task_prompts_without_inputs.has(h))d.push(this.task_prompts_without_inputs.get(h));else{for(const[m,p]of this.task_prompts_with_input)if(h.includes(m)){d.push(p.replaceAll("{input}",h).replaceAll(m,""));break}d.length!==u.length&&d.push(h)}return d}post_process_generation(u,d,h){const m=this.tasks_answer_post_processing_type.get(d)??"pure_text";u=u.replaceAll("<s>","").replaceAll("</s>","");let p;switch(m){case"pure_text":p=u;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const v=m==="ocr"?"quad_boxes":"bboxes",T=u.matchAll(this.regexes[v]),E=[],O=[];for(const[b,M,...I]of T)E.push(M?M.trim():E.at(-1)??""),O.push(I.map((k,$)=>(Number(k)+.5)/this.size_per_bin*h[$%2]));p={labels:E,[v]:O};break;default:throw new Error(`Task "${d}" (of type "${m}") not yet implemented.`)}return{[d]:p}}async _call(u,d=null,h={}){if(!u&&!d)throw new Error("Either text or images must be provided");const m=await this.image_processor(u,h),p=d?this.tokenizer(d,h):{};return{...m,...p}}}Pe(a,"tokenizer_class",o.AutoTokenizer),Pe(a,"image_processor_class",s.AutoImageProcessor)},"./src/models/glpn/image_processing_glpn.js":(e,t,n)=>{n.r(t),n.d(t,{GLPNFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,t,n)=>{n.r(t),n.d(t,{GroundingDinoImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class o extends r.ImageProcessor{async _call(c){const u=await super._call(c),d=u.pixel_values.dims,h=(0,s.ones)([d[0],d[2],d[3]]);return{...u,pixel_mask:h}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,t,n)=>{n.r(t),n.d(t,{GroundingDinoProcessor:()=>u});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/base/image_processors_utils.js");function c(d,h){const p=d.dims.at(-1)-1,v=d.tolist();v.fill(!1,0,1),v.fill(!1,p);const T=h.tolist();return v.map((E,O)=>E?O:null).filter(E=>E!==null).map(E=>T[E])}class u extends r.Processor{async _call(h,m,p={}){const v=h?await this.image_processor(h,p):{};return{...m?this.tokenizer(m,p):{},...v}}post_process_grounded_object_detection(h,m,{box_threshold:p=.25,text_threshold:v=.25,target_sizes:T=null}={}){const{logits:E,pred_boxes:O}=h,b=E.dims[0];if(T!==null&&T.length!==b)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const M=E.dims.at(1),I=E.sigmoid(),k=I.max(-1).tolist(),$=O.tolist().map(D=>D.map(j=>(0,a.center_to_corners_format)(j))),P=[];for(let D=0;D<b;++D){const j=T!==null?T[D]:null;j!==null&&($[D]=$[D].map(re=>re.map((he,ue)=>he*j[(ue+1)%2])));const Y=k[D],q=[],oe=[],de=[];for(let re=0;re<M;++re){const he=Y[re];if(he<=p)continue;const ue=$[D][re],ye=I[D][re];q.push(he),de.push(ue);const xe=c(ye.gt(v),m[D]);oe.push(xe)}P.push({scores:q,boxes:de,labels:this.batch_decode(oe)})}return P}}Pe(u,"tokenizer_class",o.AutoTokenizer),Pe(u,"image_processor_class",s.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(e,t,n)=>{n.r(t),n.d(t,{Idefics3ImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class o extends r.ImageProcessor{constructor(c){super(c),this.do_image_splitting=c.do_image_splitting??!0,this.max_image_size=c.max_image_size}get_resize_for_vision_encoder(c,u){let[d,h]=c.dims.slice(-2);const m=h/d;return h>=d?(h=Math.ceil(h/u)*u,d=Math.floor(h/m),d=Math.ceil(d/u)*u):(d=Math.ceil(d/u)*u,h=Math.floor(d*m),h=Math.ceil(h/u)*u),{height:d,width:h}}async _call(c,{do_image_splitting:u=null,return_row_col_info:d=!1}={}){let h;if(!Array.isArray(c))h=[[c]];else{if(c.length===0||!c[0])throw new Error("No images provided.");Array.isArray(c[0])?h=c:h=[c]}let m=[],p=[],v=[];const T=[],E=[];for(const D of h){let j=await Promise.all(D.map(oe=>this.preprocess(oe)));T.push(...j.map(oe=>oe.original_size)),E.push(...j.map(oe=>oe.reshaped_input_size)),j.forEach(oe=>oe.pixel_values.unsqueeze_(0));const{longest_edge:Y}=this.max_image_size;let q;if(u??this.do_image_splitting){let oe=new Array(j.length),de=new Array(j.length);q=await Promise.all(j.map(async(re,he)=>{const ue=this.get_resize_for_vision_encoder(re.pixel_values,Y),ye=await(0,s.interpolate_4d)(re.pixel_values,{size:[ue.height,ue.width]}),{frames:xe,num_splits_h:te,num_splits_w:ke}=await this.split_image(ye,this.max_image_size);return oe[he]=te,de[he]=ke,(0,s.cat)(xe,0)})),p.push(oe),v.push(de)}else{const oe=[Y,Y];q=await Promise.all(j.map(de=>(0,s.interpolate_4d)(de.pixel_values,{size:oe}))),p.push(new Array(j.length).fill(0)),v.push(new Array(j.length).fill(0))}m.push((0,s.cat)(q,0))}const O=m.length,[b,M,I,k]=m[0].dims;let $,P;if(O===1)$=m[0].unsqueeze_(0),P=(0,s.full)([O,b,I,k],!0);else{const D=Math.max(...m.map(q=>q.dims.at(0)));P=(0,s.full)([O,D,I,k],!0);const j=P.data,Y=D*I*k;for(let q=0;q<O;++q){const oe=m[q].dims[0];if(oe<D){m[q]=(0,s.cat)([m[q],(0,s.full)([D-oe,M,I,k],0)],0);const de=q*Y+oe*I*k,re=(q+1)*Y;j.fill(!1,de,re)}}$=(0,s.stack)(m,0)}return{pixel_values:$,pixel_attention_mask:P,original_sizes:T,reshaped_input_sizes:E,...d?{rows:p,cols:v}:{}}}async split_image(c,{longest_edge:u}){const d=u,h=u,m=[],[p,v]=c.dims.slice(-2);let T=0,E=0;if(p>d||v>h){T=Math.ceil(p/d),E=Math.ceil(v/h);const O=Math.ceil(p/T),b=Math.ceil(v/E);for(let k=0;k<T;++k)for(let $=0;$<E;++$){let P,D,j,Y;k===T-1?(D=p-O,Y=p):(D=k*O,Y=(k+1)*O),$===E-1?(P=v-b,j=v):(P=$*b,j=($+1)*b);const q=[D,P],oe=[Y,j],de=await(0,s.slice)(c,q,oe,[2,3]);m.push(de)}const M=d,I=h;(p!==M||v!==I)&&(c=await(0,s.interpolate_4d)(c,{size:[M,I]}))}return m.push(c),{frames:m,num_splits_h:T,num_splits_w:E}}}},"./src/models/idefics3/processing_idefics3.js":(e,t,n)=>{n.r(t),n.d(t,{Idefics3Processor:()=>h});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");n("./src/utils/image.js");var a=n("./src/utils/core.js");function c(m,p,v,T,E,O){let b="";for(let M=0;M<p;++M){for(let I=0;I<v;++I)b+=T+`<row_${M+1}_col_${I+1}>`+E.repeat(m);b+=`
`}return b+=`
${T}${O}`+E.repeat(m)+`${T}`,b}function u(m,p,v,T){return`${p}${T}`+v.repeat(m)+`${p}`}function d(m,p,v,T,E,O){return m===0&&p===0?u(v,T,E,O):c(v,m,p,T,E,O)}class h extends r.Processor{constructor(){super(...arguments);Pe(this,"fake_image_token","<fake_token_around_image>");Pe(this,"image_token","<image>");Pe(this,"global_img_token","<global-img>")}async _call(v,T=null,E={}){E.return_row_col_info??(E.return_row_col_info=!0);let O;T&&(O=await this.image_processor(T,E)),Array.isArray(v)||(v=[v]);const b=O.rows??[new Array(v.length).fill(0)],M=O.cols??[new Array(v.length).fill(0)],I=this.config.image_seq_len,k=[],$=[];for(let D=0;D<v.length;++D){const j=v[D],Y=b[D],q=M[D];k.push((0,a.count)(j,this.image_token));const oe=Y.map((he,ue)=>d(he,q[ue],I,this.fake_image_token,this.image_token,this.global_img_token)),de=j.split(this.image_token);if(de.length===0)throw new Error("The image token should be present in the text.");let re=de[0];for(let he=0;he<oe.length;++he)re+=oe[he]+de[he+1];$.push(re)}return{...this.tokenizer($),...O}}}Pe(h,"image_processor_class",s.AutoImageProcessor),Pe(h,"tokenizer_class",o.AutoTokenizer),Pe(h,"uses_processor_config",!0)},"./src/models/image_processors.js":(e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>r.BeitFeatureExtractor,BitImageProcessor:()=>s.BitImageProcessor,CLIPFeatureExtractor:()=>a.CLIPFeatureExtractor,CLIPImageProcessor:()=>a.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>o.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>c.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>c.ConvNextImageProcessor,DPTFeatureExtractor:()=>m.DPTFeatureExtractor,DPTImageProcessor:()=>m.DPTImageProcessor,DeiTFeatureExtractor:()=>u.DeiTFeatureExtractor,DeiTImageProcessor:()=>u.DeiTImageProcessor,DetrFeatureExtractor:()=>d.DetrFeatureExtractor,DetrImageProcessor:()=>d.DetrImageProcessor,DonutFeatureExtractor:()=>h.DonutFeatureExtractor,DonutImageProcessor:()=>h.DonutImageProcessor,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>v.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>T.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>E.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>b.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>M.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>I.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>k.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>k.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>$.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>$.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>P.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>P.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>D.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>D.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>j.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>j.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>Y.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>Y.MobileViTImageProcessor,NougatImageProcessor:()=>q.NougatImageProcessor,OwlViTFeatureExtractor:()=>de.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>de.OwlViTImageProcessor,Owlv2ImageProcessor:()=>oe.Owlv2ImageProcessor,Phi3VImageProcessor:()=>re.Phi3VImageProcessor,PvtImageProcessor:()=>he.PvtImageProcessor,Qwen2VLImageProcessor:()=>ue.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>ye.RTDetrImageProcessor,SamImageProcessor:()=>xe.SamImageProcessor,SegformerFeatureExtractor:()=>te.SegformerFeatureExtractor,SegformerImageProcessor:()=>te.SegformerImageProcessor,SiglipImageProcessor:()=>ke.SiglipImageProcessor,Swin2SRImageProcessor:()=>De.Swin2SRImageProcessor,VLMImageProcessor:()=>O.VLMImageProcessor,ViTFeatureExtractor:()=>me.ViTFeatureExtractor,ViTImageProcessor:()=>me.ViTImageProcessor,VitMatteImageProcessor:()=>ee.VitMatteImageProcessor,VitPoseImageProcessor:()=>ge.VitPoseImageProcessor,YolosFeatureExtractor:()=>Ie.YolosFeatureExtractor,YolosImageProcessor:()=>Ie.YolosImageProcessor});var r=n("./src/models/beit/image_processing_beit.js"),s=n("./src/models/bit/image_processing_bit.js"),o=n("./src/models/chinese_clip/image_processing_chinese_clip.js"),a=n("./src/models/clip/image_processing_clip.js"),c=n("./src/models/convnext/image_processing_convnext.js"),u=n("./src/models/deit/image_processing_deit.js"),d=n("./src/models/detr/image_processing_detr.js"),h=n("./src/models/donut/image_processing_donut.js"),m=n("./src/models/dpt/image_processing_dpt.js"),p=n("./src/models/efficientnet/image_processing_efficientnet.js"),v=n("./src/models/glpn/image_processing_glpn.js"),T=n("./src/models/grounding_dino/image_processing_grounding_dino.js"),E=n("./src/models/idefics3/image_processing_idefics3.js"),O=n("./src/models/janus/image_processing_janus.js"),b=n("./src/models/jina_clip/image_processing_jina_clip.js"),M=n("./src/models/llava_onevision/image_processing_llava_onevision.js"),I=n("./src/models/mask2former/image_processing_mask2former.js"),k=n("./src/models/maskformer/image_processing_maskformer.js"),$=n("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),P=n("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),D=n("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),j=n("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),Y=n("./src/models/mobilevit/image_processing_mobilevit.js"),q=n("./src/models/nougat/image_processing_nougat.js"),oe=n("./src/models/owlv2/image_processing_owlv2.js"),de=n("./src/models/owlvit/image_processing_owlvit.js"),re=n("./src/models/phi3_v/image_processing_phi3_v.js"),he=n("./src/models/pvt/image_processing_pvt.js"),ue=n("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),ye=n("./src/models/rt_detr/image_processing_rt_detr.js"),xe=n("./src/models/sam/image_processing_sam.js"),te=n("./src/models/segformer/image_processing_segformer.js"),ke=n("./src/models/siglip/image_processing_siglip.js"),De=n("./src/models/swin2sr/image_processing_swin2sr.js"),me=n("./src/models/vit/image_processing_vit.js"),ee=n("./src/models/vitmatte/image_processing_vitmatte.js"),ge=n("./src/models/vitpose/image_processing_vitpose.js"),Ie=n("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,t,n)=>{n.r(t),n.d(t,{VLMImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){super({do_pad:!0,pad_size:{width:a.image_size,height:a.image_size},...a}),this.constant_values=this.config.background_color.map(c=>c*this.rescale_factor)}pad_image(a,c,u,d){return super.pad_image(a,c,u,{constant_values:this.constant_values,center:!0,...d})}}},"./src/models/janus/processing_janus.js":(e,t,n)=>{n.r(t),n.d(t,{VLChatProcessor:()=>d});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/utils/core.js"),c=n("./src/utils/tensor.js"),u=n("./src/utils/image.js");class d extends r.Processor{constructor(m,p){super(m,p),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(m,{images:p=null,chat_template:v="default"}={}){p?Array.isArray(p)||(p=[p]):p=await Promise.all(m.filter(q=>q.images).flatMap(q=>q.images).map(q=>u.RawImage.read(q)));const T=this.tokenizer,E=T.apply_chat_template(m,{tokenize:!1,add_generation_prompt:!0,chat_template:v}),O=q=>T.encode(q,{add_special_tokens:!1}),b=E.split(this.image_tag),M=b.length-1;if(p.length!==M)throw new Error(`Number of images provided (${p.length}) does not match number of "${this.image_tag}" image tags (${M})`);const[I,k,$]=T.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let P=O(b[0]),D=new Array(P.length).fill(!1);for(let q=1;q<b.length;++q){const oe=new Array(this.num_image_tokens).fill(I),de=O(b[q]);P=(0,a.mergeArrays)(P,[k],oe,[$],de);const re=new Array(this.num_image_tokens).fill(!0);D=(0,a.mergeArrays)(D,[!1],re,[!1],new Array(de.length).fill(!1))}const j=[1,P.length],Y={input_ids:new c.Tensor("int64",P,j),attention_mask:new c.Tensor("int64",new Array(P.length).fill(1),j),images_seq_mask:new c.Tensor("bool",D,j),images_emb_mask:new c.Tensor("bool",new Array(M*this.num_image_tokens).fill(!0),[1,M,this.num_image_tokens])};if(p&&p.length>0){const q=await this.image_processor(p);return q.pixel_values.unsqueeze_(0),{...Y,...q}}return Y}}Pe(d,"image_processor_class",s.AutoImageProcessor),Pe(d,"tokenizer_class",o.AutoTokenizer),Pe(d,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(e,t,n)=>{n.r(t),n.d(t,{JinaCLIPImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){const{resize_mode:c,fill_color:u,interpolation:d,size:h,...m}=a,p=c==="squash"?{width:h,height:h}:c==="shortest"?{shortest_edge:h}:{longest_edge:h},v=d==="bicubic"?3:2;super({...m,size:p,resample:v,do_center_crop:!0,crop_size:h,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(e,t,n)=>{n.r(t),n.d(t,{JinaCLIPProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");class a extends r.Processor{async _call(u=null,d=null,h={}){if(!u&&!d)throw new Error("Either text or images must be provided");const m=u?this.tokenizer(u,h):{},p=d?await this.image_processor(d,h):{};return{...m,...p}}}Pe(a,"tokenizer_class",o.AutoTokenizer),Pe(a,"image_processor_class",s.AutoImageProcessor)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,t,n)=>{n.r(t),n.d(t,{LlavaOnevisionImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,t,n)=>{n.r(t),n.d(t,{Mask2FormerImageProcessor:()=>s});var r=n("./src/models/maskformer/image_processing_maskformer.js");class s extends r.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,t,n)=>{n.r(t),n.d(t,{MaskFormerFeatureExtractor:()=>o,MaskFormerImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_panoptic_segmentation(...c){return(0,r.post_process_panoptic_segmentation)(...c)}post_process_instance_segmentation(...c){return(0,r.post_process_instance_segmentation)(...c)}}class o extends s{}},"./src/models/mgp_str/processing_mgp_str.js":(e,t,n)=>{n.r(t),n.d(t,{MgpstrProcessor:()=>u});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/utils/maths.js");const c={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class u extends r.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(h,m){if(!c.hasOwnProperty(m))throw new Error(`Format ${m} is not supported.`);const[p,v]=c[m],T=this[p].bind(this),[E,O]=h.dims,b=[],M=[],I=h.tolist();for(let $=0;$<E;++$){const P=I[$],D=[],j=[];for(let q=1;q<O;++q){const[oe,de]=(0,a.max)((0,a.softmax)(P[q]));if(j.push(oe),de==v)break;D.push(de)}const Y=j.length>0?j.reduce((q,oe)=>q*oe,1):0;M.push(D),b.push(Y)}return[T(M),b]}char_decode(h){return this.char_tokenizer.batch_decode(h).map(m=>m.replaceAll(" ",""))}bpe_decode(h){return this.bpe_tokenizer.batch_decode(h)}wp_decode(h){return this.wp_tokenizer.batch_decode(h).map(m=>m.replaceAll(" ",""))}batch_decode([h,m,p]){const[v,T]=this._decode_helper(h,"char"),[E,O]=this._decode_helper(m,"bpe"),[b,M]=this._decode_helper(p,"wp"),I=[],k=[];for(let $=0;$<v.length;++$){const[P,D]=(0,a.max)([T[$],O[$],M[$]]);I.push([v[$],E[$],b[$]][D]),k.push(P)}return{generated_text:I,scores:k,char_preds:v,bpe_preds:E,wp_preds:b}}static async from_pretrained(...h){const m=await super.from_pretrained(...h),p=await o.AutoTokenizer.from_pretrained("Xenova/gpt2"),v=await o.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return m.components={image_processor:m.image_processor,char_tokenizer:m.tokenizer,bpe_tokenizer:p,wp_tokenizer:v},m}async _call(h,m=null){const p=await this.image_processor(h);return m&&(p.labels=this.tokenizer(m).input_ids),p}}Pe(u,"tokenizer_class",o.AutoTokenizer),Pe(u,"image_processor_class",s.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV1FeatureExtractor:()=>o,MobileNetV1ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV2FeatureExtractor:()=>o,MobileNetV2ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV3FeatureExtractor:()=>o,MobileNetV3ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV4FeatureExtractor:()=>o,MobileNetV4ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,t,n)=>{n.r(t),n.d(t,{MobileViTFeatureExtractor:()=>o,MobileViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,t,n)=>{n.r(t),n.d(t,{MoonshineFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js");class o extends r.FeatureExtractor{async _call(c){(0,r.validate_audio_inputs)(c,"MoonshineFeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));const u=[1,c.length];return{input_values:new s.Tensor("float32",c,u)}}}},"./src/models/moonshine/processing_moonshine.js":(e,t,n)=>{n.r(t),n.d(t,{MoonshineProcessor:()=>a});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),o=n("./src/base/processing_utils.js");class a extends o.Processor{async _call(u){return await this.feature_extractor(u)}}Pe(a,"tokenizer_class",s.AutoTokenizer),Pe(a,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(e,t,n)=>{n.r(t),n.d(t,{NougatImageProcessor:()=>s});var r=n("./src/models/donut/image_processing_donut.js");class s extends r.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,t,n)=>{n.r(t),n.d(t,{Owlv2ImageProcessor:()=>s});var r=n("./src/models/owlvit/image_processing_owlvit.js");class s extends r.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,t,n)=>{n.r(t),n.d(t,{OwlViTFeatureExtractor:()=>o,OwlViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...c){return(0,r.post_process_object_detection)(...c)}}class o extends s{}},"./src/models/owlvit/processing_owlvit.js":(e,t,n)=>{n.r(t),n.d(t,{OwlViTProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");class a extends r.Processor{}Pe(a,"tokenizer_class",o.AutoTokenizer),Pe(a,"image_processor_class",s.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(e,t,n)=>{n.r(t),n.d(t,{PaliGemmaProcessor:()=>u});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");const a="<image>";function c(d,h,m,p,v){return`${p.repeat(m*v)}${h}${d}
`}class u extends r.Processor{async _call(h,m=null,p={}){m||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),m=""),Array.isArray(h)||(h=[h]),Array.isArray(m)||(m=[m]);const v=this.tokenizer.bos_token,T=this.image_processor.config.image_seq_length;let E;m.some(M=>M.includes(a))?E=m.map(M=>{const I=M.replaceAll(a,a.repeat(T)),k=I.lastIndexOf(a),$=k===-1?0:k+a.length;return I.slice(0,$)+v+I.slice($)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),E=m.map(M=>c(M,v,T,a,h.length)));const O=this.tokenizer(E,p);return{...await this.image_processor(h,p),...O}}}Pe(u,"tokenizer_class",o.AutoTokenizer),Pe(u,"image_processor_class",s.AutoImageProcessor),Pe(u,"uses_processor_config",!1)},"./src/models/phi3_v/image_processing_phi3_v.js":(e,t,n)=>{n.r(t),n.d(t,{Phi3VImageProcessor:()=>h});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");const o=336,a=[2,3],{ceil:c,floor:u,sqrt:d}=Math;class h extends r.ImageProcessor{constructor(p){super({...p,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=p.num_crops}calc_num_image_tokens_from_image_size(p,v){const{num_img_tokens:T}=this.config;return u((u(v/o)*u(p/o)+1)*T+1+(u(v/o)+1)*d(T))}get_resize_output_image_size(p,v){const T=this._num_crops,[E,O]=p.size;let b=E/O,M=1;for(;M*Math.ceil(M/b)<=T;)M+=1;M-=1;const I=Math.floor(M*336),k=Math.floor(I/b);return[I,k]}pad_image(p,v,T,E={}){const[O,b]=v,M=o*c(O/o),I=o*c(b/o),k=[1,1,1].map(($,P)=>($-this.image_mean[P])/this.image_std[P]);return super.pad_image(p,v,{width:I,height:M},{center:!0,constant_values:k,...E})}async _call(p,{num_crops:v=null}={}){if(this._num_crops=v??(v=this.config.num_crops),v<4||d(v)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(p)||(p=[p]);const T=p.length,E=await Promise.all(p.map(D=>this.preprocess(D))),O=E.map(D=>D.original_size),b=E.map(D=>D.reshaped_input_size),M=[];for(const{pixel_values:D}of E){D.unsqueeze_(0);const[j,Y]=D.dims.slice(-2),q=await(0,s.interpolate_4d)(D,{size:[o,o],mode:"bicubic"});if(v>0){const oe=[],de=d(v),re=u(Y/de),he=u(j/de);for(let ye=0;ye<de;++ye)for(let xe=0;xe<de;++xe){let te,ke,De,me;ye===de-1?(ke=j-he,me=j):(ke=ye*he,me=(ye+1)*he),xe===de-1?(te=Y-re,De=Y):(te=xe*re,De=(xe+1)*re);const ee=[ke,te],ge=[me,De],Ie=await(0,s.slice)(D,ee,ge,a);oe.push(Ie)}const ue=await(0,s.interpolate_4d)((0,s.cat)(oe,0),{size:[o,o],mode:"bicubic"});M.push((0,s.cat)([q,ue],0))}else M.push(q)}const I=(0,s.stack)(M,0),k=b.map(D=>D.map(j=>o*c(j/o))),$=new s.Tensor("int64",k.flat(),[T,2]),P=k.map(([D,j])=>this.calc_num_image_tokens_from_image_size(j,D));return{pixel_values:I,original_sizes:O,reshaped_input_sizes:b,image_sizes:$,num_img_tokens:P}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,t,n)=>{n.r(t),n.d(t,{Phi3VProcessor:()=>u});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");n("./src/utils/image.js");const a="<|image|>",c=/<\|image_\d+\|>/g;class u extends r.Processor{async _call(h,m=null,{padding:p=!0,truncation:v=!0,num_crops:T=null}={}){Array.isArray(h)||(h=[h]);let E,O;if(m){O=await this.image_processor(m,{num_crops:T});const{num_img_tokens:b}=O,M=h.map((k,$)=>k.split(c).join(a.repeat(b[$])));E=this.tokenizer(M,{padding:p,truncation:v});const I=this.tokenizer.model.convert_tokens_to_ids([a])[0];E.input_ids.map_(k=>k==I?-k:k)}else E=this.tokenizer(h);return{...E,...O}}}Pe(u,"image_processor_class",s.AutoImageProcessor),Pe(u,"tokenizer_class",o.AutoTokenizer)},"./src/models/processors.js":(e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>r.Florence2Processor,GroundingDinoProcessor:()=>s.GroundingDinoProcessor,Idefics3Processor:()=>o.Idefics3Processor,JinaCLIPProcessor:()=>c.JinaCLIPProcessor,MgpstrProcessor:()=>u.MgpstrProcessor,MoonshineProcessor:()=>d.MoonshineProcessor,OwlViTProcessor:()=>h.OwlViTProcessor,PaliGemmaProcessor:()=>p.PaliGemmaProcessor,Phi3VProcessor:()=>m.Phi3VProcessor,PyAnnoteProcessor:()=>v.PyAnnoteProcessor,Qwen2VLProcessor:()=>T.Qwen2VLProcessor,SamProcessor:()=>E.SamProcessor,SpeechT5Processor:()=>O.SpeechT5Processor,VLChatProcessor:()=>a.VLChatProcessor,Wav2Vec2ProcessorWithLM:()=>b.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>M.WhisperProcessor});var r=n("./src/models/florence2/processing_florence2.js"),s=n("./src/models/grounding_dino/processing_grounding_dino.js"),o=n("./src/models/idefics3/processing_idefics3.js"),a=n("./src/models/janus/processing_janus.js"),c=n("./src/models/jina_clip/processing_jina_clip.js"),u=n("./src/models/mgp_str/processing_mgp_str.js"),d=n("./src/models/moonshine/processing_moonshine.js"),h=n("./src/models/owlvit/processing_owlvit.js"),m=n("./src/models/phi3_v/processing_phi3_v.js"),p=n("./src/models/paligemma/processing_paligemma.js"),v=n("./src/models/pyannote/processing_pyannote.js"),T=n("./src/models/qwen2_vl/processing_qwen2_vl.js"),E=n("./src/models/sam/processing_sam.js"),O=n("./src/models/speecht5/processing_speecht5.js"),b=n("./src/models/wav2vec2/processing_wav2vec2.js"),M=n("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,t,n)=>{n.r(t),n.d(t,{PvtImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,t,n)=>{n.r(t),n.d(t,{PyAnnoteFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),o=n("./src/utils/maths.js");class a extends r.FeatureExtractor{async _call(u){(0,r.validate_audio_inputs)(u,"PyAnnoteFeatureExtractor"),u instanceof Float64Array&&(u=new Float32Array(u));const d=[1,1,u.length];return{input_values:new s.Tensor("float32",u,d)}}samples_to_frames(u){return(u-this.config.offset)/this.config.step}post_process_speaker_diarization(u,d){const h=d/this.samples_to_frames(d)/this.config.sampling_rate,m=[];for(const p of u.tolist()){const v=[];let T=-1;for(let E=0;E<p.length;++E){const O=(0,o.softmax)(p[E]),[b,M]=(0,o.max)(O),[I,k]=[E,E+1];M!==T?(T=M,v.push({id:M,start:I,end:k,score:b})):(v.at(-1).end=k,v.at(-1).score+=b)}m.push(v.map(({id:E,start:O,end:b,score:M})=>({id:E,start:O*h,end:b*h,confidence:M/(b-O)})))}return m}}},"./src/models/pyannote/processing_pyannote.js":(e,t,n)=>{n.r(t),n.d(t,{PyAnnoteProcessor:()=>o});var r=n("./src/base/processing_utils.js"),s=n("./src/models/pyannote/feature_extraction_pyannote.js");class o extends r.Processor{async _call(c){return await this.feature_extractor(c)}post_process_speaker_diarization(...c){return this.feature_extractor.post_process_speaker_diarization(...c)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}Pe(o,"feature_extractor_class",s.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,t,n)=>{n.r(t),n.d(t,{Qwen2VLImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class o extends r.ImageProcessor{async _call(c,...u){const{pixel_values:d,original_sizes:h,reshaped_input_sizes:m}=await super._call(c,...u);let p=d;const{temporal_patch_size:v,merge_size:T,patch_size:E}=this.config;p.dims[0]===1&&(p=(0,s.cat)(Array.from({length:v},()=>p),0));const O=p.dims[0]/v,b=p.dims[1],M=Math.floor(p.dims[2]/E),I=Math.floor(p.dims[3]/E),k=p.view(O,v,b,Math.floor(M/T),T,E,Math.floor(I/T),T,E).permute(0,3,6,4,7,2,1,5,8).view(O*M*I,b*v*E*E),$=new s.Tensor("int64",[O,M,I],[1,3]);return{pixel_values:k,image_grid_thw:$,original_sizes:h,reshaped_input_sizes:m}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,t,n)=>{n.r(t),n.d(t,{Qwen2VLProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),o=n("./src/tokenizers.js");n("./src/utils/image.js");class a extends r.Processor{async _call(u,d=null,...h){Array.isArray(u)||(u=[u]);let m,p;if(d&&(m=await this.image_processor(d),p=m.image_grid_thw),p){let T=this.image_processor.config.merge_size**2,E=0;const O=p.tolist();u=u.map(b=>{for(;b.includes("<|image_pad|>");){const M=Number(O[E++].reduce((I,k)=>I*k,1n));b=b.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(M/T)))}return b.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(u),...m}}}Pe(a,"image_processor_class",s.AutoImageProcessor),Pe(a,"tokenizer_class",o.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(e,t,n)=>{n.r(t),n.d(t,{RTDetrImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...a){return(0,r.post_process_object_detection)(...a)}}},"./src/models/sam/image_processing_sam.js":(e,t,n)=>{n.r(t),n.d(t,{SamImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/core.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{reshape_input_points(u,d,h,m=!1){u=structuredClone(u);let p=(0,s.calculateDimensions)(u);if(p.length===3)m||(p=[1,...p]),u=[u];else if(p.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let v=0;v<u.length;++v){let T=d[v],E=h[v],O=[E[0]/T[0],E[1]/T[1]];for(let b=0;b<u[v].length;++b)for(let M=0;M<u[v][b].length;++M)for(let I=0;I<u[v][b][M].length;++I)u[v][b][M][I]*=O[I%2]}return new o.Tensor("float32",Float32Array.from(u.flat(1/0)),p)}add_input_labels(u,d){let h=(0,s.calculateDimensions)(u);if(h.length===2)h=[1,...h],u=[u];else if(h.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(h.some((m,p)=>m!==d.dims[p]))throw Error(`The first ${h.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new o.Tensor("int64",u.flat(1/0).map(BigInt),h)}async _call(u,{input_points:d=null,input_labels:h=null,input_boxes:m=null}={}){const p=await super._call(u);if(d&&(p.input_points=this.reshape_input_points(d,p.original_sizes,p.reshaped_input_sizes)),h){if(!p.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");p.input_labels=this.add_input_labels(h,p.input_points)}return m&&(p.input_boxes=this.reshape_input_points(m,p.original_sizes,p.reshaped_input_sizes,!0)),p}async post_process_masks(u,d,h,{mask_threshold:m=0,binarize:p=!0,pad_size:v=null}={}){const T=[];v=v??this.pad_size;const E=[v.height,v.width];for(let O=0;O<d.length;++O){const b=d[O],M=h[O];let I=await(0,o.interpolate_4d)(u[O],{mode:"bilinear",size:E});if(I=I.slice(null,null,[0,M[0]],[0,M[1]]),I=await(0,o.interpolate_4d)(I,{mode:"bilinear",size:b}),p){const k=I.data,$=new Uint8Array(k.length);for(let P=0;P<k.length;++P)k[P]>m&&($[P]=1);I=new o.Tensor("bool",$,I.dims)}T.push(I)}return T}generate_crop_boxes(u,d,{crop_n_layers:h=0,overlap_ratio:m=512/1500,points_per_crop:p=32,crop_n_points_downscale_factor:v=1}={}){}}},"./src/models/sam/processing_sam.js":(e,t,n)=>{n.r(t),n.d(t,{SamProcessor:()=>o});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js");class o extends r.Processor{async _call(...c){return await this.image_processor(...c)}post_process_masks(...c){return this.image_processor.post_process_masks(...c)}reshape_input_points(...c){return this.image_processor.reshape_input_points(...c)}}Pe(o,"image_processor_class",s.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,t,n)=>{n.r(t),n.d(t,{SeamlessM4TFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),o=n("./src/utils/audio.js");class a extends r.FeatureExtractor{constructor(u){super(u);const d=this.config.sampling_rate,h=(0,o.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(d/2),d,null,"kaldi",!0);for(let m=0;m<h.length;++m)h[m].push(0);this.mel_filters=h,this.window=(0,o.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(u,d){return u=u.map(h=>h*32768),(0,o.spectrogram)(u,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:d,transpose:!0})}async _call(u,{padding:d=!0,pad_to_multiple_of:h=2,do_normalize_per_mel_bins:m=!0,return_attention_mask:p=!0}={}){(0,r.validate_audio_inputs)(u,"SeamlessM4TFeatureExtractor");let v=await this._extract_fbank_features(u,this.config.max_length);if(m){const[$,P]=v.dims,D=v.data;for(let j=0;j<P;++j){let Y=0;for(let re=0;re<$;++re)Y+=D[re*P+j];const q=Y/$;let oe=0;for(let re=0;re<$;++re)oe+=(D[re*P+j]-q)**2;oe/=$-1;const de=Math.sqrt(oe+1e-7);for(let re=0;re<$;++re){const he=re*P+j;D[he]=(D[he]-q)/de}}}let T;if(d){const[$,P]=v.dims,D=v.data,j=$%h;if(j>0){const Y=new Float32Array(P*($+j));Y.set(D),Y.fill(this.config.padding_value,D.length);const q=$+j;v=new s.Tensor(v.type,Y,[q,P]),p&&(T=new s.Tensor("int64",new BigInt64Array(q),[1,q]),T.data.fill(1n,0,$))}}const[E,O]=v.dims,b=this.config.stride;if(E%b!==0)throw new Error(`The number of frames (${E}) must be a multiple of the stride (${b}).`);const I=v.view(1,Math.floor(E/b),O*b),k={input_features:I};if(p){const $=I.dims[1],P=new BigInt64Array($);if(T){const D=T.data;for(let j=1,Y=0;j<E;j+=b,++Y)P[Y]=D[j]}else P.fill(1n);k.attention_mask=new s.Tensor("int64",P,[1,$])}return k}}},"./src/models/segformer/image_processing_segformer.js":(e,t,n)=>{n.r(t),n.d(t,{SegformerFeatureExtractor:()=>o,SegformerImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_semantic_segmentation(...c){return(0,r.post_process_semantic_segmentation)(...c)}}class o extends s{}},"./src/models/siglip/image_processing_siglip.js":(e,t,n)=>{n.r(t),n.d(t,{SiglipImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,t,n)=>{n.r(t),n.d(t,{SpeechT5FeatureExtractor:()=>s});var r=n("./src/base/feature_extraction_utils.js");class s extends r.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,t,n)=>{n.r(t),n.d(t,{SpeechT5Processor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/tokenizers.js"),o=n("./src/models/auto/feature_extraction_auto.js");class a extends r.Processor{async _call(u){return await this.feature_extractor(u)}}Pe(a,"tokenizer_class",s.AutoTokenizer),Pe(a,"feature_extractor_class",o.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(e,t,n)=>{n.r(t),n.d(t,{Swin2SRImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{pad_image(a,c,u,d={}){const[h,m,p]=c;return super.pad_image(a,c,{width:m+(u-m%u)%u,height:h+(u-h%u)%u},{mode:"symmetric",center:!1,constant_values:-1,...d})}}},"./src/models/vit/image_processing_vit.js":(e,t,n)=>{n.r(t),n.d(t,{ViTFeatureExtractor:()=>o,ViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class o extends s{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,t,n)=>{n.r(t),n.d(t,{VitMatteImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class o extends r.ImageProcessor{async _call(c,u){Array.isArray(c)||(c=[c]),Array.isArray(u)||(u=[u]);const d=await Promise.all(c.map(p=>this.preprocess(p))),h=await Promise.all(u.map(p=>this.preprocess(p,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,s.stack)(d.map((p,v)=>(0,s.cat)([p.pixel_values,h[v].pixel_values],0)),0),original_sizes:d.map(p=>p.original_size),reshaped_input_sizes:d.map(p=>p.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,t,n)=>{n.r(t),n.d(t,{VitPoseImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_pose_estimation(a,c,{threshold:u=null}={}){const d=a.tolist(),[h,m,p,v]=a.dims,T=[];for(let E=0;E<h;++E){const O=d[E],b=c[E],M=[];for(let I=0;I<b.length;++I){const k=b[I],$=[],P=[],D=[],j=k.at(-2)/v,Y=k.at(-1)/p;for(let q=0;q<O.length;++q){let[oe,de]=[0,0],re=0,he=-1/0;const ue=O[q];for(let xe=0;xe<ue.length;++xe){const te=ue[xe];for(let ke=0;ke<te.length;++ke){const De=te[ke];re+=De,he=Math.max(he,De),oe+=(ke+.5)*De,de+=xe*De}}if(u!=null&&he<u)continue;const ye=[j*oe/re,Y*de/re];$.push(ye),D.push(q),P.push(he)}M.push({bbox:k,scores:P,labels:D,keypoints:$})}T.push(M)}return T}}},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2FeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js");class o extends r.FeatureExtractor{_zero_mean_unit_var_norm(c){const d=c.reduce((m,p)=>m+p,0)/c.length,h=c.reduce((m,p)=>m+(p-d)**2,0)/c.length;return c.map(m=>(m-d)/Math.sqrt(h+1e-7))}async _call(c){(0,r.validate_audio_inputs)(c,"Wav2Vec2FeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));let u=c;this.config.do_normalize&&(u=this._zero_mean_unit_var_norm(u));const d=[1,u.length];return{input_values:new s.Tensor("float32",u,d),attention_mask:new s.Tensor("int64",new BigInt64Array(u.length).fill(1n),d)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2ProcessorWithLM:()=>o});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/feature_extraction_auto.js");class o extends r.Processor{async _call(c){return await this.feature_extractor(c)}}Pe(o,"feature_extractor_class",s.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,t,n)=>{n.r(t),n.d(t,{WeSpeakerFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class o extends r.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,d=(0,s.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);for(let h=0;h<d.length;++h)d[h].push(0);this.mel_filters=d,this.window=(0,s.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(c){return c=c.map(u=>u*32768),(0,s.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(c){(0,r.validate_audio_inputs)(c,"WeSpeakerFeatureExtractor");const u=(await this._extract_fbank_features(c)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const d=u.mean(1).data,h=u.data,[m,p,v]=u.dims;for(let T=0;T<m;++T){const E=T*p*v,O=T*v;for(let b=0;b<p;++b){const M=E+b*v;for(let I=0;I<v;++I)h[M+I]-=d[O+I]}}}return{input_features:u}}}},"./src/models/whisper/common_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WHISPER_LANGUAGE_MAPPING:()=>s,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>o,whisper_language_to_code:()=>a});const r=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],s=new Map(r),o=new Map([...r.map(([c,u])=>[u,c]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function a(c){c=c.toLowerCase();let u=o.get(c);if(u===void 0)if(s.has(c))u=c;else{const h=c.length===2?s.keys():s.values();throw new Error(`Language "${c}" is not supported. Must be one of: ${JSON.stringify(h)}`)}return u}},"./src/models/whisper/feature_extraction_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js"),o=n("./src/utils/maths.js");class a extends r.FeatureExtractor{constructor(u){var d;super(u),(d=this.config).mel_filters??(d.mel_filters=(0,s.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=(0,s.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(u){const d=await(0,s.spectrogram)(u,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:this.config.nb_max_frames}),h=d.data,m=(0,o.max)(h)[0];for(let p=0;p<h.length;++p)h[p]=(Math.max(h[p],m-8)+4)/4;return d}async _call(u){(0,r.validate_audio_inputs)(u,"WhisperFeatureExtractor");let d;return u.length>this.config.n_samples?(console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),d=u.slice(0,this.config.n_samples)):(d=new Float32Array(this.config.n_samples),d.set(u)),{input_features:(await this._extract_fbank_features(d)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperGenerationConfig:()=>s});var r=n("./src/generation/configuration_utils.js");class s extends r.GenerationConfig{constructor(){super(...arguments);Pe(this,"return_timestamps",null);Pe(this,"return_token_timestamps",null);Pe(this,"num_frames",null);Pe(this,"alignment_heads",null);Pe(this,"task",null);Pe(this,"language",null);Pe(this,"no_timestamps_token_id",null);Pe(this,"prompt_ids",null);Pe(this,"is_multilingual",null);Pe(this,"lang_to_id",null);Pe(this,"task_to_id",null);Pe(this,"max_initial_timestamp_index",1)}}},"./src/models/whisper/processing_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperProcessor:()=>a});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),o=n("./src/base/processing_utils.js");class a extends o.Processor{async _call(u){return await this.feature_extractor(u)}}Pe(a,"tokenizer_class",s.AutoTokenizer),Pe(a,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(e,t,n)=>{n.r(t),n.d(t,{YolosFeatureExtractor:()=>o,YolosImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...c){return(0,r.post_process_object_detection)(...c)}}class o extends s{}},"./src/ops/registry.js":(e,t,n)=>{n.r(t),n.d(t,{TensorOpRegistry:()=>a});var r=n("./src/backends/onnx.js"),s=n("./src/utils/tensor.js");const o=async(c,u,d)=>{const h=await(0,r.createInferenceSession)(new Uint8Array(c),u);return async m=>{const p=(0,r.isONNXProxy)(),v=Object.fromEntries(Object.entries(m).map(([E,O])=>[E,(p?O.clone():O).ort_tensor])),T=await h.run(v);return Array.isArray(d)?d.map(E=>new s.Tensor(T[E])):new s.Tensor(T[d])}};class a{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=o([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=o([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=o([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=o([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=o([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=o([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=o([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=o([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}Pe(a,"session_options",{})},"./src/pipelines.js":(e,t,n)=>{n.r(t),n.d(t,{AudioClassificationPipeline:()=>de,AutomaticSpeechRecognitionPipeline:()=>he,DepthEstimationPipeline:()=>Ie,DocumentQuestionAnsweringPipeline:()=>me,FeatureExtractionPipeline:()=>q,FillMaskPipeline:()=>I,ImageClassificationPipeline:()=>ye,ImageFeatureExtractionPipeline:()=>oe,ImageSegmentationPipeline:()=>xe,ImageToImagePipeline:()=>ge,ImageToTextPipeline:()=>ue,ObjectDetectionPipeline:()=>ke,Pipeline:()=>E,QuestionAnsweringPipeline:()=>M,SummarizationPipeline:()=>$,Text2TextGenerationPipeline:()=>k,TextClassificationPipeline:()=>O,TextGenerationPipeline:()=>j,TextToAudioPipeline:()=>ee,TokenClassificationPipeline:()=>b,TranslationPipeline:()=>P,ZeroShotAudioClassificationPipeline:()=>re,ZeroShotClassificationPipeline:()=>Y,ZeroShotImageClassificationPipeline:()=>te,ZeroShotObjectDetectionPipeline:()=>De,pipeline:()=>pe});var r=n("./src/tokenizers.js"),s=n("./src/models.js"),o=n("./src/models/auto/processing_auto.js");n("./src/base/processing_utils.js");var a=n("./src/utils/generic.js"),c=n("./src/utils/core.js"),u=n("./src/utils/maths.js"),d=n("./src/utils/audio.js"),h=n("./src/utils/tensor.js"),m=n("./src/utils/image.js");async function p(Ge){return Array.isArray(Ge)||(Ge=[Ge]),await Promise.all(Ge.map(_e=>m.RawImage.read(_e)))}async function v(Ge,_e){return Array.isArray(Ge)||(Ge=[Ge]),await Promise.all(Ge.map(Ae=>typeof Ae=="string"||Ae instanceof URL?(0,d.read_audio)(Ae,_e):Ae instanceof Float64Array?new Float32Array(Ae):Ae))}function T(Ge,_e){_e&&(Ge=Ge.map(Ke=>Ke|0));const[Ae,He,qe,Qe]=Ge;return{xmin:Ae,ymin:He,xmax:qe,ymax:Qe}}class E extends a.Callable{constructor({task:_e,model:Ae,tokenizer:He=null,processor:qe=null}){super(),this.task=_e,this.model=Ae,this.tokenizer=He,this.processor=qe}async dispose(){await this.model.dispose()}}class O extends E{constructor(_e){super(_e)}async _call(_e,{top_k:Ae=1}={}){const He=this.tokenizer(_e,{padding:!0,truncation:!0}),qe=await this.model(He),Qe=this.model.config.problem_type==="multi_label_classification"?ht=>ht.sigmoid():ht=>new h.Tensor("float32",(0,u.softmax)(ht.data),ht.dims),Ke=this.model.config.id2label,rt=[];for(const ht of qe.logits){const _t=Qe(ht),ot=await(0,h.topk)(_t,Ae),mt=ot[0].tolist(),ve=ot[1].tolist().map((ie,Ee)=>({label:Ke?Ke[ie]:`LABEL_${ie}`,score:mt[Ee]}));Ae===1?rt.push(...ve):rt.push(ve)}return Array.isArray(_e)||Ae===1?rt:rt[0]}}class b extends E{constructor(_e){super(_e)}async _call(_e,{ignore_labels:Ae=["O"]}={}){const He=Array.isArray(_e),qe=this.tokenizer(He?_e:[_e],{padding:!0,truncation:!0}),Ke=(await this.model(qe)).logits,rt=this.model.config.id2label,ht=[];for(let _t=0;_t<Ke.dims[0];++_t){const ot=qe.input_ids[_t],mt=Ke[_t],Q=[];for(let ve=0;ve<mt.dims[0];++ve){const ie=mt[ve],Ee=(0,u.max)(ie.data)[1],Re=rt?rt[Ee]:`LABEL_${Ee}`;if(Ae.includes(Re))continue;const Xe=this.tokenizer.decode([ot[ve].item()],{skip_special_tokens:!0});if(Xe==="")continue;const Ze=(0,u.softmax)(ie.data);Q.push({entity:Re,score:Ze[Ee],index:ve,word:Xe})}ht.push(Q)}return He?ht:ht[0]}}class M extends E{constructor(_e){super(_e)}async _call(_e,Ae,{top_k:He=1}={}){const qe=this.tokenizer(_e,{text_pair:Ae,padding:!0,truncation:!0}),{start_logits:Qe,end_logits:Ke}=await this.model(qe),rt=qe.input_ids.tolist(),ht=qe.attention_mask.tolist(),_t=this.tokenizer.all_special_ids,ot=[];for(let mt=0;mt<Qe.dims[0];++mt){const Q=rt[mt],ve=Q.findIndex(ft=>ft==this.tokenizer.sep_token_id);ht[mt].map((ft,gt)=>ft==1&&(gt===0||gt>ve&&_t.findIndex(St=>St==Q[gt])===-1));const ie=Qe[mt].tolist(),Ee=Ke[mt].tolist();for(let ft=1;ft<ie.length;++ft)(ht[mt]==0||ft<=ve||_t.findIndex(gt=>gt==Q[ft])!==-1)&&(ie[ft]=-1/0,Ee[ft]=-1/0);const Re=(0,u.softmax)(ie).map((ft,gt)=>[ft,gt]),Xe=(0,u.softmax)(Ee).map((ft,gt)=>[ft,gt]);Re[0][0]=0,Xe[0][0]=0;const Ze=(0,c.product)(Re,Xe).filter(ft=>ft[0][1]<=ft[1][1]).map(ft=>[ft[0][1],ft[1][1],ft[0][0]*ft[1][0]]).sort((ft,gt)=>gt[2]-ft[2]);for(let ft=0;ft<Math.min(Ze.length,He);++ft){const[gt,St,kt]=Ze[ft],Dt=Q.slice(gt,St+1),mn=this.tokenizer.decode(Dt,{skip_special_tokens:!0});ot.push({answer:mn,score:kt})}}return He===1?ot[0]:ot}}class I extends E{constructor(_e){super(_e)}async _call(_e,{top_k:Ae=5}={}){const He=this.tokenizer(_e,{padding:!0,truncation:!0}),{logits:qe}=await this.model(He),Qe=[],Ke=He.input_ids.tolist();for(let rt=0;rt<Ke.length;++rt){const ht=Ke[rt],_t=ht.findIndex(ie=>ie==this.tokenizer.mask_token_id);if(_t===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const ot=qe[rt][_t],mt=await(0,h.topk)(new h.Tensor("float32",(0,u.softmax)(ot.data),ot.dims),Ae),Q=mt[0].tolist(),ve=mt[1].tolist();Qe.push(ve.map((ie,Ee)=>{const Re=ht.slice();return Re[_t]=ie,{score:Q[Ee],token:Number(ie),token_str:this.tokenizer.decode([ie]),sequence:this.tokenizer.decode(Re,{skip_special_tokens:!0})}}))}return Array.isArray(_e)?Qe:Qe[0]}}class k extends E{constructor(Ae){super(Ae);Pe(this,"_key","generated_text")}async _call(Ae,He={}){Array.isArray(Ae)||(Ae=[Ae]),this.model.config.prefix&&(Ae=Ae.map(_t=>this.model.config.prefix+_t));const qe=this.model.config.task_specific_params;qe&&qe[this.task]&&qe[this.task].prefix&&(Ae=Ae.map(_t=>qe[this.task].prefix+_t));const Qe=this.tokenizer,Ke={padding:!0,truncation:!0};let rt;this instanceof P&&"_build_translation_inputs"in Qe?rt=Qe._build_translation_inputs(Ae,Ke,He):rt=Qe(Ae,Ke);const ht=await this.model.generate({...rt,...He});return Qe.batch_decode(ht,{skip_special_tokens:!0}).map(_t=>({[this._key]:_t}))}}class $ extends k{constructor(Ae){super(Ae);Pe(this,"_key","summary_text")}}class P extends k{constructor(Ae){super(Ae);Pe(this,"_key","translation_text")}}function D(Ge){return Array.isArray(Ge)&&Ge.every(_e=>"role"in _e&&"content"in _e)}class j extends E{constructor(_e){super(_e)}async _call(_e,Ae={}){let He=!1,qe=!1,Qe;if(typeof _e=="string")Qe=_e=[_e];else if(Array.isArray(_e)&&_e.every(ve=>typeof ve=="string"))He=!0,Qe=_e;else{if(D(_e))_e=[_e];else if(Array.isArray(_e)&&_e.every(D))He=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");qe=!0,Qe=_e.map(ve=>this.tokenizer.apply_chat_template(ve,{tokenize:!1,add_generation_prompt:!0}))}const Ke=Ae.add_special_tokens??!1,rt=qe?!1:Ae.return_full_text??!0;this.tokenizer.padding_side="left";const ht=this.tokenizer(Qe,{add_special_tokens:Ke,padding:!0,truncation:!0}),_t=await this.model.generate({...ht,...Ae}),ot=this.tokenizer.batch_decode(_t,{skip_special_tokens:!0});let mt;!rt&&ht.input_ids.dims.at(-1)>0&&(mt=this.tokenizer.batch_decode(ht.input_ids,{skip_special_tokens:!0}).map(ve=>ve.length));const Q=Array.from({length:_e.length},ve=>[]);for(let ve=0;ve<ot.length;++ve){const ie=Math.floor(ve/_t.dims[0]*_e.length);mt&&(ot[ve]=ot[ve].slice(mt[ie])),Q[ie].push({generated_text:qe?[..._e[ie],{role:"assistant",content:ot[ve]}]:ot[ve]})}return!He&&Q.length===1?Q[0]:Q}}class Y extends E{constructor(_e){super(_e),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([Ae,He])=>[Ae.toLowerCase(),He])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(_e,Ae,{hypothesis_template:He="This example is {}.",multi_label:qe=!1}={}){const Qe=Array.isArray(_e);Qe||(_e=[_e]),Array.isArray(Ae)||(Ae=[Ae]);const Ke=Ae.map(_t=>He.replace("{}",_t)),rt=qe||Ae.length===1,ht=[];for(const _t of _e){const ot=[];for(const ve of Ke){const ie=this.tokenizer(_t,{text_pair:ve,padding:!0,truncation:!0}),Ee=await this.model(ie);rt?ot.push([Ee.logits.data[this.contradiction_id],Ee.logits.data[this.entailment_id]]):ot.push(Ee.logits.data[this.entailment_id])}const Q=(rt?ot.map(ve=>(0,u.softmax)(ve)[1]):(0,u.softmax)(ot)).map((ve,ie)=>[ve,ie]).sort((ve,ie)=>ie[0]-ve[0]);ht.push({sequence:_t,labels:Q.map(ve=>Ae[ve[1]]),scores:Q.map(ve=>ve[0])})}return Qe?ht:ht[0]}}class q extends E{constructor(_e){super(_e)}async _call(_e,{pooling:Ae="none",normalize:He=!1,quantize:qe=!1,precision:Qe="binary"}={}){const Ke=this.tokenizer(_e,{padding:!0,truncation:!0}),rt=await this.model(Ke);let ht=rt.last_hidden_state??rt.logits??rt.token_embeddings;if(Ae!=="none")if(Ae==="mean")ht=(0,h.mean_pooling)(ht,Ke.attention_mask);else if(Ae==="cls")ht=ht.slice(null,0);else throw Error(`Pooling method '${Ae}' not supported.`);return He&&(ht=ht.normalize(2,-1)),qe&&(ht=(0,h.quantize_embeddings)(ht,Qe)),ht}}class oe extends E{constructor(_e){super(_e)}async _call(_e,{pool:Ae=null}={}){const He=await p(_e),{pixel_values:qe}=await this.processor(He),Qe=await this.model({pixel_values:qe});let Ke;if(Ae){if(!("pooler_output"in Qe))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");Ke=Qe.pooler_output}else Ke=Qe.last_hidden_state??Qe.logits??Qe.image_embeds;return Ke}}class de extends E{constructor(_e){super(_e)}async _call(_e,{top_k:Ae=5}={}){const He=this.processor.feature_extractor.config.sampling_rate,qe=await v(_e,He),Qe=this.model.config.id2label,Ke=[];for(const rt of qe){const ht=await this.processor(rt),ot=(await this.model(ht)).logits[0],mt=await(0,h.topk)(new h.Tensor("float32",(0,u.softmax)(ot.data),ot.dims),Ae),Q=mt[0].tolist(),ie=mt[1].tolist().map((Ee,Re)=>({label:Qe?Qe[Ee]:`LABEL_${Ee}`,score:Q[Re]}));Ke.push(ie)}return Array.isArray(_e)?Ke:Ke[0]}}class re extends E{constructor(_e){super(_e)}async _call(_e,Ae,{hypothesis_template:He="This is a sound of {}."}={}){const qe=!Array.isArray(_e);qe&&(_e=[_e]);const Qe=Ae.map(ot=>He.replace("{}",ot)),Ke=this.tokenizer(Qe,{padding:!0,truncation:!0}),rt=this.processor.feature_extractor.config.sampling_rate,ht=await v(_e,rt),_t=[];for(const ot of ht){const mt=await this.processor(ot),Q=await this.model({...Ke,...mt}),ve=(0,u.softmax)(Q.logits_per_audio.data);_t.push([...ve].map((ie,Ee)=>({score:ie,label:Ae[Ee]})))}return qe?_t[0]:_t}}class he extends E{constructor(_e){super(_e)}async _call(_e,Ae={}){switch(this.model.config.model_type){case"whisper":return this._call_whisper(_e,Ae);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(_e,Ae);case"moonshine":return this._call_moonshine(_e,Ae);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(_e,Ae){Ae.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),Ae.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const He=!Array.isArray(_e);He&&(_e=[_e]);const qe=this.processor.feature_extractor.config.sampling_rate,Qe=await v(_e,qe),Ke=[];for(const rt of Qe){const ht=await this.processor(rt),ot=(await this.model(ht)).logits[0],mt=[];for(const ve of ot)mt.push((0,u.max)(ve.data)[1]);const Q=this.tokenizer.decode(mt);Ke.push({text:Q})}return He?Ke[0]:Ke}async _call_whisper(_e,Ae){const He=Ae.return_timestamps??!1,qe=Ae.chunk_length_s??0,Qe=Ae.force_full_sequences??!1;let Ke=Ae.stride_length_s??null;const rt={...Ae};He==="word"&&(rt.return_token_timestamps=!0,rt.return_timestamps=!1);const ht=!Array.isArray(_e);ht&&(_e=[_e]);const _t=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,ot=this.processor.feature_extractor.config.hop_length,mt=this.processor.feature_extractor.config.sampling_rate,Q=await v(_e,mt),ve=[];for(const ie of Q){let Ee=[];if(qe>0){if(Ke===null)Ke=qe/6;else if(qe<=Ke)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const Ze=mt*qe,ft=mt*Ke,gt=Ze-2*ft;let St=0;for(;;){const kt=St+Ze,Dt=ie.subarray(St,kt),mn=await this.processor(Dt),An=St===0,Gn=kt>=ie.length;if(Ee.push({stride:[Dt.length,An?0:ft,Gn?0:ft],input_features:mn.input_features,is_last:Gn}),Gn)break;St+=gt}}else Ee=[{stride:[ie.length,0,0],input_features:(await this.processor(ie)).input_features,is_last:!0}];for(const Ze of Ee){rt.num_frames=Math.floor(Ze.stride[0]/ot);const ft=await this.model.generate({inputs:Ze.input_features,...rt});He==="word"?(Ze.tokens=ft.sequences.tolist()[0],Ze.token_timestamps=ft.token_timestamps.tolist()[0].map(gt=>(0,u.round)(gt,2))):Ze.tokens=ft[0].tolist(),Ze.stride=Ze.stride.map(gt=>gt/mt)}const[Re,Xe]=this.tokenizer._decode_asr(Ee,{time_precision:_t,return_timestamps:He,force_full_sequences:Qe});ve.push({text:Re,...Xe})}return ht?ve[0]:ve}async _call_moonshine(_e,Ae){const He=!Array.isArray(_e);He&&(_e=[_e]);const qe=this.processor.feature_extractor.config.sampling_rate,Qe=await v(_e,qe),Ke=[];for(const rt of Qe){const ht=await this.processor(rt),_t=Math.floor(rt.length/qe)*6,ot=await this.model.generate({max_new_tokens:_t,...Ae,...ht}),mt=this.processor.batch_decode(ot,{skip_special_tokens:!0})[0];Ke.push({text:mt})}return He?Ke[0]:Ke}}class ue extends E{constructor(_e){super(_e)}async _call(_e,Ae={}){const He=Array.isArray(_e),qe=await p(_e),{pixel_values:Qe}=await this.processor(qe),Ke=[];for(const rt of Qe){rt.dims=[1,...rt.dims];const ht=await this.model.generate({inputs:rt,...Ae}),_t=this.tokenizer.batch_decode(ht,{skip_special_tokens:!0}).map(ot=>({generated_text:ot.trim()}));Ke.push(_t)}return He?Ke:Ke[0]}}class ye extends E{constructor(_e){super(_e)}async _call(_e,{top_k:Ae=5}={}){const He=await p(_e),{pixel_values:qe}=await this.processor(He),Qe=await this.model({pixel_values:qe}),Ke=this.model.config.id2label,rt=[];for(const ht of Qe.logits){const _t=await(0,h.topk)(new h.Tensor("float32",(0,u.softmax)(ht.data),ht.dims),Ae),ot=_t[0].tolist(),Q=_t[1].tolist().map((ve,ie)=>({label:Ke?Ke[ve]:`LABEL_${ve}`,score:ot[ie]}));rt.push(Q)}return Array.isArray(_e)?rt:rt[0]}}class xe extends E{constructor(_e){super(_e),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(_e,{threshold:Ae=.5,mask_threshold:He=.5,overlap_mask_area_threshold:qe=.8,label_ids_to_fuse:Qe=null,target_sizes:Ke=null,subtask:rt=null}={}){if(Array.isArray(_e)&&_e.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const _t=await p(_e),ot=_t.map(Xe=>[Xe.height,Xe.width]),{pixel_values:mt,pixel_mask:Q}=await this.processor(_t),ve=await this.model({pixel_values:mt,pixel_mask:Q});let ie=null;if(rt!==null)ie=this.subtasks_mapping[rt];else for(let[Xe,Ze]of Object.entries(this.subtasks_mapping))if(Ze in this.processor.image_processor){ie=this.processor.image_processor[Ze].bind(this.processor.image_processor),rt=Xe;break}const Ee=this.model.config.id2label,Re=[];if(rt==="panoptic"||rt==="instance"){const Xe=ie(ve,Ae,He,qe,Qe,Ke??ot)[0],Ze=Xe.segmentation;for(const ft of Xe.segments_info){const gt=new Uint8ClampedArray(Ze.data.length);for(let kt=0;kt<Ze.data.length;++kt)Ze.data[kt]===ft.id&&(gt[kt]=255);const St=new m.RawImage(gt,Ze.dims[1],Ze.dims[0],1);Re.push({score:ft.score,label:Ee[ft.label_id],mask:St})}}else if(rt==="semantic"){const{segmentation:Xe,labels:Ze}=ie(ve,Ke??ot)[0];for(const ft of Ze){const gt=new Uint8ClampedArray(Xe.data.length);for(let kt=0;kt<Xe.data.length;++kt)Xe.data[kt]===ft&&(gt[kt]=255);const St=new m.RawImage(gt,Xe.dims[1],Xe.dims[0],1);Re.push({score:null,label:Ee[ft],mask:St})}}else throw Error(`Subtask ${rt} not supported.`);return Re}}class te extends E{constructor(_e){super(_e)}async _call(_e,Ae,{hypothesis_template:He="This is a photo of {}"}={}){const qe=Array.isArray(_e),Qe=await p(_e),Ke=Ae.map(Q=>He.replace("{}",Q)),rt=this.tokenizer(Ke,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:ht}=await this.processor(Qe),_t=await this.model({...rt,pixel_values:ht}),ot=this.model.config.model_type==="siglip"?Q=>Q.sigmoid().data:Q=>(0,u.softmax)(Q.data),mt=[];for(const Q of _t.logits_per_image){const ie=[...ot(Q)].map((Ee,Re)=>({score:Ee,label:Ae[Re]}));ie.sort((Ee,Re)=>Re.score-Ee.score),mt.push(ie)}return qe?mt:mt[0]}}class ke extends E{constructor(_e){super(_e)}async _call(_e,{threshold:Ae=.9,percentage:He=!1}={}){const qe=Array.isArray(_e);if(qe&&_e.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const Qe=await p(_e),Ke=He?null:Qe.map(ve=>[ve.height,ve.width]),{pixel_values:rt,pixel_mask:ht}=await this.processor(Qe),_t=await this.model({pixel_values:rt,pixel_mask:ht}),ot=this.processor.image_processor.post_process_object_detection(_t,Ae,Ke),mt=this.model.config.id2label,Q=ot.map(ve=>ve.boxes.map((ie,Ee)=>({score:ve.scores[Ee],label:mt[ve.classes[Ee]],box:T(ie,!He)})));return qe?Q:Q[0]}}class De extends E{constructor(_e){super(_e)}async _call(_e,Ae,{threshold:He=.1,top_k:qe=null,percentage:Qe=!1}={}){const Ke=Array.isArray(_e),rt=await p(_e),ht=this.tokenizer(Ae,{padding:!0,truncation:!0}),_t=await this.processor(rt),ot=[];for(let mt=0;mt<rt.length;++mt){const Q=rt[mt],ve=Qe?null:[[Q.height,Q.width]],ie=_t.pixel_values[mt].unsqueeze_(0),Ee=await this.model({...ht,pixel_values:ie});let Re;if("post_process_grounded_object_detection"in this.processor){const Xe=this.processor.post_process_grounded_object_detection(Ee,ht.input_ids,{box_threshold:He,text_threshold:He,target_sizes:ve})[0];Re=Xe.boxes.map((Ze,ft)=>({score:Xe.scores[ft],label:Xe.labels[ft],box:T(Ze,!Qe)}))}else{const Xe=this.processor.image_processor.post_process_object_detection(Ee,He,ve,!0)[0];Re=Xe.boxes.map((Ze,ft)=>({score:Xe.scores[ft],label:Ae[Xe.classes[ft]],box:T(Ze,!Qe)}))}Re.sort((Xe,Ze)=>Ze.score-Xe.score),qe!==null&&(Re=Re.slice(0,qe)),ot.push(Re)}return Ke?ot:ot[0]}}class me extends E{constructor(_e){super(_e)}async _call(_e,Ae,He={}){const qe=(await p(_e))[0],{pixel_values:Qe}=await this.processor(qe),Ke=`<s_docvqa><s_question>${Ae}</s_question><s_answer>`,rt=this.tokenizer(Ke,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,ht=await this.model.generate({inputs:Qe,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:rt,...He}),ot=this.tokenizer.batch_decode(ht)[0].match(/<s_answer>(.*?)<\/s_answer>/);let mt=null;return ot&&ot.length>=2&&(mt=ot[1].trim()),[{answer:mt}]}}class ee extends E{constructor(Ae){super(Ae);Pe(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan");this.vocoder=Ae.vocoder??null}async _call(Ae,{speaker_embeddings:He=null}={}){return this.processor?this._call_text_to_spectrogram(Ae,{speaker_embeddings:He}):this._call_text_to_waveform(Ae)}async _call_text_to_waveform(Ae){const He=this.tokenizer(Ae,{padding:!0,truncation:!0}),{waveform:qe}=await this.model(He),Qe=this.model.config.sampling_rate;return new d.RawAudio(qe.data,Qe)}async _call_text_to_spectrogram(Ae,{speaker_embeddings:He}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await s.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),(typeof He=="string"||He instanceof URL)&&(He=new Float32Array(await(await fetch(He)).arrayBuffer())),He instanceof Float32Array)He=new h.Tensor("float32",He,[1,He.length]);else if(!(He instanceof h.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:qe}=this.tokenizer(Ae,{padding:!0,truncation:!0}),{waveform:Qe}=await this.model.generate_speech(qe,He,{vocoder:this.vocoder}),Ke=this.processor.feature_extractor.config.sampling_rate;return new d.RawAudio(Qe.data,Ke)}}class ge extends E{constructor(_e){super(_e)}async _call(_e){const Ae=await p(_e),He=await this.processor(Ae),qe=await this.model(He),Qe=[];for(const Ke of qe.reconstruction){const rt=Ke.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");Qe.push(m.RawImage.fromTensor(rt))}return Qe.length>1?Qe:Qe[0]}}class Ie extends E{constructor(_e){super(_e)}async _call(_e){const Ae=await p(_e),He=await this.processor(Ae),{predicted_depth:qe}=await this.model(He),Qe=[];for(let Ke=0;Ke<Ae.length;++Ke){const rt=qe[Ke],[ht,_t]=rt.dims.slice(-2),[ot,mt]=Ae[Ke].size,Q=(await(0,h.interpolate_4d)(rt.view(1,1,ht,_t),{size:[mt,ot],mode:"bilinear"})).view(mt,ot),ve=Q.min().item(),ie=Q.max().item(),Ee=Q.sub(ve).div_(ie-ve).mul_(255).to("uint8").unsqueeze(0),Re=m.RawImage.fromTensor(Ee);Qe.push({predicted_depth:Q,depth:Re})}return Qe.length>1?Qe:Qe[0]}}const Be=Object.freeze({"text-classification":{tokenizer:r.AutoTokenizer,pipeline:O,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:r.AutoTokenizer,pipeline:b,model:s.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:r.AutoTokenizer,pipeline:M,model:s.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:r.AutoTokenizer,pipeline:I,model:s.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:r.AutoTokenizer,pipeline:$,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:r.AutoTokenizer,pipeline:P,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:r.AutoTokenizer,pipeline:k,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:r.AutoTokenizer,pipeline:j,model:s.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:r.AutoTokenizer,pipeline:Y,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:de,model:s.AutoModelForAudioClassification,processor:o.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:r.AutoTokenizer,pipeline:re,model:s.AutoModel,processor:o.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:r.AutoTokenizer,pipeline:he,model:[s.AutoModelForSpeechSeq2Seq,s.AutoModelForCTC],processor:o.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:r.AutoTokenizer,pipeline:ee,model:[s.AutoModelForTextToWaveform,s.AutoModelForTextToSpectrogram],processor:[o.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:r.AutoTokenizer,pipeline:ue,model:s.AutoModelForVision2Seq,processor:o.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:ye,model:s.AutoModelForImageClassification,processor:o.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:xe,model:[s.AutoModelForImageSegmentation,s.AutoModelForSemanticSegmentation,s.AutoModelForUniversalSegmentation],processor:o.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"zero-shot-image-classification":{tokenizer:r.AutoTokenizer,pipeline:te,model:s.AutoModel,processor:o.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:ke,model:s.AutoModelForObjectDetection,processor:o.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:r.AutoTokenizer,pipeline:De,model:s.AutoModelForZeroShotObjectDetection,processor:o.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:r.AutoTokenizer,pipeline:me,model:s.AutoModelForDocumentQuestionAnswering,processor:o.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:ge,model:s.AutoModelForImageToImage,processor:o.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:Ie,model:s.AutoModelForDepthEstimation,processor:o.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:r.AutoTokenizer,pipeline:q,model:s.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:o.AutoProcessor,pipeline:oe,model:[s.AutoModelForImageFeatureExtraction,s.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),Ue=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function pe(Ge,_e=null,{progress_callback:Ae=null,config:He=null,cache_dir:qe=null,local_files_only:Qe=!1,revision:Ke="main",device:rt=null,dtype:ht=null,model_file_name:_t=null,session_options:ot={}}={}){Ge=Ue[Ge]??Ge;const mt=Be[Ge.split("_",1)[0]];if(!mt)throw Error(`Unsupported pipeline: ${Ge}. Must be one of [${Object.keys(Be)}]`);_e||(_e=mt.default.model,console.log(`No model specified. Using default model: "${_e}".`));const Q={progress_callback:Ae,config:He,cache_dir:qe,local_files_only:Qe,revision:Ke,device:rt,dtype:ht,model_file_name:_t,session_options:ot},ve=new Map([["tokenizer",mt.tokenizer],["model",mt.model],["processor",mt.processor]]),ie=await Ye(ve,_e,Q);ie.task=Ge,(0,c.dispatchCallback)(Ae,{status:"ready",task:Ge,model:_e});const Ee=mt.pipeline;return new Ee(ie)}async function Ye(Ge,_e,Ae){const He=Object.create(null),qe=[];for(const[Qe,Ke]of Ge.entries()){if(!Ke)continue;let rt;Array.isArray(Ke)?rt=new Promise(async(ht,_t)=>{var mt,Q;let ot;for(const ve of Ke){if(ve===null){ht(null);return}try{ht(await ve.from_pretrained(_e,Ae));return}catch(ie){if((mt=ie.message)!=null&&mt.includes("Unsupported model type"))ot=ie;else if((Q=ie.message)!=null&&Q.includes("Could not locate file"))ot=ie;else{_t(ie);return}}}_t(ot)}):rt=Ke.from_pretrained(_e,Ae),He[Qe]=rt,qe.push(rt)}await Promise.all(qe);for(const[Qe,Ke]of Object.entries(He))He[Qe]=await Ke;return He}},"./src/tokenizers.js":(e,t,n)=>{n.r(t),n.d(t,{AlbertTokenizer:()=>Os,AutoTokenizer:()=>Mn,BartTokenizer:()=>mi,BertTokenizer:()=>bs,BlenderbotSmallTokenizer:()=>Ea,BlenderbotTokenizer:()=>Ta,BloomTokenizer:()=>Ys,CLIPTokenizer:()=>Bo,CamembertTokenizer:()=>ut,CodeGenTokenizer:()=>zo,CodeLlamaTokenizer:()=>Fi,CohereTokenizer:()=>Wo,ConvBertTokenizer:()=>Oi,DebertaTokenizer:()=>xs,DebertaV2Tokenizer:()=>io,DistilBertTokenizer:()=>ls,ElectraTokenizer:()=>Wt,EsmTokenizer:()=>Ri,FalconTokenizer:()=>ba,GPT2Tokenizer:()=>Li,GPTNeoXTokenizer:()=>xa,GemmaTokenizer:()=>Rl,Grok1Tokenizer:()=>ji,HerbertTokenizer:()=>pi,LlamaTokenizer:()=>jo,M2M100Tokenizer:()=>No,MBart50Tokenizer:()=>cs,MBartTokenizer:()=>Bn,MPNetTokenizer:()=>wa,MarianTokenizer:()=>Kt,MgpstrTokenizer:()=>Ca,MobileBertTokenizer:()=>fi,NllbTokenizer:()=>us,NougatTokenizer:()=>Ni,PreTrainedTokenizer:()=>Rt,Qwen2Tokenizer:()=>Ma,RoFormerTokenizer:()=>Di,RobertaTokenizer:()=>sr,SiglipTokenizer:()=>Vo,SpeechT5Tokenizer:()=>Pa,SqueezeBertTokenizer:()=>so,T5Tokenizer:()=>Pr,TokenizerModel:()=>oe,VitsTokenizer:()=>Sa,Wav2Vec2CTCTokenizer:()=>Uo,WhisperTokenizer:()=>oo,XLMRobertaTokenizer:()=>Fl,XLMTokenizer:()=>At,is_chinese_char:()=>I});var r=n("./src/utils/generic.js"),s=n("./src/utils/core.js"),o=n("./src/utils/hub.js"),a=n("./src/utils/maths.js"),c=n("./src/utils/tensor.js"),u=n("./src/utils/data-structures.js"),d=n("./node_modules/@huggingface/jinja/dist/index.js"),h=n("./src/models/whisper/common_whisper.js");async function m(Le,G){const ae=await Promise.all([(0,o.getModelJSON)(Le,"tokenizer.json",!0,G),(0,o.getModelJSON)(Le,"tokenizer_config.json",!0,G)]);return G.legacy!==null&&(ae[1].legacy=G.legacy),ae}function p(Le,G){const ae=[];let be=0;for(const Oe of Le.matchAll(G)){const Fe=Oe[0];be<Oe.index&&ae.push(Le.slice(be,Oe.index)),Fe.length>0&&ae.push(Fe),be=Oe.index+Fe.length}return be<Le.length&&ae.push(Le.slice(be)),ae}function v(Le,G=!0){if(Le.Regex!==void 0){let ae=Le.Regex.replace(/\\([#&~])/g,"$1");for(const[be,Oe]of Y)ae=ae.replaceAll(be,Oe);return new RegExp(ae,"gu")}else if(Le.String!==void 0){const ae=(0,s.escapeRegExp)(Le.String);return new RegExp(G?ae:`(${ae})`,"gu")}else return console.warn("Unknown pattern type:",Le),null}function T(Le){return new Map(Object.entries(Le))}function E(Le){const G=Le.dims;switch(G.length){case 1:return Le.tolist();case 2:if(G[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return Le.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${G.length}.`)}}function O(Le){return Le.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function b(Le){return Le.replace(new RegExp("\\p{M}","gu"),"")}function M(Le){return b(Le.toLowerCase())}function I(Le){return Le>=19968&&Le<=40959||Le>=13312&&Le<=19903||Le>=131072&&Le<=173791||Le>=173824&&Le<=177983||Le>=177984&&Le<=178207||Le>=178208&&Le<=183983||Le>=63744&&Le<=64255||Le>=194560&&Le<=195103}function k(Le,G,ae){const be=[];let Oe=0;for(;Oe<Le.length;){if(be.push(Le[Oe]),(G.get(Le[Oe])??ae)!==ae){++Oe;continue}for(;++Oe<Le.length&&(G.get(Le[Oe])??ae)===ae;)G.get(be.at(-1))!==ae&&(be[be.length-1]+=Le[Oe])}return be}function $(Le){return Le.match(/\S+/g)||[]}const P="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",D=new RegExp(`^[${P}]+$`,"gu"),j=".,!?…。，、।۔،",Y=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],[` ?[^(\\s|[${j}])]+`,` ?[^\\s${j}]+`]]);class q{constructor(G){this.content=G.content,this.id=G.id,this.single_word=G.single_word??!1,this.lstrip=G.lstrip??!1,this.rstrip=G.rstrip??!1,this.special=G.special??!1,this.normalized=G.normalized??null}}class oe extends r.Callable{constructor(G){super(),this.config=G,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(G,...ae){switch(G.type){case"WordPiece":return new de(G);case"Unigram":return new re(G,...ae);case"BPE":return new ye(G);default:if(G.vocab)return Array.isArray(G.vocab)?new re(G,...ae):new xe(G,...ae);throw new Error(`Unknown TokenizerModel type: ${G.type}`)}}_call(G){return G=this.encode(G),this.fuse_unk&&(G=k(G,this.tokens_to_ids,this.unk_token_id)),G}encode(G){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(G){return G.map(ae=>this.tokens_to_ids.get(ae)??this.unk_token_id)}convert_ids_to_tokens(G){return G.map(ae=>this.vocab[ae]??this.unk_token)}}class de extends oe{constructor(G){super(G),this.tokens_to_ids=T(G.vocab),this.unk_token_id=this.tokens_to_ids.get(G.unk_token),this.unk_token=G.unk_token,this.max_input_chars_per_word=G.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[ae,be]of this.tokens_to_ids)this.vocab[be]=ae}encode(G){const ae=[];for(const be of G){const Oe=[...be];if(Oe.length>this.max_input_chars_per_word){ae.push(this.unk_token);continue}let Fe=!1,tt=0;const yt=[];for(;tt<Oe.length;){let xt=Oe.length,wt=null;for(;tt<xt;){let Ct=Oe.slice(tt,xt).join("");if(tt>0&&(Ct=this.config.continuing_subword_prefix+Ct),this.tokens_to_ids.has(Ct)){wt=Ct;break}--xt}if(wt===null){Fe=!0;break}yt.push(wt),tt=xt}Fe?ae.push(this.unk_token):ae.push(...yt)}return ae}}class re extends oe{constructor(G,ae){super(G);const be=G.vocab.length;this.vocab=new Array(be),this.scores=new Array(be);for(let Oe=0;Oe<be;++Oe)[this.vocab[Oe],this.scores[Oe]]=G.vocab[Oe];this.unk_token_id=G.unk_id,this.unk_token=this.vocab[G.unk_id],this.tokens_to_ids=new Map(this.vocab.map((Oe,Fe)=>[Oe,Fe])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ae.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,a.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new u.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(G){const ae=G.chars,be=1;let Oe=0;for(;Oe<ae.length;){let Fe=!1;const tt=ae.slice(Oe).join(""),yt=this.trie.commonPrefixSearch(tt);for(const xt of yt){const wt=this.tokens_to_ids.get(xt),Ct=this.scores[wt],tn=(0,s.len)(xt);G.insert(Oe,tn,Ct,wt),!Fe&&tn===be&&(Fe=!0)}Fe||G.insert(Oe,be,this.unk_score,this.unk_token_id),Oe+=be}}tokenize(G){const ae=new u.TokenLattice(G,this.bos_token_id,this.eos_token_id);return this.populateNodes(ae),ae.tokens()}encode(G){const ae=[];for(const be of G){const Oe=this.tokenize(be);ae.push(...Oe)}return ae}}const he=(()=>{const Le=[...Array.from({length:94},(Oe,Fe)=>Fe+33),...Array.from({length:12},(Oe,Fe)=>Fe+161),...Array.from({length:82},(Oe,Fe)=>Fe+174)],G=Le.slice();let ae=0;for(let Oe=0;Oe<256;++Oe)Le.includes(Oe)||(Le.push(Oe),G.push(256+ae),ae+=1);const be=G.map(Oe=>String.fromCharCode(Oe));return Object.fromEntries(Le.map((Oe,Fe)=>[Oe,be[Fe]]))})(),ue=(0,s.reverseDictionary)(he);class ye extends oe{constructor(G){super(G),this.tokens_to_ids=T(G.vocab),this.unk_token_id=this.tokens_to_ids.get(G.unk_token),this.unk_token=G.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[be,Oe]of this.tokens_to_ids)this.vocab[Oe]=be;const ae=Array.isArray(G.merges[0]);this.merges=ae?G.merges:G.merges.map(be=>be.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((be,Oe)=>[JSON.stringify(be),Oe])),this.end_of_word_suffix=G.end_of_word_suffix,this.continuing_subword_suffix=G.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.cache=new Map}bpe(G){if(G.length===0)return[];const ae=this.cache.get(G);if(ae!==void 0)return ae;const be=Array.from(G);this.end_of_word_suffix&&(be[be.length-1]+=this.end_of_word_suffix);let Oe=[];if(be.length>1){const Fe=new u.PriorityQueue((xt,wt)=>xt.score<wt.score);let tt={token:be[0],bias:0,prev:null,next:null},yt=tt;for(let xt=1;xt<be.length;++xt){const wt={bias:xt/be.length,token:be[xt],prev:yt,next:null};yt.next=wt,this._add_node(Fe,yt),yt=wt}for(;!Fe.isEmpty();){const xt=Fe.pop();if(xt.deleted||!xt.next||xt.next.deleted)continue;if(xt.deleted=!0,xt.next.deleted=!0,xt.prev){const Ct={...xt.prev};xt.prev.deleted=!0,xt.prev=Ct,Ct.prev?Ct.prev.next=Ct:tt=Ct}const wt={token:xt.token+xt.next.token,bias:xt.bias,prev:xt.prev,next:xt.next.next};wt.prev?(wt.prev.next=wt,this._add_node(Fe,wt.prev)):tt=wt,wt.next&&(wt.next.prev=wt,this._add_node(Fe,wt))}for(let xt=tt;xt!==null;xt=xt.next)Oe.push(xt.token)}else Oe=be;if(this.continuing_subword_suffix)for(let Fe=0;Fe<Oe.length-1;++Fe)Oe[Fe]+=this.continuing_subword_suffix;return this.cache.set(G,Oe),Oe}_add_node(G,ae){const be=this.bpe_ranks.get(JSON.stringify([ae.token,ae.next.token]));be!==void 0&&(ae.score=be+ae.bias,G.push(ae))}encode(G){const ae=[];for(const be of G){if(this.ignore_merges&&this.tokens_to_ids.has(be)){ae.push(be);continue}const Oe=this.bpe(be);for(const Fe of Oe)if(this.tokens_to_ids.has(Fe))ae.push(Fe);else if(this.byte_fallback){const tt=Array.from(this.text_encoder.encode(Fe)).map(yt=>`<0x${yt.toString(16).toUpperCase().padStart(2,"0")}>`);tt.every(yt=>this.tokens_to_ids.has(yt))?ae.push(...tt):ae.push(this.unk_token)}else ae.push(this.unk_token)}return ae}}class xe extends oe{constructor(G,ae){super(G),this.tokens_to_ids=T(ae.target_lang?G.vocab[ae.target_lang]:G.vocab),this.bos_token=ae.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ae.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=ae.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=ae.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[be,Oe]of this.tokens_to_ids)this.vocab[Oe]=be}encode(G){return G}}class te extends r.Callable{constructor(G){super(),this.config=G}static fromConfig(G){if(G===null)return null;switch(G.type){case"BertNormalizer":return new Ye(G);case"Precompiled":return new An(G);case"Sequence":return new pe(G);case"Replace":return new ke(G);case"NFC":return new De(G);case"NFKC":return new me(G);case"NFKD":return new ee(G);case"Strip":return new ge(G);case"StripAccents":return new Ie(G);case"Lowercase":return new Be(G);case"Prepend":return new Ue(G);default:throw new Error(`Unknown Normalizer type: ${G.type}`)}}normalize(G){throw Error("normalize should be implemented in subclass.")}_call(G){return this.normalize(G)}}class ke extends te{normalize(G){const ae=v(this.config.pattern);return ae===null?G:G.replaceAll(ae,this.config.content)}}class De extends te{normalize(G){return G=G.normalize("NFC"),G}}class me extends te{normalize(G){return G=G.normalize("NFKC"),G}}class ee extends te{normalize(G){return G=G.normalize("NFKD"),G}}class ge extends te{normalize(G){return this.config.strip_left&&this.config.strip_right?G=G.trim():(this.config.strip_left&&(G=G.trimStart()),this.config.strip_right&&(G=G.trimEnd())),G}}class Ie extends te{normalize(G){return G=b(G),G}}class Be extends te{normalize(G){return G=G.toLowerCase(),G}}class Ue extends te{normalize(G){return G=this.config.prepend+G,G}}class pe extends te{constructor(G){super(G),this.normalizers=G.normalizers.map(ae=>te.fromConfig(ae))}normalize(G){return this.normalizers.reduce((ae,be)=>be.normalize(ae),G)}}class Ye extends te{_tokenize_chinese_chars(G){const ae=[];for(let be=0;be<G.length;++be){const Oe=G[be],Fe=Oe.charCodeAt(0);I(Fe)?(ae.push(" "),ae.push(Oe),ae.push(" ")):ae.push(Oe)}return ae.join("")}stripAccents(G){return G.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(G){switch(G){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(G)}}_clean_text(G){const ae=[];for(const be of G){const Oe=be.charCodeAt(0);Oe===0||Oe===65533||this._is_control(be)||(/^\s$/.test(be)?ae.push(" "):ae.push(be))}return ae.join("")}normalize(G){return this.config.clean_text&&(G=this._clean_text(G)),this.config.handle_chinese_chars&&(G=this._tokenize_chinese_chars(G)),this.config.lowercase?(G=G.toLowerCase(),this.config.strip_accents!==!1&&(G=this.stripAccents(G))):this.config.strip_accents&&(G=this.stripAccents(G)),G}}class Ge extends r.Callable{static fromConfig(G){if(G===null)return null;switch(G.type){case"BertPreTokenizer":return new _e(G);case"Sequence":return new Gn(G);case"Whitespace":return new zn(G);case"WhitespaceSplit":return new Br(G);case"Metaspace":return new Dt(G);case"ByteLevel":return new Ae(G);case"Split":return new He(G);case"Punctuation":return new qe(G);case"Digits":return new Qe(G);case"Replace":return new en(G);default:throw new Error(`Unknown PreTokenizer type: ${G.type}`)}}pre_tokenize_text(G,ae){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(G,ae){return(Array.isArray(G)?G.map(be=>this.pre_tokenize_text(be,ae)):this.pre_tokenize_text(G,ae)).flat()}_call(G,ae){return this.pre_tokenize(G,ae)}}class _e extends Ge{constructor(G){super(),this.pattern=new RegExp(`[^\\s${P}]+|[${P}]`,"gu")}pre_tokenize_text(G,ae){return G.trim().match(this.pattern)||[]}}class Ae extends Ge{constructor(G){super(),this.config=G,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=he,this.text_encoder=new TextEncoder}pre_tokenize_text(G,ae){return this.add_prefix_space&&!G.startsWith(" ")&&(G=" "+G),(this.use_regex?G.match(this.pattern)||[]:[G]).map(Oe=>Array.from(this.text_encoder.encode(Oe),Fe=>this.byte_encoder[Fe]).join(""))}}class He extends Ge{constructor(G){super(),this.config=G,this.pattern=v(this.config.pattern,this.config.invert)}pre_tokenize_text(G,ae){var be;return this.pattern===null?[]:this.config.invert?G.match(this.pattern)||[]:((be=this.config.behavior)==null?void 0:be.toLowerCase())==="removed"?G.split(this.pattern).filter(Oe=>Oe):p(G,this.pattern)}}class qe extends Ge{constructor(G){super(),this.config=G,this.pattern=new RegExp(`[^${P}]+|[${P}]+`,"gu")}pre_tokenize_text(G,ae){return G.match(this.pattern)||[]}}class Qe extends Ge{constructor(G){super(),this.config=G;const ae=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(ae,"gu")}pre_tokenize_text(G,ae){return G.match(this.pattern)||[]}}class Ke extends r.Callable{constructor(G){super(),this.config=G}static fromConfig(G){if(G===null)return null;switch(G.type){case"TemplateProcessing":return new _t(G);case"ByteLevel":return new ot(G);case"RobertaProcessing":return new ht(G);case"BertProcessing":return new rt(G);case"Sequence":return new mt(G);default:throw new Error(`Unknown PostProcessor type: ${G.type}`)}}post_process(G,...ae){throw Error("post_process should be implemented in subclass.")}_call(G,...ae){return this.post_process(G,...ae)}}class rt extends Ke{constructor(G){super(G),this.cls=G.cls[0],this.sep=G.sep[0]}post_process(G,ae=null,{add_special_tokens:be=!0}={}){be&&(G=(0,s.mergeArrays)([this.cls],G,[this.sep]));let Oe=new Array(G.length).fill(0);if(ae!==null){const Fe=be&&this instanceof ht?[this.sep]:[],tt=be?[this.sep]:[];G=(0,s.mergeArrays)(G,Fe,ae,tt),Oe=(0,s.mergeArrays)(Oe,new Array(ae.length+Fe.length+tt.length).fill(1))}return{tokens:G,token_type_ids:Oe}}}class ht extends rt{}class _t extends Ke{constructor(G){super(G),this.single=G.single,this.pair=G.pair}post_process(G,ae=null,{add_special_tokens:be=!0}={}){const Oe=ae===null?this.single:this.pair;let Fe=[],tt=[];for(const yt of Oe)"SpecialToken"in yt?be&&(Fe.push(yt.SpecialToken.id),tt.push(yt.SpecialToken.type_id)):"Sequence"in yt&&(yt.Sequence.id==="A"?(Fe=(0,s.mergeArrays)(Fe,G),tt=(0,s.mergeArrays)(tt,new Array(G.length).fill(yt.Sequence.type_id))):yt.Sequence.id==="B"&&(Fe=(0,s.mergeArrays)(Fe,ae),tt=(0,s.mergeArrays)(tt,new Array(ae.length).fill(yt.Sequence.type_id))));return{tokens:Fe,token_type_ids:tt}}}class ot extends Ke{post_process(G,ae=null){return ae&&(G=(0,s.mergeArrays)(G,ae)),{tokens:G}}}class mt extends Ke{constructor(G){super(G),this.processors=G.processors.map(ae=>Ke.fromConfig(ae))}post_process(G,ae=null,be={}){let Oe;for(const Fe of this.processors)if(Fe instanceof ot)G=Fe.post_process(G).tokens,ae&&(ae=Fe.post_process(ae).tokens);else{const tt=Fe.post_process(G,ae,be);G=tt.tokens,Oe=tt.token_type_ids}return{tokens:G,token_type_ids:Oe}}}class Q extends r.Callable{constructor(G){super(),this.config=G,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=G.trim_offsets}static fromConfig(G){if(G===null)return null;switch(G.type){case"WordPiece":return new Xe(G);case"Metaspace":return new mn(G);case"ByteLevel":return new Ze(G);case"Replace":return new ve(G);case"ByteFallback":return new ie(G);case"Fuse":return new Ee(G);case"Strip":return new Re(G);case"Sequence":return new gt(G);case"CTC":return new ft(G);case"BPEDecoder":return new St(G);default:throw new Error(`Unknown Decoder type: ${G.type}`)}}_call(G){return this.decode(G)}decode(G){return this.decode_chain(G).join("")}decode_chain(G){throw Error("`decode_chain` should be implemented in subclass.")}}class ve extends Q{decode_chain(G){const ae=v(this.config.pattern);return ae===null?G:G.map(be=>be.replaceAll(ae,this.config.content))}}class ie extends Q{constructor(G){super(G),this.text_decoder=new TextDecoder}decode_chain(G){const ae=[];let be=[];for(const Oe of G){let Fe=null;if(Oe.length===6&&Oe.startsWith("<0x")&&Oe.endsWith(">")){const tt=parseInt(Oe.slice(3,5),16);isNaN(tt)||(Fe=tt)}if(Fe!==null)be.push(Fe);else{if(be.length>0){const tt=this.text_decoder.decode(Uint8Array.from(be));ae.push(tt),be=[]}ae.push(Oe)}}if(be.length>0){const Oe=this.text_decoder.decode(Uint8Array.from(be));ae.push(Oe),be=[]}return ae}}class Ee extends Q{decode_chain(G){return[G.join("")]}}class Re extends Q{constructor(G){super(G),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(G){return G.map(ae=>{let be=0;for(let Fe=0;Fe<this.start&&ae[Fe]===this.content;++Fe){be=Fe+1;continue}let Oe=ae.length;for(let Fe=0;Fe<this.stop;++Fe){const tt=ae.length-Fe-1;if(ae[tt]===this.content){Oe=tt;continue}else break}return ae.slice(be,Oe)})}}class Xe extends Q{constructor(G){super(G),this.cleanup=G.cleanup}decode_chain(G){return G.map((ae,be)=>(be!==0&&(ae.startsWith(this.config.prefix)?ae=ae.replace(this.config.prefix,""):ae=" "+ae),this.cleanup&&(ae=O(ae)),ae))}}class Ze extends Q{constructor(G){super(G),this.byte_decoder=ue,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(G){const ae=G.join(""),be=new Uint8Array([...ae].map(Fe=>this.byte_decoder[Fe]));return this.text_decoder.decode(be)}decode_chain(G){const ae=[];let be=[];for(const Oe of G)this.added_tokens.find(Fe=>Fe.content===Oe)!==void 0?(be.length>0&&(ae.push(this.convert_tokens_to_string(be)),be=[]),ae.push(Oe)):be.push(Oe);return be.length>0&&ae.push(this.convert_tokens_to_string(be)),ae}}class ft extends Q{constructor(G){super(G),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(G){if(G.length===0)return"";const ae=[G[0]];for(let Fe=1;Fe<G.length;++Fe)G[Fe]!==ae.at(-1)&&ae.push(G[Fe]);let Oe=ae.filter(Fe=>Fe!==this.pad_token).join("");return this.cleanup&&(Oe=O(Oe).replaceAll(this.word_delimiter_token," ").trim()),Oe}decode_chain(G){return[this.convert_tokens_to_string(G)]}}class gt extends Q{constructor(G){super(G),this.decoders=G.decoders.map(ae=>Q.fromConfig(ae))}decode_chain(G){return this.decoders.reduce((ae,be)=>be.decode_chain(ae),G)}}class St extends Q{constructor(G){super(G),this.suffix=this.config.suffix}decode_chain(G){return G.map((ae,be)=>ae.replaceAll(this.suffix,be===G.length-1?"":" "))}}class kt extends Q{decode_chain(G){let ae="";for(let be=1;be<G.length;be+=2)ae+=G[be];return[ae]}}class Dt extends Ge{constructor(G){super(),this.addPrefixSpace=G.add_prefix_space,this.replacement=G.replacement,this.strRep=G.str_rep||this.replacement,this.prepend_scheme=G.prepend_scheme??"always"}pre_tokenize_text(G,{section_index:ae=void 0}={}){let be=G.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!be.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&ae===0)&&(be=this.strRep+be),[be]}}class mn extends Q{constructor(G){super(G),this.addPrefixSpace=G.add_prefix_space,this.replacement=G.replacement}decode_chain(G){const ae=[];for(let be=0;be<G.length;++be){let Oe=G[be].replaceAll(this.replacement," ");this.addPrefixSpace&&be==0&&Oe.startsWith(" ")&&(Oe=Oe.substring(1)),ae.push(Oe)}return ae}}class An extends te{constructor(G){super(G),this.charsmap=G.precompiled_charsmap}normalize(G){return G=G.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),G=G.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),G.includes("～")?G=G.split("～").map(be=>be.normalize("NFKC")).join("～"):G=G.normalize("NFKC"),G}}class Gn extends Ge{constructor(G){super(),this.tokenizers=G.pretokenizers.map(ae=>Ge.fromConfig(ae))}pre_tokenize_text(G,ae){return this.tokenizers.reduce((be,Oe)=>Oe.pre_tokenize(be,ae),[G])}}class zn extends Ge{constructor(G){super()}pre_tokenize_text(G,ae){return G.match(/\w+|[^\w\s]+/g)||[]}}class Br extends Ge{constructor(G){super()}pre_tokenize_text(G,ae){return $(G)}}class en extends Ge{constructor(G){super(),this.config=G,this.pattern=v(this.config.pattern),this.content=this.config.content}pre_tokenize_text(G,ae){return this.pattern===null?[G]:[G.replaceAll(this.pattern,this.config.content)]}}const $n=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function ln(Le,G,ae,be){for(const Oe of Object.keys(Le)){const Fe=G-Le[Oe].length,tt=ae(Oe),yt=new Array(Fe).fill(tt);Le[Oe]=be==="right"?(0,s.mergeArrays)(Le[Oe],yt):(0,s.mergeArrays)(yt,Le[Oe])}}function fr(Le,G){for(const ae of Object.keys(Le))Le[ae].length=G}class Rt extends r.Callable{constructor(ae,be){super();Pe(this,"return_token_type_ids",!1);Pe(this,"padding_side","right");this._tokenizer_config=be,this.normalizer=te.fromConfig(ae.normalizer),this.pre_tokenizer=Ge.fromConfig(ae.pre_tokenizer),this.model=oe.fromConfig(ae.model,be),this.post_processor=Ke.fromConfig(ae.post_processor),this.decoder=Q.fromConfig(ae.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const Oe of ae.added_tokens){const Fe=new q(Oe);this.added_tokens.push(Fe),this.model.tokens_to_ids.set(Fe.content,Fe.id),this.model.vocab[Fe.id]=Fe.content,Fe.special&&(this.special_tokens.push(Fe.content),this.all_special_ids.push(Fe.id))}if(this.additional_special_tokens=be.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_regex=this.added_tokens.length>0?new RegExp(this.added_tokens.slice().sort((Oe,Fe)=>Fe.content.length-Oe.content.length).map(Oe=>`${Oe.lstrip?"\\s*":""}(${(0,s.escapeRegExp)(Oe.content)})${Oe.rstrip?"\\s*":""}`).join("|")):null,this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=be.model_max_length,this.remove_space=be.remove_space,this.clean_up_tokenization_spaces=be.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=be.do_lowercase_and_remove_accent??!1,be.padding_side&&(this.padding_side=be.padding_side),this.legacy=!1,this.chat_template=be.chat_template??null,Array.isArray(this.chat_template)){const Oe=Object.create(null);for(const{name:Fe,template:tt}of this.chat_template){if(typeof Fe!="string"||typeof tt!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');Oe[Fe]=tt}this.chat_template=Oe}this._compiled_template_cache=new Map}getToken(...ae){for(const be of ae){const Oe=this._tokenizer_config[be];if(Oe)if(typeof Oe=="object"){if(Oe.__type==="AddedToken")return Oe.content;throw Error(`Unknown token: ${Oe}`)}else return Oe}return null}static async from_pretrained(ae,{progress_callback:be=null,config:Oe=null,cache_dir:Fe=null,local_files_only:tt=!1,revision:yt="main",legacy:xt=null}={}){const wt=await m(ae,{progress_callback:be,config:Oe,cache_dir:Fe,local_files_only:tt,revision:yt,legacy:xt});return new this(...wt)}_call(ae,{text_pair:be=null,add_special_tokens:Oe=!0,padding:Fe=!1,truncation:tt=null,max_length:yt=null,return_tensor:xt=!0,return_token_type_ids:wt=null}={}){const Ct=Array.isArray(ae);let tn;if(Ct){if(ae.length===0)throw Error("text array must be non-empty");if(be!==null){if(Array.isArray(be)){if(ae.length!==be.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");tn=ae.map((En,lr)=>this._encode_plus(En,{text_pair:be[lr],add_special_tokens:Oe,return_token_type_ids:wt}))}else tn=ae.map(En=>this._encode_plus(En,{add_special_tokens:Oe,return_token_type_ids:wt}))}else{if(ae==null)throw Error("text may not be null or undefined");if(Array.isArray(be))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");tn=[this._encode_plus(ae,{text_pair:be,add_special_tokens:Oe,return_token_type_ids:wt})]}if(yt===null?Fe==="max_length"?yt=this.model_max_length:yt=(0,a.max)(tn.map(En=>En.input_ids.length))[0]:tt||console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=true` to explicitly truncate examples to max length."),yt=Math.min(yt,this.model_max_length??1/0),Fe||tt)for(let En=0;En<tn.length;++En)tn[En].input_ids.length!==yt&&(tn[En].input_ids.length>yt?tt&&fr(tn[En],yt):Fe&&ln(tn[En],yt,lr=>lr==="input_ids"?this.pad_token_id:0,this.padding_side));const In={};if(xt){if(!(Fe&&tt)&&tn.some(lr=>{var Ht;for(const gn of Object.keys(lr))if(lr[gn].length!==((Ht=tn[0][gn])==null?void 0:Ht.length))return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const En=[tn.length,tn[0].input_ids.length];for(const lr of Object.keys(tn[0]))In[lr]=new c.Tensor("int64",BigInt64Array.from(tn.flatMap(Ht=>Ht[lr]).map(BigInt)),En)}else{for(const En of Object.keys(tn[0]))In[En]=tn.map(lr=>lr[En]);if(!Ct)for(const En of Object.keys(In))In[En]=In[En][0]}return In}_encode_text(ae){return ae===null?null:(this.added_tokens_regex?ae.split(this.added_tokens_regex).filter(Fe=>Fe):[ae]).map((Fe,tt)=>{if(this.added_tokens.find(xt=>xt.content===Fe)!==void 0)return Fe;{if(this.remove_space===!0&&(Fe=Fe.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(Fe=M(Fe)),this.normalizer!==null&&(Fe=this.normalizer(Fe)),Fe.length===0)return[];const xt=this.pre_tokenizer!==null?this.pre_tokenizer(Fe,{section_index:tt}):[Fe];return this.model(xt)}}).flat()}_encode_plus(ae,{text_pair:be=null,add_special_tokens:Oe=!0,return_token_type_ids:Fe=null}={}){const{tokens:tt,token_type_ids:yt}=this._tokenize_helper(ae,{pair:be,add_special_tokens:Oe}),xt=this.model.convert_tokens_to_ids(tt),wt={input_ids:xt,attention_mask:new Array(xt.length).fill(1)};return(Fe??this.return_token_type_ids)&&yt&&(wt.token_type_ids=yt),wt}_tokenize_helper(ae,{pair:be=null,add_special_tokens:Oe=!1}={}){const Fe=this._encode_text(ae),tt=this._encode_text(be);return this.post_processor?this.post_processor(Fe,tt,{add_special_tokens:Oe}):{tokens:(0,s.mergeArrays)(Fe??[],tt??[])}}tokenize(ae,{pair:be=null,add_special_tokens:Oe=!1}={}){return this._tokenize_helper(ae,{pair:be,add_special_tokens:Oe}).tokens}encode(ae,{text_pair:be=null,add_special_tokens:Oe=!0,return_token_type_ids:Fe=null}={}){return this._encode_plus(ae,{text_pair:be,add_special_tokens:Oe,return_token_type_ids:Fe}).input_ids}batch_decode(ae,be={}){return ae instanceof c.Tensor&&(ae=ae.tolist()),ae.map(Oe=>this.decode(Oe,be))}decode(ae,be={}){if(ae instanceof c.Tensor&&(ae=E(ae)),!Array.isArray(ae)||ae.length===0||!(0,s.isIntegralNumber)(ae[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(ae,be)}decode_single(ae,{skip_special_tokens:be=!1,clean_up_tokenization_spaces:Oe=null}){let Fe=this.model.convert_ids_to_tokens(ae);be&&(Fe=Fe.filter(yt=>!this.special_tokens.includes(yt)));let tt=this.decoder?this.decoder(Fe):Fe.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(tt=tt.replaceAll(this.decoder.end_of_word_suffix," "),be&&(tt=tt.trim())),(Oe??this.clean_up_tokenization_spaces)&&(tt=O(tt)),tt}get_chat_template({chat_template:ae=null,tools:be=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const Oe=this.chat_template;if(ae!==null&&Object.hasOwn(Oe,ae))ae=Oe[ae];else if(ae===null)if(be!==null&&"tool_use"in Oe)ae=Oe.tool_use;else if("default"in Oe)ae=Oe.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(Oe).sort()}.`)}else if(ae===null)if(this.chat_template)ae=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return ae}apply_chat_template(ae,{tools:be=null,documents:Oe=null,chat_template:Fe=null,add_generation_prompt:tt=!1,tokenize:yt=!0,padding:xt=!1,truncation:wt=!1,max_length:Ct=null,return_tensor:tn=!0,return_dict:In=!1,tokenizer_kwargs:En={},...lr}={}){if(Fe=this.get_chat_template({chat_template:Fe,tools:be}),typeof Fe!="string")throw Error(`chat_template must be a string, but got ${typeof Fe}`);let Ht=this._compiled_template_cache.get(Fe);Ht===void 0&&(Ht=new d.Template(Fe),this._compiled_template_cache.set(Fe,Ht));const gn=Object.create(null);for(const Sr of $n){const We=this.getToken(Sr);We&&(gn[Sr]=We)}const Xr=Ht.render({messages:ae,add_generation_prompt:tt,tools:be,documents:Oe,...gn,...lr});if(yt){const Sr=this._call(Xr,{add_special_tokens:!1,padding:xt,truncation:wt,max_length:Ct,return_tensor:tn,...En});return In?Sr:Sr.input_ids}return Xr}}class bs extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class Os extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class fi extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class so extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class xs extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class io extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class pi extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class Oi extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class Di extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class ls extends Rt{}class ut extends Rt{}class At extends Rt{constructor(ae,be){super(ae,be);Pe(this,"return_token_type_ids",!0);console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class Wt extends Rt{constructor(){super(...arguments);Pe(this,"return_token_type_ids",!0)}}class Pr extends Rt{}class Li extends Rt{}class mi extends Rt{}class Bn extends Rt{constructor(G,ae){super(G,ae),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(be=>this.languageRegex.test(be)),this.lang_to_token=be=>be}_build_translation_inputs(G,ae,be){return Ds(this,G,ae,be)}}class cs extends Bn{}class sr extends Rt{}class Ys extends Rt{}const fn="▁";class jo extends Rt{constructor(ae,be){super(ae,be);Pe(this,"padding_side","left");this.legacy=be.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new Dt({replacement:fn,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(ae){if(ae===null)return null;if(this.legacy||ae.length===0)return super._encode_text(ae);let be=super._encode_text(fn+ae.replaceAll(fn," "));return be.length>1&&be[0]===fn&&this.special_tokens.includes(be[1])&&(be=be.slice(1)),be}}class Fi extends Rt{}class Fl extends Rt{}class wa extends Rt{}class ba extends Rt{}class xa extends Rt{}class Ri extends Rt{}class Ma extends Rt{}class Rl extends Rt{}class ji extends Rt{}function Ds(Le,G,ae,be){if(!("language_codes"in Le)||!Array.isArray(Le.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in Le)||!(Le.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in Le)||typeof Le.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const Oe=be.src_lang,Fe=be.tgt_lang;if(!Le.language_codes.includes(Fe))throw new Error(`Target language code "${Fe}" is not valid. Must be one of: {${Le.language_codes.join(", ")}}`);if(Oe!==void 0){if(!Le.language_codes.includes(Oe))throw new Error(`Source language code "${Oe}" is not valid. Must be one of: {${Le.language_codes.join(", ")}}`);for(const tt of Le.post_processor.config.single)if("SpecialToken"in tt&&Le.languageRegex.test(tt.SpecialToken.id)){tt.SpecialToken.id=Le.lang_to_token(Oe);break}}return be.forced_bos_token_id=Le.model.convert_tokens_to_ids([Le.lang_to_token(Fe)])[0],Le._call(G,ae)}class us extends Rt{constructor(G,ae){super(G,ae),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(be=>this.languageRegex.test(be)),this.lang_to_token=be=>be}_build_translation_inputs(G,ae,be){return Ds(this,G,ae,be)}}class No extends Rt{constructor(G,ae){super(G,ae),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(be=>this.languageRegex.test(be)).map(be=>be.slice(2,-2)),this.lang_to_token=be=>`__${be}__`}_build_translation_inputs(G,ae,be){return Ds(this,G,ae,be)}}class oo extends Rt{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(G,{return_timestamps:ae=!1,return_language:be=!1,time_precision:Oe=null,force_full_sequences:Fe=!0}={}){if(Oe===null)throw Error("Must specify time_precision");let tt=null;const yt=ae==="word";function xt(){return{language:tt,timestamp:[null,null],text:""}}const wt=[];let Ct=xt(),tn=0;const In=this.timestamp_begin,lr=In+1500;let Ht=[],gn=[],Xr=!1,Sr=null;const We=new Set(this.all_special_ids);for(const tr of G){const Dr=tr.tokens,zt=yt?tr.token_timestamps:null;let ts=null,Ls=In;if("stride"in tr){const[Tt,rn,pr]=tr.stride;if(tn-=rn,Sr=Tt-pr,rn&&(Ls=rn/Oe+In),pr)for(let rr=Dr.length-1;rr>=0;--rr){const Cr=Number(Dr[rr]);if(Cr>=In){if(ts!==null&&(Cr-In)*Oe<Sr)break;ts=Cr}}}let On=[],nr=[];for(let Tt=0;Tt<Dr.length;++Tt){const rn=Number(Dr[Tt]);if(We.has(rn)){const pr=this.decode([rn]),rr=h.WHISPER_LANGUAGE_MAPPING.get(pr.slice(2,-2));if(rr!==void 0){if(tt!==null&&rr!==tt&&!ae){Ht.push(On);const Cr=this.findLongestCommonSequence(Ht)[0],Ft=this.decode(Cr);Ct.text=Ft,wt.push(Ct),Ht=[],On=[],Ct=xt()}tt=Ct.language=rr}}else if(rn>=In&&rn<=lr){const pr=(rn-In)*Oe+tn,rr=(0,a.round)(pr,2);if(ts!==null&&rn>=ts)Xr=!0;else if(Xr||Ht.length>0&&rn<Ls)Xr=!1;else if(Ct.timestamp[0]===null)Ct.timestamp[0]=rr;else if(rr!==Ct.timestamp[0]){Ct.timestamp[1]=rr,Ht.push(On),yt&&gn.push(nr);const[Cr,Ft]=this.findLongestCommonSequence(Ht,gn),ao=this.decode(Cr);Ct.text=ao,yt&&(Ct.words=this.collateWordTimestamps(Cr,Ft,tt)),wt.push(Ct),Ht=[],On=[],gn=[],nr=[],Ct=xt()}}else if(On.push(rn),yt){let pr=(0,a.round)(zt[Tt]+tn,2),rr;if(Tt+1<zt.length){rr=(0,a.round)(zt[Tt+1]+tn,2);const Cr=this.decode([rn]);D.test(Cr)&&(rr=(0,a.round)(Math.min(pr+Oe,rr),2))}else rr=null;nr.push([pr,rr])}}if("stride"in tr){const[Tt,rn,pr]=tr.stride;tn+=Tt-pr}On.length>0?(Ht.push(On),yt&&gn.push(nr)):Ht.every(Tt=>Tt.length===0)&&(Ct=xt(),Ht=[],On=[],gn=[],nr=[])}if(Ht.length>0){if(Fe&&ae)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[tr,Dr]=this.findLongestCommonSequence(Ht,gn),zt=this.decode(tr);Ct.text=zt,yt&&(Ct.words=this.collateWordTimestamps(tr,Dr,tt)),wt.push(Ct)}let Vr=Object.create(null);const gi=wt.map(tr=>tr.text).join("");if(ae||be){for(let tr=0;tr<wt.length;++tr){const Dr=wt[tr];ae||delete Dr.timestamp,be||delete Dr.language}if(yt){const tr=[];for(const Dr of wt)for(const zt of Dr.words)tr.push(zt);Vr={chunks:tr}}else Vr={chunks:wt}}return[gi,Vr]}findLongestCommonSequence(G,ae=null){let be=G[0],Oe=be.length,Fe=[];const tt=Array.isArray(ae)&&ae.length>0;let yt=tt?[]:null,xt=tt?ae[0]:null;for(let wt=1;wt<G.length;++wt){const Ct=G[wt];let tn=0,In=[Oe,Oe,0,0];const En=Ct.length;for(let Vr=1;Vr<Oe+En;++Vr){const gi=Math.max(0,Oe-Vr),tr=Math.min(Oe,Oe+En-Vr),Dr=be.slice(gi,tr),zt=Math.max(0,Vr-Oe),ts=Math.min(En,Vr),Ls=Ct.slice(zt,ts);if(Dr.length!==Ls.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let On;tt?On=Dr.filter((rn,pr)=>rn===Ls[pr]&&xt[gi+pr]<=ae[wt][zt+pr]).length:On=Dr.filter((rn,pr)=>rn===Ls[pr]).length;const nr=Vr/1e4,Tt=On/Vr+nr;On>1&&Tt>tn&&(tn=Tt,In=[gi,tr,zt,ts])}const[lr,Ht,gn,Xr]=In,Sr=Math.floor((Ht+lr)/2),We=Math.floor((Xr+gn)/2);Fe.push(...be.slice(0,Sr)),be=Ct.slice(We),Oe=be.length,tt&&(yt.push(...xt.slice(0,Sr)),xt=ae[wt].slice(We))}return Fe.push(...be),tt?(yt.push(...xt),[Fe,yt]):[Fe,[]]}collateWordTimestamps(G,ae,be){const[Oe,Fe,tt]=this.combineTokensIntoWords(G,be),yt=[];for(let xt=0;xt<Oe.length;++xt){const wt=tt[xt];yt.push({text:Oe[xt],timestamp:[ae[wt.at(0)][0],ae[wt.at(-1)][1]]})}return yt}combineTokensIntoWords(G,ae,be=`"'“¡¿([{-`,Oe=`"'.。,，!！?？:：”)]}、`){ae=ae??"english";let Fe,tt,yt;return["chinese","japanese","thai","lao","myanmar"].includes(ae)?[Fe,tt,yt]=this.splitTokensOnUnicode(G):[Fe,tt,yt]=this.splitTokensOnSpaces(G),this.mergePunctuations(Fe,tt,yt,be,Oe)}decode(G,ae){let be;return ae!=null&&ae.decode_with_timestamps?(G instanceof c.Tensor&&(G=E(G)),be=this.decodeWithTimestamps(G,ae)):be=super.decode(G,ae),be}decodeWithTimestamps(G,ae){const be=(ae==null?void 0:ae.time_precision)??.02,Oe=Array.from(this.all_special_ids).at(-1)+1;let Fe=[[]];for(let tt of G)if(tt=Number(tt),tt>=Oe){const yt=((tt-Oe)*be).toFixed(2);Fe.push(`<|${yt}|>`),Fe.push([])}else Fe[Fe.length-1].push(tt);return Fe=Fe.map(tt=>typeof tt=="string"?tt:super.decode(tt,ae)),Fe.join("")}splitTokensOnUnicode(G){const ae=this.decode(G,{decode_with_timestamps:!0}),be="�",Oe=[],Fe=[],tt=[];let yt=[],xt=[],wt=0;for(let Ct=0;Ct<G.length;++Ct){const tn=G[Ct];yt.push(tn),xt.push(Ct);const In=this.decode(yt,{decode_with_timestamps:!0});(!In.includes(be)||ae[wt+In.indexOf(be)]===be)&&(Oe.push(In),Fe.push(yt),tt.push(xt),yt=[],xt=[],wt+=In.length)}return[Oe,Fe,tt]}splitTokensOnSpaces(G){const[ae,be,Oe]=this.splitTokensOnUnicode(G),Fe=[],tt=[],yt=[],xt=new RegExp(`^[${P}]$`,"gu");for(let wt=0;wt<ae.length;++wt){const Ct=ae[wt],tn=be[wt],In=Oe[wt],En=tn[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),lr=Ct.startsWith(" "),Ht=Ct.trim(),gn=xt.test(Ht);if(En||lr||gn||Fe.length===0)Fe.push(Ct),tt.push(tn),yt.push(In);else{const Xr=Fe.length-1;Fe[Xr]+=Ct,tt[Xr].push(...tn),yt[Xr].push(...In)}}return[Fe,tt,yt]}mergePunctuations(G,ae,be,Oe,Fe){const tt=structuredClone(G),yt=structuredClone(ae),xt=structuredClone(be);let wt=tt.length-2,Ct=tt.length-1;for(;wt>=0;)tt[wt].startsWith(" ")&&Oe.includes(tt[wt].trim())?(tt[Ct]=tt[wt]+tt[Ct],yt[Ct]=(0,s.mergeArrays)(yt[wt],yt[Ct]),xt[Ct]=(0,s.mergeArrays)(xt[wt],xt[Ct]),tt[wt]="",yt[wt]=[],xt[wt]=[]):Ct=wt,--wt;for(wt=0,Ct=1;Ct<tt.length;)!tt[wt].endsWith(" ")&&Fe.includes(tt[Ct])?(tt[wt]+=tt[Ct],yt[wt]=(0,s.mergeArrays)(yt[wt],yt[Ct]),xt[wt]=(0,s.mergeArrays)(xt[wt],xt[Ct]),tt[Ct]="",yt[Ct]=[],xt[Ct]=[]):wt=Ct,++Ct;return[tt.filter(tn=>tn),yt.filter(tn=>tn.length>0),xt.filter(tn=>tn.length>0)]}}class zo extends Rt{}class Bo extends Rt{}class Vo extends Rt{}class Kt extends Rt{constructor(G,ae){super(G,ae),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(be=>this.languageRegex.test(be)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(G){if(G===null)return null;const[ae,...be]=G.trim().split(this.languageRegex);if(be.length===0)return super._encode_text(ae);if(be.length===2){const[Oe,Fe]=be;return this.supported_language_codes.includes(Oe)||console.warn(`Unsupported language code "${Oe}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,s.mergeArrays)([Oe],super._encode_text(Fe))}}}class Uo extends Rt{}class Ta extends Rt{}class Ea extends Rt{}class Pa extends Rt{}class Ni extends Rt{}class Sa extends Rt{constructor(G,ae){super(G,ae),this.decoder=new kt({})}}class Wo extends Rt{}class Ca extends Rt{}class Mn{static async from_pretrained(G,{progress_callback:ae=null,config:be=null,cache_dir:Oe=null,local_files_only:Fe=!1,revision:tt="main",legacy:yt=null}={}){var In;const[xt,wt]=await m(G,{progress_callback:ae,config:be,cache_dir:Oe,local_files_only:Fe,revision:tt,legacy:yt}),Ct=((In=wt.tokenizer_class)==null?void 0:In.replace(/Fast$/,""))??"PreTrainedTokenizer";let tn=this.TOKENIZER_CLASS_MAPPING[Ct];return tn||(console.warn(`Unknown tokenizer class "${Ct}", attempting to construct from base class.`),tn=Rt),new tn(xt,wt)}}Pe(Mn,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:Pr,DistilBertTokenizer:ls,CamembertTokenizer:ut,DebertaTokenizer:xs,DebertaV2Tokenizer:io,BertTokenizer:bs,HerbertTokenizer:pi,ConvBertTokenizer:Oi,RoFormerTokenizer:Di,XLMTokenizer:At,ElectraTokenizer:Wt,MobileBertTokenizer:fi,SqueezeBertTokenizer:so,AlbertTokenizer:Os,GPT2Tokenizer:Li,BartTokenizer:mi,MBartTokenizer:Bn,MBart50Tokenizer:cs,RobertaTokenizer:sr,WhisperTokenizer:oo,CodeGenTokenizer:zo,CLIPTokenizer:Bo,SiglipTokenizer:Vo,MarianTokenizer:Kt,BloomTokenizer:Ys,NllbTokenizer:us,M2M100Tokenizer:No,LlamaTokenizer:jo,CodeLlamaTokenizer:Fi,XLMRobertaTokenizer:Fl,MPNetTokenizer:wa,FalconTokenizer:ba,GPTNeoXTokenizer:xa,EsmTokenizer:Ri,Wav2Vec2CTCTokenizer:Uo,BlenderbotTokenizer:Ta,BlenderbotSmallTokenizer:Ea,SpeechT5Tokenizer:Pa,NougatTokenizer:Ni,VitsTokenizer:Sa,Qwen2Tokenizer:Ma,GemmaTokenizer:Rl,Grok1Tokenizer:ji,CohereTokenizer:Wo,MgpstrTokenizer:Ca,PreTrainedTokenizer:Rt})},"./src/utils/audio.js":(e,t,n)=>{n.r(t),n.d(t,{RawAudio:()=>de,hamming:()=>p,hanning:()=>m,mel_filter_bank:()=>I,read_audio:()=>d,spectrogram:()=>j,window_function:()=>Y});var r=n("./src/utils/hub.js"),s=n("./src/utils/maths.js"),o=n("./src/utils/core.js"),a=n("./src/env.js"),c=n("?7a2c"),u=n("./src/utils/tensor.js");async function d(re,he){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const ue=await(await(0,r.getFile)(re)).arrayBuffer(),ye=new AudioContext({sampleRate:he});typeof he>"u"&&console.warn(`No sampling rate provided, using default of ${ye.sampleRate}Hz.`);const xe=await ye.decodeAudioData(ue);let te;if(xe.numberOfChannels===2){const ke=Math.sqrt(2),De=xe.getChannelData(0),me=xe.getChannelData(1);te=new Float32Array(De.length);for(let ee=0;ee<xe.length;++ee)te[ee]=ke*(De[ee]+me[ee])/2}else te=xe.getChannelData(0);return te}function h(re,he){if(re<1)return new Float64Array;if(re===1)return new Float64Array([1]);const ue=1-he,ye=2*Math.PI/(re-1),xe=new Float64Array(re);for(let te=0;te<re;++te)xe[te]=he-ue*Math.cos(te*ye);return xe}function m(re){return h(re,.5)}function p(re){return h(re,.54)}const v={htk:re=>2595*Math.log10(1+re/700),kaldi:re=>1127*Math.log(1+re/700),slaney:(re,he=1e3,ue=15,ye=27/Math.log(6.4))=>re>=he?ue+Math.log(re/he)*ye:3*re/200};function T(re,he="htk"){const ue=v[he];if(!ue)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof re=="number"?ue(re):re.map(ye=>ue(ye))}const E={htk:re=>700*(10**(re/2595)-1),kaldi:re=>700*(Math.exp(re/1127)-1),slaney:(re,he=1e3,ue=15,ye=Math.log(6.4)/27)=>re>=ue?he*Math.exp(ye*(re-ue)):200*re/3};function O(re,he="htk"){const ue=E[he];if(!ue)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof re=="number"?ue(re):re.map(ye=>ue(ye))}function b(re,he){const ue=Float64Array.from({length:he.length-1},(ke,De)=>he[De+1]-he[De]),ye=Array.from({length:re.length},()=>new Array(he.length));for(let ke=0;ke<re.length;++ke){const De=ye[ke];for(let me=0;me<he.length;++me)De[me]=he[me]-re[ke]}const xe=he.length-2,te=Array.from({length:xe},()=>new Array(re.length));for(let ke=0;ke<re.length;++ke){const De=ye[ke];for(let me=0;me<xe;++me){const ee=-De[me]/ue[me],ge=De[me+2]/ue[me+1];te[me][ke]=Math.max(0,Math.min(ee,ge))}}return te}function M(re,he,ue){const ye=(he-re)/(ue-1);return Float64Array.from({length:ue},(xe,te)=>re+ye*te)}function I(re,he,ue,ye,xe,te=null,ke="htk",De=!1){if(te!==null&&te!=="slaney")throw new Error('norm must be one of null or "slaney"');const me=T(ue,ke),ee=T(ye,ke),ge=M(me,ee,he+2);let Ie=O(ge,ke),Be;if(De){const pe=xe/(re*2);Be=T(Float64Array.from({length:re},(Ye,Ge)=>Ge*pe),ke),Ie=ge}else Be=M(0,Math.floor(xe/2),re);const Ue=b(Be,Ie);if(te!==null&&te==="slaney")for(let pe=0;pe<he;++pe){const Ye=Ue[pe],Ge=2/(Ie[pe+2]-Ie[pe]);for(let _e=0;_e<re;++_e)Ye[_e]*=Ge}return Ue}function k(re,he,ue){const ye=new re.constructor(re.length+he+ue),xe=re.length-1;for(let te=0;te<re.length;++te)ye[he+te]=re[te];for(let te=1;te<=he;++te)ye[he-te]=re[(0,o.calculateReflectOffset)(te,xe)];for(let te=1;te<=ue;++te)ye[xe+he+te]=re[(0,o.calculateReflectOffset)(xe-te,xe)];return ye}function $(re,he,ue,ye,xe){if(ue<=0)throw new Error("reference must be greater than zero");if(ye<=0)throw new Error("min_value must be greater than zero");ue=Math.max(ye,ue);const te=Math.log10(ue);for(let ke=0;ke<re.length;++ke)re[ke]=he*Math.log10(Math.max(ye,re[ke])-te);if(xe!==null){if(xe<=0)throw new Error("db_range must be greater than zero");const ke=(0,s.max)(re)[0]-xe;for(let De=0;De<re.length;++De)re[De]=Math.max(re[De],ke)}return re}function P(re,he=1,ue=1e-5,ye=null){return $(re,20,he,ue,ye)}function D(re,he=1,ue=1e-10,ye=null){return $(re,10,he,ue,ye)}async function j(re,he,ue,ye,{fft_length:xe=null,power:te=1,center:ke=!0,pad_mode:De="reflect",onesided:me=!0,preemphasis:ee=null,mel_filters:ge=null,mel_floor:Ie=1e-10,log_mel:Be=null,reference:Ue=1,min_value:pe=1e-10,db_range:Ye=null,remove_dc_offset:Ge=null,min_num_frames:_e=null,max_num_frames:Ae=null,do_pad:He=!0,transpose:qe=!1}={}){const Qe=he.length;if(xe===null&&(xe=ue),ue>xe)throw Error(`frame_length (${ue}) may not be larger than fft_length (${xe})`);if(Qe!==ue)throw new Error(`Length of the window (${Qe}) must equal frame_length (${ue})`);if(ye<=0)throw new Error("hop_length must be greater than zero");if(te===null&&ge!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(ke){if(De!=="reflect")throw new Error(`pad_mode="${De}" not implemented yet.`);const Xe=Math.floor((xe-1)/2)+1;re=k(re,Xe,Xe)}let Ke=Math.floor(1+Math.floor((re.length-ue)/ye));_e!==null&&Ke<_e&&(Ke=_e);const rt=me?Math.floor(xe/2)+1:xe;let ht=Ke,_t=Ke;Ae!==null&&(Ae>Ke?He&&(_t=Ae):_t=ht=Ae);const ot=new s.FFT(xe),mt=new Float64Array(xe),Q=new Float64Array(ot.outputBufferSize),ve=new Float32Array(rt*_t);for(let Xe=0;Xe<ht;++Xe){const Ze=Xe*ye,ft=Math.min(re.length-Ze,ue);ft!==ue&&mt.fill(0,0,ue);for(let gt=0;gt<ft;++gt)mt[gt]=re[Ze+gt];if(Ge){let gt=0;for(let kt=0;kt<ft;++kt)gt+=mt[kt];const St=gt/ft;for(let kt=0;kt<ft;++kt)mt[kt]-=St}if(ee!==null){for(let gt=ft-1;gt>=1;--gt)mt[gt]-=ee*mt[gt-1];mt[0]*=1-ee}for(let gt=0;gt<he.length;++gt)mt[gt]*=he[gt];ot.realTransform(Q,mt);for(let gt=0;gt<rt;++gt){const St=gt<<1;ve[gt*_t+Xe]=Q[St]**2+Q[St+1]**2}}if(te!==null&&te!==2){const Xe=2/te;for(let Ze=0;Ze<ve.length;++Ze)ve[Ze]**=Xe}const ie=ge.length;let Ee=await(0,u.matmul)(new u.Tensor("float32",ge.flat(),[ie,rt]),new u.Tensor("float32",ve,[rt,_t]));qe&&(Ee=Ee.transpose(1,0));const Re=Ee.data;for(let Xe=0;Xe<Re.length;++Xe)Re[Xe]=Math.max(Ie,Re[Xe]);if(te!==null&&Be!==null){const Xe=Math.min(Re.length,ht*ie);switch(Be){case"log":for(let Ze=0;Ze<Xe;++Ze)Re[Ze]=Math.log(Re[Ze]);break;case"log10":for(let Ze=0;Ze<Xe;++Ze)Re[Ze]=Math.log10(Re[Ze]);break;case"dB":if(te===1)P(Re,Ue,pe,Ye);else if(te===2)D(Re,Ue,pe,Ye);else throw new Error(`Cannot use log_mel option '${Be}' with power ${te}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${Be}'`)}}return Ee}function Y(re,he,{periodic:ue=!0,frame_length:ye=null,center:xe=!0}={}){const te=ue?re+1:re;let ke;switch(he){case"boxcar":ke=new Float64Array(te).fill(1);break;case"hann":case"hann_window":ke=m(te);break;case"hamming":ke=p(te);break;case"povey":ke=m(te).map(De=>Math.pow(De,.85));break;default:throw new Error(`Unknown window type ${he}.`)}if(ue&&(ke=ke.subarray(0,re)),ye===null)return ke;if(re>ye)throw new Error(`Length of the window (${re}) may not be larger than frame_length (${ye})`);return ke}function q(re,he){let ue=44;const ye=new ArrayBuffer(ue+re.length*4),xe=new DataView(ye);oe(xe,0,"RIFF"),xe.setUint32(4,36+re.length*4,!0),oe(xe,8,"WAVE"),oe(xe,12,"fmt "),xe.setUint32(16,16,!0),xe.setUint16(20,3,!0),xe.setUint16(22,1,!0),xe.setUint32(24,he,!0),xe.setUint32(28,he*4,!0),xe.setUint16(32,4,!0),xe.setUint16(34,32,!0),oe(xe,36,"data"),xe.setUint32(40,re.length*4,!0);for(let te=0;te<re.length;++te,ue+=4)xe.setFloat32(ue,re[te],!0);return ye}function oe(re,he,ue){for(let ye=0;ye<ue.length;++ye)re.setUint8(he+ye,ue.charCodeAt(ye))}class de{constructor(he,ue){this.audio=he,this.sampling_rate=ue}toWav(){return q(this.audio,this.sampling_rate)}toBlob(){const he=this.toWav();return new Blob([he],{type:"audio/wav"})}async save(he){let ue;if(a.apis.IS_BROWSER_ENV){if(a.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");ue=o.saveBlob}else if(a.apis.IS_FS_AVAILABLE)ue=async(ye,xe)=>{let te=await xe.arrayBuffer();c.writeFileSync(ye,Buffer.from(te))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await ue(he,this.toBlob())}}},"./src/utils/constants.js":(e,t,n)=>{n.r(t),n.d(t,{CHAT_TEMPLATE_NAME:()=>u,CONFIG_NAME:()=>s,FEATURE_EXTRACTOR_NAME:()=>o,GENERATION_CONFIG_NAME:()=>d,GITHUB_ISSUE_URL:()=>r,IMAGE_PROCESSOR_NAME:()=>a,PROCESSOR_NAME:()=>c});const r="https://github.com/huggingface/transformers.js/issues/new/choose",s="config.json",o="preprocessor_config.json",a=o,c="processor_config.json",u="chat_template.json",d="generation_config.json"},"./src/utils/core.js":(e,t,n)=>{n.r(t),n.d(t,{calculateDimensions:()=>d,calculateReflectOffset:()=>v,count:()=>b,dispatchCallback:()=>r,escapeRegExp:()=>o,isIntegralNumber:()=>c,isNullishDimension:()=>u,isTypedArray:()=>a,len:()=>O,mergeArrays:()=>m,pick:()=>E,pop:()=>h,product:()=>p,reverseDictionary:()=>s,saveBlob:()=>T});function r(M,I){M&&M(I)}function s(M){return Object.fromEntries(Object.entries(M).map(([I,k])=>[k,I]))}function o(M){return M.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(M){var I,k,$;return(($=(k=(I=M==null?void 0:M.prototype)==null?void 0:I.__proto__)==null?void 0:k.constructor)==null?void 0:$.name)==="TypedArray"}function c(M){return Number.isInteger(M)||typeof M=="bigint"}function u(M){return M==null||M===-1}function d(M){const I=[];let k=M;for(;Array.isArray(k);)I.push(k.length),k=k[0];return I}function h(M,I,k=void 0){const $=M[I];if($!==void 0)return delete M[I],$;if(k===void 0)throw Error(`Key ${I} does not exist in object.`);return k}function m(...M){return Array.prototype.concat.apply([],M)}function p(...M){return M.reduce((I,k)=>I.flatMap($=>k.map(P=>[$,P])))}function v(M,I){return Math.abs((M+I)%(2*I)-I)}function T(M,I){const k=URL.createObjectURL(I),$=document.createElement("a");$.href=k,$.download=M,$.click(),$.remove(),URL.revokeObjectURL(k)}function E(M,I){return Object.assign({},...I.map(k=>{if(M[k]!==void 0)return{[k]:M[k]}}))}function O(M){let I=0;for(const k of M)++I;return I}function b(M,I){let k=0;for(const $ of M)$===I&&++k;return k}},"./src/utils/data-structures.js":(e,t,n)=>{n.r(t),n.d(t,{CharTrie:()=>s,PriorityQueue:()=>r,TokenLattice:()=>a});class r{constructor(d=(m,p)=>m>p,h=1/0){this._heap=[],this._comparator=d,this._maxSize=h}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...d){return this.extend(d)}extend(d){for(const h of d)if(this.size<this._maxSize)this._heap.push(h),this._siftUp();else{const m=this._smallest();this._comparator(h,this._heap[m])&&(this._heap[m]=h,this._siftUpFrom(m))}return this.size}pop(){const d=this.peek(),h=this.size-1;return h>0&&this._swap(0,h),this._heap.pop(),this._siftDown(),d}replace(d){const h=this.peek();return this._heap[0]=d,this._siftDown(),h}_parent(d){return(d+1>>>1)-1}_left(d){return(d<<1)+1}_right(d){return d+1<<1}_greater(d,h){return this._comparator(this._heap[d],this._heap[h])}_swap(d,h){const m=this._heap[d];this._heap[d]=this._heap[h],this._heap[h]=m}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(d){for(;d>0&&this._greater(d,this._parent(d));)this._swap(d,this._parent(d)),d=this._parent(d)}_siftDown(){let d=0;for(;this._left(d)<this.size&&this._greater(this._left(d),d)||this._right(d)<this.size&&this._greater(this._right(d),d);){const h=this._right(d)<this.size&&this._greater(this._right(d),this._left(d))?this._right(d):this._left(d);this._swap(d,h),d=h}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class s{constructor(){this.root=o.default()}extend(d){for(const h of d)this.push(h)}push(d){let h=this.root;for(const m of d){let p=h.children.get(m);p===void 0&&(p=o.default(),h.children.set(m,p)),h=p}h.isLeaf=!0}*commonPrefixSearch(d){let h=this.root;if(h===void 0)return;let m="";for(const p of d){if(m+=p,h=h.children.get(p),h===void 0)return;h.isLeaf&&(yield m)}}}class o{constructor(d,h){this.isLeaf=d,this.children=h}static default(){return new o(!1,new Map)}}class a{constructor(d,h,m){this.chars=Array.from(d),this.len=this.chars.length,this.bosTokenId=h,this.eosTokenId=m,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const p=new c(this.bosTokenId,0,0,0,0),v=new c(this.eosTokenId,1,this.len,0,0);this.nodes.push(p.clone()),this.nodes.push(v.clone()),this.beginNodes[this.len].push(v),this.endNodes[0].push(p)}insert(d,h,m,p){const v=this.nodes.length,T=new c(p,v,d,h,m);this.beginNodes[d].push(T),this.endNodes[d+h].push(T),this.nodes.push(T)}viterbi(){const d=this.len;let h=0;for(;h<=d;){if(this.beginNodes[h].length==0)return[];for(let E of this.beginNodes[h]){E.prev=null;let O=0,b=null;for(let M of this.endNodes[h]){const I=M.backtraceScore+E.score;(b===null||I>O)&&(b=M.clone(),O=I)}if(b!==null)E.prev=b,E.backtraceScore=O;else return[]}++h}const m=[],v=this.beginNodes[d][0].prev;if(v===null)return[];let T=v.clone();for(;T.prev!==null;)m.push(T.clone()),T=T.clone().prev.clone();return m.reverse(),m}piece(d){return this.chars.slice(d.pos,d.pos+d.length).join("")}tokens(){return this.viterbi().map(h=>this.piece(h))}tokenIds(){return this.viterbi().map(h=>h.tokenId)}}class c{constructor(d,h,m,p,v){this.tokenId=d,this.nodeId=h,this.pos=m,this.length=p,this.score=v,this.prev=null,this.backtraceScore=0}clone(){const d=new c(this.tokenId,this.nodeId,this.pos,this.length,this.score);return d.prev=this.prev,d.backtraceScore=this.backtraceScore,d}}},"./src/utils/devices.js":(e,t,n)=>{n.r(t),n.d(t,{DEVICE_TYPES:()=>r});const r=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,t,n)=>{n.r(t),n.d(t,{DATA_TYPES:()=>a,DEFAULT_DEVICE_DTYPE_MAPPING:()=>c,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>u,isWebGpuFp16Supported:()=>o});var r=n("./src/env.js"),s=n("./src/utils/devices.js");const o=function(){let d;return async function(){if(d===void 0)if(!r.apis.IS_WEBGPU_AVAILABLE)d=!1;else try{d=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{d=!1}return d}}(),a=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),c=Object.freeze({[s.DEVICE_TYPES.wasm]:a.q8}),u=Object.freeze({[a.fp32]:"",[a.fp16]:"_fp16",[a.int8]:"_int8",[a.uint8]:"_uint8",[a.q8]:"_quantized",[a.q4]:"_q4",[a.q4f16]:"_q4f16",[a.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,t,n)=>{n.r(t),n.d(t,{Callable:()=>r});const r=class{constructor(){let s=function(...o){return s._call(...o)};return Object.setPrototypeOf(s,new.target.prototype)}_call(...s){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,t,n)=>{n.r(t),n.d(t,{getFile:()=>h,getModelFile:()=>E,getModelJSON:()=>O});var r=n("?7a2c"),s=n("?a42a"),o=n("./src/env.js"),a=n("./src/utils/core.js");const c={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class u{constructor(k){if(this.filePath=k,this.headers=new Headers,this.exists=r.existsSync(k),this.exists){this.status=200,this.statusText="OK";let $=r.statSync(k);this.headers.set("content-length",$.size.toString()),this.updateContentType();let P=this;this.body=new ReadableStream({start(D){P.arrayBuffer().then(j=>{D.enqueue(new Uint8Array(j)),D.close()})}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const k=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",c[k]??"application/octet-stream")}clone(){let k=new u(this.filePath);return k.exists=this.exists,k.status=this.status,k.statusText=this.statusText,k.headers=new Headers(this.headers),k}async arrayBuffer(){return(await r.promises.readFile(this.filePath)).buffer}async blob(){const k=await r.promises.readFile(this.filePath);return new Blob([k],{type:this.headers.get("content-type")})}async text(){return await r.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function d(I,k=null,$=null){let P;try{P=new URL(I)}catch{return!1}return!(k&&!k.includes(P.protocol)||$&&!$.includes(P.hostname))}async function h(I){var k;if(o.env.useFS&&!d(I,["http:","https:","blob:"]))return new u(I);if(typeof process<"u"&&((k=process==null?void 0:process.release)==null?void 0:k.name)==="node"){const $=!!(Zo!=null&&Zo.TESTING_REMOTELY),P=o.env.version,D=new Headers;if(D.set("User-Agent",`transformers.js/${P}; is_ci/${$};`),d(I,["http:","https:"],["huggingface.co","hf.co"])){const Y=(Zo==null?void 0:Zo.HF_TOKEN)??(Zo==null?void 0:Zo.HF_ACCESS_TOKEN);Y&&D.set("Authorization",`Bearer ${Y}`)}return fetch(I,{headers:D})}else return fetch(I)}const m={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function p(I,k,$){if(!$)return null;const P=m[I]??`Error (${I}) occurred while trying to load file`;throw Error(`${P}: "${k}".`)}class v{constructor(k){this.path=k}async match(k){let $=s.join(this.path,k),P=new u($);if(P.exists)return P}async put(k,$){const P=Buffer.from(await $.arrayBuffer());let D=s.join(this.path,k);try{await r.promises.mkdir(s.dirname(D),{recursive:!0}),await r.promises.writeFile(D,P)}catch(j){console.warn("An error occurred while writing the file to cache:",j)}}}async function T(I,...k){for(let $ of k)try{let P=await I.match($);if(P)return P}catch{continue}}async function E(I,k,$=!0,P={}){if(!o.env.allowLocalModels){if(P.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!o.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,a.dispatchCallback)(P.progress_callback,{status:"initiate",name:I,file:k});let D;if(!D&&o.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{D=await caches.open("transformers-cache")}catch(ke){console.warn("An error occurred while opening the browser cache:",ke)}}if(!D&&o.env.useFSCache&&(D=new v(P.cache_dir??o.env.cacheDir)),!D&&o.env.useCustomCache){if(!o.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!o.env.customCache.match||!o.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");D=o.env.customCache}const j=P.revision??"main";let Y=M(I,k),q=M(o.env.localModelPath,Y),oe=M(o.env.remoteHost,o.env.remotePathTemplate.replaceAll("{model}",I).replaceAll("{revision}",encodeURIComponent(j)),k),de=j==="main"?Y:M(I,j,k),re,he=D instanceof v?de:oe,ue=!1,ye;D&&(ye=await T(D,q,he));const xe=ye!==void 0;if(ye===void 0){if(o.env.allowLocalModels)if(d(Y,["http:","https:"])){if(P.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${Y}.`);if(!o.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${Y}.`)}else try{ye=await h(q),re=q}catch(De){console.warn(`Unable to load from local path "${q}": "${De}"`)}if(ye===void 0||ye.status===404){if(P.local_files_only||!o.env.allowRemoteModels){if($)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${q}".`);return null}if(ye=await h(oe),ye.status!==200)return p(ye.status,oe,$);re=he}ue=D&&typeof Response<"u"&&ye instanceof Response&&ye.status===200}(0,a.dispatchCallback)(P.progress_callback,{status:"download",name:I,file:k});let te;return P.progress_callback?xe&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(te=new Uint8Array(await ye.arrayBuffer()),(0,a.dispatchCallback)(P.progress_callback,{status:"progress",name:I,file:k,progress:100,loaded:te.length,total:te.length})):te=await b(ye,ke=>{(0,a.dispatchCallback)(P.progress_callback,{status:"progress",name:I,file:k,...ke})}):te=new Uint8Array(await ye.arrayBuffer()),ue&&re&&await D.match(re)===void 0&&await D.put(re,new Response(te,{headers:ye.headers})).catch(ke=>{console.warn(`Unable to add response to browser cache: ${ke}.`)}),(0,a.dispatchCallback)(P.progress_callback,{status:"done",name:I,file:k}),te}async function O(I,k,$=!0,P={}){let D=await E(I,k,$,P);if(D===null)return{};let Y=new TextDecoder("utf-8").decode(D);return JSON.parse(Y)}async function b(I,k){const $=I.headers.get("Content-Length");$===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let P=parseInt($??"0"),D=new Uint8Array(P),j=0;const Y=I.body.getReader();async function q(){const{done:oe,value:de}=await Y.read();if(oe)return;let re=j+de.length;if(re>P){P=re;let ue=new Uint8Array(P);ue.set(D),D=ue}D.set(de,j),j=re;const he=j/P*100;return k({progress:he,loaded:j,total:P}),q()}return await q(),D}function M(...I){return I=I.map((k,$)=>($&&(k=k.replace(new RegExp("^/"),"")),$!==I.length-1&&(k=k.replace(new RegExp("/$"),"")),k)),I.join("/")}},"./src/utils/image.js":(e,t,n)=>{n.r(t),n.d(t,{RawImage:()=>T,load_image:()=>E});var r=n("./src/utils/core.js"),s=n("./src/utils/hub.js"),o=n("./src/env.js"),a=n("./src/utils/tensor.js"),c=n("?2b25");let u,d,h;const m=o.apis.IS_BROWSER_ENV||o.apis.IS_WEBWORKER_ENV;if(m)u=(O,b)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(O,b)},h=self.createImageBitmap,d=self.ImageData;else if(c)h=async O=>{const M=(await O.metadata()).channels,{data:I,info:k}=await O.rotate().raw().toBuffer({resolveWithObject:!0}),$=new T(new Uint8ClampedArray(I),k.width,k.height,k.channels);return M!==void 0&&M!==k.channels&&$.convert(M),$};else throw new Error("Unable to load image processing library.");const p={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},v=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class T{constructor(b,M,I,k){this.data=b,this.width=M,this.height=I,this.channels=k}get size(){return[this.width,this.height]}static async read(b){if(b instanceof T)return b;if(typeof b=="string"||b instanceof URL)return await this.fromURL(b);throw new Error(`Unsupported input type: ${typeof b}`)}static fromCanvas(b){if(!m)throw new Error("fromCanvas() is only supported in browser environments.");const I=b.getContext("2d").getImageData(0,0,b.width,b.height).data;return new T(I,b.width,b.height,4)}static async fromURL(b){const M=await(0,s.getFile)(b);if(M.status!==200)throw new Error(`Unable to read image from "${b}" (${M.status} ${M.statusText})`);const I=await M.blob();return this.fromBlob(I)}static async fromBlob(b){if(m){const M=await h(b),I=u(M.width,M.height).getContext("2d");return I.drawImage(M,0,0),new this(I.getImageData(0,0,M.width,M.height).data,M.width,M.height,4)}else{const M=c(await b.arrayBuffer());return await h(M)}}static fromTensor(b,M="CHW"){if(b.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${b.dims.length} dimensions.`);if(M==="CHW")b=b.transpose(1,2,0);else if(M!=="HWC")throw new Error(`Unsupported channel format: ${M}`);if(!(b.data instanceof Uint8ClampedArray||b.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${b.type}`);switch(b.dims[2]){case 1:case 2:case 3:case 4:return new T(b.data,b.dims[1],b.dims[0],b.dims[2]);default:throw new Error(`Unsupported number of channels: ${b.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const b=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let M=0,I=0;M<this.data.length;M+=this.channels){const k=this.data[M],$=this.data[M+1],P=this.data[M+2];b[I++]=Math.round(.2989*k+.587*$+.114*P)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(b,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const b=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let M=0,I=0;M<this.data.length;++M)b[I++]=this.data[M],b[I++]=this.data[M],b[I++]=this.data[M];break;case 4:for(let M=0,I=0;M<this.data.length;M+=4)b[I++]=this.data[M],b[I++]=this.data[M+1],b[I++]=this.data[M+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(b,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const b=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let M=0,I=0;M<this.data.length;++M)b[I++]=this.data[M],b[I++]=this.data[M],b[I++]=this.data[M],b[I++]=255;break;case 3:for(let M=0,I=0;M<this.data.length;M+=3)b[I++]=this.data[M],b[I++]=this.data[M+1],b[I++]=this.data[M+2],b[I++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(b,this.width,this.height,4)}putAlpha(b){if(b.width!==this.width||b.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${b.width}x${b.height}`);if(b.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${b.channels}`);const M=this.data,I=b.data,k=this.width*this.height;if(this.channels===3){const $=new Uint8ClampedArray(k*4);for(let P=0,D=0,j=0;P<k;++P)$[j++]=M[D++],$[j++]=M[D++],$[j++]=M[D++],$[j++]=I[P];return this._update($,this.width,this.height,4)}else if(this.channels===4){for(let $=0;$<k;++$)M[4*$+3]=I[$];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(b,M,{resample:I=2}={}){if(this.width===b&&this.height===M)return this;let k=p[I]??I;const $=(0,r.isNullishDimension)(b),P=(0,r.isNullishDimension)(M);if($&&P)return this;if($?b=M/this.height*this.width:P&&(M=b/this.width*this.height),m){const D=this.channels,j=this.toCanvas(),Y=u(b,M).getContext("2d");return Y.drawImage(j,0,0,b,M),new T(Y.getImageData(0,0,b,M).data,b,M,4).convert(D)}else{let D=this.toSharp();switch(k){case"box":case"hamming":(k==="box"||k==="hamming")&&(console.warn(`Resampling method ${k} is not yet supported. Using bilinear instead.`),k="bilinear");case"nearest":case"bilinear":case"bicubic":D=D.affine([b/this.width,0,0,M/this.height],{interpolator:k});break;case"lanczos":D=D.resize({width:b,height:M,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${k} is not supported.`)}return await h(D)}}async pad([b,M,I,k]){if(b=Math.max(b,0),M=Math.max(M,0),I=Math.max(I,0),k=Math.max(k,0),b===0&&M===0&&I===0&&k===0)return this;if(m){const $=this.channels,P=this.toCanvas(),D=this.width+b+M,j=this.height+I+k,Y=u(D,j).getContext("2d");return Y.drawImage(P,0,0,this.width,this.height,b,I,this.width,this.height),new T(Y.getImageData(0,0,D,j).data,D,j,4).convert($)}else{const $=this.toSharp().extend({left:b,right:M,top:I,bottom:k});return await h($)}}async crop([b,M,I,k]){if(b=Math.max(b,0),M=Math.max(M,0),I=Math.min(I,this.width-1),k=Math.min(k,this.height-1),b===0&&M===0&&I===this.width-1&&k===this.height-1)return this;const $=I-b+1,P=k-M+1;if(m){const D=this.channels,j=this.toCanvas(),Y=u($,P).getContext("2d");return Y.drawImage(j,b,M,$,P,0,0,$,P),new T(Y.getImageData(0,0,$,P).data,$,P,4).convert(D)}else{const D=this.toSharp().extract({left:b,top:M,width:$,height:P});return await h(D)}}async center_crop(b,M){if(this.width===b&&this.height===M)return this;const I=(this.width-b)/2,k=(this.height-M)/2;if(m){const $=this.channels,P=this.toCanvas(),D=u(b,M).getContext("2d");let j=0,Y=0,q=0,oe=0;return I>=0?j=I:q=-I,k>=0?Y=k:oe=-k,D.drawImage(P,j,Y,b,M,q,oe,b,M),new T(D.getImageData(0,0,b,M).data,b,M,4).convert($)}else{let $=this.toSharp();if(I>=0&&k>=0)$=$.extract({left:Math.floor(I),top:Math.floor(k),width:b,height:M});else if(I<=0&&k<=0){const P=Math.floor(-k),D=Math.floor(-I);$=$.extend({top:P,left:D,right:b-this.width-D,bottom:M-this.height-P})}else{let P=[0,0],D=0;k<0?(P[0]=Math.floor(-k),P[1]=M-this.height-P[0]):D=Math.floor(k);let j=[0,0],Y=0;I<0?(j[0]=Math.floor(-I),j[1]=b-this.width-j[0]):Y=Math.floor(I),$=$.extend({top:P[0],bottom:P[1],left:j[0],right:j[1]}).extract({left:Y,top:D,width:b,height:M})}return await h($)}}async toBlob(b="image/png",M=1){if(!m)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:b,quality:M})}toTensor(b="CHW"){let M=new a.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(b!=="HWC")if(b==="CHW")M=M.permute(2,0,1);else throw new Error(`Unsupported channel format: ${b}`);return M}toCanvas(){if(!m)throw new Error("toCanvas() is only supported in browser environments.");const b=this.clone().rgba(),M=u(b.width,b.height),I=new d(b.data,b.width,b.height);return M.getContext("2d").putImageData(I,0,0),M}split(){const{data:b,width:M,height:I,channels:k}=this,$=b.constructor,P=b.length/k,D=Array.from({length:k},()=>new $(P));for(let j=0;j<P;++j){const Y=k*j;for(let q=0;q<k;++q)D[q][j]=b[Y+q]}return D.map(j=>new T(j,M,I,1))}_update(b,M,I,k=null){return this.data=b,this.width=M,this.height=I,k!==null&&(this.channels=k),this}clone(){return new T(this.data.slice(),this.width,this.height,this.channels)}convert(b){if(this.channels===b)return this;switch(b){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(b){if(m){if(o.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const M=b.split(".").pop().toLowerCase(),I=v.get(M)??"image/png",k=await this.toBlob(I);(0,r.saveBlob)(b,k)}else{if(o.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(b);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(m)throw new Error("toSharp() is only supported in server-side environments.");return c(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const E=T.read.bind(T)},"./src/utils/maths.js":(e,t,n)=>{n.r(t),n.d(t,{FFT:()=>E,bankers_round:()=>M,cos_sim:()=>u,dot:()=>c,dynamic_time_warping:()=>I,interpolate_data:()=>r,log_softmax:()=>a,magnitude:()=>d,max:()=>m,medianFilter:()=>O,min:()=>h,permute_data:()=>s,round:()=>b,softmax:()=>o});function r(k,[$,P,D],[j,Y],q="bilinear",oe=!1){const de=Y/D,re=j/P,he=new k.constructor(j*Y*$),ue=P*D,ye=j*Y;for(let xe=0;xe<j;++xe)for(let te=0;te<Y;++te){const ke=xe*Y+te,De=(te+.5)/de-.5,me=(xe+.5)/re-.5;let ee=Math.floor(De),ge=Math.floor(me);const Ie=Math.min(ee+1,D-1),Be=Math.min(ge+1,P-1);ee=Math.max(ee,0),ge=Math.max(ge,0);const Ue=De-ee,pe=me-ge,Ye=(1-Ue)*(1-pe),Ge=Ue*(1-pe),_e=(1-Ue)*pe,Ae=Ue*pe,He=ge*D,qe=Be*D,Qe=He+ee,Ke=He+Ie,rt=qe+ee,ht=qe+Ie;for(let _t=0;_t<$;++_t){const ot=_t*ue;he[_t*ye+ke]=Ye*k[ot+Qe]+Ge*k[ot+Ke]+_e*k[ot+rt]+Ae*k[ot+ht]}}return he}function s(k,$,P){const D=new Array(P.length),j=new Array(P.length);for(let oe=P.length-1,de=1;oe>=0;--oe)j[oe]=de,D[oe]=$[P[oe]],de*=D[oe];const Y=P.map((oe,de)=>j[P.indexOf(de)]),q=new k.constructor(k.length);for(let oe=0;oe<k.length;++oe){let de=0;for(let re=$.length-1,he=oe;re>=0;--re)de+=he%$[re]*Y[re],he=Math.floor(he/$[re]);q[de]=k[oe]}return[q,D]}function o(k){const $=m(k)[0],P=k.map(Y=>Math.exp(Y-$)),D=P.reduce((Y,q)=>Y+q,0);return P.map(Y=>Y/D)}function a(k){const $=m(k)[0];let P=0;for(let Y=0;Y<k.length;++Y)P+=Math.exp(k[Y]-$);const D=Math.log(P);return k.map(Y=>Y-$-D)}function c(k,$){let P=0;for(let D=0;D<k.length;++D)P+=k[D]*$[D];return P}function u(k,$){const P=c(k,$),D=d(k),j=d($);return P/(D*j)}function d(k){return Math.sqrt(k.reduce(($,P)=>$+P*P,0))}function h(k){if(k.length===0)throw Error("Array must not be empty");let $=k[0],P=0;for(let D=1;D<k.length;++D)k[D]<$&&($=k[D],P=D);return[$,P]}function m(k){if(k.length===0)throw Error("Array must not be empty");let $=k[0],P=0;for(let D=1;D<k.length;++D)k[D]>$&&($=k[D],P=D);return[$,P]}function p(k){return k>0&&(k&k-1)===0}class v{constructor($){if(this.size=$|0,this.size<=1||!p(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=$<<1,this.table=new Float64Array(this.size*2);for(let D=0;D<this.table.length;D+=2){const j=Math.PI*D/this.size;this.table[D]=Math.cos(j),this.table[D+1]=-Math.sin(j)}let P=0;for(let D=1;this.size>D;D<<=1)++P;this._width=P%2===0?P-1:P,this._bitrev=new Int32Array(1<<this._width);for(let D=0;D<this._bitrev.length;++D){this._bitrev[D]=0;for(let j=0;j<this._width;j+=2){const Y=this._width-j-2;this._bitrev[D]|=(D>>>j&3)<<Y}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray($,P){const D=P||new Array($.length>>>1);for(let j=0;j<$.length;j+=2)D[j>>>1]=$[j];return D}toComplexArray($,P){const D=P||this.createComplexArray();for(let j=0;j<D.length;j+=2)D[j]=$[j>>>1],D[j+1]=0;return D}transform($,P){if($===P)throw new Error("Input and output buffers must be different");this._transform4($,P,1)}realTransform($,P){if($===P)throw new Error("Input and output buffers must be different");this._realTransform4($,P,1)}inverseTransform($,P){if($===P)throw new Error("Input and output buffers must be different");this._transform4($,P,-1);for(let D=0;D<$.length;++D)$[D]/=this.size}_transform4($,P,D){const j=this._csize;let q=1<<this._width,oe=j/q<<1,de,re;const he=this._bitrev;if(oe===4)for(de=0,re=0;de<j;de+=oe,++re){const ye=he[re];this._singleTransform2(P,$,de,ye,q)}else for(de=0,re=0;de<j;de+=oe,++re){const ye=he[re];this._singleTransform4(P,$,de,ye,q,D)}const ue=this.table;for(q>>=2;q>=2;q>>=2){oe=j/q<<1;const ye=oe>>>2;for(de=0;de<j;de+=oe){const xe=de+ye-1;for(let te=de,ke=0;te<xe;te+=2,ke+=q){const De=te,me=De+ye,ee=me+ye,ge=ee+ye,Ie=$[De],Be=$[De+1],Ue=$[me],pe=$[me+1],Ye=$[ee],Ge=$[ee+1],_e=$[ge],Ae=$[ge+1],He=ue[ke],qe=D*ue[ke+1],Qe=Ue*He-pe*qe,Ke=Ue*qe+pe*He,rt=ue[2*ke],ht=D*ue[2*ke+1],_t=Ye*rt-Ge*ht,ot=Ye*ht+Ge*rt,mt=ue[3*ke],Q=D*ue[3*ke+1],ve=_e*mt-Ae*Q,ie=_e*Q+Ae*mt,Ee=Ie+_t,Re=Be+ot,Xe=Ie-_t,Ze=Be-ot,ft=Qe+ve,gt=Ke+ie,St=D*(Qe-ve),kt=D*(Ke-ie);$[De]=Ee+ft,$[De+1]=Re+gt,$[me]=Xe+kt,$[me+1]=Ze-St,$[ee]=Ee-ft,$[ee+1]=Re-gt,$[ge]=Xe-kt,$[ge+1]=Ze+St}}}}_singleTransform2($,P,D,j,Y){const q=$[j],oe=$[j+1],de=$[j+Y],re=$[j+Y+1];P[D]=q+de,P[D+1]=oe+re,P[D+2]=q-de,P[D+3]=oe-re}_singleTransform4($,P,D,j,Y,q){const oe=Y*2,de=Y*3,re=$[j],he=$[j+1],ue=$[j+Y],ye=$[j+Y+1],xe=$[j+oe],te=$[j+oe+1],ke=$[j+de],De=$[j+de+1],me=re+xe,ee=he+te,ge=re-xe,Ie=he-te,Be=ue+ke,Ue=ye+De,pe=q*(ue-ke),Ye=q*(ye-De);P[D]=me+Be,P[D+1]=ee+Ue,P[D+2]=ge+Ye,P[D+3]=Ie-pe,P[D+4]=me-Be,P[D+5]=ee-Ue,P[D+6]=ge-Ye,P[D+7]=Ie+pe}_realTransform4($,P,D){const j=this._csize;let q=1<<this._width,oe=j/q<<1,de,re;const he=this._bitrev;if(oe===4)for(de=0,re=0;de<j;de+=oe,++re){const xe=he[re];this._singleRealTransform2(P,$,de,xe>>>1,q>>>1)}else for(de=0,re=0;de<j;de+=oe,++re){const xe=he[re];this._singleRealTransform4(P,$,de,xe>>>1,q>>>1,D)}const ue=this.table;for(q>>=2;q>=2;q>>=2){oe=j/q<<1;const xe=oe>>>1,te=xe>>>1,ke=te>>>1;for(de=0;de<j;de+=oe)for(let De=0,me=0;De<=ke;De+=2,me+=q){const ee=de+De,ge=ee+te,Ie=ge+te,Be=Ie+te,Ue=$[ee],pe=$[ee+1],Ye=$[ge],Ge=$[ge+1],_e=$[Ie],Ae=$[Ie+1],He=$[Be],qe=$[Be+1],Qe=Ue,Ke=pe,rt=ue[me],ht=D*ue[me+1],_t=Ye*rt-Ge*ht,ot=Ye*ht+Ge*rt,mt=ue[2*me],Q=D*ue[2*me+1],ve=_e*mt-Ae*Q,ie=_e*Q+Ae*mt,Ee=ue[3*me],Re=D*ue[3*me+1],Xe=He*Ee-qe*Re,Ze=He*Re+qe*Ee,ft=Qe+ve,gt=Ke+ie,St=Qe-ve,kt=Ke-ie,Dt=_t+Xe,mn=ot+Ze,An=D*(_t-Xe),Gn=D*(ot-Ze);if($[ee]=ft+Dt,$[ee+1]=gt+mn,$[ge]=St+Gn,$[ge+1]=kt-An,De===0){$[Ie]=ft-Dt,$[Ie+1]=gt-mn;continue}if(De===ke)continue;const zn=de+te-De,Br=de+xe-De;$[zn]=St-D*Gn,$[zn+1]=-kt-D*An,$[Br]=ft-D*Dt,$[Br+1]=-gt+D*mn}}const ye=j>>>1;for(let xe=2;xe<ye;xe+=2)$[j-xe]=$[xe],$[j-xe+1]=-$[xe+1]}_singleRealTransform2($,P,D,j,Y){const q=$[j],oe=$[j+Y];P[D]=q+oe,P[D+1]=0,P[D+2]=q-oe,P[D+3]=0}_singleRealTransform4($,P,D,j,Y,q){const oe=Y*2,de=Y*3,re=$[j],he=$[j+Y],ue=$[j+oe],ye=$[j+de],xe=re+ue,te=re-ue,ke=he+ye,De=q*(he-ye);P[D]=xe+ke,P[D+1]=0,P[D+2]=te,P[D+3]=-De,P[D+4]=xe-ke,P[D+5]=0,P[D+6]=te,P[D+7]=De}}class T{constructor($){const P=2*($-1),D=2*(2*$-1),j=2**Math.ceil(Math.log2(D));this.bufferSize=j,this._a=P;const Y=new Float64Array(D),q=new Float64Array(j);this._chirpBuffer=new Float64Array(j),this._buffer1=new Float64Array(j),this._buffer2=new Float64Array(j),this._outBuffer1=new Float64Array(j),this._outBuffer2=new Float64Array(j);const oe=-2*Math.PI/$,de=Math.cos(oe),re=Math.sin(oe);for(let he=0;he<D>>1;++he){const ue=(he+1-$)**2/2,ye=Math.sqrt(de**2+re**2)**ue,xe=ue*Math.atan2(re,de),te=2*he;Y[te]=ye*Math.cos(xe),Y[te+1]=ye*Math.sin(xe),q[te]=Y[te],q[te+1]=-Y[te+1]}this._slicedChirpBuffer=Y.subarray(P,D),this._f=new v(j>>1),this._f.transform(this._chirpBuffer,q)}_transform($,P,D){const j=this._buffer1,Y=this._buffer2,q=this._outBuffer1,oe=this._outBuffer2,de=this._chirpBuffer,re=this._slicedChirpBuffer,he=this._a;if(D)for(let ue=0;ue<re.length;ue+=2){const ye=ue+1,xe=ue>>1,te=P[xe];j[ue]=te*re[ue],j[ye]=te*re[ye]}else for(let ue=0;ue<re.length;ue+=2){const ye=ue+1;j[ue]=P[ue]*re[ue]-P[ye]*re[ye],j[ye]=P[ue]*re[ye]+P[ye]*re[ue]}this._f.transform(q,j);for(let ue=0;ue<de.length;ue+=2){const ye=ue+1;Y[ue]=q[ue]*de[ue]-q[ye]*de[ye],Y[ye]=q[ue]*de[ye]+q[ye]*de[ue]}this._f.inverseTransform(oe,Y);for(let ue=0;ue<oe.length;ue+=2){const ye=oe[ue+he],xe=oe[ue+he+1],te=re[ue],ke=re[ue+1];$[ue]=ye*te-xe*ke,$[ue+1]=ye*ke+xe*te}}transform($,P){this._transform($,P,!1)}realTransform($,P){this._transform($,P,!0)}}class E{constructor($){this.fft_length=$,this.isPowerOfTwo=p($),this.isPowerOfTwo?(this.fft=new v($),this.outputBufferSize=2*$):(this.fft=new T($),this.outputBufferSize=this.fft.bufferSize)}realTransform($,P){this.fft.realTransform($,P)}transform($,P){this.fft.transform($,P)}}function O(k,$){if($%2===0||$<=0)throw new Error("Window size must be a positive odd number");const P=new k.constructor(k.length),D=new k.constructor($),j=Math.floor($/2);for(let Y=0;Y<k.length;++Y){let q=0;for(let oe=-j;oe<=j;++oe){let de=Y+oe;de<0?de=Math.abs(de):de>=k.length&&(de=2*(k.length-1)-de),D[q++]=k[de]}D.sort(),P[Y]=D[j]}return P}function b(k,$){const P=Math.pow(10,$);return Math.round(k*P)/P}function M(k){const $=Math.round(k);return Math.abs(k)%1===.5?$%2===0?$:$-1:$}function I(k){const $=k.length,P=k[0].length,D=[$+1,P+1],j=Array.from({length:D[0]},()=>Array(D[1]).fill(1/0));j[0][0]=0;const Y=Array.from({length:D[0]},()=>Array(D[1]).fill(-1));for(let he=1;he<D[1];++he)for(let ue=1;ue<D[0];++ue){const ye=j[ue-1][he-1],xe=j[ue-1][he],te=j[ue][he-1];let ke,De;ye<xe&&ye<te?(ke=ye,De=0):xe<ye&&xe<te?(ke=xe,De=1):(ke=te,De=2),j[ue][he]=k[ue-1][he-1]+ke,Y[ue][he]=De}for(let he=0;he<D[1];++he)Y[0][he]=2;for(let he=0;he<D[0];++he)Y[he][0]=1;let q=$,oe=P,de=[],re=[];for(;q>0||oe>0;)switch(de.push(q-1),re.push(oe-1),Y[q][oe]){case 0:--q,--oe;break;case 1:--q;break;case 2:--oe;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${q}, ${oe}]. Please file a bug report.`)}return de.reverse(),re.reverse(),[de,re]}},"./src/utils/tensor.js":(e,t,n)=>{n.r(t),n.d(t,{Tensor:()=>c,cat:()=>P,full:()=>re,full_like:()=>he,interpolate:()=>h,interpolate_4d:()=>m,layer_norm:()=>M,matmul:()=>p,mean:()=>q,mean_pooling:()=>b,ones:()=>ue,ones_like:()=>ye,permute:()=>d,quantize_embeddings:()=>De,rand:()=>ke,rfft:()=>v,slice:()=>O,stack:()=>D,std_mean:()=>Y,topk:()=>T,zeros:()=>xe,zeros_like:()=>te});var r=n("./src/utils/maths.js"),s=n("./src/backends/onnx.js"),o=n("./src/ops/registry.js");const a=Object.freeze({float32:Float32Array,float16:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class c{constructor(...ee){Pe(this,"ort_tensor");return(0,s.isONNXTensor)(ee[0])?this.ort_tensor=ee[0]:this.ort_tensor=new s.Tensor(ee[0],ee[1],ee[2]),new Proxy(this,{get:(ge,Ie)=>{if(typeof Ie=="string"){let Be=Number(Ie);if(Number.isInteger(Be))return ge._getitem(Be)}return ge[Ie]},set:(ge,Ie,Be)=>ge[Ie]=Be})}get dims(){return this.ort_tensor.dims}set dims(ee){this.ort_tensor.dims=ee}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[ee,...ge]=this.dims;if(ge.length>0){const Ie=ge.reduce((Be,Ue)=>Be*Ue);for(let Be=0;Be<ee;++Be)yield this._subarray(Be,Ie,ge)}else yield*this.data}_getitem(ee){const[ge,...Ie]=this.dims;if(ee=$(ee,ge),Ie.length>0){const Be=Ie.reduce((Ue,pe)=>Ue*pe);return this._subarray(ee,Be,Ie)}else return new c(this.type,[this.data[ee]],Ie)}indexOf(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)if(ge[Ie]==ee)return Ie;return-1}_subarray(ee,ge,Ie){const Be=ee*ge,Ue=(ee+1)*ge,pe="subarray"in this.data?this.data.subarray(Be,Ue):this.data.slice(Be,Ue);return new c(this.type,pe,Ie)}item(){const ee=this.data;if(ee.length!==1)throw new Error(`a Tensor with ${ee.length} elements cannot be converted to Scalar`);return ee[0]}tolist(){return u(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const ee=this.data;for(let ge=0;ge<ee.length;++ge)ee[ge]=1/(1+Math.exp(-ee[ge]));return this}map(ee){return this.clone().map_(ee)}map_(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]=ee(ge[Ie],Ie,ge);return this}mul(ee){return this.clone().mul_(ee)}mul_(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]*=ee;return this}div(ee){return this.clone().div_(ee)}div_(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]/=ee;return this}add(ee){return this.clone().add_(ee)}add_(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]+=ee;return this}sub(ee){return this.clone().sub_(ee)}sub_(ee){const ge=this.data;for(let Ie=0;Ie<ge.length;++Ie)ge[Ie]-=ee;return this}clone(){return new c(this.type,this.data.slice(),this.dims.slice())}slice(...ee){const ge=[],Ie=[];for(let _e=0;_e<this.dims.length;++_e){let Ae=ee[_e];if(Ae==null)Ie.push([0,this.dims[_e]]),ge.push(this.dims[_e]);else if(typeof Ae=="number")Ae=$(Ae,this.dims[_e],_e),Ie.push([Ae,Ae+1]);else if(Array.isArray(Ae)&&Ae.length===2){let[He,qe]=Ae;if(He=He===null?0:$(He,this.dims[_e],_e,!1),qe=qe===null?this.dims[_e]:$(qe,this.dims[_e],_e,!1),He>qe)throw new Error(`Invalid slice: ${Ae}`);const Qe=[Math.max(He,0),Math.min(qe,this.dims[_e])];Ie.push(Qe),ge.push(Qe[1]-Qe[0])}else throw new Error(`Invalid slice: ${Ae}`)}const Be=Ie.map(([_e,Ae])=>Ae-_e),Ue=Be.reduce((_e,Ae)=>_e*Ae),pe=this.data,Ye=new pe.constructor(Ue),Ge=this.stride();for(let _e=0;_e<Ue;++_e){let Ae=0;for(let He=Be.length-1,qe=_e;He>=0;--He){const Qe=Be[He];Ae+=(qe%Qe+Ie[He][0])*Ge[He],qe=Math.floor(qe/Qe)}Ye[_e]=pe[Ae]}return new c(this.type,Ye,ge)}permute(...ee){return d(this,ee)}transpose(...ee){return this.permute(...ee)}sum(ee=null,ge=!1){return this.norm(1,ee,ge)}norm(ee="fro",ge=null,Ie=!1){if(ee==="fro")ee=2;else if(typeof ee=="string")throw Error(`Unsupported norm: ${ee}`);const Be=this.data,Ue=(_e,Ae)=>_e+Ae**ee;if(ge===null){const _e=Be.reduce(Ue,0)**(1/ee);return new c(this.type,[_e],[])}const[pe,Ye,Ge]=j(Ue,this,ge,Ie);if(ee!==1)for(let _e=0;_e<Ye.length;++_e)Ye[_e]=Ye[_e]**(1/ee);return new c(pe,Ye,Ge)}normalize_(ee=2,ge=1){ge=$(ge,this.dims.length);const Ie=this.norm(ee,ge,!0),Be=this.data,Ue=Ie.data;for(let pe=0;pe<Be.length;++pe){let Ye=0;for(let Ge=this.dims.length-1,_e=pe,Ae=1;Ge>=0;--Ge){const He=this.dims[Ge];if(Ge!==ge){const qe=_e%He;Ye+=qe*Ae,Ae*=this.dims[Ge]}_e=Math.floor(_e/He)}Be[pe]/=Ue[Ye]}return this}normalize(ee=2,ge=1){return this.clone().normalize_(ee,ge)}stride(){return oe(this.dims)}squeeze(ee=null){return new c(this.type,this.data,I(this.dims,ee))}squeeze_(ee=null){return this.dims=I(this.dims,ee),this}unsqueeze(ee=null){return new c(this.type,this.data,k(this.dims,ee))}unsqueeze_(ee=null){return this.dims=k(this.dims,ee),this}flatten_(ee=0,ge=-1){ge=(ge+this.dims.length)%this.dims.length;let Ie=this.dims.slice(0,ee),Be=this.dims.slice(ee,ge+1),Ue=this.dims.slice(ge+1);return this.dims=[...Ie,Be.reduce((pe,Ye)=>pe*Ye,1),...Ue],this}flatten(ee=0,ge=-1){return this.clone().flatten_(ee,ge)}view(...ee){let ge=-1;for(let Be=0;Be<ee.length;++Be)if(ee[Be]===-1){if(ge!==-1)throw new Error("Only one dimension can be inferred");ge=Be}const Ie=this.data;if(ge!==-1){const Be=ee.reduce((Ue,pe,Ye)=>Ye!==ge?Ue*pe:Ue,1);ee[ge]=Ie.length/Be}return new c(this.type,Ie,ee)}neg_(){const ee=this.data;for(let ge=0;ge<ee.length;++ge)ee[ge]=-ee[ge];return this}neg(){return this.clone().neg_()}gt(ee){const ge=new Uint8Array(this.data.length),Ie=this.data;for(let Be=0;Be<Ie.length;++Be)ge[Be]=Ie[Be]>ee?1:0;return new c("bool",ge,this.dims)}lt(ee){const ge=new Uint8Array(this.data.length),Ie=this.data;for(let Be=0;Be<Ie.length;++Be)ge[Be]=Ie[Be]<ee?1:0;return new c("bool",ge,this.dims)}clamp_(ee,ge){const Ie=this.data;for(let Be=0;Be<Ie.length;++Be)Ie[Be]=Math.min(Math.max(Ie[Be],ee),ge);return this}clamp(ee,ge){return this.clone().clamp_(ee,ge)}round_(){const ee=this.data;for(let ge=0;ge<ee.length;++ge)ee[ge]=Math.round(ee[ge]);return this}round(){return this.clone().round_()}mean(ee=null,ge=!1){return q(this,ee,ge)}min(ee=null,ge=!1){if(ee===null){const pe=(0,r.min)(this.data)[0];return new c(this.type,[pe],[])}const[Ie,Be,Ue]=j((pe,Ye)=>Math.min(pe,Ye),this,ee,ge,1/0);return new c(Ie,Be,Ue)}max(ee=null,ge=!1){if(ee===null){const pe=(0,r.max)(this.data)[0];return new c(this.type,[pe],[])}const[Ie,Be,Ue]=j((pe,Ye)=>Math.max(pe,Ye),this,ee,ge,-1/0);return new c(Ie,Be,Ue)}argmin(ee=null,ge=!1){if(ee!==null)throw new Error("`dim !== null` not yet implemented.");const Ie=(0,r.min)(this.data)[1];return new c("int64",[BigInt(Ie)],[])}argmax(ee=null,ge=!1){if(ee!==null)throw new Error("`dim !== null` not yet implemented.");const Ie=(0,r.max)(this.data)[1];return new c("int64",[BigInt(Ie)],[])}to(ee){if(this.type===ee)return this;if(!a.hasOwnProperty(ee))throw new Error(`Unsupported type: ${ee}`);let ge;const Ie=["int64","uint64"].includes(this.type),Be=["int64","uint64"].includes(ee);return Ie&&!Be?ge=Number:!Ie&&Be&&(ge=BigInt),new c(ee,a[ee].from(this.data,ge),this.dims)}}function u(me,ee){const ge=me.length,Ie=ee.reduce((Ue,pe)=>Ue*pe);if(ge!==Ie)throw Error(`cannot reshape array of size ${ge} into shape (${ee})`);let Be=me;for(let Ue=ee.length-1;Ue>=0;Ue--)Be=Be.reduce((pe,Ye)=>{let Ge=pe[pe.length-1];return Ge.length<ee[Ue]?Ge.push(Ye):pe.push([Ye]),pe},[[]]);return Be[0]}function d(me,ee){const[ge,Ie]=(0,r.permute_data)(me.data,me.dims,ee);return new c(me.type,ge,Ie)}function h(me,[ee,ge],Ie="bilinear",Be=!1){const Ue=me.dims.at(-3)??1,pe=me.dims.at(-2),Ye=me.dims.at(-1);let Ge=(0,r.interpolate_data)(me.data,[Ue,pe,Ye],[ee,ge],Ie,Be);return new c(me.type,Ge,[Ue,ee,ge])}async function m(me,{size:ee=null,mode:ge="bilinear"}={}){if(me.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!ee)throw new Error("`interpolate_4d` requires a `size` argument.");let Ie;if(ee.length===2)Ie=[...me.dims.slice(0,2),...ee];else if(ee.length===3)Ie=[me.dims[0],...ee];else if(ee.length===4)Ie=ee;else throw new Error("`size` must be of length 2, 3, or 4.");let Be;if(ge==="nearest")Be=await o.TensorOpRegistry.nearest_interpolate_4d;else if(ge==="bilinear")Be=await o.TensorOpRegistry.bilinear_interpolate_4d;else if(ge==="bicubic")Be=await o.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${ge}`);const Ue=new c("int64",new BigInt64Array(Ie.map(BigInt)),[Ie.length]);return await Be({x:me,s:Ue})}async function p(me,ee){return await(await o.TensorOpRegistry.matmul)({a:me,b:ee})}async function v(me,ee){return await(await o.TensorOpRegistry.rfft)({x:me,a:ee})}async function T(me,ee){const ge=await o.TensorOpRegistry.top_k;return ee==null?ee=me.dims.at(-1):ee=Math.min(ee,me.dims.at(-1)),await ge({x:me,k:new c("int64",[BigInt(ee)],[1])})}const E=me=>new c("int64",me,[me.length]);async function O(me,ee,ge,Ie,Be){return await(await o.TensorOpRegistry.slice)({x:me,s:E(ee),e:E(ge),a:E(Ie),t:E(Be??new Array(Ie.length).fill(1))})}function b(me,ee){const ge=me.data,Ie=ee.data,Be=[me.dims[0],me.dims[2]],Ue=new ge.constructor(Be[0]*Be[1]),[pe,Ye,Ge]=me.dims;let _e=0;for(let Ae=0;Ae<pe;++Ae){const He=Ae*Ge*Ye;for(let qe=0;qe<Ge;++qe){let Qe=0,Ke=0;const rt=Ae*Ye,ht=He+qe;for(let ot=0;ot<Ye;++ot){const mt=Number(Ie[rt+ot]);Ke+=mt,Qe+=ge[ht+ot*Ge]*mt}const _t=Qe/Ke;Ue[_e++]=_t}}return new c(me.type,Ue,Be)}function M(me,ee,{eps:ge=1e-5}={}){if(me.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[Ie,Be]=me.dims;if(ee.length!==1&&ee[0]!==Be)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[Ue,pe]=Y(me,1,0,!0),Ye=Ue.data,Ge=pe.data,_e=me.data,Ae=new _e.constructor(_e.length);for(let He=0;He<Ie;++He){const qe=He*Be;for(let Qe=0;Qe<Be;++Qe){const Ke=qe+Qe;Ae[Ke]=(_e[Ke]-Ge[He])/(Ye[He]+ge)}}return new c(me.type,Ae,me.dims)}function I(me,ee){return me=me.slice(),ee===null?me=me.filter(ge=>ge!==1):typeof ee=="number"?me[ee]===1&&me.splice(ee,1):Array.isArray(ee)&&(me=me.filter((ge,Ie)=>ge!==1||!ee.includes(Ie))),me}function k(me,ee){return ee=$(ee,me.length+1),me=me.slice(),me.splice(ee,0,1),me}function $(me,ee,ge=null,Ie=!0){if(Ie&&(me<-ee||me>=ee))throw new Error(`IndexError: index ${me} is out of bounds for dimension${ge===null?"":" "+ge} with size ${ee}`);return me<0&&(me=(me%ee+ee)%ee),me}function P(me,ee=0){ee=$(ee,me[0].dims.length);const ge=me[0].dims.slice();ge[ee]=me.reduce((pe,Ye)=>pe+Ye.dims[ee],0);const Ie=ge.reduce((pe,Ye)=>pe*Ye,1),Be=new me[0].data.constructor(Ie),Ue=me[0].type;if(ee===0){let pe=0;for(const Ye of me){const Ge=Ye.data;Be.set(Ge,pe),pe+=Ge.length}}else{let pe=0;for(let Ye=0;Ye<me.length;++Ye){const{data:Ge,dims:_e}=me[Ye];for(let Ae=0;Ae<Ge.length;++Ae){let He=0;for(let qe=_e.length-1,Qe=Ae,Ke=1;qe>=0;--qe){const rt=_e[qe];let ht=Qe%rt;qe===ee&&(ht+=pe),He+=ht*Ke,Ke*=ge[qe],Qe=Math.floor(Qe/rt)}Be[He]=Ge[Ae]}pe+=_e[ee]}}return new c(Ue,Be,ge)}function D(me,ee=0){return P(me.map(ge=>ge.unsqueeze(ee)),ee)}function j(me,ee,ge=null,Ie=!1,Be=null){const Ue=ee.data,pe=ee.dims;ge=$(ge,pe.length);const Ye=pe.slice();Ye[ge]=1;const Ge=new Ue.constructor(Ue.length/pe[ge]);Be!==null&&Ge.fill(Be);for(let _e=0;_e<Ue.length;++_e){let Ae=0;for(let He=pe.length-1,qe=_e,Qe=1;He>=0;--He){const Ke=pe[He];if(He!==ge){const rt=qe%Ke;Ae+=rt*Qe,Qe*=Ye[He]}qe=Math.floor(qe/Ke)}Ge[Ae]=me(Ge[Ae],Ue[_e],_e,Ae)}return Ie||Ye.splice(ge,1),[ee.type,Ge,Ye]}function Y(me,ee=null,ge=1,Ie=!1){const Be=me.data,Ue=me.dims;if(ee===null){const Qe=Be.reduce((_t,ot)=>_t+ot,0)/Be.length,Ke=Math.sqrt(Be.reduce((_t,ot)=>_t+(ot-Qe)**2,0)/(Be.length-ge)),rt=new c(me.type,[Qe],[]);return[new c(me.type,[Ke],[]),rt]}ee=$(ee,Ue.length);const pe=q(me,ee,Ie),Ye=pe.data,[Ge,_e,Ae]=j((qe,Qe,Ke,rt)=>qe+(Qe-Ye[rt])**2,me,ee,Ie);for(let qe=0;qe<_e.length;++qe)_e[qe]=Math.sqrt(_e[qe]/(Ue[ee]-ge));return[new c(Ge,_e,Ae),pe]}function q(me,ee=null,ge=!1){const Ie=me.dims,Be=me.data;if(ee===null){const Ge=Be.reduce((_e,Ae)=>_e+Ae,0);return new c(me.type,[Ge/Be.length],[])}ee=$(ee,Ie.length);const[Ue,pe,Ye]=j((Ge,_e)=>Ge+_e,me,ee,ge);if(Ie[ee]!==1)for(let Ge=0;Ge<pe.length;++Ge)pe[Ge]/=Ie[ee];return new c(Ue,pe,Ye)}function oe(me){const ee=new Array(me.length);for(let ge=me.length-1,Ie=1;ge>=0;--ge)ee[ge]=Ie,Ie*=me[ge];return ee}function de(me,ee,ge,Ie){const Be=me.reduce((Ue,pe)=>Ue*pe,1);return new c(ge,new Ie(Be).fill(ee),me)}function re(me,ee){let ge,Ie;if(typeof ee=="number")ge="float32",Ie=Float32Array;else if(typeof ee=="bigint")ge="int64",Ie=BigInt64Array;else if(typeof ee=="boolean")ge="bool",Ie=Uint8Array;else throw new Error(`Unsupported data type: ${typeof ee}`);return de(me,ee,ge,Ie)}function he(me,ee){return re(me.dims,ee)}function ue(me){return de(me,1n,"int64",BigInt64Array)}function ye(me){return ue(me.dims)}function xe(me){return de(me,0n,"int64",BigInt64Array)}function te(me){return xe(me.dims)}function ke(me){const ee=me.reduce((ge,Ie)=>ge*Ie,1);return new c("float32",Float32Array.from({length:ee},()=>Math.random()),me)}function De(me,ee){if(me.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(me.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(ee))throw new Error("The precision must be either 'binary' or 'ubinary'");const ge=ee==="binary",Ie=ge?"int8":"uint8",Be=ge?Int8Array:Uint8Array,Ue=me.data,pe=new Be(Ue.length/8);for(let Ye=0;Ye<Ue.length;++Ye){const Ge=Ue[Ye]>0?1:0,_e=Math.floor(Ye/8),Ae=Ye%8;pe[_e]|=Ge<<7-Ae,ge&&Ae===0&&(pe[_e]-=128)}return new c(Ie,pe,[me.dims[0],me.dims[1]/8])}}},yA={};function Rn(e){var t=yA[e];if(t!==void 0)return t.exports;var n=yA[e]={exports:{}};return tF[e](n,n.exports,Rn),n.exports}Rn.m=tF;(()=>{var e=Object.getPrototypeOf?n=>Object.getPrototypeOf(n):n=>n.__proto__,t;Rn.t=function(n,r){if(r&1&&(n=this(n)),r&8||typeof n=="object"&&n&&(r&4&&n.__esModule||r&16&&typeof n.then=="function"))return n;var s=Object.create(null);Rn.r(s);var o={};t=t||[null,e({}),e([]),e(e)];for(var a=r&2&&n;typeof a=="object"&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach(c=>o[c]=()=>n[c]);return o.default=()=>n,Rn.d(s,o),s}})();Rn.d=(e,t)=>{for(var n in t)Rn.o(t,n)&&!Rn.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})};Rn.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);Rn.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};(()=>{var e;if(typeof import.meta.url=="string"&&(e=import.meta.url),!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),Rn.p=e})();Rn.b=new URL("./",import.meta.url);var A={};(()=>{/*!*****************************!*\
  !*** ./src/transformers.js ***!
  \*****************************/Rn.r(A),Rn.d(A,{ASTFeatureExtractor:()=>h.ASTFeatureExtractor,ASTForAudioClassification:()=>n.ASTForAudioClassification,ASTModel:()=>n.ASTModel,ASTPreTrainedModel:()=>n.ASTPreTrainedModel,AlbertForMaskedLM:()=>n.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>n.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>n.AlbertForSequenceClassification,AlbertModel:()=>n.AlbertModel,AlbertPreTrainedModel:()=>n.AlbertPreTrainedModel,AlbertTokenizer:()=>r.AlbertTokenizer,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>s.AutoConfig,AutoFeatureExtractor:()=>m.AutoFeatureExtractor,AutoImageProcessor:()=>T.AutoImageProcessor,AutoModel:()=>n.AutoModel,AutoModelForAudioClassification:()=>n.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>n.AutoModelForAudioFrameClassification,AutoModelForCTC:()=>n.AutoModelForCTC,AutoModelForCausalLM:()=>n.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>n.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>n.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>n.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>n.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>n.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>n.AutoModelForImageSegmentation,AutoModelForImageToImage:()=>n.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>n.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>n.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>n.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>n.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>n.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>n.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>n.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>n.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>n.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>n.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>n.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>n.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>n.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>n.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>n.AutoModelForVision2Seq,AutoModelForXVector:()=>n.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>n.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>b.AutoProcessor,AutoTokenizer:()=>r.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BartForConditionalGeneration:()=>n.BartForConditionalGeneration,BartForSequenceClassification:()=>n.BartForSequenceClassification,BartModel:()=>n.BartModel,BartPretrainedModel:()=>n.BartPretrainedModel,BartTokenizer:()=>r.BartTokenizer,BaseModelOutput:()=>n.BaseModelOutput,BaseStreamer:()=>M.BaseStreamer,BeitFeatureExtractor:()=>v.BeitFeatureExtractor,BeitForImageClassification:()=>n.BeitForImageClassification,BeitModel:()=>n.BeitModel,BeitPreTrainedModel:()=>n.BeitPreTrainedModel,BertForMaskedLM:()=>n.BertForMaskedLM,BertForQuestionAnswering:()=>n.BertForQuestionAnswering,BertForSequenceClassification:()=>n.BertForSequenceClassification,BertForTokenClassification:()=>n.BertForTokenClassification,BertModel:()=>n.BertModel,BertPreTrainedModel:()=>n.BertPreTrainedModel,BertTokenizer:()=>r.BertTokenizer,BitImageProcessor:()=>v.BitImageProcessor,BlenderbotForConditionalGeneration:()=>n.BlenderbotForConditionalGeneration,BlenderbotModel:()=>n.BlenderbotModel,BlenderbotPreTrainedModel:()=>n.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>n.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>n.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>n.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>r.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>r.BlenderbotTokenizer,BloomForCausalLM:()=>n.BloomForCausalLM,BloomModel:()=>n.BloomModel,BloomPreTrainedModel:()=>n.BloomPreTrainedModel,BloomTokenizer:()=>r.BloomTokenizer,CLIPFeatureExtractor:()=>v.CLIPFeatureExtractor,CLIPImageProcessor:()=>v.CLIPImageProcessor,CLIPModel:()=>n.CLIPModel,CLIPPreTrainedModel:()=>n.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>n.CLIPSegForImageSegmentation,CLIPSegModel:()=>n.CLIPSegModel,CLIPSegPreTrainedModel:()=>n.CLIPSegPreTrainedModel,CLIPTextModel:()=>n.CLIPTextModel,CLIPTextModelWithProjection:()=>n.CLIPTextModelWithProjection,CLIPTokenizer:()=>r.CLIPTokenizer,CLIPVisionModel:()=>n.CLIPVisionModel,CLIPVisionModelWithProjection:()=>n.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>n.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>n.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>n.CamembertForSequenceClassification,CamembertForTokenClassification:()=>n.CamembertForTokenClassification,CamembertModel:()=>n.CamembertModel,CamembertPreTrainedModel:()=>n.CamembertPreTrainedModel,CamembertTokenizer:()=>r.CamembertTokenizer,CausalLMOutput:()=>n.CausalLMOutput,CausalLMOutputWithPast:()=>n.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>v.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>n.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>n.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>n.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>h.ClapFeatureExtractor,ClapModel:()=>n.ClapModel,ClapPreTrainedModel:()=>n.ClapPreTrainedModel,ClapTextModelWithProjection:()=>n.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>k.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>n.CodeGenForCausalLM,CodeGenModel:()=>n.CodeGenModel,CodeGenPreTrainedModel:()=>n.CodeGenPreTrainedModel,CodeGenTokenizer:()=>r.CodeGenTokenizer,CodeLlamaTokenizer:()=>r.CodeLlamaTokenizer,CohereForCausalLM:()=>n.CohereForCausalLM,CohereModel:()=>n.CohereModel,CoherePreTrainedModel:()=>n.CoherePreTrainedModel,CohereTokenizer:()=>r.CohereTokenizer,ConvBertForMaskedLM:()=>n.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>n.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>n.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>n.ConvBertForTokenClassification,ConvBertModel:()=>n.ConvBertModel,ConvBertPreTrainedModel:()=>n.ConvBertPreTrainedModel,ConvBertTokenizer:()=>r.ConvBertTokenizer,ConvNextFeatureExtractor:()=>v.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>n.ConvNextForImageClassification,ConvNextImageProcessor:()=>v.ConvNextImageProcessor,ConvNextModel:()=>n.ConvNextModel,ConvNextPreTrainedModel:()=>n.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>n.ConvNextV2ForImageClassification,ConvNextV2Model:()=>n.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>n.ConvNextV2PreTrainedModel,DPTFeatureExtractor:()=>v.DPTFeatureExtractor,DPTForDepthEstimation:()=>n.DPTForDepthEstimation,DPTImageProcessor:()=>v.DPTImageProcessor,DPTModel:()=>n.DPTModel,DPTPreTrainedModel:()=>n.DPTPreTrainedModel,DebertaForMaskedLM:()=>n.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>n.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>n.DebertaForSequenceClassification,DebertaForTokenClassification:()=>n.DebertaForTokenClassification,DebertaModel:()=>n.DebertaModel,DebertaPreTrainedModel:()=>n.DebertaPreTrainedModel,DebertaTokenizer:()=>r.DebertaTokenizer,DebertaV2ForMaskedLM:()=>n.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>n.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>n.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>n.DebertaV2ForTokenClassification,DebertaV2Model:()=>n.DebertaV2Model,DebertaV2PreTrainedModel:()=>n.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>r.DebertaV2Tokenizer,DecisionTransformerModel:()=>n.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>n.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>v.DeiTFeatureExtractor,DeiTForImageClassification:()=>n.DeiTForImageClassification,DeiTImageProcessor:()=>v.DeiTImageProcessor,DeiTModel:()=>n.DeiTModel,DeiTPreTrainedModel:()=>n.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>n.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>n.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>n.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>n.DepthProPreTrainedModel,DetrFeatureExtractor:()=>v.DetrFeatureExtractor,DetrForObjectDetection:()=>n.DetrForObjectDetection,DetrForSegmentation:()=>n.DetrForSegmentation,DetrImageProcessor:()=>v.DetrImageProcessor,DetrModel:()=>n.DetrModel,DetrObjectDetectionOutput:()=>n.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>n.DetrPreTrainedModel,DetrSegmentationOutput:()=>n.DetrSegmentationOutput,Dinov2ForImageClassification:()=>n.Dinov2ForImageClassification,Dinov2Model:()=>n.Dinov2Model,Dinov2PreTrainedModel:()=>n.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>n.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>n.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>n.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>n.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>n.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>n.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>n.DistilBertForTokenClassification,DistilBertModel:()=>n.DistilBertModel,DistilBertPreTrainedModel:()=>n.DistilBertPreTrainedModel,DistilBertTokenizer:()=>r.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>v.DonutFeatureExtractor,DonutImageProcessor:()=>v.DonutImageProcessor,DonutSwinModel:()=>n.DonutSwinModel,DonutSwinPreTrainedModel:()=>n.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>n.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>v.EfficientNetImageProcessor,EfficientNetModel:()=>n.EfficientNetModel,EfficientNetPreTrainedModel:()=>n.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>n.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>n.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>n.ElectraForSequenceClassification,ElectraForTokenClassification:()=>n.ElectraForTokenClassification,ElectraModel:()=>n.ElectraModel,ElectraPreTrainedModel:()=>n.ElectraPreTrainedModel,ElectraTokenizer:()=>r.ElectraTokenizer,EosTokenCriteria:()=>I.EosTokenCriteria,EsmForMaskedLM:()=>n.EsmForMaskedLM,EsmForSequenceClassification:()=>n.EsmForSequenceClassification,EsmForTokenClassification:()=>n.EsmForTokenClassification,EsmModel:()=>n.EsmModel,EsmPreTrainedModel:()=>n.EsmPreTrainedModel,EsmTokenizer:()=>r.EsmTokenizer,ExaoneForCausalLM:()=>n.ExaoneForCausalLM,ExaoneModel:()=>n.ExaoneModel,ExaonePreTrainedModel:()=>n.ExaonePreTrainedModel,FFT:()=>u.FFT,FalconForCausalLM:()=>n.FalconForCausalLM,FalconModel:()=>n.FalconModel,FalconPreTrainedModel:()=>n.FalconPreTrainedModel,FalconTokenizer:()=>r.FalconTokenizer,FastViTForImageClassification:()=>n.FastViTForImageClassification,FastViTModel:()=>n.FastViTModel,FastViTPreTrainedModel:()=>n.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>d.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>n.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>n.Florence2PreTrainedModel,Florence2Processor:()=>O.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>k.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>k.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>v.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>n.GLPNForDepthEstimation,GLPNModel:()=>n.GLPNModel,GLPNPreTrainedModel:()=>n.GLPNPreTrainedModel,GPT2LMHeadModel:()=>n.GPT2LMHeadModel,GPT2Model:()=>n.GPT2Model,GPT2PreTrainedModel:()=>n.GPT2PreTrainedModel,GPT2Tokenizer:()=>r.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>n.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>n.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>n.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>n.GPTJForCausalLM,GPTJModel:()=>n.GPTJModel,GPTJPreTrainedModel:()=>n.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>n.GPTNeoForCausalLM,GPTNeoModel:()=>n.GPTNeoModel,GPTNeoPreTrainedModel:()=>n.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>n.GPTNeoXForCausalLM,GPTNeoXModel:()=>n.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>n.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>r.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>n.Gemma2ForCausalLM,Gemma2Model:()=>n.Gemma2Model,Gemma2PreTrainedModel:()=>n.Gemma2PreTrainedModel,GemmaForCausalLM:()=>n.GemmaForCausalLM,GemmaModel:()=>n.GemmaModel,GemmaPreTrainedModel:()=>n.GemmaPreTrainedModel,GemmaTokenizer:()=>r.GemmaTokenizer,GraniteForCausalLM:()=>n.GraniteForCausalLM,GraniteModel:()=>n.GraniteModel,GranitePreTrainedModel:()=>n.GranitePreTrainedModel,Grok1Tokenizer:()=>r.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>n.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>v.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>n.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>O.GroundingDinoProcessor,GroupViTModel:()=>n.GroupViTModel,GroupViTPreTrainedModel:()=>n.GroupViTPreTrainedModel,HerbertTokenizer:()=>r.HerbertTokenizer,HieraForImageClassification:()=>n.HieraForImageClassification,HieraModel:()=>n.HieraModel,HieraPreTrainedModel:()=>n.HieraPreTrainedModel,HubertForCTC:()=>n.HubertForCTC,HubertForSequenceClassification:()=>n.HubertForSequenceClassification,HubertModel:()=>n.HubertModel,HubertPreTrainedModel:()=>n.HubertPreTrainedModel,IJepaForImageClassification:()=>n.IJepaForImageClassification,IJepaModel:()=>n.IJepaModel,IJepaPreTrainedModel:()=>n.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>n.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>v.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>n.Idefics3PreTrainedModel,Idefics3Processor:()=>O.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>h.ImageFeatureExtractor,ImageMattingOutput:()=>n.ImageMattingOutput,ImageProcessor:()=>p.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>I.InterruptableStoppingCriteria,JAISLMHeadModel:()=>n.JAISLMHeadModel,JAISModel:()=>n.JAISModel,JAISPreTrainedModel:()=>n.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>v.JinaCLIPImageProcessor,JinaCLIPModel:()=>n.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>n.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>O.JinaCLIPProcessor,JinaCLIPTextModel:()=>n.JinaCLIPTextModel,JinaCLIPVisionModel:()=>n.JinaCLIPVisionModel,LlamaForCausalLM:()=>n.LlamaForCausalLM,LlamaModel:()=>n.LlamaModel,LlamaPreTrainedModel:()=>n.LlamaPreTrainedModel,LlamaTokenizer:()=>r.LlamaTokenizer,LlavaForConditionalGeneration:()=>n.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>n.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>v.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>n.LlavaPreTrainedModel,LogitsProcessor:()=>k.LogitsProcessor,LogitsProcessorList:()=>k.LogitsProcessorList,LogitsWarper:()=>k.LogitsWarper,LongT5ForConditionalGeneration:()=>n.LongT5ForConditionalGeneration,LongT5Model:()=>n.LongT5Model,LongT5PreTrainedModel:()=>n.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>n.M2M100ForConditionalGeneration,M2M100Model:()=>n.M2M100Model,M2M100PreTrainedModel:()=>n.M2M100PreTrainedModel,M2M100Tokenizer:()=>r.M2M100Tokenizer,MBart50Tokenizer:()=>r.MBart50Tokenizer,MBartForCausalLM:()=>n.MBartForCausalLM,MBartForConditionalGeneration:()=>n.MBartForConditionalGeneration,MBartForSequenceClassification:()=>n.MBartForSequenceClassification,MBartModel:()=>n.MBartModel,MBartPreTrainedModel:()=>n.MBartPreTrainedModel,MBartTokenizer:()=>r.MBartTokenizer,MPNetForMaskedLM:()=>n.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>n.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>n.MPNetForSequenceClassification,MPNetForTokenClassification:()=>n.MPNetForTokenClassification,MPNetModel:()=>n.MPNetModel,MPNetPreTrainedModel:()=>n.MPNetPreTrainedModel,MPNetTokenizer:()=>r.MPNetTokenizer,MT5ForConditionalGeneration:()=>n.MT5ForConditionalGeneration,MT5Model:()=>n.MT5Model,MT5PreTrainedModel:()=>n.MT5PreTrainedModel,MarianMTModel:()=>n.MarianMTModel,MarianModel:()=>n.MarianModel,MarianPreTrainedModel:()=>n.MarianPreTrainedModel,MarianTokenizer:()=>r.MarianTokenizer,Mask2FormerImageProcessor:()=>v.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>v.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>n.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>v.MaskFormerImageProcessor,MaskFormerModel:()=>n.MaskFormerModel,MaskFormerPreTrainedModel:()=>n.MaskFormerPreTrainedModel,MaskedLMOutput:()=>n.MaskedLMOutput,MaxLengthCriteria:()=>I.MaxLengthCriteria,MgpstrForSceneTextRecognition:()=>n.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>n.MgpstrModelOutput,MgpstrPreTrainedModel:()=>n.MgpstrPreTrainedModel,MgpstrProcessor:()=>O.MgpstrProcessor,MgpstrTokenizer:()=>r.MgpstrTokenizer,MinLengthLogitsProcessor:()=>k.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>k.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>n.MistralForCausalLM,MistralModel:()=>n.MistralModel,MistralPreTrainedModel:()=>n.MistralPreTrainedModel,MobileBertForMaskedLM:()=>n.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>n.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>n.MobileBertForSequenceClassification,MobileBertModel:()=>n.MobileBertModel,MobileBertPreTrainedModel:()=>n.MobileBertPreTrainedModel,MobileBertTokenizer:()=>r.MobileBertTokenizer,MobileLLMForCausalLM:()=>n.MobileLLMForCausalLM,MobileLLMModel:()=>n.MobileLLMModel,MobileLLMPreTrainedModel:()=>n.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>v.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>n.MobileNetV1ForImageClassification,MobileNetV1ImageProcessor:()=>v.MobileNetV1ImageProcessor,MobileNetV1Model:()=>n.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>n.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>v.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>n.MobileNetV2ForImageClassification,MobileNetV2ImageProcessor:()=>v.MobileNetV2ImageProcessor,MobileNetV2Model:()=>n.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>n.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>v.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>n.MobileNetV3ForImageClassification,MobileNetV3ImageProcessor:()=>v.MobileNetV3ImageProcessor,MobileNetV3Model:()=>n.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>n.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>v.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>n.MobileNetV4ForImageClassification,MobileNetV4ImageProcessor:()=>v.MobileNetV4ImageProcessor,MobileNetV4Model:()=>n.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>n.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>v.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>n.MobileViTForImageClassification,MobileViTImageProcessor:()=>v.MobileViTImageProcessor,MobileViTModel:()=>n.MobileViTModel,MobileViTPreTrainedModel:()=>n.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>n.MobileViTV2ForImageClassification,MobileViTV2Model:()=>n.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>n.MobileViTV2PreTrainedModel,ModelOutput:()=>n.ModelOutput,ModernBertForMaskedLM:()=>n.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>n.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>n.ModernBertForTokenClassification,ModernBertModel:()=>n.ModernBertModel,ModernBertPreTrainedModel:()=>n.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>n.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>h.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>n.MoonshineForConditionalGeneration,MoonshineModel:()=>n.MoonshineModel,MoonshinePreTrainedModel:()=>n.MoonshinePreTrainedModel,MoonshineProcessor:()=>O.MoonshineProcessor,MptForCausalLM:()=>n.MptForCausalLM,MptModel:()=>n.MptModel,MptPreTrainedModel:()=>n.MptPreTrainedModel,MultiModalityCausalLM:()=>n.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>n.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>n.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>n.MusicgenForConditionalGeneration,MusicgenModel:()=>n.MusicgenModel,MusicgenPreTrainedModel:()=>n.MusicgenPreTrainedModel,NllbTokenizer:()=>r.NllbTokenizer,NoBadWordsLogitsProcessor:()=>k.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>k.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>n.NomicBertModel,NomicBertPreTrainedModel:()=>n.NomicBertPreTrainedModel,NougatImageProcessor:()=>v.NougatImageProcessor,NougatTokenizer:()=>r.NougatTokenizer,OPTForCausalLM:()=>n.OPTForCausalLM,OPTModel:()=>n.OPTModel,OPTPreTrainedModel:()=>n.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>n.Olmo2ForCausalLM,Olmo2Model:()=>n.Olmo2Model,Olmo2PreTrainedModel:()=>n.Olmo2PreTrainedModel,OlmoForCausalLM:()=>n.OlmoForCausalLM,OlmoModel:()=>n.OlmoModel,OlmoPreTrainedModel:()=>n.OlmoPreTrainedModel,OpenELMForCausalLM:()=>n.OpenELMForCausalLM,OpenELMModel:()=>n.OpenELMModel,OpenELMPreTrainedModel:()=>n.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>v.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>n.OwlViTForObjectDetection,OwlViTImageProcessor:()=>v.OwlViTImageProcessor,OwlViTModel:()=>n.OwlViTModel,OwlViTPreTrainedModel:()=>n.OwlViTPreTrainedModel,OwlViTProcessor:()=>O.OwlViTProcessor,Owlv2ForObjectDetection:()=>n.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>v.Owlv2ImageProcessor,Owlv2Model:()=>n.Owlv2Model,Owlv2PreTrainedModel:()=>n.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>n.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>n.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>O.PaliGemmaProcessor,PatchTSMixerForPrediction:()=>n.PatchTSMixerForPrediction,PatchTSMixerModel:()=>n.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>n.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>n.PatchTSTForPrediction,PatchTSTModel:()=>n.PatchTSTModel,PatchTSTPreTrainedModel:()=>n.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>n.Phi3ForCausalLM,Phi3Model:()=>n.Phi3Model,Phi3PreTrainedModel:()=>n.Phi3PreTrainedModel,Phi3VForCausalLM:()=>n.Phi3VForCausalLM,Phi3VImageProcessor:()=>v.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>n.Phi3VPreTrainedModel,Phi3VProcessor:()=>O.Phi3VProcessor,PhiForCausalLM:()=>n.PhiForCausalLM,PhiModel:()=>n.PhiModel,PhiPreTrainedModel:()=>n.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PreTrainedModel:()=>n.PreTrainedModel,PreTrainedTokenizer:()=>r.PreTrainedTokenizer,PretrainedConfig:()=>s.PretrainedConfig,PretrainedMixin:()=>n.PretrainedMixin,Processor:()=>E.Processor,PvtForImageClassification:()=>n.PvtForImageClassification,PvtImageProcessor:()=>v.PvtImageProcessor,PvtModel:()=>n.PvtModel,PvtPreTrainedModel:()=>n.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>h.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>n.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>n.PyAnnoteModel,PyAnnotePreTrainedModel:()=>n.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>O.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>n.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>n.Qwen2ForCausalLM,Qwen2Model:()=>n.Qwen2Model,Qwen2PreTrainedModel:()=>n.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>r.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>n.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>v.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>n.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>O.Qwen2VLProcessor,RTDetrForObjectDetection:()=>n.RTDetrForObjectDetection,RTDetrImageProcessor:()=>v.RTDetrImageProcessor,RTDetrModel:()=>n.RTDetrModel,RTDetrObjectDetectionOutput:()=>n.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>n.RTDetrPreTrainedModel,RawAudio:()=>o.RawAudio,RawImage:()=>a.RawImage,RepetitionPenaltyLogitsProcessor:()=>k.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>n.ResNetForImageClassification,ResNetModel:()=>n.ResNetModel,ResNetPreTrainedModel:()=>n.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>n.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>n.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>n.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>n.RoFormerForTokenClassification,RoFormerModel:()=>n.RoFormerModel,RoFormerPreTrainedModel:()=>n.RoFormerPreTrainedModel,RoFormerTokenizer:()=>r.RoFormerTokenizer,RobertaForMaskedLM:()=>n.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>n.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>n.RobertaForSequenceClassification,RobertaForTokenClassification:()=>n.RobertaForTokenClassification,RobertaModel:()=>n.RobertaModel,RobertaPreTrainedModel:()=>n.RobertaPreTrainedModel,RobertaTokenizer:()=>r.RobertaTokenizer,SamImageProcessor:()=>v.SamImageProcessor,SamImageSegmentationOutput:()=>n.SamImageSegmentationOutput,SamModel:()=>n.SamModel,SamPreTrainedModel:()=>n.SamPreTrainedModel,SamProcessor:()=>O.SamProcessor,SapiensForDepthEstimation:()=>n.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>n.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>n.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>n.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>h.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>v.SegformerFeatureExtractor,SegformerForImageClassification:()=>n.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>n.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>v.SegformerImageProcessor,SegformerModel:()=>n.SegformerModel,SegformerPreTrainedModel:()=>n.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>n.Seq2SeqLMOutput,SequenceClassifierOutput:()=>n.SequenceClassifierOutput,SiglipImageProcessor:()=>v.SiglipImageProcessor,SiglipModel:()=>n.SiglipModel,SiglipPreTrainedModel:()=>n.SiglipPreTrainedModel,SiglipTextModel:()=>n.SiglipTextModel,SiglipTokenizer:()=>r.SiglipTokenizer,SiglipVisionModel:()=>n.SiglipVisionModel,SpeechT5FeatureExtractor:()=>h.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>n.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>n.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>n.SpeechT5HifiGan,SpeechT5Model:()=>n.SpeechT5Model,SpeechT5PreTrainedModel:()=>n.SpeechT5PreTrainedModel,SpeechT5Processor:()=>O.SpeechT5Processor,SpeechT5Tokenizer:()=>r.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>n.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>n.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>n.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>n.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>n.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>r.SqueezeBertTokenizer,StableLmForCausalLM:()=>n.StableLmForCausalLM,StableLmModel:()=>n.StableLmModel,StableLmPreTrainedModel:()=>n.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>n.Starcoder2ForCausalLM,Starcoder2Model:()=>n.Starcoder2Model,Starcoder2PreTrainedModel:()=>n.Starcoder2PreTrainedModel,StoppingCriteria:()=>I.StoppingCriteria,StoppingCriteriaList:()=>I.StoppingCriteriaList,StyleTextToSpeech2Model:()=>n.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>n.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>k.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>n.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>v.Swin2SRImageProcessor,Swin2SRModel:()=>n.Swin2SRModel,Swin2SRPreTrainedModel:()=>n.Swin2SRPreTrainedModel,SwinForImageClassification:()=>n.SwinForImageClassification,SwinModel:()=>n.SwinModel,SwinPreTrainedModel:()=>n.SwinPreTrainedModel,T5ForConditionalGeneration:()=>n.T5ForConditionalGeneration,T5Model:()=>n.T5Model,T5PreTrainedModel:()=>n.T5PreTrainedModel,T5Tokenizer:()=>r.T5Tokenizer,TableTransformerForObjectDetection:()=>n.TableTransformerForObjectDetection,TableTransformerModel:()=>n.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>n.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>n.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>k.TemperatureLogitsWarper,Tensor:()=>c.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>M.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>n.TokenClassifierOutput,TokenizerModel:()=>r.TokenizerModel,TopKLogitsWarper:()=>k.TopKLogitsWarper,TopPLogitsWarper:()=>k.TopPLogitsWarper,TrOCRForCausalLM:()=>n.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>n.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UniSpeechForCTC:()=>n.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>n.UniSpeechForSequenceClassification,UniSpeechModel:()=>n.UniSpeechModel,UniSpeechPreTrainedModel:()=>n.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>n.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>n.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>n.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>n.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>n.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>O.VLChatProcessor,VLMImageProcessor:()=>v.VLMImageProcessor,ViTFeatureExtractor:()=>v.ViTFeatureExtractor,ViTForImageClassification:()=>n.ViTForImageClassification,ViTImageProcessor:()=>v.ViTImageProcessor,ViTMAEModel:()=>n.ViTMAEModel,ViTMAEPreTrainedModel:()=>n.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>n.ViTMSNForImageClassification,ViTMSNModel:()=>n.ViTMSNModel,ViTMSNPreTrainedModel:()=>n.ViTMSNPreTrainedModel,ViTModel:()=>n.ViTModel,ViTPreTrainedModel:()=>n.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>n.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>n.VitMatteForImageMatting,VitMatteImageProcessor:()=>v.VitMatteImageProcessor,VitMattePreTrainedModel:()=>n.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>n.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>v.VitPoseImageProcessor,VitPosePreTrainedModel:()=>n.VitPosePreTrainedModel,VitsModel:()=>n.VitsModel,VitsModelOutput:()=>n.VitsModelOutput,VitsPreTrainedModel:()=>n.VitsPreTrainedModel,VitsTokenizer:()=>r.VitsTokenizer,Wav2Vec2BertForCTC:()=>n.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>n.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>n.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>n.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>r.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>h.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>n.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>n.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>n.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>n.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>n.Wav2Vec2PreTrainedModel,Wav2Vec2ProcessorWithLM:()=>O.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>n.WavLMForAudioFrameClassification,WavLMForCTC:()=>n.WavLMForCTC,WavLMForSequenceClassification:()=>n.WavLMForSequenceClassification,WavLMForXVector:()=>n.WavLMForXVector,WavLMModel:()=>n.WavLMModel,WavLMPreTrainedModel:()=>n.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>h.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>n.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>n.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>h.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>n.WhisperForConditionalGeneration,WhisperModel:()=>n.WhisperModel,WhisperPreTrainedModel:()=>n.WhisperPreTrainedModel,WhisperProcessor:()=>O.WhisperProcessor,WhisperTextStreamer:()=>M.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>k.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>r.WhisperTokenizer,XLMForQuestionAnswering:()=>n.XLMForQuestionAnswering,XLMForSequenceClassification:()=>n.XLMForSequenceClassification,XLMForTokenClassification:()=>n.XLMForTokenClassification,XLMModel:()=>n.XLMModel,XLMPreTrainedModel:()=>n.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>n.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>n.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>n.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>n.XLMRobertaForTokenClassification,XLMRobertaModel:()=>n.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>n.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>r.XLMRobertaTokenizer,XLMTokenizer:()=>r.XLMTokenizer,XLMWithLMHeadModel:()=>n.XLMWithLMHeadModel,XVectorOutput:()=>n.XVectorOutput,YolosFeatureExtractor:()=>v.YolosFeatureExtractor,YolosForObjectDetection:()=>n.YolosForObjectDetection,YolosImageProcessor:()=>v.YolosImageProcessor,YolosModel:()=>n.YolosModel,YolosObjectDetectionOutput:()=>n.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>n.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>u.bankers_round,cat:()=>c.cat,cos_sim:()=>u.cos_sim,dot:()=>u.dot,dynamic_time_warping:()=>u.dynamic_time_warping,env:()=>e.env,full:()=>c.full,full_like:()=>c.full_like,getKeyValueShapes:()=>s.getKeyValueShapes,hamming:()=>o.hamming,hanning:()=>o.hanning,interpolate:()=>c.interpolate,interpolate_4d:()=>c.interpolate_4d,interpolate_data:()=>u.interpolate_data,is_chinese_char:()=>r.is_chinese_char,layer_norm:()=>c.layer_norm,load_image:()=>a.load_image,log_softmax:()=>u.log_softmax,magnitude:()=>u.magnitude,matmul:()=>c.matmul,max:()=>u.max,mean:()=>c.mean,mean_pooling:()=>c.mean_pooling,medianFilter:()=>u.medianFilter,mel_filter_bank:()=>o.mel_filter_bank,min:()=>u.min,ones:()=>c.ones,ones_like:()=>c.ones_like,permute:()=>c.permute,permute_data:()=>u.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>c.quantize_embeddings,rand:()=>c.rand,read_audio:()=>o.read_audio,rfft:()=>c.rfft,round:()=>u.round,slice:()=>c.slice,softmax:()=>u.softmax,spectrogram:()=>o.spectrogram,stack:()=>c.stack,std_mean:()=>c.std_mean,topk:()=>c.topk,window_function:()=>o.window_function,zeros:()=>c.zeros,zeros_like:()=>c.zeros_like});var e=Rn("./src/env.js"),t=Rn("./src/pipelines.js"),n=Rn("./src/models.js"),r=Rn("./src/tokenizers.js"),s=Rn("./src/configs.js"),o=Rn("./src/utils/audio.js"),a=Rn("./src/utils/image.js"),c=Rn("./src/utils/tensor.js"),u=Rn("./src/utils/maths.js"),d=Rn("./src/base/feature_extraction_utils.js"),h=Rn("./src/models/feature_extractors.js"),m=Rn("./src/models/auto/feature_extraction_auto.js"),p=Rn("./src/base/image_processors_utils.js"),v=Rn("./src/models/image_processors.js"),T=Rn("./src/models/auto/image_processing_auto.js"),E=Rn("./src/base/processing_utils.js"),O=Rn("./src/models/processors.js"),b=Rn("./src/models/auto/processing_auto.js"),M=Rn("./src/generation/streamers.js"),I=Rn("./src/generation/stopping_criteria.js"),k=Rn("./src/generation/logits_process.js")})();A.ASTFeatureExtractor;A.ASTForAudioClassification;A.ASTModel;A.ASTPreTrainedModel;A.AlbertForMaskedLM;A.AlbertForQuestionAnswering;A.AlbertForSequenceClassification;A.AlbertModel;A.AlbertPreTrainedModel;A.AlbertTokenizer;A.AudioClassificationPipeline;A.AutoConfig;A.AutoFeatureExtractor;A.AutoImageProcessor;A.AutoModel;A.AutoModelForAudioClassification;A.AutoModelForAudioFrameClassification;A.AutoModelForCTC;A.AutoModelForCausalLM;A.AutoModelForDepthEstimation;A.AutoModelForDocumentQuestionAnswering;A.AutoModelForImageClassification;A.AutoModelForImageFeatureExtraction;A.AutoModelForImageMatting;A.AutoModelForImageSegmentation;A.AutoModelForImageToImage;A.AutoModelForMaskGeneration;A.AutoModelForMaskedLM;A.AutoModelForNormalEstimation;A.AutoModelForObjectDetection;A.AutoModelForPoseEstimation;A.AutoModelForQuestionAnswering;A.AutoModelForSemanticSegmentation;A.AutoModelForSeq2SeqLM;A.AutoModelForSequenceClassification;A.AutoModelForSpeechSeq2Seq;A.AutoModelForTextToSpectrogram;A.AutoModelForTextToWaveform;A.AutoModelForTokenClassification;A.AutoModelForUniversalSegmentation;A.AutoModelForVision2Seq;A.AutoModelForXVector;A.AutoModelForZeroShotObjectDetection;A.AutoProcessor;A.AutoTokenizer;A.AutomaticSpeechRecognitionPipeline;A.BartForConditionalGeneration;A.BartForSequenceClassification;A.BartModel;A.BartPretrainedModel;A.BartTokenizer;A.BaseModelOutput;A.BaseStreamer;A.BeitFeatureExtractor;A.BeitForImageClassification;A.BeitModel;A.BeitPreTrainedModel;A.BertForMaskedLM;A.BertForQuestionAnswering;A.BertForSequenceClassification;A.BertForTokenClassification;A.BertModel;A.BertPreTrainedModel;A.BertTokenizer;A.BitImageProcessor;A.BlenderbotForConditionalGeneration;A.BlenderbotModel;A.BlenderbotPreTrainedModel;A.BlenderbotSmallForConditionalGeneration;A.BlenderbotSmallModel;A.BlenderbotSmallPreTrainedModel;A.BlenderbotSmallTokenizer;A.BlenderbotTokenizer;A.BloomForCausalLM;A.BloomModel;A.BloomPreTrainedModel;A.BloomTokenizer;A.CLIPFeatureExtractor;A.CLIPImageProcessor;A.CLIPModel;A.CLIPPreTrainedModel;A.CLIPSegForImageSegmentation;A.CLIPSegModel;A.CLIPSegPreTrainedModel;A.CLIPTextModel;A.CLIPTextModelWithProjection;A.CLIPTokenizer;A.CLIPVisionModel;A.CLIPVisionModelWithProjection;A.CamembertForMaskedLM;A.CamembertForQuestionAnswering;A.CamembertForSequenceClassification;A.CamembertForTokenClassification;A.CamembertModel;A.CamembertPreTrainedModel;A.CamembertTokenizer;A.CausalLMOutput;A.CausalLMOutputWithPast;A.ChineseCLIPFeatureExtractor;A.ChineseCLIPModel;A.ChineseCLIPPreTrainedModel;A.ClapAudioModelWithProjection;A.ClapFeatureExtractor;A.ClapModel;A.ClapPreTrainedModel;A.ClapTextModelWithProjection;A.ClassifierFreeGuidanceLogitsProcessor;A.CodeGenForCausalLM;A.CodeGenModel;A.CodeGenPreTrainedModel;A.CodeGenTokenizer;A.CodeLlamaTokenizer;A.CohereForCausalLM;A.CohereModel;A.CoherePreTrainedModel;A.CohereTokenizer;A.ConvBertForMaskedLM;A.ConvBertForQuestionAnswering;A.ConvBertForSequenceClassification;A.ConvBertForTokenClassification;A.ConvBertModel;A.ConvBertPreTrainedModel;A.ConvBertTokenizer;A.ConvNextFeatureExtractor;A.ConvNextForImageClassification;A.ConvNextImageProcessor;A.ConvNextModel;A.ConvNextPreTrainedModel;A.ConvNextV2ForImageClassification;A.ConvNextV2Model;A.ConvNextV2PreTrainedModel;A.DPTFeatureExtractor;A.DPTForDepthEstimation;A.DPTImageProcessor;A.DPTModel;A.DPTPreTrainedModel;A.DebertaForMaskedLM;A.DebertaForQuestionAnswering;A.DebertaForSequenceClassification;A.DebertaForTokenClassification;A.DebertaModel;A.DebertaPreTrainedModel;A.DebertaTokenizer;A.DebertaV2ForMaskedLM;A.DebertaV2ForQuestionAnswering;A.DebertaV2ForSequenceClassification;A.DebertaV2ForTokenClassification;A.DebertaV2Model;A.DebertaV2PreTrainedModel;A.DebertaV2Tokenizer;A.DecisionTransformerModel;A.DecisionTransformerPreTrainedModel;A.DeiTFeatureExtractor;A.DeiTForImageClassification;A.DeiTImageProcessor;A.DeiTModel;A.DeiTPreTrainedModel;A.DepthAnythingForDepthEstimation;A.DepthAnythingPreTrainedModel;A.DepthEstimationPipeline;A.DepthProForDepthEstimation;A.DepthProPreTrainedModel;A.DetrFeatureExtractor;A.DetrForObjectDetection;A.DetrForSegmentation;A.DetrImageProcessor;A.DetrModel;A.DetrObjectDetectionOutput;A.DetrPreTrainedModel;A.DetrSegmentationOutput;A.Dinov2ForImageClassification;A.Dinov2Model;A.Dinov2PreTrainedModel;A.Dinov2WithRegistersForImageClassification;A.Dinov2WithRegistersModel;A.Dinov2WithRegistersPreTrainedModel;A.DistilBertForMaskedLM;A.DistilBertForQuestionAnswering;A.DistilBertForSequenceClassification;A.DistilBertForTokenClassification;A.DistilBertModel;A.DistilBertPreTrainedModel;A.DistilBertTokenizer;A.DocumentQuestionAnsweringPipeline;A.DonutFeatureExtractor;A.DonutImageProcessor;A.DonutSwinModel;A.DonutSwinPreTrainedModel;A.EfficientNetForImageClassification;A.EfficientNetImageProcessor;A.EfficientNetModel;A.EfficientNetPreTrainedModel;A.ElectraForMaskedLM;A.ElectraForQuestionAnswering;A.ElectraForSequenceClassification;A.ElectraForTokenClassification;A.ElectraModel;A.ElectraPreTrainedModel;A.ElectraTokenizer;A.EosTokenCriteria;A.EsmForMaskedLM;A.EsmForSequenceClassification;A.EsmForTokenClassification;A.EsmModel;A.EsmPreTrainedModel;A.EsmTokenizer;A.ExaoneForCausalLM;A.ExaoneModel;A.ExaonePreTrainedModel;A.FFT;A.FalconForCausalLM;A.FalconModel;A.FalconPreTrainedModel;A.FalconTokenizer;A.FastViTForImageClassification;A.FastViTModel;A.FastViTPreTrainedModel;A.FeatureExtractionPipeline;A.FeatureExtractor;A.FillMaskPipeline;A.Florence2ForConditionalGeneration;A.Florence2PreTrainedModel;A.Florence2Processor;A.ForcedBOSTokenLogitsProcessor;A.ForcedEOSTokenLogitsProcessor;A.GLPNFeatureExtractor;A.GLPNForDepthEstimation;A.GLPNModel;A.GLPNPreTrainedModel;A.GPT2LMHeadModel;A.GPT2Model;A.GPT2PreTrainedModel;A.GPT2Tokenizer;A.GPTBigCodeForCausalLM;A.GPTBigCodeModel;A.GPTBigCodePreTrainedModel;A.GPTJForCausalLM;A.GPTJModel;A.GPTJPreTrainedModel;A.GPTNeoForCausalLM;A.GPTNeoModel;A.GPTNeoPreTrainedModel;A.GPTNeoXForCausalLM;A.GPTNeoXModel;A.GPTNeoXPreTrainedModel;A.GPTNeoXTokenizer;A.Gemma2ForCausalLM;A.Gemma2Model;A.Gemma2PreTrainedModel;A.GemmaForCausalLM;A.GemmaModel;A.GemmaPreTrainedModel;A.GemmaTokenizer;A.GraniteForCausalLM;A.GraniteModel;A.GranitePreTrainedModel;A.Grok1Tokenizer;A.GroundingDinoForObjectDetection;A.GroundingDinoImageProcessor;A.GroundingDinoPreTrainedModel;A.GroundingDinoProcessor;A.GroupViTModel;A.GroupViTPreTrainedModel;A.HerbertTokenizer;A.HieraForImageClassification;A.HieraModel;A.HieraPreTrainedModel;A.HubertForCTC;A.HubertForSequenceClassification;A.HubertModel;A.HubertPreTrainedModel;A.IJepaForImageClassification;A.IJepaModel;A.IJepaPreTrainedModel;A.Idefics3ForConditionalGeneration;A.Idefics3ImageProcessor;A.Idefics3PreTrainedModel;A.Idefics3Processor;A.ImageClassificationPipeline;A.ImageFeatureExtractionPipeline;A.ImageFeatureExtractor;A.ImageMattingOutput;A.ImageProcessor;A.ImageSegmentationPipeline;A.ImageToImagePipeline;A.ImageToTextPipeline;A.InterruptableStoppingCriteria;A.JAISLMHeadModel;A.JAISModel;A.JAISPreTrainedModel;A.JinaCLIPImageProcessor;A.JinaCLIPModel;A.JinaCLIPPreTrainedModel;A.JinaCLIPProcessor;A.JinaCLIPTextModel;A.JinaCLIPVisionModel;A.LlamaForCausalLM;A.LlamaModel;A.LlamaPreTrainedModel;A.LlamaTokenizer;A.LlavaForConditionalGeneration;A.LlavaOnevisionForConditionalGeneration;A.LlavaOnevisionImageProcessor;A.LlavaPreTrainedModel;A.LogitsProcessor;A.LogitsProcessorList;A.LogitsWarper;A.LongT5ForConditionalGeneration;A.LongT5Model;A.LongT5PreTrainedModel;A.M2M100ForConditionalGeneration;A.M2M100Model;A.M2M100PreTrainedModel;A.M2M100Tokenizer;A.MBart50Tokenizer;A.MBartForCausalLM;A.MBartForConditionalGeneration;A.MBartForSequenceClassification;A.MBartModel;A.MBartPreTrainedModel;A.MBartTokenizer;A.MPNetForMaskedLM;A.MPNetForQuestionAnswering;A.MPNetForSequenceClassification;A.MPNetForTokenClassification;A.MPNetModel;A.MPNetPreTrainedModel;A.MPNetTokenizer;A.MT5ForConditionalGeneration;A.MT5Model;A.MT5PreTrainedModel;A.MarianMTModel;A.MarianModel;A.MarianPreTrainedModel;A.MarianTokenizer;A.Mask2FormerImageProcessor;A.MaskFormerFeatureExtractor;A.MaskFormerForInstanceSegmentation;A.MaskFormerImageProcessor;A.MaskFormerModel;A.MaskFormerPreTrainedModel;A.MaskedLMOutput;A.MaxLengthCriteria;A.MgpstrForSceneTextRecognition;A.MgpstrModelOutput;A.MgpstrPreTrainedModel;A.MgpstrProcessor;A.MgpstrTokenizer;A.MinLengthLogitsProcessor;A.MinNewTokensLengthLogitsProcessor;A.MistralForCausalLM;A.MistralModel;A.MistralPreTrainedModel;A.MobileBertForMaskedLM;A.MobileBertForQuestionAnswering;A.MobileBertForSequenceClassification;A.MobileBertModel;A.MobileBertPreTrainedModel;A.MobileBertTokenizer;A.MobileLLMForCausalLM;A.MobileLLMModel;A.MobileLLMPreTrainedModel;A.MobileNetV1FeatureExtractor;A.MobileNetV1ForImageClassification;A.MobileNetV1ImageProcessor;A.MobileNetV1Model;A.MobileNetV1PreTrainedModel;A.MobileNetV2FeatureExtractor;A.MobileNetV2ForImageClassification;A.MobileNetV2ImageProcessor;A.MobileNetV2Model;A.MobileNetV2PreTrainedModel;A.MobileNetV3FeatureExtractor;A.MobileNetV3ForImageClassification;A.MobileNetV3ImageProcessor;A.MobileNetV3Model;A.MobileNetV3PreTrainedModel;A.MobileNetV4FeatureExtractor;A.MobileNetV4ForImageClassification;A.MobileNetV4ImageProcessor;A.MobileNetV4Model;A.MobileNetV4PreTrainedModel;A.MobileViTFeatureExtractor;A.MobileViTForImageClassification;A.MobileViTImageProcessor;A.MobileViTModel;A.MobileViTPreTrainedModel;A.MobileViTV2ForImageClassification;A.MobileViTV2Model;A.MobileViTV2PreTrainedModel;A.ModelOutput;A.ModernBertForMaskedLM;A.ModernBertForSequenceClassification;A.ModernBertForTokenClassification;A.ModernBertModel;A.ModernBertPreTrainedModel;A.Moondream1ForConditionalGeneration;A.MoonshineFeatureExtractor;A.MoonshineForConditionalGeneration;A.MoonshineModel;A.MoonshinePreTrainedModel;A.MoonshineProcessor;A.MptForCausalLM;A.MptModel;A.MptPreTrainedModel;A.MultiModalityCausalLM;A.MultiModalityPreTrainedModel;A.MusicgenForCausalLM;A.MusicgenForConditionalGeneration;A.MusicgenModel;A.MusicgenPreTrainedModel;A.NllbTokenizer;A.NoBadWordsLogitsProcessor;A.NoRepeatNGramLogitsProcessor;A.NomicBertModel;A.NomicBertPreTrainedModel;A.NougatImageProcessor;A.NougatTokenizer;A.OPTForCausalLM;A.OPTModel;A.OPTPreTrainedModel;A.ObjectDetectionPipeline;A.Olmo2ForCausalLM;A.Olmo2Model;A.Olmo2PreTrainedModel;A.OlmoForCausalLM;A.OlmoModel;A.OlmoPreTrainedModel;A.OpenELMForCausalLM;A.OpenELMModel;A.OpenELMPreTrainedModel;A.OwlViTFeatureExtractor;A.OwlViTForObjectDetection;A.OwlViTImageProcessor;A.OwlViTModel;A.OwlViTPreTrainedModel;A.OwlViTProcessor;A.Owlv2ForObjectDetection;A.Owlv2ImageProcessor;A.Owlv2Model;A.Owlv2PreTrainedModel;A.PaliGemmaForConditionalGeneration;A.PaliGemmaPreTrainedModel;A.PaliGemmaProcessor;A.PatchTSMixerForPrediction;A.PatchTSMixerModel;A.PatchTSMixerPreTrainedModel;A.PatchTSTForPrediction;A.PatchTSTModel;A.PatchTSTPreTrainedModel;A.Phi3ForCausalLM;A.Phi3Model;A.Phi3PreTrainedModel;A.Phi3VForCausalLM;A.Phi3VImageProcessor;A.Phi3VPreTrainedModel;A.Phi3VProcessor;A.PhiForCausalLM;A.PhiModel;A.PhiPreTrainedModel;A.Pipeline;A.PreTrainedModel;A.PreTrainedTokenizer;A.PretrainedConfig;A.PretrainedMixin;A.Processor;A.PvtForImageClassification;A.PvtImageProcessor;A.PvtModel;A.PvtPreTrainedModel;A.PyAnnoteFeatureExtractor;A.PyAnnoteForAudioFrameClassification;A.PyAnnoteModel;A.PyAnnotePreTrainedModel;A.PyAnnoteProcessor;A.QuestionAnsweringModelOutput;A.QuestionAnsweringPipeline;A.Qwen2ForCausalLM;A.Qwen2Model;A.Qwen2PreTrainedModel;A.Qwen2Tokenizer;A.Qwen2VLForConditionalGeneration;A.Qwen2VLImageProcessor;A.Qwen2VLPreTrainedModel;A.Qwen2VLProcessor;A.RTDetrForObjectDetection;A.RTDetrImageProcessor;A.RTDetrModel;A.RTDetrObjectDetectionOutput;A.RTDetrPreTrainedModel;A.RawAudio;A.RawImage;A.RepetitionPenaltyLogitsProcessor;A.ResNetForImageClassification;A.ResNetModel;A.ResNetPreTrainedModel;A.RoFormerForMaskedLM;A.RoFormerForQuestionAnswering;A.RoFormerForSequenceClassification;A.RoFormerForTokenClassification;A.RoFormerModel;A.RoFormerPreTrainedModel;A.RoFormerTokenizer;A.RobertaForMaskedLM;A.RobertaForQuestionAnswering;A.RobertaForSequenceClassification;A.RobertaForTokenClassification;A.RobertaModel;A.RobertaPreTrainedModel;A.RobertaTokenizer;A.SamImageProcessor;A.SamImageSegmentationOutput;A.SamModel;A.SamPreTrainedModel;A.SamProcessor;A.SapiensForDepthEstimation;A.SapiensForNormalEstimation;A.SapiensForSemanticSegmentation;A.SapiensPreTrainedModel;A.SeamlessM4TFeatureExtractor;A.SegformerFeatureExtractor;A.SegformerForImageClassification;A.SegformerForSemanticSegmentation;A.SegformerImageProcessor;A.SegformerModel;A.SegformerPreTrainedModel;A.Seq2SeqLMOutput;A.SequenceClassifierOutput;A.SiglipImageProcessor;A.SiglipModel;A.SiglipPreTrainedModel;A.SiglipTextModel;A.SiglipTokenizer;A.SiglipVisionModel;A.SpeechT5FeatureExtractor;A.SpeechT5ForSpeechToText;A.SpeechT5ForTextToSpeech;A.SpeechT5HifiGan;A.SpeechT5Model;A.SpeechT5PreTrainedModel;A.SpeechT5Processor;A.SpeechT5Tokenizer;A.SqueezeBertForMaskedLM;A.SqueezeBertForQuestionAnswering;A.SqueezeBertForSequenceClassification;A.SqueezeBertModel;A.SqueezeBertPreTrainedModel;A.SqueezeBertTokenizer;A.StableLmForCausalLM;A.StableLmModel;A.StableLmPreTrainedModel;A.Starcoder2ForCausalLM;A.Starcoder2Model;A.Starcoder2PreTrainedModel;A.StoppingCriteria;A.StoppingCriteriaList;A.StyleTextToSpeech2Model;A.StyleTextToSpeech2PreTrainedModel;A.SummarizationPipeline;A.SuppressTokensAtBeginLogitsProcessor;A.Swin2SRForImageSuperResolution;A.Swin2SRImageProcessor;A.Swin2SRModel;A.Swin2SRPreTrainedModel;A.SwinForImageClassification;A.SwinModel;A.SwinPreTrainedModel;A.T5ForConditionalGeneration;A.T5Model;A.T5PreTrainedModel;A.T5Tokenizer;A.TableTransformerForObjectDetection;A.TableTransformerModel;A.TableTransformerObjectDetectionOutput;A.TableTransformerPreTrainedModel;A.TemperatureLogitsWarper;A.Tensor;A.Text2TextGenerationPipeline;A.TextClassificationPipeline;A.TextGenerationPipeline;A.TextStreamer;A.TextToAudioPipeline;A.TokenClassificationPipeline;A.TokenClassifierOutput;A.TokenizerModel;A.TopKLogitsWarper;A.TopPLogitsWarper;A.TrOCRForCausalLM;A.TrOCRPreTrainedModel;A.TranslationPipeline;A.UniSpeechForCTC;A.UniSpeechForSequenceClassification;A.UniSpeechModel;A.UniSpeechPreTrainedModel;A.UniSpeechSatForAudioFrameClassification;A.UniSpeechSatForCTC;A.UniSpeechSatForSequenceClassification;A.UniSpeechSatModel;A.UniSpeechSatPreTrainedModel;A.VLChatProcessor;A.VLMImageProcessor;A.ViTFeatureExtractor;A.ViTForImageClassification;A.ViTImageProcessor;A.ViTMAEModel;A.ViTMAEPreTrainedModel;A.ViTMSNForImageClassification;A.ViTMSNModel;A.ViTMSNPreTrainedModel;A.ViTModel;A.ViTPreTrainedModel;A.VisionEncoderDecoderModel;A.VitMatteForImageMatting;A.VitMatteImageProcessor;A.VitMattePreTrainedModel;A.VitPoseForPoseEstimation;A.VitPoseImageProcessor;A.VitPosePreTrainedModel;A.VitsModel;A.VitsModelOutput;A.VitsPreTrainedModel;A.VitsTokenizer;A.Wav2Vec2BertForCTC;A.Wav2Vec2BertForSequenceClassification;A.Wav2Vec2BertModel;A.Wav2Vec2BertPreTrainedModel;A.Wav2Vec2CTCTokenizer;A.Wav2Vec2FeatureExtractor;A.Wav2Vec2ForAudioFrameClassification;A.Wav2Vec2ForCTC;A.Wav2Vec2ForSequenceClassification;A.Wav2Vec2Model;A.Wav2Vec2PreTrainedModel;A.Wav2Vec2ProcessorWithLM;A.WavLMForAudioFrameClassification;A.WavLMForCTC;A.WavLMForSequenceClassification;A.WavLMForXVector;A.WavLMModel;A.WavLMPreTrainedModel;A.WeSpeakerFeatureExtractor;A.WeSpeakerResNetModel;A.WeSpeakerResNetPreTrainedModel;A.WhisperFeatureExtractor;A.WhisperForConditionalGeneration;A.WhisperModel;A.WhisperPreTrainedModel;A.WhisperProcessor;A.WhisperTextStreamer;A.WhisperTimeStampLogitsProcessor;A.WhisperTokenizer;A.XLMForQuestionAnswering;A.XLMForSequenceClassification;A.XLMForTokenClassification;A.XLMModel;A.XLMPreTrainedModel;A.XLMRobertaForMaskedLM;A.XLMRobertaForQuestionAnswering;A.XLMRobertaForSequenceClassification;A.XLMRobertaForTokenClassification;A.XLMRobertaModel;A.XLMRobertaPreTrainedModel;A.XLMRobertaTokenizer;A.XLMTokenizer;A.XLMWithLMHeadModel;A.XVectorOutput;A.YolosFeatureExtractor;A.YolosForObjectDetection;A.YolosImageProcessor;A.YolosModel;A.YolosObjectDetectionOutput;A.YolosPreTrainedModel;A.ZeroShotAudioClassificationPipeline;A.ZeroShotClassificationPipeline;A.ZeroShotImageClassificationPipeline;A.ZeroShotObjectDetectionPipeline;A.bankers_round;A.cat;A.cos_sim;A.dot;A.dynamic_time_warping;A.env;A.full;A.full_like;A.getKeyValueShapes;A.hamming;A.hanning;A.interpolate;A.interpolate_4d;A.interpolate_data;A.is_chinese_char;A.layer_norm;A.load_image;A.log_softmax;A.magnitude;A.matmul;A.max;A.mean;A.mean_pooling;A.medianFilter;A.mel_filter_bank;A.min;A.ones;A.ones_like;A.permute;A.permute_data;var TH=A.pipeline;A.quantize_embeddings;A.rand;A.read_audio;A.rfft;A.round;A.slice;A.softmax;A.spectrogram;A.stack;A.std_mean;A.topk;A.window_function;A.zeros;A.zeros_like;function a0({className:e,...t}){return R.jsx("div",{className:Kn("animate-pulse rounded-md bg-muted",e),...t})}const EH=({inputText:e,onTokenize:t})=>{const[n,r]=B.useState(!0),[s,o]=B.useState(null),[a,c]=B.useState([]),{toast:u}=JT();B.useEffect(()=>{(async()=>{try{const m=await TH("text-classification","Xenova/bert-base-multilingual-uncased");o(m.tokenizer),r(!1)}catch(m){console.error("Error initializing tokenizer:",m),u({title:"Error",description:"Failed to load tokenizer. Please try again.",variant:"destructive"})}})()},[u]),B.useEffect(()=>{s&&e&&d(e)},[e,s]);const d=async h=>{if(s)try{const m=await s.encode(h),p=m.tokens.map((v,T)=>({text:v,id:m.ids[T]}));c(p),t(p)}catch(m){console.error("Error tokenizing text:",m),u({title:"Tokenization Error",description:"Failed to tokenize the input text.",variant:"destructive"})}};return n?R.jsxs(Qs,{className:"p-4 space-y-4",children:[R.jsx("h3",{className:"text-lg font-semibold",children:"Tokenizer Playground"}),R.jsxs("div",{className:"space-y-2",children:[R.jsx(a0,{className:"h-8 w-full"}),R.jsx(a0,{className:"h-20 w-full"})]})]}):R.jsxs(Qs,{className:"p-4 space-y-4",children:[R.jsx("h3",{className:"text-lg font-semibold",children:"Tokenizer Playground"}),R.jsx("div",{className:"space-y-4",children:R.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.map((h,m)=>R.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[R.jsxs("span",{className:"font-mono text-sm",children:["Token ",m+1,": ",h.text]}),R.jsxs("span",{className:"text-xs text-muted-foreground",children:["ID: ",h.id]})]},m))})})]})},PH=({formula:e,explanation:t})=>R.jsxs("div",{className:"space-y-2",children:[R.jsx(aD,{children:R.jsxs("p",{className:"font-medium",children:["Formula: ",e]})}),R.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap font-mono",children:t})]}),SH=({currentStep:e,stepInfo:t,embeddings:n,output:r})=>{var a,c,u;const s=n.map(d=>({word:d.word,vector:d.vector,positionalEncoding:d.positionalVector,contextualVector:d.contextualVector})),o=`
    ${t.explanation.vectorExplanation}
    
    Token Values:
    ${s.map(d=>{var h,m;return`
      Word: "${d.word}"
      Base Vector: [${d.vector.map(p=>p.toFixed(3)).join(", ")}]
      Position Encoding: [${((h=d.positionalEncoding)==null?void 0:h.map(p=>p.toFixed(3)).join(", "))||""}]
      Context Vector: [${((m=d.contextualVector)==null?void 0:m.map(p=>p.toFixed(3)).join(", "))||""}]
    `}).join(`
`)}
    
    Calculations:
    ${(a=r.intermediateOutputs)!=null&&a.queryVectors?`Query vectors (Q = W_q * X):
       [${r.intermediateOutputs.queryVectors[0].map(d=>d.toFixed(3)).join(", ")}]`:""}
    ${(c=r.intermediateOutputs)!=null&&c.keyVectors?`Key vectors (K = W_k * X):
       [${r.intermediateOutputs.keyVectors[0].map(d=>d.toFixed(3)).join(", ")}]`:""}
    ${(u=r.intermediateOutputs)!=null&&u.valueVectors?`Value vectors (V = W_v * X):
       [${r.intermediateOutputs.valueVectors[0].map(d=>d.toFixed(3)).join(", ")}]`:""}
  `;return we.useEffect(()=>{XT({title:`Step ${e+1}: ${t.title}`,description:R.jsx(PH,{formula:t.formula,explanation:o}),duration:8e3})},[e,t,o]),null},CH=({predictions:e})=>(we.useEffect(()=>{e.length>0&&XT({title:"Next Word Predictions",description:R.jsxs("div",{className:"space-y-2",children:[R.jsx("p",{className:"font-medium",children:"Top 5 predicted next words:"}),e.slice(0,5).map((t,n)=>R.jsxs("div",{className:"flex justify-between",children:[R.jsx("span",{children:t.word}),R.jsxs("span",{className:"font-mono",children:[(t.probability*100).toFixed(1),"%"]})]},n))]}),duration:5e3})},[e]),null),kH=e=>{const t=Math.max(...e),n=e.map(s=>Math.exp(s-t)),r=n.reduce((s,o)=>s+o,0);return n.map(s=>s/r)},Ov=(e,t)=>{const n=[];for(let r=0;r<e.length;r++){n[r]=[];for(let s=0;s<t[0].length;s++){let o=0;for(let a=0;a<t.length;a++)o+=e[r][a]*t[a][s];n[r][s]=o}}return n},AH=(e,t)=>{const n=[];for(let r=0;r<t;r+=2){const s=1/Math.pow(1e4,r/t);n[r]=Math.sin(e*s),n[r+1]=Math.cos(e*s)}return n},$H=e=>e.split(" ").map((r,s)=>{const o=r.split("").reduce((d,h)=>(d=(d<<5)-d+h.charCodeAt(0),d&d),0),a=Array.from({length:8},(d,h)=>Math.sin((o+h)/1e3)*2-1),c=AH(s,8),u=a.map((d,h)=>Number((d+c[h]).toFixed(3)));return{word:r,vector:a.map(d=>Number(d.toFixed(3))),positionalVector:c.map(d=>Number(d.toFixed(3))),contextualVector:u.map(d=>Number(d.toFixed(3)))}}),vA=(e,t)=>{const n=e[0].vector.length,r=e.length,s=()=>{const E=[];for(let O=0;O<r;O++){E[O]=[];const b=Array(r).fill(0).map(()=>Math.random()*2-1);E[O]=kH(b)}return E},o=()=>Array(n).fill(0).map(()=>Array(n).fill(0).map(()=>Number((Math.random()*2-1).toFixed(3)))),a=o(),c=o(),u=o(),d=e.map(E=>E.contextualVector),h=Ov(d,a),m=Ov(d,c),p=Ov(d,u),v=s(),T=Ov(v,p);return{inputEmbeddings:e,outputEmbeddings:e.map((E,O)=>({...E,contextualVector:T[O].map(b=>Number(b.toFixed(3)))})),attentionWeights:v,intermediateOutputs:{queryVectors:h,keyVectors:m,valueVectors:p,weightedSum:T}}},IH=e=>{const t=e.outputEmbeddings[e.outputEmbeddings.length-1].contextualVector;return t?["the","is","are","was","were","will","would","could","should","may","might","must","can","shall","have","has","had","been","being","do"].map(s=>{const o=s.split("").reduce((c,u)=>(c=(c<<5)-c+u.charCodeAt(0),c&c),0),a=Math.abs(Math.sin(o+t.reduce((c,u)=>c+u,0)));return{word:s,probability:a}}).sort((s,o)=>o.probability-s.probability):[]},OH=()=>{const[e,t]=B.useState(""),[n,r]=B.useState(""),[s,o]=B.useState(!1),[a,c]=B.useState(0),[u,d]=B.useState(!1),[h,m]=B.useState(.1),[p,v]=B.useState([]),[T,E]=B.useState([]),[O,b]=B.useState([]),[M,I]=B.useState([]),[k,$]=B.useState([]),{toast:P}=JT(),D=Ti.length+Jv.length,j=oe=>{$(oe)},Y=()=>{if(a<D-1)try{const oe=vA(p,a+1);b(re=>[...re,oe]),c(re=>re+1);const de=a<Ti.length?Ti[a]:Jv[a-Ti.length];if(a>=Ti.length){const re=IH(oe);I(re)}}catch(oe){console.error("Error in processing step:",oe),P({title:"Error Processing Step",description:"There was an error processing this transformation step.",variant:"destructive"})}},q=()=>{if(!e){P({title:"Input Required",description:"Please enter some text to process.",variant:"destructive"});return}o(!0),c(0),r(""),b([]),I([]);try{const oe=$H(e);v(oe);const de=Array(oe.length).fill(0).map(()=>Array(oe.length).fill(0).map(()=>Number(Math.random().toFixed(2))));E(de);const re=vA(oe,0);b([re]),P({title:"Token Processing Started",description:R.jsxs("div",{className:"space-y-2",children:[R.jsxs("p",{className:"font-medium",children:["Input text tokenized into ",oe.length," tokens"]}),R.jsx("div",{className:"text-sm text-muted-foreground",children:oe.map((he,ue)=>R.jsxs("div",{className:"mt-1",children:[R.jsxs("span",{className:"font-semibold",children:["Token ",ue+1,":"]})," ",he.word]},ue))})]}),duration:5e3})}catch(oe){console.error("Error in initial processing:",oe),o(!1),P({title:"Processing Error",description:"Failed to process input text. Please try again.",variant:"destructive"})}};return R.jsx(oD,{children:R.jsx(Nt.div,{initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.7,ease:"easeOut",staggerChildren:.2}}},className:"space-y-8",children:R.jsxs(Qs,{className:"p-6 space-y-6 overflow-hidden bg-gradient-to-br from-white to-gray-50",children:[R.jsx(QK,{title:"Transformer Architecture Visualization"}),R.jsx(yH,{inputText:e,setInputText:t,outputText:n,learningRate:h,setLearningRate:m,handleProcess:q,isProcessing:s}),R.jsx(EH,{inputText:e,onTokenize:j}),p.length>0&&R.jsxs(R.Fragment,{children:[R.jsx(Nt.div,{variants:{},className:"mb-6",children:R.jsx(xH,{tokens:p,currentStep:a,tokenizedOutput:k})}),a>0&&O[a-1]&&R.jsx(SH,{currentStep:a-1,stepInfo:a<=Ti.length?Ti[a-1]:Jv[a-Ti.length-1],embeddings:p,output:O[a-1]}),R.jsx(CH,{predictions:M})]}),R.jsx(Nt.div,{variants:{},children:R.jsx(GK,{isPaused:u,setIsPaused:d,handleNextStep:Y,isProcessing:s,canProgress:a<D-1})}),R.jsx(Nt.div,{variants:{},whileHover:{scale:1.02},transition:{duration:.2},children:R.jsx(qK,{currentStep:a,layerOutputs:O,nextWordProbabilities:M})}),R.jsx(bH,{currentStep:a,embeddings:p,attentionWeights:T,nextWordProbabilities:M}),M.length>0&&R.jsx(MH,{predictions:M})]})})})},DH={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},LH=()=>R.jsxs(Nt.div,{variants:DH,className:"space-y-6",children:[R.jsx("h2",{className:"text-3xl font-bold text-primary mb-4",children:"Understanding Transformers & Large Language Models"}),R.jsx("p",{className:"text-lg text-gray-600",children:'Transformers are powerful neural networks that revolutionized natural language processing through their innovative attention mechanism, as introduced in the paper "Attention Is All You Need". They form the foundation for modern language models and enable a wide range of applications from text processing to multimodal tasks.'}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[R.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[R.jsx("h3",{className:"text-xl font-semibold text-primary mb-3",children:"Key Capabilities"}),R.jsxs("ul",{className:"space-y-2 text-gray-700",children:[R.jsx("li",{children:"• Text tokenization and embedding generation"}),R.jsx("li",{children:"• Semantic search and retrieval"}),R.jsx("li",{children:"• Conversation memory management"}),R.jsx("li",{children:"• Multimodal processing capabilities"})]})]}),R.jsxs("div",{className:"bg-indigo-50 p-6 rounded-lg",children:[R.jsx("h3",{className:"text-xl font-semibold text-primary mb-3",children:"Applications"}),R.jsxs("ul",{className:"space-y-2 text-gray-700",children:[R.jsx("li",{children:"• Dense retrieval and RAG systems"}),R.jsx("li",{children:"• Named-entity recognition"}),R.jsx("li",{children:"• Few-shot classification"}),R.jsx("li",{children:"• Text generation and completion"})]})]})]})]}),FH=()=>R.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg shadow-sm",children:[R.jsx("h3",{className:"font-semibold text-lg text-blue-900 mb-4",children:"Key Architectural Features"}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[R.jsxs("div",{className:"space-y-2",children:[R.jsx("h4",{className:"font-medium text-blue-800",children:"Processing Capabilities"}),R.jsxs("ul",{className:"space-y-2 text-blue-700",children:[R.jsxs("li",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"text-blue-500",children:"•"}),"Parallel sequence processing"]}),R.jsxs("li",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"text-blue-500",children:"•"}),"Long-range dependency handling"]})]})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("h4",{className:"font-medium text-blue-800",children:"Attention Mechanisms"}),R.jsxs("ul",{className:"space-y-2 text-blue-700",children:[R.jsxs("li",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"text-blue-500",children:"•"}),"Multi-head attention architecture"]}),R.jsxs("li",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"text-blue-500",children:"•"}),"Context-aware representations"]})]})]})]})]}),RH={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},jH=()=>R.jsxs(Nt.div,{variants:RH,className:"space-y-6",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-xl font-semibold text-primary mb-3",children:"How Transformers Work"}),R.jsx("p",{className:"text-gray-600",children:"A transformer processes text in three main steps: first, it converts words into numbers (embedding), then adds position information, and finally looks at how words relate to each other (attention). This helps it understand the meaning of sentences just like we do!"})]}),R.jsx(FH,{})]}),NH={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},zH=()=>R.jsx(Nt.div,{variants:NH,className:"space-y-6",children:R.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[R.jsx("div",{className:"max-w-sm mx-auto",children:R.jsx("img",{src:"/lovable-uploads/920119ca-4a91-4285-a54b-f7c7a01af8fa.png",alt:"Transformer Architecture Diagram",className:Kn("rounded-lg shadow-md w-full h-auto","hover:shadow-lg transition-shadow duration-300","border border-gray-100")})}),R.jsx("p",{className:"text-sm text-gray-600 text-center italic",children:"The transformer architecture showing how information flows through the model"})]})}),BH=({title:e,description:t,detailedExplanation:n,formula:r,formulaDescription:s,isLoading:o})=>R.jsx(Nt.div,{className:Kn("bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow","border border-gray-100"),whileHover:{scale:1.01},transition:{duration:.2},children:R.jsxs("div",{className:"space-y-4",children:[R.jsx("h4",{className:"text-lg sm:text-xl font-bold text-primary",children:e}),R.jsx("p",{className:"text-gray-600",children:t}),R.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg",children:[R.jsx("p",{className:"text-sm text-gray-700 mb-4",children:n}),R.jsxs("div",{className:"bg-white/80 backdrop-blur-sm p-4 rounded-lg",children:[R.jsx("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Mathematical Formula:"}),R.jsx("div",{className:"my-4 overflow-x-auto mathjax",children:R.jsx(aD,{inline:!1,children:r})}),R.jsx("p",{className:"text-sm text-gray-600 mt-2 italic",children:s})]})]})]})}),wA={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut"}}},VH=({steps:e,isLoading:t})=>{const n=[{title:"Input Embeddings",description:"Converting words into numerical vectors",detailedExplanation:"Each word is transformed into a dense vector representation that captures semantic meaning. The embedding layer learns to map similar words to similar vector spaces, enabling the model to understand relationships between words. This process converts discrete word tokens into continuous vector spaces where semantic relationships can be measured.",formula:"\\[\\mathbf{x} = \\text{Embedding}(\\text{word})\\]",formulaDescription:"Words are transformed into continuous vector representations in a high-dimensional space",category:"embedding"},{title:"Positional Encoding",description:"Adding position information to embeddings",detailedExplanation:"Since transformers process all words simultaneously, positional encodings are added to provide information about word order. These encodings use sine and cosine functions of different frequencies to create unique patterns for each position, allowing the model to understand the sequential nature of language while maintaining parallel processing capabilities.",formula:"\\[PE_{(pos,2i)} = \\sin\\left(\\frac{pos}{10000^{2i/d}}\\right)\\]",formulaDescription:"Position information is encoded using sinusoidal functions with varying frequencies",category:"encoding"},{title:"Multi-Head Attention",description:"Parallel attention computation",detailedExplanation:"Multiple attention heads process the input in parallel, each focusing on different aspects of the relationships between words. This mechanism allows the model to capture various types of dependencies and patterns simultaneously. Each head can learn to attend to different aspects of the input, such as syntactic structure, semantic relationships, or long-range dependencies.",formula:"\\[\\text{Attention}(Q,K,V) = \\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d_k}}\\right)V\\]",formulaDescription:"Multiple attention mechanisms operate in parallel to capture different relationship patterns",category:"attention"},{title:"Feed-Forward Networks",description:"Advanced Neural Processing",detailedExplanation:"The Feed-Forward Network (FFN) in transformers consists of two linear transformations with a ReLU activation in between. Each position flows through this network independently, allowing the model to process and transform the attention outputs. The first linear layer typically expands the dimensionality (often by a factor of 4), while the second layer projects back to the model's hidden size. This expansion and contraction pattern helps the model learn complex relationships and feature interactions.",formula:"\\[\\text{FFN}(x) = \\text{Linear}_2(\\text{ReLU}(\\text{Linear}_1(x)))\\]",formulaDescription:"Two-layer neural network with ReLU activation enabling complex feature learning",category:"feedforward"},{title:"Layer Normalization",description:"Advanced Network Stabilization",detailedExplanation:"Layer Normalization is crucial for transformer stability and training efficiency. It operates by normalizing the inputs across the feature dimension, computing mean and variance for each layer independently. The normalized values are then scaled and shifted using learnable parameters γ (scale) and β (shift). This normalization helps prevent internal covariate shift, enables faster training, and allows for deeper networks. Unlike batch normalization, it operates on each sample independently, making it particularly suitable for sequence processing tasks.",formula:"\\[\\text{LayerNorm}(x) = \\gamma \\cdot \\frac{x - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}} + \\beta\\]",formulaDescription:"Feature-wise normalization with learnable scale and shift parameters",category:"normalization"}];return R.jsx(Nt.div,{className:"w-full max-w-4xl mx-auto space-y-8 p-4",initial:"hidden",animate:"visible",variants:wA,children:R.jsx(Nt.ol,{className:"space-y-8",children:n.map((r,s)=>R.jsx(Nt.li,{variants:wA,custom:s,className:"list-none",children:R.jsx(Qs,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:R.jsx(BH,{...r,isLoading:t})})},s))})})},UH=()=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,staggerChildren:.2}}},t=[{title:"Input Embedding",description:"Converting words into numerical vectors",detailedExplanation:"Each word is transformed into a vector (list of numbers) that captures its meaning. Similar words will have similar vector representations, helping the model understand relationships between words.",formula:"\\[\\mathbf{x} = \\text{Embedding}(\\text{word})\\]",formulaDescription:"Words are transformed into vectors through embedding",category:"embedding"},{title:"Positional Encoding",description:"Adding position information",detailedExplanation:"Since transformers process all words at once, we need to add information about where each word appears in the sentence. We use special mathematical functions (sine and cosine waves) to create unique patterns for each position.",formula:"\\[PE_{(pos,2i)} = \\sin\\left(\\frac{pos}{10000^{2i/d}}\\right)\\]",formulaDescription:"Position encoding uses sine waves to encode word positions",category:"encoding"},{title:"Self-Attention",description:"Finding relationships between words",detailedExplanation:"The transformer looks at how each word relates to every other word in the sentence. This is like understanding context - how the meaning of a word can change based on the words around it.",formula:"\\[\\text{Attention}(Q,K,V) = \\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d_k}}\\right)V\\]",formulaDescription:"Attention mechanism uses scaled dot-product to weight the values",category:"attention"}];return R.jsxs(Nt.div,{variants:e,initial:"hidden",animate:"visible",className:"space-y-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[R.jsx(LH,{}),R.jsxs(Nt.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[R.jsx(jH,{}),R.jsx(zH,{})]}),R.jsx(VH,{steps:t,isLoading:!1})]})};function WH(e,t){return B.useReducer((n,r)=>t[n][r]??n,e)}var o2="ScrollArea",[sF,FY]=tf(o2),[GH,Ii]=sF(o2),iF=B.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:o=600,...a}=e,[c,u]=B.useState(null),[d,h]=B.useState(null),[m,p]=B.useState(null),[v,T]=B.useState(null),[E,O]=B.useState(null),[b,M]=B.useState(0),[I,k]=B.useState(0),[$,P]=B.useState(!1),[D,j]=B.useState(!1),Y=Er(t,oe=>u(oe)),q=k1(s);return R.jsx(GH,{scope:n,type:r,dir:q,scrollHideDelay:o,scrollArea:c,viewport:d,onViewportChange:h,content:m,onContentChange:p,scrollbarX:v,onScrollbarXChange:T,scrollbarXEnabled:$,onScrollbarXEnabledChange:P,scrollbarY:E,onScrollbarYChange:O,scrollbarYEnabled:D,onScrollbarYEnabledChange:j,onCornerWidthChange:M,onCornerHeightChange:k,children:R.jsx(Nn.div,{dir:q,...a,ref:Y,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":I+"px",...e.style}})})});iF.displayName=o2;var oF="ScrollAreaViewport",aF=B.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,asChild:s,nonce:o,...a}=e,c=Ii(oF,n),u=B.useRef(null),d=Er(t,u,c.onViewportChange);return R.jsxs(R.Fragment,{children:[R.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:o}),R.jsx(Nn.div,{"data-radix-scroll-area-viewport":"",...a,asChild:s,ref:d,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...e.style},children:tq({asChild:s,children:r},h=>R.jsx("div",{"data-radix-scroll-area-content":"",ref:c.onContentChange,style:{minWidth:c.scrollbarXEnabled?"fit-content":void 0},children:h}))})]})});aF.displayName=oF;var Ro="ScrollAreaScrollbar",a2=B.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ii(Ro,e.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:a}=s,c=e.orientation==="horizontal";return B.useEffect(()=>(c?o(!0):a(!0),()=>{c?o(!1):a(!1)}),[c,o,a]),s.type==="hover"?R.jsx(KH,{...r,ref:t,forceMount:n}):s.type==="scroll"?R.jsx(HH,{...r,ref:t,forceMount:n}):s.type==="auto"?R.jsx(lF,{...r,ref:t,forceMount:n}):s.type==="always"?R.jsx(l2,{...r,ref:t}):null});a2.displayName=Ro;var KH=B.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ii(Ro,e.__scopeScrollArea),[o,a]=B.useState(!1);return B.useEffect(()=>{const c=s.scrollArea;let u=0;if(c){const d=()=>{window.clearTimeout(u),a(!0)},h=()=>{u=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return c.addEventListener("pointerenter",d),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",d),c.removeEventListener("pointerleave",h)}}},[s.scrollArea,s.scrollHideDelay]),R.jsx(Dl,{present:n||o,children:R.jsx(lF,{"data-state":o?"visible":"hidden",...r,ref:t})})}),HH=B.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ii(Ro,e.__scopeScrollArea),o=e.orientation==="horizontal",a=I1(()=>u("SCROLL_END"),100),[c,u]=WH("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return B.useEffect(()=>{if(c==="idle"){const d=window.setTimeout(()=>u("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(d)}},[c,s.scrollHideDelay,u]),B.useEffect(()=>{const d=s.viewport,h=o?"scrollLeft":"scrollTop";if(d){let m=d[h];const p=()=>{const v=d[h];m!==v&&(u("SCROLL"),a()),m=v};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[s.viewport,o,u,a]),R.jsx(Dl,{present:n||c!=="hidden",children:R.jsx(l2,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:vn(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:vn(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),lF=B.forwardRef((e,t)=>{const n=Ii(Ro,e.__scopeScrollArea),{forceMount:r,...s}=e,[o,a]=B.useState(!1),c=e.orientation==="horizontal",u=I1(()=>{if(n.viewport){const d=n.viewport.offsetWidth<n.viewport.scrollWidth,h=n.viewport.offsetHeight<n.viewport.scrollHeight;a(c?d:h)}},10);return Xh(n.viewport,u),Xh(n.content,u),R.jsx(Dl,{present:r||o,children:R.jsx(l2,{"data-state":o?"visible":"hidden",...s,ref:t})})}),l2=B.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=Ii(Ro,e.__scopeScrollArea),o=B.useRef(null),a=B.useRef(0),[c,u]=B.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=fF(c.viewport,c.content),h={...r,sizes:c,onSizesChange:u,hasThumb:d>0&&d<1,onThumbChange:p=>o.current=p,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:p=>a.current=p};function m(p,v){return ZH(p,a.current,c,v)}return n==="horizontal"?R.jsx(qH,{...h,ref:t,onThumbPositionChange:()=>{if(s.viewport&&o.current){const p=s.viewport.scrollLeft,v=bA(p,c,s.dir);o.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollLeft=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollLeft=m(p,s.dir))}}):n==="vertical"?R.jsx(QH,{...h,ref:t,onThumbPositionChange:()=>{if(s.viewport&&o.current){const p=s.viewport.scrollTop,v=bA(p,c);o.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollTop=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollTop=m(p))}}):null}),qH=B.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,o=Ii(Ro,e.__scopeScrollArea),[a,c]=B.useState(),u=B.useRef(null),d=Er(t,u,o.onScrollbarXChange);return B.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),R.jsx(uF,{"data-orientation":"horizontal",...s,ref:d,sizes:n,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$1(n)+"px",...e.style},onThumbPointerDown:h=>e.onThumbPointerDown(h.x),onDragScroll:h=>e.onDragScroll(h.x),onWheelScroll:(h,m)=>{if(o.viewport){const p=o.viewport.scrollLeft+h.deltaX;e.onWheelScroll(p),mF(p,m)&&h.preventDefault()}},onResize:()=>{u.current&&o.viewport&&a&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:zw(a.paddingLeft),paddingEnd:zw(a.paddingRight)}})}})}),QH=B.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,o=Ii(Ro,e.__scopeScrollArea),[a,c]=B.useState(),u=B.useRef(null),d=Er(t,u,o.onScrollbarYChange);return B.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),R.jsx(uF,{"data-orientation":"vertical",...s,ref:d,sizes:n,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$1(n)+"px",...e.style},onThumbPointerDown:h=>e.onThumbPointerDown(h.y),onDragScroll:h=>e.onDragScroll(h.y),onWheelScroll:(h,m)=>{if(o.viewport){const p=o.viewport.scrollTop+h.deltaY;e.onWheelScroll(p),mF(p,m)&&h.preventDefault()}},onResize:()=>{u.current&&o.viewport&&a&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:zw(a.paddingTop),paddingEnd:zw(a.paddingBottom)}})}})}),[YH,cF]=sF(Ro),uF=B.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:o,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:d,onWheelScroll:h,onResize:m,...p}=e,v=Ii(Ro,n),[T,E]=B.useState(null),O=Er(t,Y=>E(Y)),b=B.useRef(null),M=B.useRef(""),I=v.viewport,k=r.content-r.viewport,$=Qr(h),P=Qr(u),D=I1(m,10);function j(Y){if(b.current){const q=Y.clientX-b.current.left,oe=Y.clientY-b.current.top;d({x:q,y:oe})}}return B.useEffect(()=>{const Y=q=>{const oe=q.target;(T==null?void 0:T.contains(oe))&&$(q,k)};return document.addEventListener("wheel",Y,{passive:!1}),()=>document.removeEventListener("wheel",Y,{passive:!1})},[I,T,k,$]),B.useEffect(P,[r,P]),Xh(T,D),Xh(v.content,D),R.jsx(YH,{scope:n,scrollbar:T,hasThumb:s,onThumbChange:Qr(o),onThumbPointerUp:Qr(a),onThumbPositionChange:P,onThumbPointerDown:Qr(c),children:R.jsx(Nn.div,{...p,ref:O,style:{position:"absolute",...p.style},onPointerDown:vn(e.onPointerDown,Y=>{Y.button===0&&(Y.target.setPointerCapture(Y.pointerId),b.current=T.getBoundingClientRect(),M.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),j(Y))}),onPointerMove:vn(e.onPointerMove,j),onPointerUp:vn(e.onPointerUp,Y=>{const q=Y.target;q.hasPointerCapture(Y.pointerId)&&q.releasePointerCapture(Y.pointerId),document.body.style.webkitUserSelect=M.current,v.viewport&&(v.viewport.style.scrollBehavior=""),b.current=null})})})}),Nw="ScrollAreaThumb",dF=B.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=cF(Nw,e.__scopeScrollArea);return R.jsx(Dl,{present:n||s.hasThumb,children:R.jsx(XH,{ref:t,...r})})}),XH=B.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,o=Ii(Nw,n),a=cF(Nw,n),{onThumbPositionChange:c}=a,u=Er(t,m=>a.onThumbChange(m)),d=B.useRef(),h=I1(()=>{d.current&&(d.current(),d.current=void 0)},100);return B.useEffect(()=>{const m=o.viewport;if(m){const p=()=>{if(h(),!d.current){const v=eq(m,c);d.current=v,c()}};return c(),m.addEventListener("scroll",p),()=>m.removeEventListener("scroll",p)}},[o.viewport,h,c]),R.jsx(Nn.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:vn(e.onPointerDownCapture,m=>{const v=m.target.getBoundingClientRect(),T=m.clientX-v.left,E=m.clientY-v.top;a.onThumbPointerDown({x:T,y:E})}),onPointerUp:vn(e.onPointerUp,a.onThumbPointerUp)})});dF.displayName=Nw;var c2="ScrollAreaCorner",hF=B.forwardRef((e,t)=>{const n=Ii(c2,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?R.jsx(JH,{...e,ref:t}):null});hF.displayName=c2;var JH=B.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=Ii(c2,n),[o,a]=B.useState(0),[c,u]=B.useState(0),d=!!(o&&c);return Xh(s.scrollbarX,()=>{var m;const h=((m=s.scrollbarX)==null?void 0:m.offsetHeight)||0;s.onCornerHeightChange(h),u(h)}),Xh(s.scrollbarY,()=>{var m;const h=((m=s.scrollbarY)==null?void 0:m.offsetWidth)||0;s.onCornerWidthChange(h),a(h)}),d?R.jsx(Nn.div,{...r,ref:t,style:{width:o,height:c,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function zw(e){return e?parseInt(e,10):0}function fF(e,t){const n=e/t;return isNaN(n)?0:n}function $1(e){const t=fF(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function ZH(e,t,n,r="ltr"){const s=$1(n),o=s/2,a=t||o,c=s-a,u=n.scrollbar.paddingStart+a,d=n.scrollbar.size-n.scrollbar.paddingEnd-c,h=n.content-n.viewport,m=r==="ltr"?[0,h]:[h*-1,0];return pF([u,d],m)(e)}function bA(e,t,n="ltr"){const r=$1(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=t.scrollbar.size-s,a=t.content-t.viewport,c=o-r,u=n==="ltr"?[0,a]:[a*-1,0],d=s2(e,u);return pF([0,a],[0,c])(d)}function pF(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function mF(e,t){return e>0&&e<t}var eq=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const o={left:e.scrollLeft,top:e.scrollTop},a=n.left!==o.left,c=n.top!==o.top;(a||c)&&t(),n=o,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function I1(e,t){const n=Qr(e),r=B.useRef(0);return B.useEffect(()=>()=>window.clearTimeout(r.current),[]),B.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Xh(e,t){const n=Qr(t);to(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}function tq(e,t){const{asChild:n,children:r}=e;if(!n)return typeof t=="function"?t(r):t;const s=B.Children.only(r);return B.cloneElement(s,{children:typeof t=="function"?t(s.props.children):t})}var gF=iF,nq=aF,rq=hF;const _F=B.forwardRef(({className:e,children:t,...n},r)=>R.jsxs(gF,{ref:r,className:Kn("relative overflow-hidden",e),...n,children:[R.jsx(nq,{className:"h-full w-full rounded-[inherit]",children:t}),R.jsx(yF,{}),R.jsx(rq,{})]}));_F.displayName=gF.displayName;const yF=B.forwardRef(({className:e,orientation:t="vertical",...n},r)=>R.jsx(a2,{ref:r,orientation:t,className:Kn("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:R.jsx(dF,{className:"relative flex-1 rounded-full bg-border"})}));yF.displayName=a2.displayName;const sq=({title:e,description:t,url:n})=>R.jsxs(Nt.div,{className:"p-4 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[R.jsx("h4",{className:"font-semibold text-lg text-primary",children:e}),R.jsx("p",{className:"text-gray-600 mt-1",children:t}),R.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 mt-2 inline-block",children:"View Resources →"})]}),iq=[{title:"Best Courses",description:"Stanford CS231N (CNNs), CS224D (NLP), Andrew Ng's ML Course, and more top-rated courses.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#best-courses",category:"courses"},{title:"Important Deep Learning Papers",description:"Collection of influential papers including AlexNet, GoogLeNet, ResNet, and GANs.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#most-important-deep-learning-papers",category:"research"},{title:"ML Tech Talks",description:"Curated talks from leading researchers and practitioners in ML/AI.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#ml-tech-talks",category:"talks"},{title:"Best ML/AI Blogs",description:"Top blogs including Andrej Karpathy, Google Research, DeepMind, and more.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#best-blogs",category:"blogs"},{title:"Neural Networks Guide",description:"Comprehensive resources for understanding neural networks, including 3Blue1Brown series.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#neural-networks",category:"neural-networks"},{title:"CNN Resources",description:"In-depth materials about Convolutional Neural Networks and their applications.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#cnns",category:"cnn"},{title:"NLP Resources",description:"Natural Language Processing resources and best practices.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#nlp",category:"nlp"},{title:"Deep Reinforcement Learning",description:"Resources and articles about Deep RL implementation and theory.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#deep-reinforcement-learning",category:"reinforcement-learning"},{title:"ML Project Advice",description:"Practical tips and best practices for ML projects.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#ml-project-advice",category:"advice"},{title:"Debugging ML Models",description:"Comprehensive guide on debugging and improving ML models.",url:"https://github.com/adeshpande3/Machine-Learning-Links-And-Lessons-Learned#debugging-ml-models",category:"debugging"}],oq=()=>R.jsxs(Qs,{className:"p-6",children:[R.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Essential Learning Resources"}),R.jsx(_F,{className:"h-[500px] pr-4",children:R.jsx("div",{className:"space-y-4",children:iq.map((e,t)=>R.jsx(sq,{...e},t))})})]}),aq={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{duration:.4,ease:"easeOut"}}},Xd={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},lq=({title:e,description:t,icon:n,content:r,analogy:s})=>R.jsx(Nt.div,{variants:aq,children:R.jsxs(Qs,{className:"p-6 h-full bg-white hover:shadow-lg transition-shadow",children:[R.jsxs(Nt.div,{className:"flex items-start gap-4",variants:Xd,children:[R.jsx("span",{className:"text-4xl",children:n}),R.jsxs("div",{className:"space-y-2",children:[R.jsx(Nt.h3,{className:"text-xl font-semibold text-primary",variants:Xd,children:e}),R.jsx(Nt.p,{className:"text-muted-foreground",variants:Xd,children:t})]})]}),R.jsxs(Nt.div,{className:"mt-4 space-y-4",variants:Xd,children:[R.jsx(Nt.p,{className:"text-gray-600",variants:Xd,children:r}),R.jsx(Nt.div,{className:"bg-muted p-4 rounded-lg",variants:Xd,children:R.jsx("p",{className:"italic text-muted-foreground",children:s})})]})]})}),cq=[{title:"Introduction to Transformers",description:"Core concepts and architectural overview",icon:"📚",content:"Transformers represent a breakthrough in neural network architecture, designed to process sequential data through self-attention mechanisms. Introduced in the seminal paper 'Attention is All You Need' (2017), they've become fundamental to modern natural language processing.",analogy:"Consider a Transformer as an advanced information processing system that can simultaneously analyze multiple aspects of data while maintaining contextual relationships."},{title:"Text Processing Pipeline",description:"From raw text to embeddings",icon:"🔤",content:"Understanding how transformers process text involves several key steps: tokenization (breaking down text), embedding creation, and attention computation. This process enables the model to understand and generate human-like text.",analogy:"Think of tokenization like breaking a sentence into meaningful pieces, similar to how we learn to read by recognizing individual words and their combinations."},{title:"Practical Applications",description:"Real-world implementations and use cases",icon:"💡",content:"Transformers power various applications including semantic search, RAG (Retrieval-Augmented Generation), conversation memory management, and multimodal processing. They can be fine-tuned for specific tasks like named-entity recognition and few-shot classification.",analogy:"Like a versatile tool that can be adapted for different tasks, transformers can be specialized for various language processing needs."},{title:"Advanced Concepts",description:"Specialized techniques and optimizations",icon:"🚀",content:"Advanced transformer implementations include techniques like key-value caching for faster generation, dense retrieval for semantic search, and specialized architectures for multimodal processing. Understanding these concepts helps in building more efficient and capable systems.",analogy:"These optimizations are like fine-tuning a high-performance engine - small adjustments that lead to significant improvements in speed and efficiency."},{title:"Model Training & Evaluation",description:"Fine-tuning and benchmarking",icon:"📊",content:"The process of adapting transformers for specific tasks involves fine-tuning pretrained models, freezing layers for efficiency, and rigorous evaluation using benchmarks. This ensures the model performs well on targeted applications while maintaining computational efficiency.",analogy:"Similar to how an athlete trains for specific events while maintaining overall fitness, models can be specialized while preserving their general capabilities."}],uq=()=>R.jsx(Nt.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2}}},children:cq.map((e,t)=>R.jsx(Nt.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},whileHover:{scale:1.02,transition:{duration:.2}},children:R.jsx(lq,{...e})},t))}),dq={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},xA={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},hq=()=>R.jsxs(Nt.div,{className:"space-y-8",initial:"hidden",animate:"visible",variants:dq,children:[R.jsx(Nt.div,{variants:xA,children:R.jsx(UH,{})}),R.jsx(Nt.div,{variants:xA,children:R.jsx(oq,{})}),R.jsx(uq,{})]}),fq=({question:e,onAnswer:t,answered:n,showExplanation:r})=>R.jsxs(Qs,{className:"p-6 max-w-2xl mx-auto animate-slide-in",children:[R.jsxs("div",{className:"mb-6",children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsx("h2",{className:"text-2xl font-bold text-primary",children:e.title}),R.jsx("span",{className:"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm",children:e.difficulty_level})]}),R.jsxs("p",{className:"text-sm text-gray-600 mb-8",children:["Category: ",e.category]})]}),R.jsxs("div",{className:"mb-6",children:[R.jsx("p",{className:"text-lg mb-2",children:e.description}),R.jsx("p",{className:"text-lg mb-4 font-medium",children:e.question}),R.jsx("div",{className:"space-y-4",children:e.options.map((s,o)=>R.jsx(ma,{variant:n&&o===e.correct_answer?"default":"outline",className:`w-full text-left justify-start ${n&&o===e.correct_answer?"bg-green-500 hover:bg-green-600":""}`,onClick:()=>t(o),disabled:n,children:s},o))})]}),r&&R.jsxs("div",{className:"mb-6 p-4 bg-muted rounded-lg animate-fade-in",children:[R.jsx("h3",{className:"font-semibold mb-2",children:"Explanation:"}),R.jsx("p",{className:"text-gray-600",children:e.explanation})]})]});function pq(e,t=[]){let n=[];function r(o,a){const c=B.createContext(a),u=n.length;n=[...n,a];function d(m){const{scope:p,children:v,...T}=m,E=(p==null?void 0:p[e][u])||c,O=B.useMemo(()=>T,Object.values(T));return R.jsx(E.Provider,{value:O,children:v})}function h(m,p){const v=(p==null?void 0:p[e][u])||c,T=B.useContext(v);if(T)return T;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${o}\``)}return d.displayName=o+"Provider",[d,h]}const s=()=>{const o=n.map(a=>B.createContext(a));return function(c){const u=(c==null?void 0:c[e])||o;return B.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return s.scopeName=e,[r,mq(s,...t)]}function mq(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return B.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var u2="Progress",d2=100,[gq,RY]=pq(u2),[_q,yq]=gq(u2),vF=B.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:o=vq,...a}=e;(s||s===0)&&!MA(s)&&console.error(wq(`${s}`,"Progress"));const c=MA(s)?s:d2;r!==null&&!TA(r,c)&&console.error(bq(`${r}`,"Progress"));const u=TA(r,c)?r:null,d=Bw(u)?o(u,c):void 0;return R.jsx(_q,{scope:n,value:u,max:c,children:R.jsx(Nn.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Bw(u)?u:void 0,"aria-valuetext":d,role:"progressbar","data-state":xF(u,c),"data-value":u??void 0,"data-max":c,...a,ref:t})})});vF.displayName=u2;var wF="ProgressIndicator",bF=B.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=yq(wF,n);return R.jsx(Nn.div,{"data-state":xF(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});bF.displayName=wF;function vq(e,t){return`${Math.round(e/t*100)}%`}function xF(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Bw(e){return typeof e=="number"}function MA(e){return Bw(e)&&!isNaN(e)&&e>0}function TA(e,t){return Bw(e)&&!isNaN(e)&&e<=t&&e>=0}function wq(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${d2}\`.`}function bq(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${d2} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var MF=vF,xq=bF;const TF=B.forwardRef(({className:e,value:t,...n},r)=>R.jsx(MF,{ref:r,className:Kn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:R.jsx(xq,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));TF.displayName=MF.displayName;const Mq=({currentQuestion:e,totalQuestions:t,score:n,answered:r,onNext:s})=>{const o=(e+1)/t*100;return R.jsxs("div",{className:"max-w-2xl mx-auto",children:[R.jsx(TF,{value:o,className:"mb-4"}),R.jsxs("div",{className:"flex justify-between items-center",children:[R.jsxs("div",{children:[R.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Question ",e+1," of ",t]}),R.jsxs("div",{className:"text-gray-600",children:["Score: ",n,"/",t]})]}),r&&e<t-1&&R.jsx(ma,{onClick:s,children:"Next Question"})]})]})},Tq=async()=>{const{data:e,error:t}=await So.from("transformer_questions").select("*").order("id");if(t)throw mM.error("Failed to load questions. Please try again."),t;return e||[]},Eq=(e,t,n)=>{e===t?(n(),mM.success("Correct answer! 🎉")):mM.error("Not quite right. Try to understand why!")},Pq=()=>{const[e,t]=B.useState([]),[n,r]=B.useState(0),[s,o]=B.useState(0),[a,c]=B.useState(!1),[u,d]=B.useState(!1),[h,m]=B.useState(!0);B.useEffect(()=>{p()},[]);const p=async()=>{try{const E=await Tq();t(E),m(!1)}catch(E){console.error("Error loading questions:",E),m(!1)}},v=E=>{u||(d(!0),Eq(E,e[n].correct_answer,()=>o(s+1)),c(!0))},T=()=>{n<e.length-1&&(r(n+1),c(!1),d(!1))};return h?R.jsx(Qs,{className:"p-6 max-w-2xl mx-auto",children:R.jsxs("div",{className:"space-y-4",children:[R.jsx(a0,{className:"h-4 w-3/4"}),R.jsx(a0,{className:"h-4 w-1/2"}),R.jsx("div",{className:"space-y-2",children:[1,2,3,4].map(E=>R.jsx(a0,{className:"h-10 w-full"},E))})]})}):e.length?R.jsxs("div",{className:"space-y-6",children:[R.jsx(fq,{question:e[n],onAnswer:v,answered:u,showExplanation:a}),R.jsx(Mq,{currentQuestion:n,totalQuestions:e.length,score:s,answered:u,onNext:T})]}):R.jsx(Qs,{className:"p-6 max-w-2xl mx-auto",children:R.jsx("p",{className:"text-center text-gray-600",children:"No questions available. Please try again later."})})},Sq=[{title:"Foundational Mathematics",resources:[{title:"Khan Academy: Linear Algebra",url:"https://www.khanacademy.org/math/linear-algebra",description:"Learn vectors, matrices, eigenvalues, and SVD."},{title:"MIT OpenCourseWare: Probability and Statistics",url:"https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/",description:"Understand probability distributions, Bayes' theorem, and hypothesis testing."},{title:"Khan Academy: Calculus",url:"https://www.khanacademy.org/math/calculus-1",description:"Master derivatives, gradients, and optimization."}]},{title:"Programming and Tools",resources:[{title:"Python.org",url:"https://www.python.org/",description:"Official Python website for learning Python programming."},{title:"NumPy Documentation",url:"https://numpy.org/doc/",description:"Learn numerical computing with Python."},{title:"Pandas Documentation",url:"https://pandas.pydata.org/docs/",description:"Master data manipulation and analysis."}]},{title:"Core Machine Learning Concepts",resources:[{title:"Coursera: Machine Learning by Andrew Ng",url:"https://www.coursera.org/learn/machine-learning",description:"A beginner-friendly course covering supervised and unsupervised learning."},{title:"Deep Learning Specialization by Andrew Ng",url:"https://www.deeplearning.ai/",description:"A comprehensive course on deep learning."},{title:"Fast.ai Practical Deep Learning",url:"https://www.fast.ai/",description:"A hands-on course for deep learning practitioners."}]},{title:"Deep Learning",resources:[{title:"CS231n: CNNs for Visual Recognition",url:"https://cs231n.github.io/",description:"Learn convolutional neural networks for image tasks."},{title:"Understanding LSTMs",url:"https://colah.github.io/posts/2015-08-Understanding-LSTMs/",description:"A detailed guide to recurrent neural networks."},{title:"The Illustrated Transformer",url:"https://jalammar.github.io/illustrated-transformer/",description:"Learn about transformers and attention mechanisms."}]}],Cq=()=>R.jsx("div",{className:"bg-gradient-to-b from-gray-50 to-white min-h-screen py-8",children:R.jsxs("div",{className:"container mx-auto px-4",children:[R.jsxs("div",{className:"text-center mb-12",children:[R.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"AI/ML Learning Resources"}),R.jsx("p",{className:"text-xl text-gray-600",children:"Your comprehensive guide to mastering Artificial Intelligence and Machine Learning."})]}),R.jsx("div",{className:"space-y-8",children:Sq.map((e,t)=>R.jsxs(Qs,{className:"p-6",children:[R.jsx("h2",{className:"text-2xl font-bold text-primary mb-6 pb-2 border-b-2 border-primary",children:e.title}),R.jsx("ul",{className:"space-y-4",children:e.resources.map((n,r)=>R.jsxs("li",{className:"bg-muted p-4 rounded-lg border-l-4 border-primary hover:shadow-md transition-shadow",children:[R.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-primary hover:underline",children:n.title}),R.jsx("p",{className:"mt-2 text-gray-600",children:n.description})]},r))})]},t))})]})});function EF(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,o;for(o=0;o<r.length;o++)s=r[o],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}var kq=["color"],Aq=B.forwardRef(function(e,t){var n=e.color,r=n===void 0?"currentColor":n,s=EF(e,kq);return B.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s,{ref:t}),B.createElement("path",{d:"M1 2C0.447715 2 0 2.44772 0 3V12C0 12.5523 0.447715 13 1 13H14C14.5523 13 15 12.5523 15 12V3C15 2.44772 14.5523 2 14 2H1ZM1 3L14 3V3.92494C13.9174 3.92486 13.8338 3.94751 13.7589 3.99505L7.5 7.96703L1.24112 3.99505C1.16621 3.94751 1.0826 3.92486 1 3.92494V3ZM1 4.90797V12H14V4.90797L7.74112 8.87995C7.59394 8.97335 7.40606 8.97335 7.25888 8.87995L1 4.90797Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),$q=["color"],Iq=B.forwardRef(function(e,t){var n=e.color,r=n===void 0?"currentColor":n,s=EF(e,$q);return B.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s,{ref:t}),B.createElement("path",{d:"M2 1C1.44772 1 1 1.44772 1 2V13C1 13.5523 1.44772 14 2 14H13C13.5523 14 14 13.5523 14 13V2C14 1.44772 13.5523 1 13 1H2ZM3.05 6H4.95V12H3.05V6ZM5.075 4.005C5.075 4.59871 4.59371 5.08 4 5.08C3.4063 5.08 2.925 4.59871 2.925 4.005C2.925 3.41129 3.4063 2.93 4 2.93C4.59371 2.93 5.075 3.41129 5.075 4.005ZM12 8.35713C12 6.55208 10.8334 5.85033 9.67449 5.85033C9.29502 5.83163 8.91721 5.91119 8.57874 6.08107C8.32172 6.21007 8.05265 6.50523 7.84516 7.01853H7.79179V6.00044H6V12.0047H7.90616V8.8112C7.8786 8.48413 7.98327 8.06142 8.19741 7.80987C8.41156 7.55832 8.71789 7.49825 8.95015 7.46774H9.02258C9.62874 7.46774 10.0786 7.84301 10.0786 8.78868V12.0047H11.9847L12 8.35713Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),h2="Avatar",[Oq,jY]=tf(h2),[Dq,PF]=Oq(h2),SF=B.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[s,o]=B.useState("idle");return R.jsx(Dq,{scope:n,imageLoadingStatus:s,onImageLoadingStatusChange:o,children:R.jsx(Nn.span,{...r,ref:t})})});SF.displayName=h2;var CF="AvatarImage",kF=B.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:s=()=>{},...o}=e,a=PF(CF,n),c=Lq(r,o.referrerPolicy),u=Qr(d=>{s(d),a.onImageLoadingStatusChange(d)});return to(()=>{c!=="idle"&&u(c)},[c,u]),c==="loaded"?R.jsx(Nn.img,{...o,ref:t,src:r}):null});kF.displayName=CF;var AF="AvatarFallback",$F=B.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...s}=e,o=PF(AF,n),[a,c]=B.useState(r===void 0);return B.useEffect(()=>{if(r!==void 0){const u=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(u)}},[r]),a&&o.imageLoadingStatus!=="loaded"?R.jsx(Nn.span,{...s,ref:t}):null});$F.displayName=AF;function Lq(e,t){const[n,r]=B.useState("idle");return to(()=>{if(!e){r("error");return}let s=!0;const o=new window.Image,a=c=>()=>{s&&r(c)};return r("loading"),o.onload=a("loaded"),o.onerror=a("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{s=!1}},[e,t]),n}var IF=SF,OF=kF,DF=$F;const LF=B.forwardRef(({className:e,...t},n)=>R.jsx(IF,{ref:n,className:Kn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));LF.displayName=IF.displayName;const FF=B.forwardRef(({className:e,...t},n)=>R.jsx(OF,{ref:n,className:Kn("aspect-square h-full w-full",e),...t}));FF.displayName=OF.displayName;const RF=B.forwardRef(({className:e,...t},n)=>R.jsx(DF,{ref:n,className:Kn("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));RF.displayName=DF.displayName;const Fq=()=>R.jsx("div",{className:"bg-gradient-to-b from-gray-50 to-white min-h-screen py-8",children:R.jsx("div",{className:"container mx-auto px-4",children:R.jsxs(Qs,{className:"max-w-3xl mx-auto p-8",children:[R.jsxs("div",{className:"text-center mb-8",children:[R.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"About the Author"}),R.jsx("div",{className:"w-20 h-1 bg-primary mx-auto"})]}),R.jsxs("div",{className:"space-y-6",children:[R.jsxs("div",{className:"text-center mb-8",children:[R.jsxs(LF,{className:"w-32 h-32 mx-auto mb-4",children:[R.jsx(FF,{src:"/lovable-uploads/12197fca-c864-4e0a-80bf-7c6137659f47.png",alt:"Dheeraj Vishwakarma",className:"object-cover"}),R.jsx(RF,{children:"DV"})]}),R.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Dheeraj Vishwakarma"}),R.jsx("p",{className:"text-gray-600 mt-2",children:"Senior AI/ML Architect"})]}),R.jsxs("div",{className:"prose max-w-none text-gray-600",children:[R.jsx("p",{className:"mb-4",children:"Experienced Senior Architect leading the charge to revolutionize the telecommunications landscape with the cutting-edge capabilities of AI and ML."}),R.jsx("p",{className:"mb-4",children:"I specialize in enhancing OSS/BSS solutions by infusing advanced AI and ML technologies into key systems such as Ericsson Charging System, Single View Billing System, Oracle Billing and Revenue Management (OBRM), Ericsson Mediation System (EMM), Nokia Flexi CMD (Mediation Zone), and Nokia Eventlink Data Refinery (Comptel Mediation) for VAS and IN Services."}),R.jsx("p",{className:"mb-4",children:"My primary focus involves using AI and ML to boost network performance, optimize resource allocation, and utilize predictive analytics for fault management and customer insights."}),R.jsx("p",{className:"mb-4",children:"My goal is to transform the telecom industry, ensuring it remains at the forefront of innovation by leveraging the potential of AI and ML advancements."})]}),R.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[R.jsxs(ma,{className:"flex items-center gap-2",variant:"outline",onClick:()=>window.open("https://www.linkedin.com/in/dheeraj-vishwakarma-61350918/","_blank"),children:[R.jsx(Iq,{className:"w-5 h-5"}),"Connect on LinkedIn"]}),R.jsxs(ma,{className:"flex items-center gap-2",variant:"outline",onClick:()=>window.open("mailto:dheeraj.vishwakarma@gmail.com"),children:[R.jsx(Aq,{className:"w-5 h-5"}),"Send Email"]})]})]})]})})});function Rq(e,t=[]){let n=[];function r(o,a){const c=B.createContext(a),u=n.length;n=[...n,a];function d(m){const{scope:p,children:v,...T}=m,E=(p==null?void 0:p[e][u])||c,O=B.useMemo(()=>T,Object.values(T));return R.jsx(E.Provider,{value:O,children:v})}function h(m,p){const v=(p==null?void 0:p[e][u])||c,T=B.useContext(v);if(T)return T;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${o}\``)}return d.displayName=o+"Provider",[d,h]}const s=()=>{const o=n.map(a=>B.createContext(a));return function(c){const u=(c==null?void 0:c[e])||o;return B.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return s.scopeName=e,[r,jq(s,...t)]}function jq(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return B.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var fx="rovingFocusGroup.onEntryFocus",Nq={bubbles:!1,cancelable:!0},O1="RovingFocusGroup",[eT,jF,zq]=ZT(O1),[Bq,NF]=Rq(O1,[zq]),[Vq,Uq]=Bq(O1),zF=B.forwardRef((e,t)=>R.jsx(eT.Provider,{scope:e.__scopeRovingFocusGroup,children:R.jsx(eT.Slot,{scope:e.__scopeRovingFocusGroup,children:R.jsx(Wq,{...e,ref:t})})}));zF.displayName=O1;var Wq=B.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:o,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:d,preventScrollOnEntryFocus:h=!1,...m}=e,p=B.useRef(null),v=Er(t,p),T=k1(o),[E=null,O]=s1({prop:a,defaultProp:c,onChange:u}),[b,M]=B.useState(!1),I=Qr(d),k=jF(n),$=B.useRef(!1),[P,D]=B.useState(0);return B.useEffect(()=>{const j=p.current;if(j)return j.addEventListener(fx,I),()=>j.removeEventListener(fx,I)},[I]),R.jsx(Vq,{scope:n,orientation:r,dir:T,loop:s,currentTabStopId:E,onItemFocus:B.useCallback(j=>O(j),[O]),onItemShiftTab:B.useCallback(()=>M(!0),[]),onFocusableItemAdd:B.useCallback(()=>D(j=>j+1),[]),onFocusableItemRemove:B.useCallback(()=>D(j=>j-1),[]),children:R.jsx(Nn.div,{tabIndex:b||P===0?-1:0,"data-orientation":r,...m,ref:v,style:{outline:"none",...e.style},onMouseDown:vn(e.onMouseDown,()=>{$.current=!0}),onFocus:vn(e.onFocus,j=>{const Y=!$.current;if(j.target===j.currentTarget&&Y&&!b){const q=new CustomEvent(fx,Nq);if(j.currentTarget.dispatchEvent(q),!q.defaultPrevented){const oe=k().filter(ye=>ye.focusable),de=oe.find(ye=>ye.active),re=oe.find(ye=>ye.id===E),ue=[de,re,...oe].filter(Boolean).map(ye=>ye.ref.current);UF(ue,h)}}$.current=!1}),onBlur:vn(e.onBlur,()=>M(!1))})})}),BF="RovingFocusGroupItem",VF=B.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:o,...a}=e,c=BI(),u=o||c,d=Uq(BF,n),h=d.currentTabStopId===u,m=jF(n),{onFocusableItemAdd:p,onFocusableItemRemove:v}=d;return B.useEffect(()=>{if(r)return p(),()=>v()},[r,p,v]),R.jsx(eT.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:R.jsx(Nn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...a,ref:t,onMouseDown:vn(e.onMouseDown,T=>{r?d.onItemFocus(u):T.preventDefault()}),onFocus:vn(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:vn(e.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){d.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const E=Hq(T,d.orientation,d.dir);if(E!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let b=m().filter(M=>M.focusable).map(M=>M.ref.current);if(E==="last")b.reverse();else if(E==="prev"||E==="next"){E==="prev"&&b.reverse();const M=b.indexOf(T.currentTarget);b=d.loop?qq(b,M+1):b.slice(M+1)}setTimeout(()=>UF(b))}})})})});VF.displayName=BF;var Gq={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Kq(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Hq(e,t,n){const r=Kq(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Gq[r]}function UF(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function qq(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Qq=zF,Yq=VF,f2="Tabs",[Xq,NY]=tf(f2,[NF]),WF=NF(),[Jq,p2]=Xq(f2),GF=B.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:o,orientation:a="horizontal",dir:c,activationMode:u="automatic",...d}=e,h=k1(c),[m,p]=s1({prop:r,onChange:s,defaultProp:o});return R.jsx(Jq,{scope:n,baseId:BI(),value:m,onValueChange:p,orientation:a,dir:h,activationMode:u,children:R.jsx(Nn.div,{dir:h,"data-orientation":a,...d,ref:t})})});GF.displayName=f2;var KF="TabsList",HF=B.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,o=p2(KF,n),a=WF(n);return R.jsx(Qq,{asChild:!0,...a,orientation:o.orientation,dir:o.dir,loop:r,children:R.jsx(Nn.div,{role:"tablist","aria-orientation":o.orientation,...s,ref:t})})});HF.displayName=KF;var qF="TabsTrigger",QF=B.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...o}=e,a=p2(qF,n),c=WF(n),u=JF(a.baseId,r),d=ZF(a.baseId,r),h=r===a.value;return R.jsx(Yq,{asChild:!0,...c,focusable:!s,active:h,children:R.jsx(Nn.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":d,"data-state":h?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u,...o,ref:t,onMouseDown:vn(e.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?a.onValueChange(r):m.preventDefault()}),onKeyDown:vn(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&a.onValueChange(r)}),onFocus:vn(e.onFocus,()=>{const m=a.activationMode!=="manual";!h&&!s&&m&&a.onValueChange(r)})})})});QF.displayName=qF;var YF="TabsContent",XF=B.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:o,...a}=e,c=p2(YF,n),u=JF(c.baseId,r),d=ZF(c.baseId,r),h=r===c.value,m=B.useRef(h);return B.useEffect(()=>{const p=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(p)},[]),R.jsx(Dl,{present:s||h,children:({present:p})=>R.jsx(Nn.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!p,id:d,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0},children:p&&o})})});XF.displayName=YF;function JF(e,t){return`${e}-trigger-${t}`}function ZF(e,t){return`${e}-content-${t}`}var Zq=GF,eR=HF,tR=QF,nR=XF;const eQ=Zq,rR=B.forwardRef(({className:e,...t},n)=>R.jsx(eR,{ref:n,className:Kn("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));rR.displayName=eR.displayName;const Zd=B.forwardRef(({className:e,...t},n)=>R.jsx(tR,{ref:n,className:Kn("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Zd.displayName=tR.displayName;const eh=B.forwardRef(({className:e,...t},n)=>R.jsx(nR,{ref:n,className:Kn("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));eh.displayName=nR.displayName;const tQ=()=>{const e=yE(),t=async()=>{await So.auth.signOut(),e("/auth")};return R.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white",children:[R.jsx("header",{className:"bg-primary py-6 mb-8 shadow-lg",children:R.jsx("div",{className:"container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:R.jsxs("div",{className:"flex justify-between items-center",children:[R.jsxs("div",{className:"space-y-2",children:[R.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white animate-fade-in",children:"Learn Transformers 🤖"}),R.jsx("p",{className:"text-base sm:text-lg text-white/90 animate-slide-in max-w-xl",children:"A step-by-step guide to understanding AI's most powerful architecture"})]}),R.jsx(ma,{variant:"outline",onClick:t,className:"text-white border-white hover:bg-white/20",children:"Sign Out"})]})})}),R.jsx("main",{className:"container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12",children:R.jsx(gO,{children:R.jsxs(eQ,{defaultValue:"learn",className:"space-y-8",children:[R.jsxs(rR,{className:"w-full max-w-2xl mx-auto grid grid-cols-5 gap-2 p-1 bg-muted rounded-lg",children:[R.jsx(Zd,{value:"learn",className:"data-[state=active]:bg-primary data-[state=active]:text-white px-3 py-2",children:"📚 Learn"}),R.jsx(Zd,{value:"visualize",className:"data-[state=active]:bg-primary data-[state=active]:text-white px-3 py-2",children:"🔍 Visualize"}),R.jsx(Zd,{value:"practice",className:"data-[state=active]:bg-primary data-[state=active]:text-white px-3 py-2",children:"✏️ Practice"}),R.jsx(Zd,{value:"resources",className:"data-[state=active]:bg-primary data-[state=active]:text-white px-3 py-2",children:"📚 Resources"}),R.jsx(Zd,{value:"author",className:"data-[state=active]:bg-primary data-[state=active]:text-white px-3 py-2",children:"👤 Author"})]}),R.jsxs("div",{className:"mt-8 space-y-8",children:[R.jsx(eh,{value:"learn",children:R.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 lg:p-8",children:R.jsx(hq,{})})}),R.jsx(eh,{value:"visualize",children:R.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 lg:p-8",children:R.jsx(OH,{})})}),R.jsx(eh,{value:"practice",children:R.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 lg:p-8",children:R.jsx(Pq,{})})}),R.jsx(eh,{value:"resources",children:R.jsx(Cq,{})}),R.jsx(eh,{value:"author",children:R.jsx(Fq,{})})]})]})})})]})};var EA,er="colors",Ps="sizes",Ut="space",nQ={gap:Ut,gridGap:Ut,columnGap:Ut,gridColumnGap:Ut,rowGap:Ut,gridRowGap:Ut,inset:Ut,insetBlock:Ut,insetBlockEnd:Ut,insetBlockStart:Ut,insetInline:Ut,insetInlineEnd:Ut,insetInlineStart:Ut,margin:Ut,marginTop:Ut,marginRight:Ut,marginBottom:Ut,marginLeft:Ut,marginBlock:Ut,marginBlockEnd:Ut,marginBlockStart:Ut,marginInline:Ut,marginInlineEnd:Ut,marginInlineStart:Ut,padding:Ut,paddingTop:Ut,paddingRight:Ut,paddingBottom:Ut,paddingLeft:Ut,paddingBlock:Ut,paddingBlockEnd:Ut,paddingBlockStart:Ut,paddingInline:Ut,paddingInlineEnd:Ut,paddingInlineStart:Ut,top:Ut,right:Ut,bottom:Ut,left:Ut,scrollMargin:Ut,scrollMarginTop:Ut,scrollMarginRight:Ut,scrollMarginBottom:Ut,scrollMarginLeft:Ut,scrollMarginX:Ut,scrollMarginY:Ut,scrollMarginBlock:Ut,scrollMarginBlockEnd:Ut,scrollMarginBlockStart:Ut,scrollMarginInline:Ut,scrollMarginInlineEnd:Ut,scrollMarginInlineStart:Ut,scrollPadding:Ut,scrollPaddingTop:Ut,scrollPaddingRight:Ut,scrollPaddingBottom:Ut,scrollPaddingLeft:Ut,scrollPaddingX:Ut,scrollPaddingY:Ut,scrollPaddingBlock:Ut,scrollPaddingBlockEnd:Ut,scrollPaddingBlockStart:Ut,scrollPaddingInline:Ut,scrollPaddingInlineEnd:Ut,scrollPaddingInlineStart:Ut,fontSize:"fontSizes",background:er,backgroundColor:er,backgroundImage:er,borderImage:er,border:er,borderBlock:er,borderBlockEnd:er,borderBlockStart:er,borderBottom:er,borderBottomColor:er,borderColor:er,borderInline:er,borderInlineEnd:er,borderInlineStart:er,borderLeft:er,borderLeftColor:er,borderRight:er,borderRightColor:er,borderTop:er,borderTopColor:er,caretColor:er,color:er,columnRuleColor:er,fill:er,outline:er,outlineColor:er,stroke:er,textDecorationColor:er,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ps,minBlockSize:Ps,maxBlockSize:Ps,inlineSize:Ps,minInlineSize:Ps,maxInlineSize:Ps,width:Ps,minWidth:Ps,maxWidth:Ps,height:Ps,minHeight:Ps,maxHeight:Ps,flexBasis:Ps,gridTemplateColumns:Ps,gridTemplateRows:Ps,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},rQ=(e,t)=>typeof t=="function"?{"()":Function.prototype.toString.call(t)}:t,ty=()=>{const e=Object.create(null);return(t,n,...r)=>{const s=(o=>JSON.stringify(o,rQ))(t);return s in e?e[s]:e[s]=n(t,...r)}},ew=Symbol.for("sxs.internal"),m2=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),PA=e=>{for(const t in e)return!0;return!1},{hasOwnProperty:sQ}=Object.prototype,tT=e=>e.includes("-")?e:e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),iQ=/\s+(?![^()]*\))/,Jd=e=>t=>e(...typeof t=="string"?String(t).split(iQ):[t]),SA={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:Jd((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:Jd((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:Jd((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:Jd((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:Jd((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:Jd((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},px=/([\d.]+)([^]*)/,oQ=(e,t)=>e.length?e.reduce((n,r)=>(n.push(...t.map(s=>s.includes("&")?s.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(s)?`:is(${r})`:r):r+" "+s)),n),[]):t,aQ=(e,t)=>e in lQ&&typeof t=="string"?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(n,r,s,o)=>r+(s==="stretch"?`-moz-available${o};${tT(e)}:${r}-webkit-fill-available`:`-moz-fit-content${o};${tT(e)}:${r}fit-content`)+o):String(t),lQ={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},_a=e=>e?e+"-":"",sR=(e,t,n)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,s,o,a,c)=>a=="$"==!!o?r:(s||a=="--"?"calc(":"")+"var(--"+(a==="$"?_a(t)+(c.includes("$")?"":_a(n))+c.replace(/\$/g,"-"):c)+")"+(s||a=="--"?"*"+(s||"")+(o||"1")+")":"")),cQ=/\s*,\s*(?![^()]*\))/,uQ=Object.prototype.toString,yh=(e,t,n,r,s)=>{let o,a,c;const u=(d,h,m)=>{let p,v;const T=E=>{for(p in E){const M=p.charCodeAt(0)===64,I=M&&Array.isArray(E[p])?E[p]:[E[p]];for(v of I){const k=/[A-Z]/.test(b=p)?b:b.replace(/-[^]/g,P=>P[1].toUpperCase()),$=typeof v=="object"&&v&&v.toString===uQ&&(!r.utils[k]||!h.length);if(k in r.utils&&!$){const P=r.utils[k];if(P!==a){a=P,T(P(v)),a=null;continue}}else if(k in SA){const P=SA[k];if(P!==c){c=P,T(P(v)),c=null;continue}}if(M&&(O=p.slice(1)in r.media?"@media "+r.media[p.slice(1)]:p,p=O.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(P,D,j,Y,q,oe)=>{const de=px.test(D),re=.0625*(de?-1:1),[he,ue]=de?[Y,D]:[D,Y];return"("+(j[0]==="="?"":j[0]===">"===de?"max-":"min-")+he+":"+(j[0]!=="="&&j.length===1?ue.replace(px,(ye,xe,te)=>Number(xe)+re*(j===">"?1:-1)+te):ue)+(q?") and ("+(q[0]===">"?"min-":"max-")+he+":"+(q.length===1?oe.replace(px,(ye,xe,te)=>Number(xe)+re*(q===">"?-1:1)+te):oe):"")+")"})),$){const P=M?m.concat(p):[...m],D=M?[...h]:oQ(h,p.split(cQ));o!==void 0&&s(CA(...o)),o=void 0,u(v,D,P)}else o===void 0&&(o=[[],h,m]),p=M||p.charCodeAt(0)!==36?p:`--${_a(r.prefix)}${p.slice(1).replace(/\$/g,"-")}`,v=$?v:typeof v=="number"?v&&k in dQ?String(v)+"px":String(v):sR(aQ(k,v??""),r.prefix,r.themeMap[k]),o[0].push(`${M?`${p} `:`${tT(p)}:`}${v}`)}}var O,b};T(d),o!==void 0&&s(CA(...o)),o=void 0};u(e,t,n)},CA=(e,t,n)=>`${n.map(r=>`${r}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(n.length?n.length+1:0).join("}")}`,dQ={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},kA=e=>String.fromCharCode(e+(e>25?39:97)),jc=e=>(t=>{let n,r="";for(n=Math.abs(t);n>52;n=n/52|0)r=kA(n%52)+r;return kA(n%52)+r})(((t,n)=>{let r=n.length;for(;r;)t=33*t^n.charCodeAt(--r);return t})(5381,JSON.stringify(e))>>>0),W_=["themed","global","styled","onevar","resonevar","allvar","inline"],hQ=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch{return!1}},fQ=e=>{let t;const n=()=>{const{cssRules:s}=t.sheet;return[].map.call(s,(o,a)=>{const{cssText:c}=o;let u="";if(c.startsWith("--sxs"))return"";if(s[a-1]&&(u=s[a-1].cssText).startsWith("--sxs")){if(!o.cssRules.length)return"";for(const d in t.rules)if(t.rules[d].group===o)return`--sxs{--sxs:${[...t.rules[d].cache].join(" ")}}${c}`;return o.cssRules.length?`${u}${c}`:""}return c}).join("")},r=()=>{if(t){const{rules:c,sheet:u}=t;if(!u.deleteRule){for(;Object(Object(u.cssRules)[0]).type===3;)u.cssRules.splice(0,1);u.cssRules=[]}for(const d in c)delete c[d]}const s=Object(e).styleSheets||[];for(const c of s)if(hQ(c)){for(let u=0,d=c.cssRules;d[u];++u){const h=Object(d[u]);if(h.type!==1)continue;const m=Object(d[u+1]);if(m.type!==4)continue;++u;const{cssText:p}=h;if(!p.startsWith("--sxs"))continue;const v=p.slice(14,-3).trim().split(/\s+/),T=W_[v[0]];T&&(t||(t={sheet:c,reset:r,rules:{},toString:n}),t.rules[T]={group:m,index:u,cache:new Set(v)})}if(t)break}if(!t){const c=(u,d)=>({type:d,cssRules:[],insertRule(h,m){this.cssRules.splice(m,0,c(h,{import:3,undefined:1}[(h.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return u==="@media{}"?`@media{${[].map.call(this.cssRules,h=>h.cssText).join("")}}`:u}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:c("","text/css"),rules:{},reset:r,toString:n}}const{sheet:o,rules:a}=t;for(let c=W_.length-1;c>=0;--c){const u=W_[c];if(!a[u]){const d=W_[c+1],h=a[d]?a[d].index:o.cssRules.length;o.insertRule("@media{}",h),o.insertRule(`--sxs{--sxs:${c}}`,h),a[u]={group:o.cssRules[h+1],index:h,cache:new Set([c])}}pQ(a[u])}};return r(),t},pQ=e=>{const t=e.group;let n=t.cssRules.length;e.apply=r=>{try{t.insertRule(r,n),++n}catch{}}},D_=Symbol(),mQ=ty(),gQ=(e,t)=>mQ(e,()=>(...n)=>{let r={type:null,composers:new Set};for(const s of n)if(s!=null)if(s[ew]){r.type==null&&(r.type=s[ew].type);for(const o of s[ew].composers)r.composers.add(o)}else s.constructor!==Object||s.$$typeof?r.type==null&&(r.type=s):r.composers.add(_Q(s,e));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),yQ(e,r,t)}),_Q=({variants:e,compoundVariants:t,defaultVariants:n,...r},s)=>{const o=`${_a(s.prefix)}c-${jc(r)}`,a=[],c=[],u=Object.create(null),d=[];for(const p in n)u[p]=String(n[p]);if(typeof e=="object"&&e)for(const p in e){h=u,m=p,sQ.call(h,m)||(u[p]="undefined");const v=e[p];for(const T in v){const E={[p]:String(T)};String(T)==="undefined"&&d.push(p);const O=v[T],b=[E,O,!PA(O)];a.push(b)}}var h,m;if(typeof t=="object"&&t)for(const p of t){let{css:v,...T}=p;v=typeof v=="object"&&v||{};for(const O in T)T[O]=String(T[O]);const E=[T,v,!PA(v)];c.push(E)}return[o,r,a,c,u,d]},yQ=(e,t,n)=>{const[r,s,o,a]=vQ(t.composers),c=typeof t.type=="function"||t.type.$$typeof?(m=>{function p(){for(let v=0;v<p[D_].length;v++){const[T,E]=p[D_][v];m.rules[T].apply(E)}return p[D_]=[],null}return p[D_]=[],p.rules={},W_.forEach(v=>p.rules[v]={apply:T=>p[D_].push([v,T])}),p})(n):null,u=(c||n).rules,d=`.${r}${s.length>1?`:where(.${s.slice(1).join(".")})`:""}`,h=m=>{m=typeof m=="object"&&m||wQ;const{css:p,...v}=m,T={};for(const b in o)if(delete v[b],b in m){let M=m[b];typeof M=="object"&&M?T[b]={"@initial":o[b],...M}:(M=String(M),T[b]=M!=="undefined"||a.has(b)?M:o[b])}else T[b]=o[b];const E=new Set([...s]);for(const[b,M,I,k]of t.composers){n.rules.styled.cache.has(b)||(n.rules.styled.cache.add(b),yh(M,[`.${b}`],[],e,D=>{u.styled.apply(D)}));const $=AA(I,T,e.media),P=AA(k,T,e.media,!0);for(const D of $)if(D!==void 0)for(const[j,Y,q]of D){const oe=`${b}-${jc(Y)}-${j}`;E.add(oe);const de=(q?n.rules.resonevar:n.rules.onevar).cache,re=q?u.resonevar:u.onevar;de.has(oe)||(de.add(oe),yh(Y,[`.${oe}`],[],e,he=>{re.apply(he)}))}for(const D of P)if(D!==void 0)for(const[j,Y]of D){const q=`${b}-${jc(Y)}-${j}`;E.add(q),n.rules.allvar.cache.has(q)||(n.rules.allvar.cache.add(q),yh(Y,[`.${q}`],[],e,oe=>{u.allvar.apply(oe)}))}}if(typeof p=="object"&&p){const b=`${r}-i${jc(p)}-css`;E.add(b),n.rules.inline.cache.has(b)||(n.rules.inline.cache.add(b),yh(p,[`.${b}`],[],e,M=>{u.inline.apply(M)}))}for(const b of String(m.className||"").trim().split(/\s+/))b&&E.add(b);const O=v.className=[...E].join(" ");return{type:t.type,className:O,selector:d,props:v,toString:()=>O,deferredInjector:c}};return m2(h,{className:r,selector:d,[ew]:t,toString:()=>(n.rules.styled.cache.has(r)||h(),r)})},vQ=e=>{let t="";const n=[],r={},s=[];for(const[o,,,,a,c]of e){t===""&&(t=o),n.push(o),s.push(...c);for(const u in a){const d=a[u];(r[u]===void 0||d!=="undefined"||c.includes(d))&&(r[u]=d)}}return[t,n,r,new Set(s)]},AA=(e,t,n,r)=>{const s=[];e:for(let[o,a,c]of e){if(c)continue;let u,d=0,h=!1;for(u in o){const m=o[u];let p=t[u];if(p!==m){if(typeof p!="object"||!p)continue e;{let v,T,E=0;for(const O in p){if(m===String(p[O])){if(O!=="@initial"){const b=O.slice(1);(T=T||[]).push(b in n?n[b]:O.replace(/^@media ?/,"")),h=!0}d+=E,v=!0}++E}if(T&&T.length&&(a={["@media "+T.join(", ")]:a}),!v)continue e}}}(s[d]=s[d]||[]).push([r?"cv":`${u}-${o[u]}`,a,h])}return s},wQ={},bQ=ty(),xQ=(e,t)=>bQ(e,()=>(...n)=>{const r=()=>{for(let s of n){s=typeof s=="object"&&s||{};let o=jc(s);if(!t.rules.global.cache.has(o)){if(t.rules.global.cache.add(o),"@import"in s){let a=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let c of[].concat(s["@import"]))c=c.includes('"')||c.includes("'")?c:`"${c}"`,t.sheet.insertRule(`@import ${c};`,a++);delete s["@import"]}yh(s,[],[],e,a=>{t.rules.global.apply(a)})}}return""};return m2(r,{toString:r})}),MQ=ty(),TQ=(e,t)=>MQ(e,()=>n=>{const r=`${_a(e.prefix)}k-${jc(n)}`,s=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);const o=[];yh(n,[],[],e,c=>o.push(c));const a=`@keyframes ${r}{${o.join("")}}`;t.rules.global.apply(a)}return r};return m2(s,{get name(){return s()},toString:s})}),EQ=class{constructor(t,n,r,s){this.token=t==null?"":String(t),this.value=n==null?"":String(n),this.scale=r==null?"":String(r),this.prefix=s==null?"":String(s)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+_a(this.prefix)+_a(this.scale)+this.token}toString(){return this.computedValue}},PQ=ty(),SQ=(e,t)=>PQ(e,()=>(n,r)=>{r=typeof n=="object"&&n||Object(r);const s=`.${n=(n=typeof n=="string"?n:"")||`${_a(e.prefix)}t-${jc(r)}`}`,o={},a=[];for(const u in r){o[u]={};for(const d in r[u]){const h=`--${_a(e.prefix)}${u}-${d}`,m=sR(String(r[u][d]),e.prefix,u);o[u][d]=new EQ(d,m,u,e.prefix),a.push(`${h}:${m}`)}}const c=()=>{if(a.length&&!t.rules.themed.cache.has(n)){t.rules.themed.cache.add(n);const u=`${r===e.theme?":root,":""}.${n}{${a.join(";")}}`;t.rules.themed.apply(u)}return n};return{...o,get className(){return c()},selector:s,toString:c}}),CQ=ty(),iR=e=>{let t=!1;const n=CQ(e,r=>{t=!0;const s="prefix"in(r=typeof r=="object"&&r||{})?String(r.prefix):"",o=typeof r.media=="object"&&r.media||{},a=typeof r.root=="object"?r.root||null:globalThis.document||null,c=typeof r.theme=="object"&&r.theme||{},u={prefix:s,media:o,theme:c,themeMap:typeof r.themeMap=="object"&&r.themeMap||{...nQ},utils:typeof r.utils=="object"&&r.utils||{}},d=fQ(a),h={css:gQ(u,d),globalCss:xQ(u,d),keyframes:TQ(u,d),createTheme:SQ(u,d),reset(){d.reset(),h.theme.toString()},theme:{},sheet:d,config:u,prefix:s,getCssText:d.toString,toString:d.toString};return String(h.theme=h.createTheme(c)),h});return t||n.reset(),n},oR=()=>EA||(EA=iR()),kQ=(...e)=>oR().createTheme(...e),va=(...e)=>oR().css(...e),AQ={default:{colors:{brand:"hsl(153 60.0% 53.0%)",brandAccent:"hsl(154 54.8% 45.1%)",brandButtonText:"white",defaultButtonBackground:"white",defaultButtonBackgroundHover:"#eaeaea",defaultButtonBorder:"lightgray",defaultButtonText:"gray",dividerBackground:"#eaeaea",inputBackground:"transparent",inputBorder:"lightgray",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"black",inputLabelText:"gray",inputPlaceholder:"darkgray",messageText:"#2b805a",messageBackground:"#e7fcf1",messageBorder:"#d0f3e1",messageTextDanger:"#ff6369",messageBackgroundDanger:"#fff8f8",messageBorderDanger:"#822025",anchorTextColor:"gray",anchorTextHoverColor:"darkgray"},space:{spaceSmall:"4px",spaceMedium:"8px",spaceLarge:"16px",labelBottomMargin:"8px",anchorBottomMargin:"4px",emailInputSpacing:"4px",socialAuthSpacing:"4px",buttonPadding:"10px 15px",inputPadding:"10px 15px"},fontSizes:{baseBodySize:"13px",baseInputSize:"14px",baseLabelSize:"14px",baseButtonSize:"14px"},fonts:{bodyFontFamily:"ui-sans-serif, sans-serif",buttonFontFamily:"ui-sans-serif, sans-serif",inputFontFamily:"ui-sans-serif, sans-serif",labelFontFamily:"ui-sans-serif, sans-serif"},borderWidths:{buttonBorderWidth:"1px",inputBorderWidth:"1px"},radii:{borderRadiusButton:"4px",buttonBorderRadius:"4px",inputBorderRadius:"4px"}},dark:{colors:{brandButtonText:"white",defaultButtonBackground:"#2e2e2e",defaultButtonBackgroundHover:"#3e3e3e",defaultButtonBorder:"#3e3e3e",defaultButtonText:"white",dividerBackground:"#2e2e2e",inputBackground:"#1e1e1e",inputBorder:"#3e3e3e",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"white",inputPlaceholder:"darkgray",messageText:"#85e0b7",messageBackground:"#072719",messageBorder:"#2b805a",messageBackgroundDanger:"#1f1315"}}},Nr={SIGN_IN:"sign_in",SIGN_UP:"sign_up",FORGOTTEN_PASSWORD:"forgotten_password",MAGIC_LINK:"magic_link",UPDATE_PASSWORD:"update_password",VERIFY_OTP:"verify_otp"},$Q="supabase-auth-ui",IQ={ROOT:"root",SIGN_IN:Nr.SIGN_IN,SIGN_UP:Nr.SIGN_UP,FORGOTTEN_PASSWORD:Nr.FORGOTTEN_PASSWORD,MAGIC_LINK:Nr.MAGIC_LINK,UPDATE_PASSWORD:Nr.UPDATE_PASSWORD,anchor:"ui-anchor",button:"ui-button",container:"ui-container",divider:"ui-divider",input:"ui-input",label:"ui-label",loader:"ui-loader",message:"ui-message"};function Xc(e,t,n){var r,s;const o=[],a=IQ[e];return o.push(n!=null&&n.prependedClassName?(n==null?void 0:n.prependedClassName)+"_"+a:$Q+"_"+a),(r=n==null?void 0:n.className)!=null&&r[e]&&o.push((s=n==null?void 0:n.className)==null?void 0:s[e]),((n==null?void 0:n.extend)===void 0||(n==null?void 0:n.extend)===!0)&&o.push(t),o}function nT(e,t){let n;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(Array.isArray(t))for(n=0;n<t.length;n++)e[n]=nT(e[n],t[n]);else for(n in t)e[n]=nT(e[n],t[n]);return e}return t}function mx(e,...t){let n=t.length;for(let r=0;r<n;r++)e=nT(e,t[r]);return e}function OQ(e,t){return e.replace(/{{(\w+)}}/g,(n,r)=>t.hasOwnProperty(r)?t[r]:n)}var DQ={sign_up:{email_label:"Email address",password_label:"Create a Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign up",loading_button_label:"Signing up ...",social_provider_text:"Sign in with {{provider}}",link_text:"Don't have an account? Sign up",confirmation_text:"Check your email for the confirmation link"},sign_in:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign in",loading_button_label:"Signing in ...",social_provider_text:"Sign in with {{provider}}",link_text:"Already have an account? Sign in"},magic_link:{email_input_label:"Email address",email_input_placeholder:"Your email address",button_label:"Send Magic Link",loading_button_label:"Sending Magic Link ...",link_text:"Send a magic link email",confirmation_text:"Check your email for the magic link"},forgotten_password:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",button_label:"Send reset password instructions",loading_button_label:"Sending reset instructions ...",link_text:"Forgot your password?",confirmation_text:"Check your email for the password reset link"},update_password:{password_label:"New password",password_input_placeholder:"Your new password",button_label:"Update password",loading_button_label:"Updating password ...",confirmation_text:"Your password has been updated"},verify_otp:{email_input_label:"Email address",email_input_placeholder:"Your email address",phone_input_label:"Phone number",phone_input_placeholder:"Your phone number",token_input_label:"Token",token_input_placeholder:"Your Otp token",button_label:"Verify token",loading_button_label:"Signing in ..."}};const LQ=va({fontFamily:"$bodyFontFamily",fontSize:"$baseBodySize",marginBottom:"$anchorBottomMargin",color:"$anchorTextColor",display:"block",textAlign:"center",textDecoration:"underline","&:hover":{color:"$anchorTextHoverColor"}}),kc=({children:e,appearance:t,...n})=>{var r;const s=Xc("anchor",LQ(),t);return we.createElement("a",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.anchor,className:s.join(" ")},e)},FQ=va({fontFamily:"$buttonFontFamily",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",borderRadius:"$borderRadiusButton",fontSize:"$baseButtonSize",padding:"$buttonPadding",cursor:"pointer",borderWidth:"$buttonBorderWidth",borderStyle:"solid",width:"100%",transitionProperty:"background-color",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms","&:disabled":{opacity:.7,cursor:"unset"},variants:{color:{default:{backgroundColor:"$defaultButtonBackground",color:"$defaultButtonText",borderColor:"$defaultButtonBorder","&:hover:not(:disabled)":{backgroundColor:"$defaultButtonBackgroundHover"}},primary:{backgroundColor:"$brand",color:"$brandButtonText",borderColor:"$brandAccent","&:hover:not(:disabled)":{backgroundColor:"$brandAccent"}}}}}),hf=({children:e,color:t="default",appearance:n,icon:r,loading:s=!1,...o})=>{var a;const c=Xc("button",FQ({color:t}),n);return we.createElement("button",{...o,style:(a=n==null?void 0:n.style)==null?void 0:a.button,className:c.join(" "),disabled:s},r,e)},RQ=va({display:"flex",gap:"4px",variants:{direction:{horizontal:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(48px, 1fr))"},vertical:{flexDirection:"column",margin:"8px 0"}},gap:{small:{gap:"4px"},medium:{gap:"8px"},large:{gap:"16px"}}}}),Oo=({children:e,appearance:t,...n})=>{var r;const s=Xc("container",RQ({direction:n.direction,gap:n.gap}),t);return we.createElement("div",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.container,className:s.join(" ")},e)},jQ=va({background:"$dividerBackground",display:"block",margin:"16px 0",height:"1px",width:"100%"}),NQ=({children:e,appearance:t,...n})=>{var r;const s=Xc("divider",jQ(),t);return we.createElement("div",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.divider,className:s.join(" ")})},zQ=va({fontFamily:"$inputFontFamily",background:"$inputBackground",borderRadius:"$inputBorderRadius",padding:"$inputPadding",cursor:"text",borderWidth:"$inputBorderWidth",borderColor:"$inputBorder",borderStyle:"solid",fontSize:"$baseInputSize",width:"100%",color:"$inputText",boxSizing:"border-box","&:hover":{borderColor:"$inputBorderHover",outline:"none"},"&:focus":{borderColor:"$inputBorderFocus",outline:"none"},"&::placeholder":{color:"$inputPlaceholder",letterSpacing:"initial"},transitionProperty:"background-color, border",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms",variants:{type:{default:{letterSpacing:"0px"},password:{letterSpacing:"0px"}}}}),bl=({children:e,appearance:t,...n})=>{var r;const s=Xc("input",zQ({type:n.type==="password"?"password":"default"}),t);return we.createElement("input",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.input,className:s.join(" ")},e)},BQ=va({fontFamily:"$labelFontFamily",fontSize:"$baseLabelSize",marginBottom:"$labelBottomMargin",color:"$inputLabelText",display:"block"}),xl=({children:e,appearance:t,...n})=>{var r;const s=Xc("label",BQ(),t);return we.createElement("label",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.label,className:s.join(" ")},e)},VQ=va({fontFamily:"$bodyFontFamily",fontSize:"$baseInputSize",marginBottom:"$labelBottomMargin",display:"block",textAlign:"center",borderRadius:"0.375rem",padding:"1.5rem 1rem",lineHeight:"1rem",color:"$messageText",backgroundColor:"$messageBackground",border:"1px solid $messageBorder",variants:{color:{danger:{color:"$messageTextDanger",backgroundColor:"$messageBackgroundDanger",border:"1px solid $messageBorderDanger"}}}}),Lo=({children:e,appearance:t,...n})=>{var r;const s=Xc("message",VQ({color:n.color}),t);return we.createElement("span",{...n,style:(r=t==null?void 0:t.style)==null?void 0:r.message,className:s.join(" ")},e)};function aR({setAuthView:e=()=>{},supabaseClient:t,redirectTo:n,i18n:r,appearance:s,showLinks:o=!1}){var a;const[c,u]=B.useState(""),[d,h]=B.useState(""),[m,p]=B.useState(""),[v,T]=B.useState(!1),E=async b=>{var M,I;if(b.preventDefault(),h(""),p(""),T(!0),c.length===0){h((M=r==null?void 0:r.magic_link)==null?void 0:M.empty_email_address),T(!1);return}const{error:k}=await t.auth.signInWithOtp({email:c,options:{emailRedirectTo:n}});k?h(k.message):p((I=r==null?void 0:r.magic_link)==null?void 0:I.confirmation_text),T(!1)},O=r==null?void 0:r.magic_link;return we.createElement("form",{id:"auth-magic-link",onSubmit:E},we.createElement(Oo,{gap:"large",direction:"vertical",appearance:s},we.createElement("div",null,we.createElement(xl,{htmlFor:"email",appearance:s},O==null?void 0:O.email_input_label),we.createElement(bl,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:O==null?void 0:O.email_input_placeholder,onChange:b=>{h&&h(""),u(b.target.value)},appearance:s})),we.createElement(hf,{color:"primary",type:"submit",loading:v,appearance:s},v?O==null?void 0:O.loading_button_label:O==null?void 0:O.button_label),o&&we.createElement(kc,{href:"#auth-sign-in",onClick:b=>{b.preventDefault(),e(Nr.SIGN_IN)},appearance:s},(a=r==null?void 0:r.sign_in)==null?void 0:a.link_text),m&&we.createElement(Lo,{appearance:s},m),d&&we.createElement(Lo,{color:"danger",appearance:s},d)))}const as=va({width:"21px",height:"21px"}),UQ=({provider:e})=>e=="google"?WQ():e=="facebook"?GQ():e=="twitter"?KQ():e=="apple"?HQ():e=="github"?qQ():e=="gitlab"?QQ():e=="bitbucket"?YQ():e=="discord"?XQ():e=="azure"?JQ():e=="keycloak"?ZQ():e=="linkedin"?eY():e=="notion"?tY():e=="slack"?nY():e=="spotify"?rY():e=="twitch"?sY():e=="workos"?iY():e=="kakao"?oY():null,WQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),we.createElement("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),we.createElement("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),we.createElement("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),GQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#039be5",d:"M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"}),we.createElement("path",{fill:"#fff",d:"M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"})),KQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#03A9F4",d:"M42,12.429c-1.323,0.586-2.746,0.977-4.247,1.162c1.526-0.906,2.7-2.351,3.251-4.058c-1.428,0.837-3.01,1.452-4.693,1.776C34.967,9.884,33.05,9,30.926,9c-4.08,0-7.387,3.278-7.387,7.32c0,0.572,0.067,1.129,0.193,1.67c-6.138-0.308-11.582-3.226-15.224-7.654c-0.64,1.082-1,2.349-1,3.686c0,2.541,1.301,4.778,3.285,6.096c-1.211-0.037-2.351-0.374-3.349-0.914c0,0.022,0,0.055,0,0.086c0,3.551,2.547,6.508,5.923,7.181c-0.617,0.169-1.269,0.263-1.941,0.263c-0.477,0-0.942-0.054-1.392-0.135c0.94,2.902,3.667,5.023,6.898,5.086c-2.528,1.96-5.712,3.134-9.174,3.134c-0.598,0-1.183-0.034-1.761-0.104C9.268,36.786,13.152,38,17.321,38c13.585,0,21.017-11.156,21.017-20.834c0-0.317-0.01-0.633-0.025-0.945C39.763,15.197,41.013,13.905,42,12.429"})),HQ=()=>we.createElement("svg",{className:as(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"21px",height:"21px"}," ",we.createElement("path",{d:"M 15.904297 1.078125 C 15.843359 1.06875 15.774219 1.0746094 15.699219 1.0996094 C 14.699219 1.2996094 13.600391 1.8996094 12.900391 2.5996094 C 12.300391 3.1996094 11.800781 4.1996094 11.800781 5.0996094 C 11.800781 5.2996094 11.999219 5.5 12.199219 5.5 C 13.299219 5.4 14.399609 4.7996094 15.099609 4.0996094 C 15.699609 3.2996094 16.199219 2.4 16.199219 1.5 C 16.199219 1.275 16.087109 1.10625 15.904297 1.078125 z M 16.199219 5.4003906 C 14.399219 5.4003906 13.600391 6.5 12.400391 6.5 C 11.100391 6.5 9.9003906 5.5 8.4003906 5.5 C 6.3003906 5.5 3.0996094 7.4996094 3.0996094 12.099609 C 2.9996094 16.299609 6.8 21 9 21 C 10.3 21 10.600391 20.199219 12.400391 20.199219 C 14.200391 20.199219 14.600391 21 15.900391 21 C 17.400391 21 18.500391 19.399609 19.400391 18.099609 C 19.800391 17.399609 20.100391 17.000391 20.400391 16.400391 C 20.600391 16.000391 20.4 15.600391 20 15.400391 C 17.4 14.100391 16.900781 9.9003906 19.800781 8.4003906 C 20.300781 8.1003906 20.4 7.4992188 20 7.1992188 C 18.9 6.1992187 17.299219 5.4003906 16.199219 5.4003906 z"})),qQ=()=>we.createElement("svg",{className:as(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"21px",height:"21px"}," ",we.createElement("path",{d:"M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"})),QQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#e53935",d:"M24 43L16 20 32 20z"}),we.createElement("path",{fill:"#ff7043",d:"M24 43L42 20 32 20z"}),we.createElement("path",{fill:"#e53935",d:"M37 5L42 20 32 20z"}),we.createElement("path",{fill:"#ffa726",d:"M24 43L42 20 45 28z"}),we.createElement("path",{fill:"#ff7043",d:"M24 43L6 20 16 20z"}),we.createElement("path",{fill:"#e53935",d:"M11 5L6 20 16 20z"}),we.createElement("path",{fill:"#ffa726",d:"M24 43L6 20 3 28z"})),YQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 62.42 62.42"},we.createElement("defs",null,we.createElement("linearGradient",{id:"New_Gradient_Swatch_1",x1:"64.01",y1:"30.27",x2:"32.99",y2:"54.48",gradientUnits:"userSpaceOnUse"},we.createElement("stop",{offset:"0.18",stopColor:"#0052cc"}),we.createElement("stop",{offset:"1",stopColor:"#2684ff"}))),we.createElement("title",null,"Bitbucket-blue"),we.createElement("g",{id:"Layer_2","data-name":"Layer 2"},we.createElement("g",{id:"Blue",transform:"translate(0 -3.13)"},we.createElement("path",{d:"M2,6.26A2,2,0,0,0,0,8.58L8.49,60.12a2.72,2.72,0,0,0,2.66,2.27H51.88a2,2,0,0,0,2-1.68L62.37,8.59a2,2,0,0,0-2-2.32ZM37.75,43.51h-13L21.23,25.12H40.9Z",fill:"#2684ff"}),we.createElement("path",{d:"M59.67,25.12H40.9L37.75,43.51h-13L9.4,61.73a2.71,2.71,0,0,0,1.75.66H51.89a2,2,0,0,0,2-1.68Z",fill:"url(#New_Gradient_Swatch_1)"})))),XQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#536dfe",d:"M39.248,10.177c-2.804-1.287-5.812-2.235-8.956-2.778c-0.057-0.01-0.114,0.016-0.144,0.068	c-0.387,0.688-0.815,1.585-1.115,2.291c-3.382-0.506-6.747-0.506-10.059,0c-0.3-0.721-0.744-1.603-1.133-2.291	c-0.03-0.051-0.087-0.077-0.144-0.068c-3.143,0.541-6.15,1.489-8.956,2.778c-0.024,0.01-0.045,0.028-0.059,0.051	c-5.704,8.522-7.267,16.835-6.5,25.044c0.003,0.04,0.026,0.079,0.057,0.103c3.763,2.764,7.409,4.442,10.987,5.554	c0.057,0.017,0.118-0.003,0.154-0.051c0.846-1.156,1.601-2.374,2.248-3.656c0.038-0.075,0.002-0.164-0.076-0.194	c-1.197-0.454-2.336-1.007-3.432-1.636c-0.087-0.051-0.094-0.175-0.014-0.234c0.231-0.173,0.461-0.353,0.682-0.534	c0.04-0.033,0.095-0.04,0.142-0.019c7.201,3.288,14.997,3.288,22.113,0c0.047-0.023,0.102-0.016,0.144,0.017	c0.22,0.182,0.451,0.363,0.683,0.536c0.08,0.059,0.075,0.183-0.012,0.234c-1.096,0.641-2.236,1.182-3.434,1.634	c-0.078,0.03-0.113,0.12-0.075,0.196c0.661,1.28,1.415,2.498,2.246,3.654c0.035,0.049,0.097,0.07,0.154,0.052	c3.595-1.112,7.241-2.79,11.004-5.554c0.033-0.024,0.054-0.061,0.057-0.101c0.917-9.491-1.537-17.735-6.505-25.044	C39.293,10.205,39.272,10.187,39.248,10.177z M16.703,30.273c-2.168,0-3.954-1.99-3.954-4.435s1.752-4.435,3.954-4.435	c2.22,0,3.989,2.008,3.954,4.435C20.658,28.282,18.906,30.273,16.703,30.273z M31.324,30.273c-2.168,0-3.954-1.99-3.954-4.435	s1.752-4.435,3.954-4.435c2.22,0,3.989,2.008,3.954,4.435C35.278,28.282,33.544,30.273,31.324,30.273z"})),JQ=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6a",x1:"-1254.397",x2:"-1261.911",y1:"877.268",y2:"899.466",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},we.createElement("stop",{offset:"0",stopColor:"#114a8b"}),we.createElement("stop",{offset:"1",stopColor:"#0669bc"})),we.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6a)",d:"M17.634,6h11.305L17.203,40.773c-0.247,0.733-0.934,1.226-1.708,1.226H6.697 c-0.994,0-1.8-0.806-1.8-1.8c0-0.196,0.032-0.39,0.094-0.576L15.926,7.227C16.173,6.494,16.86,6,17.634,6L17.634,6z"}),we.createElement("path",{fill:"#0078d4",d:"M34.062,29.324H16.135c-0.458-0.001-0.83,0.371-0.831,0.829c0,0.231,0.095,0.451,0.264,0.608 l11.52,10.752C27.423,41.826,27.865,42,28.324,42h10.151L34.062,29.324z"}),we.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6b",x1:"-1252.05",x2:"-1253.788",y1:"887.612",y2:"888.2",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},we.createElement("stop",{offset:"0",stopOpacity:".3"}),we.createElement("stop",{offset:".071",stopOpacity:".2"}),we.createElement("stop",{offset:".321",stopOpacity:".1"}),we.createElement("stop",{offset:".623",stopOpacity:".05"}),we.createElement("stop",{offset:"1",stopOpacity:"0"})),we.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6b)",d:"M17.634,6c-0.783-0.003-1.476,0.504-1.712,1.25L5.005,39.595 c-0.335,0.934,0.151,1.964,1.085,2.299C6.286,41.964,6.493,42,6.702,42h9.026c0.684-0.122,1.25-0.603,1.481-1.259l2.177-6.416 l7.776,7.253c0.326,0.27,0.735,0.419,1.158,0.422h10.114l-4.436-12.676l-12.931,0.003L28.98,6H17.634z"}),we.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6c",x1:"-1252.952",x2:"-1244.704",y1:"876.6",y2:"898.575",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},we.createElement("stop",{offset:"0",stopColor:"#3ccbf4"}),we.createElement("stop",{offset:"1",stopColor:"#2892df"})),we.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6c)",d:"M32.074,7.225C31.827,6.493,31.141,6,30.368,6h-12.6c0.772,0,1.459,0.493,1.705,1.224 l10.935,32.399c0.318,0.942-0.188,1.963-1.13,2.281C29.093,41.968,28.899,42,28.703,42h12.6c0.994,0,1.8-0.806,1.8-1.801 c0-0.196-0.032-0.39-0.095-0.575L32.074,7.225z"})),ZQ=()=>we.createElement("svg",{className:as(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},we.createElement("path",{d:"M472.136 163.959H408.584C407.401 163.959 406.218 163.327 405.666 162.3L354.651 73.6591C354.02 72.632 352.916 72 351.654 72H143.492C142.309 72 141.126 72.632 140.574 73.6591L87.5084 165.618L36.414 254.259C35.862 255.286 35.862 256.55 36.414 257.656L87.5084 346.297L140.495 438.335C141.047 439.362 142.23 440.073 143.413 439.994H351.654C352.837 439.994 354.02 439.362 354.651 438.335L405.745 349.694C406.297 348.667 407.48 347.956 408.663 348.035H472.215C474.344 348.035 476 346.297 476 344.243V167.83C475.921 165.697 474.186 163.959 472.136 163.959ZM228.728 349.694L212.721 377.345C212.485 377.74 212.091 378.135 211.696 378.372C211.223 378.609 210.75 378.767 210.198 378.767H178.422C177.318 378.767 176.293 378.214 175.82 377.187L128.431 294.787L123.779 286.65L106.748 257.498C106.511 257.103 106.353 256.629 106.432 256.076C106.432 255.602 106.59 255.049 106.827 254.654L123.937 224.949L175.899 134.886C176.451 133.938 177.476 133.306 178.501 133.306H210.198C210.75 133.306 211.302 133.464 211.854 133.701C212.248 133.938 212.643 134.254 212.879 134.728L228.886 162.537C229.359 163.485 229.28 164.67 228.728 165.539L177.397 254.654C177.16 255.049 177.081 255.523 177.081 255.918C177.081 256.392 177.239 256.787 177.397 257.182L228.728 346.218C229.438 347.403 229.359 348.667 228.728 349.694V349.694ZM388.083 257.498L371.051 286.65L366.399 294.787L319.011 377.187C318.459 378.135 317.512 378.767 316.409 378.767H284.632C284.08 378.767 283.607 378.609 283.134 378.372C282.74 378.135 282.346 377.819 282.109 377.345L266.103 349.694C265.393 348.667 265.393 347.403 266.024 346.376L317.355 257.34C317.591 256.945 317.67 256.471 317.67 256.076C317.67 255.602 317.513 255.207 317.355 254.812L266.024 165.697C265.472 164.749 265.393 163.643 265.866 162.695L281.873 134.886C282.109 134.491 282.503 134.096 282.898 133.859C283.371 133.543 283.923 133.464 284.553 133.464H316.409C317.512 133.464 318.538 134.017 319.011 135.044L370.972 225.107L388.083 254.812C388.319 255.286 388.477 255.76 388.477 256.234C388.477 256.55 388.319 257.024 388.083 257.498V257.498Z",fill:"#008AAA"})),eY=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#0288D1",d:"M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z"}),we.createElement("path",{fill:"#FFF",d:"M12 19H17V36H12zM14.485 17h-.028C12.965 17 12 15.888 12 14.499 12 13.08 12.995 12 14.514 12c1.521 0 2.458 1.08 2.486 2.499C17 15.887 16.035 17 14.485 17zM36 36h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501 0-2.313 1.012-2.707 1.99C24.957 25.543 25 26.511 25 27v9h-5V19h5v2.616C25.721 20.5 26.85 19 29.738 19c3.578 0 6.261 2.25 6.261 7.274L36 36 36 36z"})),tY=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px",fillRule:"evenodd",clipRule:"evenodd"},we.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z",clipRule:"evenodd"}),we.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619 l23.971-1.387c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463 C13.171,14.718,12.862,15.181,12.862,16.182L12.862,16.182z",clipRule:"evenodd"}),we.createElement("path",{fill:"#424242",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619l23.971-1.387 c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463C13.171,14.718,12.862,15.181,12.862,16.182 L12.862,16.182z M36.526,17.413c0.154,0.694,0,1.387-0.695,1.465l-1.155,0.23v16.943c-1.003,0.539-1.928,0.847-2.698,0.847 c-1.234,0-1.543-0.385-2.467-1.54l-7.555-11.86v11.475l2.391,0.539c0,0,0,1.386-1.929,1.386l-5.317,0.308 c-0.154-0.308,0-1.078,0.539-1.232l1.388-0.385V20.418l-1.927-0.154c-0.155-0.694,0.23-1.694,1.31-1.772l5.704-0.385l7.862,12.015 V19.493l-2.005-0.23c-0.154-0.848,0.462-1.464,1.233-1.54L36.526,17.413z M7.389,5.862l21.968-1.618 c2.698-0.231,3.392-0.076,5.087,1.155l7.013,4.929C42.614,11.176,43,11.407,43,12.33v27.032c0,1.694-0.617,2.696-2.775,2.849 l-25.512,1.541c-1.62,0.077-2.391-0.154-3.239-1.232l-5.164-6.7C5.385,34.587,5,33.664,5,32.585V8.556 C5,7.171,5.617,6.015,7.389,5.862z",clipRule:"evenodd"})),nY=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},we.createElement("path",{fill:"#33d375",d:"M33,8c0-2.209-1.791-4-4-4s-4,1.791-4,4c0,1.254,0,9.741,0,11c0,2.209,1.791,4,4,4s4-1.791,4-4	C33,17.741,33,9.254,33,8z"}),we.createElement("path",{fill:"#33d375",d:"M43,19c0,2.209-1.791,4-4,4c-1.195,0-4,0-4,0s0-2.986,0-4c0-2.209,1.791-4,4-4S43,16.791,43,19z"}),we.createElement("path",{fill:"#40c4ff",d:"M8,14c-2.209,0-4,1.791-4,4s1.791,4,4,4c1.254,0,9.741,0,11,0c2.209,0,4-1.791,4-4s-1.791-4-4-4	C17.741,14,9.254,14,8,14z"}),we.createElement("path",{fill:"#40c4ff",d:"M19,4c2.209,0,4,1.791,4,4c0,1.195,0,4,0,4s-2.986,0-4,0c-2.209,0-4-1.791-4-4S16.791,4,19,4z"}),we.createElement("path",{fill:"#e91e63",d:"M14,39.006C14,41.212,15.791,43,18,43s4-1.788,4-3.994c0-1.252,0-9.727,0-10.984	c0-2.206-1.791-3.994-4-3.994s-4,1.788-4,3.994C14,29.279,14,37.754,14,39.006z"}),we.createElement("path",{fill:"#e91e63",d:"M4,28.022c0-2.206,1.791-3.994,4-3.994c1.195,0,4,0,4,0s0,2.981,0,3.994c0,2.206-1.791,3.994-4,3.994	S4,30.228,4,28.022z"}),we.createElement("path",{fill:"#ffc107",d:"M39,33c2.209,0,4-1.791,4-4s-1.791-4-4-4c-1.254,0-9.741,0-11,0c-2.209,0-4,1.791-4,4s1.791,4,4,4	C29.258,33,37.746,33,39,33z"}),we.createElement("path",{fill:"#ffc107",d:"M28,43c-2.209,0-4-1.791-4-4c0-1.195,0-4,0-4s2.986,0,4,0c2.209,0,4,1.791,4,4S30.209,43,28,43z"})),rY=()=>we.createElement("svg",{className:as(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},we.createElement("path",{d:"M255.498 31.0034C131.513 31.0034 31 131.515 31 255.502C31 379.492 131.513 480 255.498 480C379.497 480 480 379.495 480 255.502C480 131.522 379.497 31.0135 255.495 31.0135L255.498 31V31.0034ZM358.453 354.798C354.432 361.391 345.801 363.486 339.204 359.435C286.496 327.237 220.139 319.947 141.993 337.801C134.463 339.516 126.957 334.798 125.24 327.264C123.516 319.731 128.217 312.225 135.767 310.511C221.284 290.972 294.639 299.384 353.816 335.549C360.413 339.596 362.504 348.2 358.453 354.798ZM385.932 293.67C380.864 301.903 370.088 304.503 361.858 299.438C301.512 262.345 209.528 251.602 138.151 273.272C128.893 276.067 119.118 270.851 116.309 261.61C113.521 252.353 118.74 242.597 127.981 239.782C209.512 215.044 310.87 227.026 380.17 269.612C388.4 274.68 391 285.456 385.935 293.676V293.673L385.932 293.67ZM388.293 230.016C315.935 187.039 196.56 183.089 127.479 204.055C116.387 207.42 104.654 201.159 101.293 190.063C97.9326 178.964 104.189 167.241 115.289 163.87C194.59 139.796 326.418 144.446 409.723 193.902C419.722 199.826 422.995 212.71 417.068 222.675C411.168 232.653 398.247 235.943 388.303 230.016H388.293V230.016Z",fill:"#1ED760"})),sY=()=>we.createElement("svg",{className:as(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},we.createElement("path",{d:"M416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"white"}),we.createElement("path",{d:"M144 32L64 112V400H160V480L240 400H304L448 256V32H144ZM416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"#9146FF"}),we.createElement("path",{d:"M368 120H336V216H368V120Z",fill:"#9146FF"}),we.createElement("path",{d:"M280 120H248V216H280V120Z",fill:"#9146FF"})),iY=()=>we.createElement("svg",{className:as(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},we.createElement("path",{d:"M33 256.043C33 264.556 35.3159 273.069 39.4845 280.202L117.993 415.493C126.098 429.298 138.373 440.572 153.657 445.634C183.764 455.528 214.797 442.873 229.618 417.333L248.609 384.661L173.806 256.043L252.777 119.831L271.768 87.1591C277.557 77.2654 284.968 69.4424 294 63H285.894H172.185C150.878 63 131.193 74.2742 120.54 92.6812L39.7161 231.884C35.3159 239.016 33 247.53 33 256.043Z",fill:"#6363F1"}),we.createElement("path",{d:"M480 256.058C480 247.539 477.684 239.021 473.516 231.883L393.849 94.6596C379.028 69.3331 347.995 56.4396 317.888 66.34C302.603 71.4053 290.329 82.6871 282.224 96.5015L264.391 127.354L339.194 256.058L260.223 392.131L241.232 424.825C235.443 434.495 228.032 442.553 219 449H227.106H340.815C362.122 449 381.807 437.718 392.46 419.299L473.284 280.003C477.684 272.866 480 264.577 480 256.058Z",fill:"#6363F1"})),oY=()=>we.createElement("svg",{className:as(),xmlns:"http://www.w3.org/2000/svg",width:"2500",height:"2500",viewBox:"0 0 256 256"},we.createElement("path",{fill:"#FFE812",d:"M256 236c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20V20C0 8.954 8.954 0 20 0h216c11.046 0 20 8.954 20 20v216z"}),we.createElement("path",{d:"M128 36C70.562 36 24 72.713 24 118c0 29.279 19.466 54.97 48.748 69.477-1.593 5.494-10.237 35.344-10.581 37.689 0 0-.207 1.762.934 2.434s2.483.15 2.483.15c3.272-.457 37.943-24.811 43.944-29.04 5.995.849 12.168 1.29 18.472 1.29 57.438 0 104-36.712 104-82 0-45.287-46.562-82-104-82z"}),we.createElement("path",{fill:"#FFE812",d:"M70.5 146.625c-3.309 0-6-2.57-6-5.73V105.25h-9.362c-3.247 0-5.888-2.636-5.888-5.875s2.642-5.875 5.888-5.875h30.724c3.247 0 5.888 2.636 5.888 5.875s-2.642 5.875-5.888 5.875H76.5v35.645c0 3.16-2.691 5.73-6 5.73zM123.112 146.547c-2.502 0-4.416-1.016-4.993-2.65l-2.971-7.778-18.296-.001-2.973 7.783c-.575 1.631-2.488 2.646-4.99 2.646a9.155 9.155 0 0 1-3.814-.828c-1.654-.763-3.244-2.861-1.422-8.52l14.352-37.776c1.011-2.873 4.082-5.833 7.99-5.922 3.919.088 6.99 3.049 8.003 5.928l14.346 37.759c1.826 5.672.236 7.771-1.418 8.532a9.176 9.176 0 0 1-3.814.827c-.001 0 0 0 0 0zm-11.119-21.056L106 108.466l-5.993 17.025h11.986zM138 145.75c-3.171 0-5.75-2.468-5.75-5.5V99.5c0-3.309 2.748-6 6.125-6s6.125 2.691 6.125 6v35.25h12.75c3.171 0 5.75 2.468 5.75 5.5s-2.579 5.5-5.75 5.5H138zM171.334 146.547c-3.309 0-6-2.691-6-6V99.5c0-3.309 2.691-6 6-6s6 2.691 6 6v12.896l16.74-16.74c.861-.861 2.044-1.335 3.328-1.335 1.498 0 3.002.646 4.129 1.772 1.051 1.05 1.678 2.401 1.764 3.804.087 1.415-.384 2.712-1.324 3.653l-13.673 13.671 14.769 19.566a5.951 5.951 0 0 1 1.152 4.445 5.956 5.956 0 0 1-2.328 3.957 5.94 5.94 0 0 1-3.609 1.211 5.953 5.953 0 0 1-4.793-2.385l-14.071-18.644-2.082 2.082v13.091a6.01 6.01 0 0 1-6.002 6.003z"}));function aY({supabaseClient:e,socialLayout:t="vertical",providers:n=["github","google","azure"],providerScopes:r,queryParams:s,redirectTo:o,onlyThirdPartyProviders:a=!0,view:c="sign_in",i18n:u,appearance:d}){const[h,m]=B.useState(!1),[p,v]=B.useState(""),T=t==="vertical",E=c==="magic_link"?"sign_in":c,O=async M=>{m(!0);const{error:I}=await e.auth.signInWithOAuth({provider:M,options:{redirectTo:o,scopes:r==null?void 0:r[M],queryParams:s}});I&&v(I.message),m(!1)};function b(M){const I=M.toLowerCase();return M.charAt(0).toUpperCase()+I.slice(1)}return we.createElement(we.Fragment,null,n&&n.length>0&&we.createElement(we.Fragment,null,we.createElement(Oo,{gap:"large",direction:"vertical",appearance:d},we.createElement(Oo,{direction:T?"vertical":"horizontal",gap:T?"small":"medium",appearance:d},n.map(M=>{var I;return we.createElement(hf,{key:M,color:"default",loading:h,onClick:()=>O(M),appearance:d},we.createElement(UQ,{provider:M}),T&&OQ((I=u==null?void 0:u[E])==null?void 0:I.social_provider_text,{provider:b(M)}))}))),!a&&we.createElement(NQ,{appearance:d})))}function $A({authView:e="sign_in",defaultEmail:t="",defaultPassword:n="",setAuthView:r=()=>{},setDefaultEmail:s=T=>{},setDefaultPassword:o=T=>{},supabaseClient:a,showLinks:c=!1,redirectTo:u,additionalData:d,magicLink:h,i18n:m,appearance:p,children:v}){var T,E,O,b;const M=B.useRef(!0),[I,k]=B.useState(t),[$,P]=B.useState(n),[D,j]=B.useState(""),[Y,q]=B.useState(!1),[oe,de]=B.useState("");B.useEffect(()=>(M.current=!0,k(t),P(n),()=>{M.current=!1}),[e]);const re=async ye=>{var xe;switch(ye.preventDefault(),j(""),q(!0),e){case"sign_in":const{error:te}=await a.auth.signInWithPassword({email:I,password:$});te&&j(te.message);break;case"sign_up":let ke={emailRedirectTo:u};d&&(ke.data=d);const{data:{user:De,session:me},error:ee}=await a.auth.signUp({email:I,password:$,options:ke});ee?j(ee.message):De&&!me&&de((xe=m==null?void 0:m.sign_up)==null?void 0:xe.confirmation_text);break}M.current&&q(!1)},he=ye=>{s(I),o($),r(ye)},ue=m==null?void 0:m[e];return we.createElement("form",{id:e==="sign_in"?"auth-sign-in":"auth-sign-up",onSubmit:re,autoComplete:"on",style:{width:"100%"}},we.createElement(Oo,{direction:"vertical",gap:"large",appearance:p},we.createElement(Oo,{direction:"vertical",gap:"large",appearance:p},we.createElement("div",null,we.createElement(xl,{htmlFor:"email",appearance:p},ue==null?void 0:ue.email_label),we.createElement(bl,{id:"email",type:"email",name:"email",placeholder:ue==null?void 0:ue.email_input_placeholder,defaultValue:I,onChange:ye=>k(ye.target.value),autoComplete:"email",appearance:p})),we.createElement("div",null,we.createElement(xl,{htmlFor:"password",appearance:p},ue==null?void 0:ue.password_label),we.createElement(bl,{id:"password",type:"password",name:"password",placeholder:ue==null?void 0:ue.password_input_placeholder,defaultValue:$,onChange:ye=>P(ye.target.value),autoComplete:e==="sign_in"?"current-password":"new-password",appearance:p})),v),we.createElement(hf,{type:"submit",color:"primary",loading:Y,appearance:p},Y?ue==null?void 0:ue.loading_button_label:ue==null?void 0:ue.button_label),c&&we.createElement(Oo,{direction:"vertical",gap:"small",appearance:p},e===Nr.SIGN_IN&&h&&we.createElement(kc,{href:"#auth-magic-link",onClick:ye=>{ye.preventDefault(),r(Nr.MAGIC_LINK)},appearance:p},(T=m==null?void 0:m.magic_link)==null?void 0:T.link_text),e===Nr.SIGN_IN&&we.createElement(kc,{href:"#auth-forgot-password",onClick:ye=>{ye.preventDefault(),r(Nr.FORGOTTEN_PASSWORD)},appearance:p},(E=m==null?void 0:m.forgotten_password)==null?void 0:E.link_text),e===Nr.SIGN_IN?we.createElement(kc,{href:"#auth-sign-up",onClick:ye=>{ye.preventDefault(),he(Nr.SIGN_UP)},appearance:p},(O=m==null?void 0:m.sign_up)==null?void 0:O.link_text):we.createElement(kc,{href:"#auth-sign-in",onClick:ye=>{ye.preventDefault(),he(Nr.SIGN_IN)},appearance:p},(b=m==null?void 0:m.sign_in)==null?void 0:b.link_text))),oe&&we.createElement(Lo,{appearance:p},oe),D&&we.createElement(Lo,{color:"danger",appearance:p},D))}function lR({setAuthView:e=()=>{},supabaseClient:t,redirectTo:n,i18n:r,appearance:s,showLinks:o=!1}){var a;const[c,u]=B.useState(""),[d,h]=B.useState(""),[m,p]=B.useState(""),[v,T]=B.useState(!1),E=async b=>{var M;b.preventDefault(),h(""),p(""),T(!0);const{error:I}=await t.auth.resetPasswordForEmail(c,{redirectTo:n});I?h(I.message):p((M=r==null?void 0:r.forgotten_password)==null?void 0:M.confirmation_text),T(!1)},O=r==null?void 0:r.forgotten_password;return we.createElement("form",{id:"auth-forgot-password",onSubmit:E},we.createElement(Oo,{direction:"vertical",gap:"large",appearance:s},we.createElement(Oo,{gap:"large",direction:"vertical",appearance:s},we.createElement("div",null,we.createElement(xl,{htmlFor:"email",appearance:s},O==null?void 0:O.email_label),we.createElement(bl,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:O==null?void 0:O.email_input_placeholder,onChange:b=>u(b.target.value),appearance:s})),we.createElement(hf,{type:"submit",color:"primary",loading:v,appearance:s},v?O==null?void 0:O.loading_button_label:O==null?void 0:O.button_label),o&&we.createElement(kc,{href:"#auth-sign-in",onClick:b=>{b.preventDefault(),e(Nr.SIGN_IN)},appearance:s},(a=r==null?void 0:r.sign_in)==null?void 0:a.link_text),m&&we.createElement(Lo,{appearance:s},m),d&&we.createElement(Lo,{color:"danger",appearance:s},d))))}function cR({supabaseClient:e,i18n:t,appearance:n}){const[r,s]=B.useState(""),[o,a]=B.useState(""),[c,u]=B.useState(""),[d,h]=B.useState(!1),m=async v=>{var T;v.preventDefault(),a(""),u(""),h(!0);const{error:E}=await e.auth.updateUser({password:r});E?a(E.message):u((T=t==null?void 0:t.update_password)==null?void 0:T.confirmation_text),h(!1)},p=t==null?void 0:t.update_password;return we.createElement("form",{id:"auth-update-password",onSubmit:m},we.createElement(Oo,{gap:"large",direction:"vertical",appearance:n},we.createElement("div",null,we.createElement(xl,{htmlFor:"password",appearance:n},p==null?void 0:p.password_label),we.createElement(bl,{id:"password",name:"password",placeholder:p==null?void 0:p.password_input_placeholder,type:"password",autoFocus:!0,onChange:v=>s(v.target.value),appearance:n})),we.createElement(hf,{type:"submit",color:"primary",loading:d,appearance:n},d?p==null?void 0:p.loading_button_label:p==null?void 0:p.button_label),c&&we.createElement(Lo,{appearance:n},c),o&&we.createElement(Lo,{color:"danger",appearance:n},o)))}function lY({setAuthView:e=()=>{},supabaseClient:t,otpType:n="email",i18n:r,appearance:s,showLinks:o=!1}){var a;const[c,u]=B.useState(""),[d,h]=B.useState(""),[m,p]=B.useState(""),[v,T]=B.useState(""),[E,O]=B.useState(""),[b,M]=B.useState(!1),I=async $=>{$.preventDefault(),T(""),O(""),M(!0);let P={email:c,token:m,type:n};["sms","phone_change"].includes(n)&&(P={phone:d,token:m,type:n});const{error:D}=await t.auth.verifyOtp(P);D&&T(D.message),M(!1)},k=r==null?void 0:r.verify_otp;return we.createElement("form",{id:"auth-magic-link",onSubmit:I},we.createElement(Oo,{gap:"large",direction:"vertical",appearance:s},["sms","phone_change"].includes(n)?we.createElement("div",null,we.createElement(xl,{htmlFor:"phone",appearance:s},k==null?void 0:k.phone_input_label),we.createElement(bl,{id:"phone",name:"phone",type:"text",autoFocus:!0,placeholder:k==null?void 0:k.phone_input_placeholder,onChange:$=>h($.target.value),appearance:s})):we.createElement("div",null,we.createElement(xl,{htmlFor:"email",appearance:s},k==null?void 0:k.email_input_label),we.createElement(bl,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:k==null?void 0:k.email_input_placeholder,onChange:$=>u($.target.value),appearance:s})),we.createElement("div",null,we.createElement(xl,{htmlFor:"token",appearance:s},k==null?void 0:k.token_input_label),we.createElement(bl,{id:"token",name:"token",type:"text",placeholder:k==null?void 0:k.token_input_placeholder,onChange:$=>p($.target.value),appearance:s})),we.createElement(hf,{color:"primary",type:"submit",loading:b,appearance:s},b?k==null?void 0:k.loading_button_label:k==null?void 0:k.button_label),o&&we.createElement(kc,{href:"#auth-sign-in",onClick:$=>{$.preventDefault(),e(Nr.SIGN_IN)},appearance:s},(a=r==null?void 0:r.sign_in)==null?void 0:a.link_text),E&&we.createElement(Lo,{appearance:s},E),v&&we.createElement(Lo,{color:"danger",appearance:s},v)))}const uR=B.createContext({user:null,session:null}),cY=e=>{const{supabaseClient:t}=e,[n,r]=B.useState(null),[s,o]=B.useState((n==null?void 0:n.user)??null);B.useEffect(()=>{(async()=>{var u;const{data:d}=await t.auth.getSession();r(d.session),o(((u=d.session)==null?void 0:u.user)??null)})();const{data:c}=t.auth.onAuthStateChange(async(u,d)=>{r(d),o((d==null?void 0:d.user)??null)});return()=>{c==null||c.subscription.unsubscribe()}},[]);const a={session:n,user:s};return we.createElement(uR.Provider,{value:a,...e})},uY=()=>{const e=B.useContext(uR);if(e===void 0)throw new Error("useUser must be used within a UserContextProvider.");return e};function ff({supabaseClient:e,socialLayout:t="vertical",providers:n,providerScopes:r,queryParams:s,view:o="sign_in",redirectTo:a,onlyThirdPartyProviders:c=!1,magicLink:u=!1,showLinks:d=!0,appearance:h,theme:m="default",localization:p={variables:{}},otpType:v="email",additionalData:T,children:E}){const O=mx(DQ,p.variables??{}),[b,M]=B.useState(o),[I,k]=B.useState(""),[$,P]=B.useState(""),D=b==="sign_in"||b==="sign_up"||b==="magic_link";B.useEffect(()=>{var q,oe;iR({theme:mx(((q=h==null?void 0:h.theme)==null?void 0:q.default)??{},((oe=h==null?void 0:h.variables)==null?void 0:oe.default)??{})})},[h]);const j=({children:q})=>{var oe;return we.createElement("div",{className:m!=="default"?kQ(mx(h==null?void 0:h.theme[m],((oe=h==null?void 0:h.variables)==null?void 0:oe[m])??{})):""},D&&we.createElement(aY,{appearance:h,supabaseClient:e,providers:n,providerScopes:r,queryParams:s,socialLayout:t,redirectTo:a,onlyThirdPartyProviders:c,i18n:O,view:b}),!c&&q)};B.useEffect(()=>{const{data:q}=e.auth.onAuthStateChange(oe=>{oe==="PASSWORD_RECOVERY"?M("update_password"):oe==="USER_UPDATED"&&M("sign_in")});return M(o),()=>q.subscription.unsubscribe()},[o]);const Y={supabaseClient:e,setAuthView:M,defaultEmail:I,defaultPassword:$,setDefaultEmail:k,setDefaultPassword:P,redirectTo:a,magicLink:u,showLinks:d,i18n:O,appearance:h};switch(b){case Nr.SIGN_IN:return we.createElement(j,null,we.createElement($A,{...Y,authView:"sign_in"}));case Nr.SIGN_UP:return we.createElement(j,null,we.createElement($A,{appearance:h,supabaseClient:e,authView:"sign_up",setAuthView:M,defaultEmail:I,defaultPassword:$,setDefaultEmail:k,setDefaultPassword:P,redirectTo:a,magicLink:u,showLinks:d,i18n:O,additionalData:T,children:E}));case Nr.FORGOTTEN_PASSWORD:return we.createElement(j,null,we.createElement(lR,{appearance:h,supabaseClient:e,setAuthView:M,redirectTo:a,showLinks:d,i18n:O}));case Nr.MAGIC_LINK:return we.createElement(j,null,we.createElement(aR,{appearance:h,supabaseClient:e,setAuthView:M,redirectTo:a,showLinks:d,i18n:O}));case Nr.UPDATE_PASSWORD:return we.createElement(cR,{appearance:h,supabaseClient:e,i18n:O});case Nr.VERIFY_OTP:return we.createElement(lY,{appearance:h,supabaseClient:e,otpType:v,i18n:O});default:return null}}ff.ForgottenPassword=lR;ff.UpdatePassword=cR;ff.MagicLink=aR;ff.UserContextProvider=cY;ff.useUser=uY;va({borderRadius:"12px",boxShadow:"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",width:"360px",padding:"28px 32px"});const dY=sE("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),dR=B.forwardRef(({className:e,variant:t,...n},r)=>R.jsx("div",{ref:r,role:"alert",className:Kn(dY({variant:t}),e),...n}));dR.displayName="Alert";const hY=B.forwardRef(({className:e,...t},n)=>R.jsx("h5",{ref:n,className:Kn("mb-1 font-medium leading-none tracking-tight",e),...t}));hY.displayName="AlertTitle";const hR=B.forwardRef(({className:e,...t},n)=>R.jsx("div",{ref:n,className:Kn("text-sm [&_p]:leading-relaxed",e),...t}));hR.displayName="AlertDescription";const fY=()=>{const e=yE(),[t,n]=B.useState("");B.useEffect(()=>{const{data:{subscription:s}}=So.auth.onAuthStateChange(async(o,a)=>{switch(console.log("Auth event:",o),a&&e("/"),o){case"USER_UPDATED":const{error:c}=await So.auth.getSession();c&&n(r(c));break;case"SIGNED_OUT":n(""),await So.auth.signOut();break;case"SIGNED_IN":n("");break;case"TOKEN_REFRESHED":console.log("Token refreshed successfully");break;case"INITIAL_SESSION":const{error:u}=await So.auth.getSession();u&&(console.error("Session error:",u),n(r(u)));break;default:o.includes("ERROR")&&(console.error("Auth error event:",o),n("An authentication error occurred. Please try again."))}});return So.auth.getSession().then(({data:{session:o},error:a})=>{a?(console.error("Session error:",a),n(r(a))):o&&e("/")}),()=>s.unsubscribe()},[e]);const r=s=>{if(console.error("Auth error:",s),s instanceof rD)switch(s.code){case"invalid_credentials":return"Invalid email or password. Please check your credentials and try again.";case"email_not_confirmed":return"Please verify your email address before signing in.";case"user_not_found":return"No user found with these credentials.";case"invalid_grant":return"Invalid login credentials.";case"refresh_token_not_found":return"Your session has expired. Please sign in again.";case"invalid_claim":return"Session expired. Please sign in again.";default:return`Authentication error: ${s.message}`}return s.message};return R.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:R.jsxs(Qs,{className:"w-full max-w-md",children:[R.jsx(lD,{children:R.jsx(cD,{className:"text-center text-2xl font-bold",children:"Welcome"})}),R.jsxs(uD,{children:[t&&R.jsx(dR,{variant:"destructive",className:"mb-4",children:R.jsx(hR,{children:t})}),R.jsx(ff,{supabaseClient:So,appearance:{theme:AQ,variables:{default:{colors:{brand:"rgb(var(--primary))",brandAccent:"rgb(var(--primary))"}}}},theme:"light",providers:[]})]})]})})},pY=new f6,mY=({children:e})=>{const[t,n]=B.useState(null);return B.useEffect(()=>{const{data:{subscription:r}}=So.auth.onAuthStateChange((s,o)=>{n(!!o)});return So.auth.getSession().then(({data:{session:s}})=>{n(!!s)}),()=>r.unsubscribe()},[]),t===null?R.jsx("div",{children:"Loading..."}):t?R.jsx(R.Fragment,{children:e}):R.jsx(tV,{to:"/auth",replace:!0})},gY=()=>{const e={loader:{load:["input/asciimath","[tex]/html"]},tex:{packages:{"[+]":["html"]},inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},startup:{typeset:!1},options:{enableMenu:!1,processHtmlClass:"mathjax"}};return R.jsx(oD,{version:3,config:e,children:R.jsx(m6,{client:pY,children:R.jsxs(gO,{children:[R.jsx(VB,{}),R.jsx(_5,{}),R.jsx(oV,{children:R.jsxs(rV,{children:[R.jsx(MM,{path:"/auth",element:R.jsx(fY,{})}),R.jsx(MM,{path:"/",element:R.jsx(mY,{children:R.jsx(tQ,{})})})]})})]})})})};tI(document.getElementById("root")).render(R.jsx(gY,{}));export{zA as g};
